[2024-11-11 07:26:49,906] INFO: __init__ : 26] Credit Risk Model Building Started
[2024-11-11 07:26:57,869] INFO: main : 12] >>>>>>>>>>>Starting Data Ingestion Stage<<<<<<<<<<<<<
[2024-11-11 07:26:57,869] INFO: common : 32] Successfully loaded yaml file: config\config.yaml
[2024-11-11 07:26:57,869] INFO: common : 32] Successfully loaded yaml file: params.yaml
[2024-11-11 07:26:57,893] INFO: common : 32] Successfully loaded yaml file: schema.yaml
[2024-11-11 07:26:57,894] INFO: common : 55] Created directory: artifacts
[2024-11-11 07:26:57,894] INFO: common : 55] Created directory: artifacts/data_ingestion
[2024-11-11 07:26:57,895] INFO: data_ingestion : 17] Loading customers data...
[2024-11-11 07:26:58,008] INFO: common : 79] Successfully loaded DataFrame from: data\customers.csv
[2024-11-11 07:26:58,008] INFO: data_ingestion : 20] Loading loans data...
[2024-11-11 07:26:58,155] INFO: common : 79] Successfully loaded DataFrame from: data\loans.csv
[2024-11-11 07:26:58,155] INFO: data_ingestion : 23] Loading bureau data...
[2024-11-11 07:26:58,210] INFO: common : 79] Successfully loaded DataFrame from: data\bureau_data.csv
[2024-11-11 07:26:58,210] INFO: data_ingestion : 26] The Shape of customers data: (50000, 12)
[2024-11-11 07:26:58,210] INFO: data_ingestion : 27] The Shape of loans data: (50000, 15)
[2024-11-11 07:26:58,210] INFO: data_ingestion : 28] The Shape of bureau data: (50000, 8)
[2024-11-11 07:26:58,744] INFO: common : 97] Successfully saved DataFrame to: artifacts\data_ingestion\data.csv
[2024-11-11 07:26:58,746] INFO: main : 14] >>>>>>>>>>>Completed Data Ingestion Stage<<<<<<<<<<<<<
[2024-11-11 07:26:58,746] INFO: main : 24] >>>>>>>>>>>Starting Data Pre-Processing Stage<<<<<<<<<<<<<
[2024-11-11 07:26:58,755] INFO: common : 32] Successfully loaded yaml file: config\config.yaml
[2024-11-11 07:26:58,757] INFO: common : 32] Successfully loaded yaml file: params.yaml
[2024-11-11 07:26:58,759] INFO: common : 32] Successfully loaded yaml file: schema.yaml
[2024-11-11 07:26:58,760] INFO: common : 55] Created directory: artifacts
[2024-11-11 07:26:58,761] INFO: common : 55] Created directory: artifacts/data_preprocessing
[2024-11-11 07:26:58,972] INFO: common : 79] Successfully loaded DataFrame from: artifacts\data_ingestion\data.csv
[2024-11-11 07:26:58,972] INFO: data_preprocessing : 26] The Valure counts for 'default' column: default
0    45703
1     4297
Name: count, dtype: int64
[2024-11-11 07:26:58,988] INFO: data_preprocessing : 42] No missing values found in column 'cust_id'
[2024-11-11 07:26:58,988] INFO: data_preprocessing : 42] No missing values found in column 'age'
[2024-11-11 07:26:58,991] INFO: data_preprocessing : 42] No missing values found in column 'gender'
[2024-11-11 07:26:58,991] INFO: data_preprocessing : 42] No missing values found in column 'marital_status'
[2024-11-11 07:26:58,991] INFO: data_preprocessing : 42] No missing values found in column 'employment_status'
[2024-11-11 07:26:58,991] INFO: data_preprocessing : 42] No missing values found in column 'income'
[2024-11-11 07:26:58,999] INFO: data_preprocessing : 42] No missing values found in column 'number_of_dependants'
[2024-11-11 07:26:59,002] WARNING: data_preprocessing : 33] Missing values found in column 'residence_type', replacing with 'Unknown'
[2024-11-11 07:26:59,016] INFO: data_preprocessing : 35] Missing values replaced in column 'residence_type' with mode 'Owned'
[2024-11-11 07:26:59,016] INFO: data_preprocessing : 42] No missing values found in column 'years_at_current_address'
[2024-11-11 07:26:59,018] INFO: data_preprocessing : 42] No missing values found in column 'city'
[2024-11-11 07:26:59,021] INFO: data_preprocessing : 42] No missing values found in column 'state'
[2024-11-11 07:26:59,022] INFO: data_preprocessing : 42] No missing values found in column 'zipcode'
[2024-11-11 07:26:59,024] INFO: data_preprocessing : 42] No missing values found in column 'loan_id'
[2024-11-11 07:26:59,028] INFO: data_preprocessing : 42] No missing values found in column 'loan_purpose'
[2024-11-11 07:26:59,031] INFO: data_preprocessing : 42] No missing values found in column 'loan_type'
[2024-11-11 07:26:59,033] INFO: data_preprocessing : 42] No missing values found in column 'sanction_amount'
[2024-11-11 07:26:59,033] INFO: data_preprocessing : 42] No missing values found in column 'loan_amount'
[2024-11-11 07:26:59,034] INFO: data_preprocessing : 42] No missing values found in column 'processing_fee'
[2024-11-11 07:26:59,035] INFO: data_preprocessing : 42] No missing values found in column 'gst'
[2024-11-11 07:26:59,036] INFO: data_preprocessing : 42] No missing values found in column 'net_disbursement'
[2024-11-11 07:26:59,036] INFO: data_preprocessing : 42] No missing values found in column 'loan_tenure_months'
[2024-11-11 07:26:59,036] INFO: data_preprocessing : 42] No missing values found in column 'principal_outstanding'
[2024-11-11 07:26:59,036] INFO: data_preprocessing : 42] No missing values found in column 'bank_balance_at_application'
[2024-11-11 07:26:59,041] INFO: data_preprocessing : 42] No missing values found in column 'disbursal_date'
[2024-11-11 07:26:59,045] INFO: data_preprocessing : 42] No missing values found in column 'installment_start_dt'
[2024-11-11 07:26:59,046] INFO: data_preprocessing : 42] No missing values found in column 'default'
[2024-11-11 07:26:59,047] INFO: data_preprocessing : 42] No missing values found in column 'number_of_open_accounts'
[2024-11-11 07:26:59,048] INFO: data_preprocessing : 42] No missing values found in column 'number_of_closed_accounts'
[2024-11-11 07:26:59,049] INFO: data_preprocessing : 42] No missing values found in column 'total_loan_months'
[2024-11-11 07:26:59,049] INFO: data_preprocessing : 42] No missing values found in column 'delinquent_months'
[2024-11-11 07:26:59,050] INFO: data_preprocessing : 42] No missing values found in column 'total_dpd'
[2024-11-11 07:26:59,050] INFO: data_preprocessing : 42] No missing values found in column 'enquiry_count'
[2024-11-11 07:26:59,052] INFO: data_preprocessing : 42] No missing values found in column 'credit_utilization_ratio'
[2024-11-11 07:26:59,125] INFO: data_preprocessing : 51] No duplicate rows found
[2024-11-11 07:26:59,125] INFO: data_preprocessing : 53] Index(['cust_id', 'age', 'gender', 'marital_status', 'employment_status',
       'income', 'number_of_dependants', 'residence_type',
       'years_at_current_address', 'city', 'state', 'zipcode', 'loan_id',
       'loan_purpose', 'loan_type', 'sanction_amount', 'loan_amount',
       'processing_fee', 'gst', 'net_disbursement', 'loan_tenure_months',
       'principal_outstanding', 'bank_balance_at_application',
       'disbursal_date', 'installment_start_dt', 'default',
       'number_of_open_accounts', 'number_of_closed_accounts',
       'total_loan_months', 'delinquent_months', 'total_dpd', 'enquiry_count',
       'credit_utilization_ratio'],
      dtype='object')
[2024-11-11 07:26:59,622] INFO: common : 97] Successfully saved DataFrame to: artifacts\data_preprocessing\preprocessed_data.csv
[2024-11-11 07:26:59,624] INFO: main : 26] >>>>>>>>>>>Completed Data Pre-Processing Stage<<<<<<<<<<<<<
[2024-11-11 07:26:59,624] INFO: main : 36] >>>>>>>>>>>Starting Data Cleaning Stage<<<<<<<<<<<<<
[2024-11-11 07:26:59,624] INFO: common : 32] Successfully loaded yaml file: config\config.yaml
[2024-11-11 07:26:59,631] INFO: common : 32] Successfully loaded yaml file: params.yaml
[2024-11-11 07:26:59,634] INFO: common : 32] Successfully loaded yaml file: schema.yaml
[2024-11-11 07:26:59,635] INFO: common : 55] Created directory: artifacts
[2024-11-11 07:26:59,636] INFO: common : 55] Created directory: artifacts/data_cleaning
[2024-11-11 07:26:59,851] INFO: common : 79] Successfully loaded DataFrame from: artifacts\data_preprocessing\preprocessed_data.csv
[2024-11-11 07:26:59,851] INFO: data_cleaning : 30] Initiating train test split...
[2024-11-11 07:26:59,883] INFO: data_cleaning : 32] Train test split completed successfully.
[2024-11-11 07:26:59,884] INFO: data_cleaning : 54] Train_df :Index(['cust_id', 'age', 'gender', 'marital_status', 'employment_status',
       'income', 'number_of_dependants', 'residence_type',
       'years_at_current_address', 'city', 'state', 'zipcode', 'loan_id',
       'loan_purpose', 'loan_type', 'sanction_amount', 'loan_amount',
       'processing_fee', 'gst', 'net_disbursement', 'loan_tenure_months',
       'principal_outstanding', 'bank_balance_at_application',
       'disbursal_date', 'installment_start_dt', 'default',
       'number_of_open_accounts', 'number_of_closed_accounts',
       'total_loan_months', 'delinquent_months', 'total_dpd', 'enquiry_count',
       'credit_utilization_ratio'],
      dtype='object')
[2024-11-11 07:26:59,900] INFO: data_cleaning : 59]  After outlier removal train_df :(40000, 33)
[2024-11-11 07:26:59,900] INFO: data_cleaning : 60]  After outlier removal test_df :(10000, 33)
[2024-11-11 07:26:59,900] INFO: data_cleaning : 65] Rule 1: GST should not be more than 20% :(0, 33)
[2024-11-11 07:26:59,907] INFO: data_cleaning : 69] Rule 2: Net disbursement should not be higher than loan_amount :(0, 33)
[2024-11-11 07:26:59,917] INFO: data_cleaning : 74] Rule 3 : Fixed loan_purpose column :loan_purpose
Personal     14037
Home         12006
Auto          7950
Education     6007
Name: count, dtype: int64
[2024-11-11 07:26:59,919] INFO: data_cleaning : 79] Rule 4 : Generated loan_to_income column(LTI)
[2024-11-11 07:26:59,932] INFO: data_cleaning : 84] Generated delinquency_ratio column :count    40000.000000
mean        10.424123
std         17.283345
min          0.000000
25%          0.000000
50%          3.800000
75%         13.200000
max        100.000000
Name: delinquency_ratio, dtype: float64
[2024-11-11 07:26:59,959] INFO: data_cleaning : 106] Categorical Columns : Index(['gender', 'marital_status', 'employment_status', 'residence_type',
       'city', 'state', 'loan_purpose', 'loan_type', 'disbursal_date',
       'installment_start_dt'],
      dtype='object')
[2024-11-11 07:26:59,959] INFO: data_cleaning : 107] Numerical Columns : Index(['age', 'income', 'number_of_dependants', 'years_at_current_address',
       'zipcode', 'sanction_amount', 'loan_amount', 'processing_fee', 'gst',
       'net_disbursement', 'loan_tenure_months', 'principal_outstanding',
       'bank_balance_at_application', 'default', 'number_of_open_accounts',
       'number_of_closed_accounts', 'total_loan_months', 'delinquent_months',
       'total_dpd', 'enquiry_count', 'credit_utilization_ratio',
       'loan_to_income', 'delinquency_ratio', 'avg_dpd_per_delinquency'],
      dtype='object')
[2024-11-11 07:26:59,959] INFO: data_cleaning : 40] Removing columns...
[2024-11-11 07:26:59,959] INFO: data_cleaning : 43] Columns removed successfully.
[2024-11-11 07:26:59,973] INFO: data_cleaning : 40] Removing columns...
[2024-11-11 07:26:59,975] INFO: data_cleaning : 43] Columns removed successfully.
[2024-11-11 07:27:00,328] INFO: common : 97] Successfully saved DataFrame to: artifacts\data_cleaning\train_data.csv
[2024-11-11 07:27:00,434] INFO: common : 97] Successfully saved DataFrame to: artifacts\data_cleaning\test_data.csv
[2024-11-11 07:27:00,440] INFO: main : 38] >>>>>>>>>>>Completed Data Cleaning Stage<<<<<<<<<<<<<
[2024-11-11 07:53:37,962] INFO: __init__ : 26] Credit Risk Model Building Started
[2024-11-11 07:53:49,020] INFO: main : 12] >>>>>>>>>>>Starting Data Ingestion Stage<<<<<<<<<<<<<
[2024-11-11 07:53:49,033] INFO: common : 32] Successfully loaded yaml file: config\config.yaml
[2024-11-11 07:53:49,036] INFO: common : 32] Successfully loaded yaml file: params.yaml
[2024-11-11 07:53:49,049] INFO: common : 32] Successfully loaded yaml file: schema.yaml
[2024-11-11 07:53:49,051] INFO: common : 55] Created directory: artifacts
[2024-11-11 07:53:49,051] INFO: common : 55] Created directory: artifacts/data_ingestion
[2024-11-11 07:53:49,052] INFO: data_ingestion : 17] Loading customers data...
[2024-11-11 07:53:49,171] INFO: common : 79] Successfully loaded DataFrame from: data\customers.csv
[2024-11-11 07:53:49,172] INFO: data_ingestion : 20] Loading loans data...
[2024-11-11 07:53:49,327] INFO: common : 79] Successfully loaded DataFrame from: data\loans.csv
[2024-11-11 07:53:49,328] INFO: data_ingestion : 23] Loading bureau data...
[2024-11-11 07:53:49,381] INFO: common : 79] Successfully loaded DataFrame from: data\bureau_data.csv
[2024-11-11 07:53:49,381] INFO: data_ingestion : 26] The Shape of customers data: (50000, 12)
[2024-11-11 07:53:49,395] INFO: data_ingestion : 27] The Shape of loans data: (50000, 15)
[2024-11-11 07:53:49,395] INFO: data_ingestion : 28] The Shape of bureau data: (50000, 8)
[2024-11-11 07:53:49,910] INFO: common : 97] Successfully saved DataFrame to: artifacts\data_ingestion\data.csv
[2024-11-11 07:53:49,924] INFO: main : 14] >>>>>>>>>>>Completed Data Ingestion Stage<<<<<<<<<<<<<
[2024-11-11 07:53:49,924] INFO: main : 24] >>>>>>>>>>>Starting Data Pre-Processing Stage<<<<<<<<<<<<<
[2024-11-11 07:53:49,928] INFO: common : 32] Successfully loaded yaml file: config\config.yaml
[2024-11-11 07:53:49,930] INFO: common : 32] Successfully loaded yaml file: params.yaml
[2024-11-11 07:53:49,931] INFO: common : 32] Successfully loaded yaml file: schema.yaml
[2024-11-11 07:53:49,931] INFO: common : 55] Created directory: artifacts
[2024-11-11 07:53:49,931] INFO: common : 55] Created directory: artifacts/data_preprocessing
[2024-11-11 07:53:50,141] INFO: common : 79] Successfully loaded DataFrame from: artifacts\data_ingestion\data.csv
[2024-11-11 07:53:50,141] INFO: data_preprocessing : 26] The Valure counts for 'default' column: default
0    45703
1     4297
Name: count, dtype: int64
[2024-11-11 07:53:50,141] INFO: data_preprocessing : 42] No missing values found in column 'cust_id'
[2024-11-11 07:53:50,141] INFO: data_preprocessing : 42] No missing values found in column 'age'
[2024-11-11 07:53:50,156] INFO: data_preprocessing : 42] No missing values found in column 'gender'
[2024-11-11 07:53:50,159] INFO: data_preprocessing : 42] No missing values found in column 'marital_status'
[2024-11-11 07:53:50,162] INFO: data_preprocessing : 42] No missing values found in column 'employment_status'
[2024-11-11 07:53:50,163] INFO: data_preprocessing : 42] No missing values found in column 'income'
[2024-11-11 07:53:50,164] INFO: data_preprocessing : 42] No missing values found in column 'number_of_dependants'
[2024-11-11 07:53:50,167] WARNING: data_preprocessing : 33] Missing values found in column 'residence_type', replacing with 'Unknown'
[2024-11-11 07:53:50,178] INFO: data_preprocessing : 35] Missing values replaced in column 'residence_type' with mode 'Owned'
[2024-11-11 07:53:50,179] INFO: data_preprocessing : 42] No missing values found in column 'years_at_current_address'
[2024-11-11 07:53:50,180] INFO: data_preprocessing : 42] No missing values found in column 'city'
[2024-11-11 07:53:50,180] INFO: data_preprocessing : 42] No missing values found in column 'state'
[2024-11-11 07:53:50,180] INFO: data_preprocessing : 42] No missing values found in column 'zipcode'
[2024-11-11 07:53:50,190] INFO: data_preprocessing : 42] No missing values found in column 'loan_id'
[2024-11-11 07:53:50,193] INFO: data_preprocessing : 42] No missing values found in column 'loan_purpose'
[2024-11-11 07:53:50,196] INFO: data_preprocessing : 42] No missing values found in column 'loan_type'
[2024-11-11 07:53:50,197] INFO: data_preprocessing : 42] No missing values found in column 'sanction_amount'
[2024-11-11 07:53:50,198] INFO: data_preprocessing : 42] No missing values found in column 'loan_amount'
[2024-11-11 07:53:50,199] INFO: data_preprocessing : 42] No missing values found in column 'processing_fee'
[2024-11-11 07:53:50,200] INFO: data_preprocessing : 42] No missing values found in column 'gst'
[2024-11-11 07:53:50,201] INFO: data_preprocessing : 42] No missing values found in column 'net_disbursement'
[2024-11-11 07:53:50,202] INFO: data_preprocessing : 42] No missing values found in column 'loan_tenure_months'
[2024-11-11 07:53:50,203] INFO: data_preprocessing : 42] No missing values found in column 'principal_outstanding'
[2024-11-11 07:53:50,204] INFO: data_preprocessing : 42] No missing values found in column 'bank_balance_at_application'
[2024-11-11 07:53:50,207] INFO: data_preprocessing : 42] No missing values found in column 'disbursal_date'
[2024-11-11 07:53:50,210] INFO: data_preprocessing : 42] No missing values found in column 'installment_start_dt'
[2024-11-11 07:53:50,212] INFO: data_preprocessing : 42] No missing values found in column 'default'
[2024-11-11 07:53:50,212] INFO: data_preprocessing : 42] No missing values found in column 'number_of_open_accounts'
[2024-11-11 07:53:50,213] INFO: data_preprocessing : 42] No missing values found in column 'number_of_closed_accounts'
[2024-11-11 07:53:50,214] INFO: data_preprocessing : 42] No missing values found in column 'total_loan_months'
[2024-11-11 07:53:50,215] INFO: data_preprocessing : 42] No missing values found in column 'delinquent_months'
[2024-11-11 07:53:50,216] INFO: data_preprocessing : 42] No missing values found in column 'total_dpd'
[2024-11-11 07:53:50,217] INFO: data_preprocessing : 42] No missing values found in column 'enquiry_count'
[2024-11-11 07:53:50,218] INFO: data_preprocessing : 42] No missing values found in column 'credit_utilization_ratio'
[2024-11-11 07:53:50,281] INFO: data_preprocessing : 51] No duplicate rows found
[2024-11-11 07:53:50,281] INFO: data_preprocessing : 53] Index(['cust_id', 'age', 'gender', 'marital_status', 'employment_status',
       'income', 'number_of_dependants', 'residence_type',
       'years_at_current_address', 'city', 'state', 'zipcode', 'loan_id',
       'loan_purpose', 'loan_type', 'sanction_amount', 'loan_amount',
       'processing_fee', 'gst', 'net_disbursement', 'loan_tenure_months',
       'principal_outstanding', 'bank_balance_at_application',
       'disbursal_date', 'installment_start_dt', 'default',
       'number_of_open_accounts', 'number_of_closed_accounts',
       'total_loan_months', 'delinquent_months', 'total_dpd', 'enquiry_count',
       'credit_utilization_ratio'],
      dtype='object')
[2024-11-11 07:53:50,790] INFO: common : 97] Successfully saved DataFrame to: artifacts\data_preprocessing\preprocessed_data.csv
[2024-11-11 07:53:50,790] INFO: main : 26] >>>>>>>>>>>Completed Data Pre-Processing Stage<<<<<<<<<<<<<
[2024-11-11 07:53:50,790] INFO: main : 36] >>>>>>>>>>>Starting Data Cleaning Stage<<<<<<<<<<<<<
[2024-11-11 07:53:50,790] INFO: common : 32] Successfully loaded yaml file: config\config.yaml
[2024-11-11 07:53:50,800] INFO: common : 32] Successfully loaded yaml file: params.yaml
[2024-11-11 07:53:50,802] INFO: common : 32] Successfully loaded yaml file: schema.yaml
[2024-11-11 07:53:50,805] INFO: common : 55] Created directory: artifacts
[2024-11-11 07:53:50,805] INFO: common : 55] Created directory: artifacts/data_cleaning
[2024-11-11 07:53:50,807] ERROR: main : 41] An unexpected error occurred: DataCleaningConfig.__init__() got an unexpected keyword argument 'schema'
[2024-11-11 07:54:26,533] INFO: __init__ : 26] Credit Risk Model Building Started
[2024-11-11 07:54:28,668] INFO: main : 12] >>>>>>>>>>>Starting Data Ingestion Stage<<<<<<<<<<<<<
[2024-11-11 07:54:28,668] INFO: common : 32] Successfully loaded yaml file: config\config.yaml
[2024-11-11 07:54:28,668] INFO: common : 32] Successfully loaded yaml file: params.yaml
[2024-11-11 07:54:28,683] INFO: common : 32] Successfully loaded yaml file: schema.yaml
[2024-11-11 07:54:28,684] INFO: common : 55] Created directory: artifacts
[2024-11-11 07:54:28,684] INFO: common : 55] Created directory: artifacts/data_ingestion
[2024-11-11 07:54:28,684] INFO: data_ingestion : 17] Loading customers data...
[2024-11-11 07:54:28,777] INFO: common : 79] Successfully loaded DataFrame from: data\customers.csv
[2024-11-11 07:54:28,778] INFO: data_ingestion : 20] Loading loans data...
[2024-11-11 07:54:28,896] INFO: common : 79] Successfully loaded DataFrame from: data\loans.csv
[2024-11-11 07:54:28,896] INFO: data_ingestion : 23] Loading bureau data...
[2024-11-11 07:54:28,937] INFO: common : 79] Successfully loaded DataFrame from: data\bureau_data.csv
[2024-11-11 07:54:28,937] INFO: data_ingestion : 26] The Shape of customers data: (50000, 12)
[2024-11-11 07:54:28,945] INFO: data_ingestion : 27] The Shape of loans data: (50000, 15)
[2024-11-11 07:54:28,946] INFO: data_ingestion : 28] The Shape of bureau data: (50000, 8)
[2024-11-11 07:54:29,419] INFO: common : 97] Successfully saved DataFrame to: artifacts\data_ingestion\data.csv
[2024-11-11 07:54:29,434] INFO: main : 14] >>>>>>>>>>>Completed Data Ingestion Stage<<<<<<<<<<<<<
[2024-11-11 07:54:29,434] INFO: main : 24] >>>>>>>>>>>Starting Data Pre-Processing Stage<<<<<<<<<<<<<
[2024-11-11 07:54:29,438] INFO: common : 32] Successfully loaded yaml file: config\config.yaml
[2024-11-11 07:54:29,439] INFO: common : 32] Successfully loaded yaml file: params.yaml
[2024-11-11 07:54:29,443] INFO: common : 32] Successfully loaded yaml file: schema.yaml
[2024-11-11 07:54:29,443] INFO: common : 55] Created directory: artifacts
[2024-11-11 07:54:29,444] INFO: common : 55] Created directory: artifacts/data_preprocessing
[2024-11-11 07:54:29,641] INFO: common : 79] Successfully loaded DataFrame from: artifacts\data_ingestion\data.csv
[2024-11-11 07:54:29,642] INFO: data_preprocessing : 26] The Valure counts for 'default' column: default
0    45703
1     4297
Name: count, dtype: int64
[2024-11-11 07:54:29,642] INFO: data_preprocessing : 42] No missing values found in column 'cust_id'
[2024-11-11 07:54:29,642] INFO: data_preprocessing : 42] No missing values found in column 'age'
[2024-11-11 07:54:29,651] INFO: data_preprocessing : 42] No missing values found in column 'gender'
[2024-11-11 07:54:29,654] INFO: data_preprocessing : 42] No missing values found in column 'marital_status'
[2024-11-11 07:54:29,658] INFO: data_preprocessing : 42] No missing values found in column 'employment_status'
[2024-11-11 07:54:29,659] INFO: data_preprocessing : 42] No missing values found in column 'income'
[2024-11-11 07:54:29,659] INFO: data_preprocessing : 42] No missing values found in column 'number_of_dependants'
[2024-11-11 07:54:29,662] WARNING: data_preprocessing : 33] Missing values found in column 'residence_type', replacing with 'Unknown'
[2024-11-11 07:54:29,670] INFO: data_preprocessing : 35] Missing values replaced in column 'residence_type' with mode 'Owned'
[2024-11-11 07:54:29,678] INFO: data_preprocessing : 42] No missing values found in column 'years_at_current_address'
[2024-11-11 07:54:29,682] INFO: data_preprocessing : 42] No missing values found in column 'city'
[2024-11-11 07:54:29,685] INFO: data_preprocessing : 42] No missing values found in column 'state'
[2024-11-11 07:54:29,686] INFO: data_preprocessing : 42] No missing values found in column 'zipcode'
[2024-11-11 07:54:29,688] INFO: data_preprocessing : 42] No missing values found in column 'loan_id'
[2024-11-11 07:54:29,691] INFO: data_preprocessing : 42] No missing values found in column 'loan_purpose'
[2024-11-11 07:54:29,693] INFO: data_preprocessing : 42] No missing values found in column 'loan_type'
[2024-11-11 07:54:29,694] INFO: data_preprocessing : 42] No missing values found in column 'sanction_amount'
[2024-11-11 07:54:29,695] INFO: data_preprocessing : 42] No missing values found in column 'loan_amount'
[2024-11-11 07:54:29,696] INFO: data_preprocessing : 42] No missing values found in column 'processing_fee'
[2024-11-11 07:54:29,697] INFO: data_preprocessing : 42] No missing values found in column 'gst'
[2024-11-11 07:54:29,699] INFO: data_preprocessing : 42] No missing values found in column 'net_disbursement'
[2024-11-11 07:54:29,699] INFO: data_preprocessing : 42] No missing values found in column 'loan_tenure_months'
[2024-11-11 07:54:29,700] INFO: data_preprocessing : 42] No missing values found in column 'principal_outstanding'
[2024-11-11 07:54:29,701] INFO: data_preprocessing : 42] No missing values found in column 'bank_balance_at_application'
[2024-11-11 07:54:29,704] INFO: data_preprocessing : 42] No missing values found in column 'disbursal_date'
[2024-11-11 07:54:29,706] INFO: data_preprocessing : 42] No missing values found in column 'installment_start_dt'
[2024-11-11 07:54:29,707] INFO: data_preprocessing : 42] No missing values found in column 'default'
[2024-11-11 07:54:29,708] INFO: data_preprocessing : 42] No missing values found in column 'number_of_open_accounts'
[2024-11-11 07:54:29,709] INFO: data_preprocessing : 42] No missing values found in column 'number_of_closed_accounts'
[2024-11-11 07:54:29,710] INFO: data_preprocessing : 42] No missing values found in column 'total_loan_months'
[2024-11-11 07:54:29,711] INFO: data_preprocessing : 42] No missing values found in column 'delinquent_months'
[2024-11-11 07:54:29,712] INFO: data_preprocessing : 42] No missing values found in column 'total_dpd'
[2024-11-11 07:54:29,713] INFO: data_preprocessing : 42] No missing values found in column 'enquiry_count'
[2024-11-11 07:54:29,714] INFO: data_preprocessing : 42] No missing values found in column 'credit_utilization_ratio'
[2024-11-11 07:54:29,778] INFO: data_preprocessing : 51] No duplicate rows found
[2024-11-11 07:54:29,779] INFO: data_preprocessing : 53] Index(['cust_id', 'age', 'gender', 'marital_status', 'employment_status',
       'income', 'number_of_dependants', 'residence_type',
       'years_at_current_address', 'city', 'state', 'zipcode', 'loan_id',
       'loan_purpose', 'loan_type', 'sanction_amount', 'loan_amount',
       'processing_fee', 'gst', 'net_disbursement', 'loan_tenure_months',
       'principal_outstanding', 'bank_balance_at_application',
       'disbursal_date', 'installment_start_dt', 'default',
       'number_of_open_accounts', 'number_of_closed_accounts',
       'total_loan_months', 'delinquent_months', 'total_dpd', 'enquiry_count',
       'credit_utilization_ratio'],
      dtype='object')
[2024-11-11 07:54:30,348] INFO: common : 97] Successfully saved DataFrame to: artifacts\data_preprocessing\preprocessed_data.csv
[2024-11-11 07:54:30,348] INFO: main : 26] >>>>>>>>>>>Completed Data Pre-Processing Stage<<<<<<<<<<<<<
[2024-11-11 07:54:30,348] INFO: main : 36] >>>>>>>>>>>Starting Data Cleaning Stage<<<<<<<<<<<<<
[2024-11-11 07:54:30,359] INFO: common : 32] Successfully loaded yaml file: config\config.yaml
[2024-11-11 07:54:30,361] INFO: common : 32] Successfully loaded yaml file: params.yaml
[2024-11-11 07:54:30,365] INFO: common : 32] Successfully loaded yaml file: schema.yaml
[2024-11-11 07:54:30,366] INFO: common : 55] Created directory: artifacts
[2024-11-11 07:54:30,367] INFO: common : 55] Created directory: artifacts/data_cleaning
[2024-11-11 07:54:30,368] ERROR: main : 41] An unexpected error occurred: 'DataCleaningConfig' object has no attribute 'params'
[2024-11-11 07:55:17,443] INFO: __init__ : 26] Credit Risk Model Building Started
[2024-11-11 07:55:19,464] INFO: main : 12] >>>>>>>>>>>Starting Data Ingestion Stage<<<<<<<<<<<<<
[2024-11-11 07:55:19,464] INFO: common : 32] Successfully loaded yaml file: config\config.yaml
[2024-11-11 07:55:19,479] INFO: common : 32] Successfully loaded yaml file: params.yaml
[2024-11-11 07:55:19,484] INFO: common : 32] Successfully loaded yaml file: schema.yaml
[2024-11-11 07:55:19,486] INFO: common : 55] Created directory: artifacts
[2024-11-11 07:55:19,486] INFO: common : 55] Created directory: artifacts/data_ingestion
[2024-11-11 07:55:19,487] INFO: data_ingestion : 17] Loading customers data...
[2024-11-11 07:55:19,594] INFO: common : 79] Successfully loaded DataFrame from: data\customers.csv
[2024-11-11 07:55:19,595] INFO: data_ingestion : 20] Loading loans data...
[2024-11-11 07:55:19,729] INFO: common : 79] Successfully loaded DataFrame from: data\loans.csv
[2024-11-11 07:55:19,729] INFO: data_ingestion : 23] Loading bureau data...
[2024-11-11 07:55:19,785] INFO: common : 79] Successfully loaded DataFrame from: data\bureau_data.csv
[2024-11-11 07:55:19,785] INFO: data_ingestion : 26] The Shape of customers data: (50000, 12)
[2024-11-11 07:55:19,785] INFO: data_ingestion : 27] The Shape of loans data: (50000, 15)
[2024-11-11 07:55:19,785] INFO: data_ingestion : 28] The Shape of bureau data: (50000, 8)
[2024-11-11 07:55:19,847] ERROR: common : 100] Error saving DataFrame to: artifacts\data_ingestion\data.csv - [Errno 22] Invalid argument: 'artifacts\\data_ingestion\\data.csv'
[2024-11-11 07:55:19,847] ERROR: data_ingestion_pipeline : 22] Error occurred during data ingestion: Error occurred in python script name [C:\Users\ambig\jupiter_notebook\Projects\Credit-Risk-Model\src\Credit_Risk_Model\utils\common.py] line number [95] error message[[Errno 22] Invalid argument: 'artifacts\\data_ingestion\\data.csv']
[2024-11-11 07:55:19,862] INFO: main : 14] >>>>>>>>>>>Completed Data Ingestion Stage<<<<<<<<<<<<<
[2024-11-11 07:55:19,863] INFO: main : 24] >>>>>>>>>>>Starting Data Pre-Processing Stage<<<<<<<<<<<<<
[2024-11-11 07:55:19,868] INFO: common : 32] Successfully loaded yaml file: config\config.yaml
[2024-11-11 07:55:19,871] INFO: common : 32] Successfully loaded yaml file: params.yaml
[2024-11-11 07:55:19,873] INFO: common : 32] Successfully loaded yaml file: schema.yaml
[2024-11-11 07:55:19,873] INFO: common : 55] Created directory: artifacts
[2024-11-11 07:55:19,873] INFO: common : 55] Created directory: artifacts/data_preprocessing
[2024-11-11 07:55:20,122] INFO: common : 79] Successfully loaded DataFrame from: artifacts\data_ingestion\data.csv
[2024-11-11 07:55:20,122] INFO: data_preprocessing : 26] The Valure counts for 'default' column: default
0    45703
1     4297
Name: count, dtype: int64
[2024-11-11 07:55:20,122] INFO: data_preprocessing : 42] No missing values found in column 'cust_id'
[2024-11-11 07:55:20,122] INFO: data_preprocessing : 42] No missing values found in column 'age'
[2024-11-11 07:55:20,134] INFO: data_preprocessing : 42] No missing values found in column 'gender'
[2024-11-11 07:55:20,137] INFO: data_preprocessing : 42] No missing values found in column 'marital_status'
[2024-11-11 07:55:20,141] INFO: data_preprocessing : 42] No missing values found in column 'employment_status'
[2024-11-11 07:55:20,142] INFO: data_preprocessing : 42] No missing values found in column 'income'
[2024-11-11 07:55:20,143] INFO: data_preprocessing : 42] No missing values found in column 'number_of_dependants'
[2024-11-11 07:55:20,146] WARNING: data_preprocessing : 33] Missing values found in column 'residence_type', replacing with 'Unknown'
[2024-11-11 07:55:20,154] INFO: data_preprocessing : 35] Missing values replaced in column 'residence_type' with mode 'Owned'
[2024-11-11 07:55:20,162] INFO: data_preprocessing : 42] No missing values found in column 'years_at_current_address'
[2024-11-11 07:55:20,165] INFO: data_preprocessing : 42] No missing values found in column 'city'
[2024-11-11 07:55:20,169] INFO: data_preprocessing : 42] No missing values found in column 'state'
[2024-11-11 07:55:20,169] INFO: data_preprocessing : 42] No missing values found in column 'zipcode'
[2024-11-11 07:55:20,174] INFO: data_preprocessing : 42] No missing values found in column 'loan_id'
[2024-11-11 07:55:20,178] INFO: data_preprocessing : 42] No missing values found in column 'loan_purpose'
[2024-11-11 07:55:20,181] INFO: data_preprocessing : 42] No missing values found in column 'loan_type'
[2024-11-11 07:55:20,183] INFO: data_preprocessing : 42] No missing values found in column 'sanction_amount'
[2024-11-11 07:55:20,184] INFO: data_preprocessing : 42] No missing values found in column 'loan_amount'
[2024-11-11 07:55:20,185] INFO: data_preprocessing : 42] No missing values found in column 'processing_fee'
[2024-11-11 07:55:20,187] INFO: data_preprocessing : 42] No missing values found in column 'gst'
[2024-11-11 07:55:20,188] INFO: data_preprocessing : 42] No missing values found in column 'net_disbursement'
[2024-11-11 07:55:20,189] INFO: data_preprocessing : 42] No missing values found in column 'loan_tenure_months'
[2024-11-11 07:55:20,191] INFO: data_preprocessing : 42] No missing values found in column 'principal_outstanding'
[2024-11-11 07:55:20,192] INFO: data_preprocessing : 42] No missing values found in column 'bank_balance_at_application'
[2024-11-11 07:55:20,196] INFO: data_preprocessing : 42] No missing values found in column 'disbursal_date'
[2024-11-11 07:55:20,198] INFO: data_preprocessing : 42] No missing values found in column 'installment_start_dt'
[2024-11-11 07:55:20,198] INFO: data_preprocessing : 42] No missing values found in column 'default'
[2024-11-11 07:55:20,203] INFO: data_preprocessing : 42] No missing values found in column 'number_of_open_accounts'
[2024-11-11 07:55:20,204] INFO: data_preprocessing : 42] No missing values found in column 'number_of_closed_accounts'
[2024-11-11 07:55:20,205] INFO: data_preprocessing : 42] No missing values found in column 'total_loan_months'
[2024-11-11 07:55:20,206] INFO: data_preprocessing : 42] No missing values found in column 'delinquent_months'
[2024-11-11 07:55:20,207] INFO: data_preprocessing : 42] No missing values found in column 'total_dpd'
[2024-11-11 07:55:20,208] INFO: data_preprocessing : 42] No missing values found in column 'enquiry_count'
[2024-11-11 07:55:20,208] INFO: data_preprocessing : 42] No missing values found in column 'credit_utilization_ratio'
[2024-11-11 07:55:20,280] INFO: data_preprocessing : 51] No duplicate rows found
[2024-11-11 07:55:20,280] INFO: data_preprocessing : 53] Index(['cust_id', 'age', 'gender', 'marital_status', 'employment_status',
       'income', 'number_of_dependants', 'residence_type',
       'years_at_current_address', 'city', 'state', 'zipcode', 'loan_id',
       'loan_purpose', 'loan_type', 'sanction_amount', 'loan_amount',
       'processing_fee', 'gst', 'net_disbursement', 'loan_tenure_months',
       'principal_outstanding', 'bank_balance_at_application',
       'disbursal_date', 'installment_start_dt', 'default',
       'number_of_open_accounts', 'number_of_closed_accounts',
       'total_loan_months', 'delinquent_months', 'total_dpd', 'enquiry_count',
       'credit_utilization_ratio'],
      dtype='object')
[2024-11-11 07:55:20,811] INFO: common : 97] Successfully saved DataFrame to: artifacts\data_preprocessing\preprocessed_data.csv
[2024-11-11 07:55:20,811] INFO: main : 26] >>>>>>>>>>>Completed Data Pre-Processing Stage<<<<<<<<<<<<<
[2024-11-11 07:55:20,827] INFO: main : 36] >>>>>>>>>>>Starting Data Cleaning Stage<<<<<<<<<<<<<
[2024-11-11 07:55:20,831] INFO: common : 32] Successfully loaded yaml file: config\config.yaml
[2024-11-11 07:55:20,833] INFO: common : 32] Successfully loaded yaml file: params.yaml
[2024-11-11 07:55:20,836] INFO: common : 32] Successfully loaded yaml file: schema.yaml
[2024-11-11 07:55:20,836] INFO: common : 55] Created directory: artifacts
[2024-11-11 07:55:20,839] INFO: common : 55] Created directory: artifacts/data_cleaning
[2024-11-11 07:55:21,063] INFO: common : 79] Successfully loaded DataFrame from: artifacts\data_preprocessing\preprocessed_data.csv
[2024-11-11 07:55:21,063] INFO: data_cleaning : 29] Initiating train test split...
[2024-11-11 07:55:21,088] INFO: data_cleaning : 31] Train test split completed successfully.
[2024-11-11 07:55:21,088] INFO: data_cleaning : 73] Train_df :Index(['cust_id', 'age', 'gender', 'marital_status', 'employment_status',
       'income', 'number_of_dependants', 'residence_type',
       'years_at_current_address', 'city', 'state', 'zipcode', 'loan_id',
       'loan_purpose', 'loan_type', 'sanction_amount', 'loan_amount',
       'processing_fee', 'gst', 'net_disbursement', 'loan_tenure_months',
       'principal_outstanding', 'bank_balance_at_application',
       'disbursal_date', 'installment_start_dt', 'default',
       'number_of_open_accounts', 'number_of_closed_accounts',
       'total_loan_months', 'delinquent_months', 'total_dpd', 'enquiry_count',
       'credit_utilization_ratio'],
      dtype='object')
[2024-11-11 07:55:21,097] INFO: data_cleaning : 78]  After outlier removal train_df :(40000, 33)
[2024-11-11 07:55:21,097] INFO: data_cleaning : 79]  After outlier removal test_df :(10000, 33)
[2024-11-11 07:55:21,097] INFO: data_cleaning : 84] Rule 1: GST should not be more than 20% :(0, 33)
[2024-11-11 07:55:21,109] INFO: data_cleaning : 88] Rule 2: Net disbursement should not be higher than loan_amount :(0, 33)
[2024-11-11 07:55:21,119] INFO: data_cleaning : 93] Rule 3 : Fixed loan_purpose column :loan_purpose
Personal     14037
Home         12006
Auto          7950
Education     6007
Name: count, dtype: int64
[2024-11-11 07:55:21,120] INFO: data_cleaning : 98] Rule 4 : Generated loan_to_income column(LTI)
[2024-11-11 07:55:21,129] INFO: data_cleaning : 103] Generated delinquency_ratio column :count    40000.000000
mean        10.424123
std         17.283345
min          0.000000
25%          0.000000
50%          3.800000
75%         13.200000
max        100.000000
Name: delinquency_ratio, dtype: float64
[2024-11-11 07:55:21,136] ERROR: main : 41] An unexpected error occurred: 'DataCleaning' object has no attribute 'target_column'
[2024-11-11 08:05:58,438] INFO: __init__ : 26] Credit Risk Model Building Started
[2024-11-11 08:06:01,031] INFO: main : 12] >>>>>>>>>>>Starting Data Ingestion Stage<<<<<<<<<<<<<
[2024-11-11 08:06:01,031] INFO: common : 32] Successfully loaded yaml file: config\config.yaml
[2024-11-11 08:06:01,031] INFO: common : 32] Successfully loaded yaml file: params.yaml
[2024-11-11 08:06:01,031] INFO: common : 32] Successfully loaded yaml file: schema.yaml
[2024-11-11 08:06:01,031] INFO: common : 55] Created directory: artifacts
[2024-11-11 08:06:01,031] INFO: common : 55] Created directory: artifacts/data_ingestion
[2024-11-11 08:06:01,041] INFO: data_ingestion : 17] Loading customers data...
[2024-11-11 08:06:01,131] INFO: common : 79] Successfully loaded DataFrame from: data\customers.csv
[2024-11-11 08:06:01,131] INFO: data_ingestion : 20] Loading loans data...
[2024-11-11 08:06:01,245] INFO: common : 79] Successfully loaded DataFrame from: data\loans.csv
[2024-11-11 08:06:01,246] INFO: data_ingestion : 23] Loading bureau data...
[2024-11-11 08:06:01,281] INFO: common : 79] Successfully loaded DataFrame from: data\bureau_data.csv
[2024-11-11 08:06:01,281] INFO: data_ingestion : 26] The Shape of customers data: (50000, 12)
[2024-11-11 08:06:01,281] INFO: data_ingestion : 27] The Shape of loans data: (50000, 15)
[2024-11-11 08:06:01,281] INFO: data_ingestion : 28] The Shape of bureau data: (50000, 8)
[2024-11-11 08:06:01,832] INFO: common : 97] Successfully saved DataFrame to: artifacts\data_ingestion\data.csv
[2024-11-11 08:06:01,844] INFO: main : 14] >>>>>>>>>>>Completed Data Ingestion Stage<<<<<<<<<<<<<
[2024-11-11 08:06:01,844] INFO: main : 24] >>>>>>>>>>>Starting Data Pre-Processing Stage<<<<<<<<<<<<<
[2024-11-11 08:06:01,852] INFO: common : 32] Successfully loaded yaml file: config\config.yaml
[2024-11-11 08:06:01,854] INFO: common : 32] Successfully loaded yaml file: params.yaml
[2024-11-11 08:06:01,858] INFO: common : 32] Successfully loaded yaml file: schema.yaml
[2024-11-11 08:06:01,858] INFO: common : 55] Created directory: artifacts
[2024-11-11 08:06:01,859] INFO: common : 55] Created directory: artifacts/data_preprocessing
[2024-11-11 08:06:02,111] INFO: common : 79] Successfully loaded DataFrame from: artifacts\data_ingestion\data.csv
[2024-11-11 08:06:02,114] INFO: data_preprocessing : 26] The Valure counts for 'default' column: default
0    45703
1     4297
Name: count, dtype: int64
[2024-11-11 08:06:02,118] INFO: data_preprocessing : 42] No missing values found in column 'cust_id'
[2024-11-11 08:06:02,119] INFO: data_preprocessing : 42] No missing values found in column 'age'
[2024-11-11 08:06:02,122] INFO: data_preprocessing : 42] No missing values found in column 'gender'
[2024-11-11 08:06:02,126] INFO: data_preprocessing : 42] No missing values found in column 'marital_status'
[2024-11-11 08:06:02,129] INFO: data_preprocessing : 42] No missing values found in column 'employment_status'
[2024-11-11 08:06:02,130] INFO: data_preprocessing : 42] No missing values found in column 'income'
[2024-11-11 08:06:02,131] INFO: data_preprocessing : 42] No missing values found in column 'number_of_dependants'
[2024-11-11 08:06:02,134] WARNING: data_preprocessing : 33] Missing values found in column 'residence_type', replacing with 'Unknown'
[2024-11-11 08:06:02,147] INFO: data_preprocessing : 35] Missing values replaced in column 'residence_type' with mode 'Owned'
[2024-11-11 08:06:02,148] INFO: data_preprocessing : 42] No missing values found in column 'years_at_current_address'
[2024-11-11 08:06:02,150] INFO: data_preprocessing : 42] No missing values found in column 'city'
[2024-11-11 08:06:02,150] INFO: data_preprocessing : 42] No missing values found in column 'state'
[2024-11-11 08:06:02,150] INFO: data_preprocessing : 42] No missing values found in column 'zipcode'
[2024-11-11 08:06:02,159] INFO: data_preprocessing : 42] No missing values found in column 'loan_id'
[2024-11-11 08:06:02,163] INFO: data_preprocessing : 42] No missing values found in column 'loan_purpose'
[2024-11-11 08:06:02,166] INFO: data_preprocessing : 42] No missing values found in column 'loan_type'
[2024-11-11 08:06:02,168] INFO: data_preprocessing : 42] No missing values found in column 'sanction_amount'
[2024-11-11 08:06:02,168] INFO: data_preprocessing : 42] No missing values found in column 'loan_amount'
[2024-11-11 08:06:02,170] INFO: data_preprocessing : 42] No missing values found in column 'processing_fee'
[2024-11-11 08:06:02,171] INFO: data_preprocessing : 42] No missing values found in column 'gst'
[2024-11-11 08:06:02,171] INFO: data_preprocessing : 42] No missing values found in column 'net_disbursement'
[2024-11-11 08:06:02,172] INFO: data_preprocessing : 42] No missing values found in column 'loan_tenure_months'
[2024-11-11 08:06:02,173] INFO: data_preprocessing : 42] No missing values found in column 'principal_outstanding'
[2024-11-11 08:06:02,173] INFO: data_preprocessing : 42] No missing values found in column 'bank_balance_at_application'
[2024-11-11 08:06:02,176] INFO: data_preprocessing : 42] No missing values found in column 'disbursal_date'
[2024-11-11 08:06:02,179] INFO: data_preprocessing : 42] No missing values found in column 'installment_start_dt'
[2024-11-11 08:06:02,180] INFO: data_preprocessing : 42] No missing values found in column 'default'
[2024-11-11 08:06:02,181] INFO: data_preprocessing : 42] No missing values found in column 'number_of_open_accounts'
[2024-11-11 08:06:02,182] INFO: data_preprocessing : 42] No missing values found in column 'number_of_closed_accounts'
[2024-11-11 08:06:02,183] INFO: data_preprocessing : 42] No missing values found in column 'total_loan_months'
[2024-11-11 08:06:02,184] INFO: data_preprocessing : 42] No missing values found in column 'delinquent_months'
[2024-11-11 08:06:02,184] INFO: data_preprocessing : 42] No missing values found in column 'total_dpd'
[2024-11-11 08:06:02,185] INFO: data_preprocessing : 42] No missing values found in column 'enquiry_count'
[2024-11-11 08:06:02,186] INFO: data_preprocessing : 42] No missing values found in column 'credit_utilization_ratio'
[2024-11-11 08:06:02,260] INFO: data_preprocessing : 51] No duplicate rows found
[2024-11-11 08:06:02,260] INFO: data_preprocessing : 53] Index(['cust_id', 'age', 'gender', 'marital_status', 'employment_status',
       'income', 'number_of_dependants', 'residence_type',
       'years_at_current_address', 'city', 'state', 'zipcode', 'loan_id',
       'loan_purpose', 'loan_type', 'sanction_amount', 'loan_amount',
       'processing_fee', 'gst', 'net_disbursement', 'loan_tenure_months',
       'principal_outstanding', 'bank_balance_at_application',
       'disbursal_date', 'installment_start_dt', 'default',
       'number_of_open_accounts', 'number_of_closed_accounts',
       'total_loan_months', 'delinquent_months', 'total_dpd', 'enquiry_count',
       'credit_utilization_ratio'],
      dtype='object')
[2024-11-11 08:06:02,776] INFO: common : 97] Successfully saved DataFrame to: artifacts\data_preprocessing\preprocessed_data.csv
[2024-11-11 08:06:02,776] INFO: main : 26] >>>>>>>>>>>Completed Data Pre-Processing Stage<<<<<<<<<<<<<
[2024-11-11 08:06:02,776] INFO: main : 36] >>>>>>>>>>>Starting Data Cleaning Stage<<<<<<<<<<<<<
[2024-11-11 08:06:02,776] INFO: common : 32] Successfully loaded yaml file: config\config.yaml
[2024-11-11 08:06:02,791] INFO: common : 32] Successfully loaded yaml file: params.yaml
[2024-11-11 08:06:02,794] INFO: common : 32] Successfully loaded yaml file: schema.yaml
[2024-11-11 08:06:02,795] INFO: common : 55] Created directory: artifacts
[2024-11-11 08:06:02,795] INFO: common : 55] Created directory: artifacts/data_cleaning
[2024-11-11 08:06:02,796] ERROR: main : 41] An unexpected error occurred: DataCleaningConfig.__init__() got an unexpected keyword argument 'target_column'
[2024-11-11 08:10:38,336] INFO: __init__ : 26] Credit Risk Model Building Started
[2024-11-11 08:10:48,957] INFO: main : 12] >>>>>>>>>>>Starting Data Ingestion Stage<<<<<<<<<<<<<
[2024-11-11 08:10:48,957] INFO: common : 32] Successfully loaded yaml file: config\config.yaml
[2024-11-11 08:10:48,957] INFO: common : 32] Successfully loaded yaml file: params.yaml
[2024-11-11 08:10:48,957] INFO: common : 32] Successfully loaded yaml file: schema.yaml
[2024-11-11 08:10:48,972] INFO: common : 55] Created directory: artifacts
[2024-11-11 08:10:48,973] INFO: common : 55] Created directory: artifacts/data_ingestion
[2024-11-11 08:10:48,973] INFO: data_ingestion : 17] Loading customers data...
[2024-11-11 08:10:49,082] INFO: common : 79] Successfully loaded DataFrame from: data\customers.csv
[2024-11-11 08:10:49,082] INFO: data_ingestion : 20] Loading loans data...
[2024-11-11 08:10:49,218] INFO: common : 79] Successfully loaded DataFrame from: data\loans.csv
[2024-11-11 08:10:49,218] INFO: data_ingestion : 23] Loading bureau data...
[2024-11-11 08:10:49,273] INFO: common : 79] Successfully loaded DataFrame from: data\bureau_data.csv
[2024-11-11 08:10:49,273] INFO: data_ingestion : 26] The Shape of customers data: (50000, 12)
[2024-11-11 08:10:49,273] INFO: data_ingestion : 27] The Shape of loans data: (50000, 15)
[2024-11-11 08:10:49,273] INFO: data_ingestion : 28] The Shape of bureau data: (50000, 8)
[2024-11-11 08:10:49,782] INFO: common : 97] Successfully saved DataFrame to: artifacts\data_ingestion\data.csv
[2024-11-11 08:10:49,787] INFO: main : 14] >>>>>>>>>>>Completed Data Ingestion Stage<<<<<<<<<<<<<
[2024-11-11 08:10:49,787] INFO: main : 24] >>>>>>>>>>>Starting Data Pre-Processing Stage<<<<<<<<<<<<<
[2024-11-11 08:10:49,793] INFO: common : 32] Successfully loaded yaml file: config\config.yaml
[2024-11-11 08:10:49,794] INFO: common : 32] Successfully loaded yaml file: params.yaml
[2024-11-11 08:10:49,797] INFO: common : 32] Successfully loaded yaml file: schema.yaml
[2024-11-11 08:10:49,798] INFO: common : 55] Created directory: artifacts
[2024-11-11 08:10:49,800] INFO: common : 55] Created directory: artifacts/data_preprocessing
[2024-11-11 08:10:50,002] INFO: common : 79] Successfully loaded DataFrame from: artifacts\data_ingestion\data.csv
[2024-11-11 08:10:50,002] INFO: data_preprocessing : 26] The Valure counts for 'default' column: default
0    45703
1     4297
Name: count, dtype: int64
[2024-11-11 08:10:50,011] INFO: data_preprocessing : 42] No missing values found in column 'cust_id'
[2024-11-11 08:10:50,011] INFO: data_preprocessing : 42] No missing values found in column 'age'
[2024-11-11 08:10:50,015] INFO: data_preprocessing : 42] No missing values found in column 'gender'
[2024-11-11 08:10:50,019] INFO: data_preprocessing : 42] No missing values found in column 'marital_status'
[2024-11-11 08:10:50,021] INFO: data_preprocessing : 42] No missing values found in column 'employment_status'
[2024-11-11 08:10:50,022] INFO: data_preprocessing : 42] No missing values found in column 'income'
[2024-11-11 08:10:50,022] INFO: data_preprocessing : 42] No missing values found in column 'number_of_dependants'
[2024-11-11 08:10:50,026] WARNING: data_preprocessing : 33] Missing values found in column 'residence_type', replacing with 'Unknown'
[2024-11-11 08:10:50,031] INFO: data_preprocessing : 35] Missing values replaced in column 'residence_type' with mode 'Owned'
[2024-11-11 08:10:50,031] INFO: data_preprocessing : 42] No missing values found in column 'years_at_current_address'
[2024-11-11 08:10:50,041] INFO: data_preprocessing : 42] No missing values found in column 'city'
[2024-11-11 08:10:50,044] INFO: data_preprocessing : 42] No missing values found in column 'state'
[2024-11-11 08:10:50,044] INFO: data_preprocessing : 42] No missing values found in column 'zipcode'
[2024-11-11 08:10:50,047] INFO: data_preprocessing : 42] No missing values found in column 'loan_id'
[2024-11-11 08:10:50,051] INFO: data_preprocessing : 42] No missing values found in column 'loan_purpose'
[2024-11-11 08:10:50,054] INFO: data_preprocessing : 42] No missing values found in column 'loan_type'
[2024-11-11 08:10:50,055] INFO: data_preprocessing : 42] No missing values found in column 'sanction_amount'
[2024-11-11 08:10:50,055] INFO: data_preprocessing : 42] No missing values found in column 'loan_amount'
[2024-11-11 08:10:50,056] INFO: data_preprocessing : 42] No missing values found in column 'processing_fee'
[2024-11-11 08:10:50,057] INFO: data_preprocessing : 42] No missing values found in column 'gst'
[2024-11-11 08:10:50,057] INFO: data_preprocessing : 42] No missing values found in column 'net_disbursement'
[2024-11-11 08:10:50,058] INFO: data_preprocessing : 42] No missing values found in column 'loan_tenure_months'
[2024-11-11 08:10:50,059] INFO: data_preprocessing : 42] No missing values found in column 'principal_outstanding'
[2024-11-11 08:10:50,060] INFO: data_preprocessing : 42] No missing values found in column 'bank_balance_at_application'
[2024-11-11 08:10:50,063] INFO: data_preprocessing : 42] No missing values found in column 'disbursal_date'
[2024-11-11 08:10:50,067] INFO: data_preprocessing : 42] No missing values found in column 'installment_start_dt'
[2024-11-11 08:10:50,067] INFO: data_preprocessing : 42] No missing values found in column 'default'
[2024-11-11 08:10:50,068] INFO: data_preprocessing : 42] No missing values found in column 'number_of_open_accounts'
[2024-11-11 08:10:50,069] INFO: data_preprocessing : 42] No missing values found in column 'number_of_closed_accounts'
[2024-11-11 08:10:50,070] INFO: data_preprocessing : 42] No missing values found in column 'total_loan_months'
[2024-11-11 08:10:50,071] INFO: data_preprocessing : 42] No missing values found in column 'delinquent_months'
[2024-11-11 08:10:50,071] INFO: data_preprocessing : 42] No missing values found in column 'total_dpd'
[2024-11-11 08:10:50,072] INFO: data_preprocessing : 42] No missing values found in column 'enquiry_count'
[2024-11-11 08:10:50,073] INFO: data_preprocessing : 42] No missing values found in column 'credit_utilization_ratio'
[2024-11-11 08:10:50,147] INFO: data_preprocessing : 51] No duplicate rows found
[2024-11-11 08:10:50,147] INFO: data_preprocessing : 53] Index(['cust_id', 'age', 'gender', 'marital_status', 'employment_status',
       'income', 'number_of_dependants', 'residence_type',
       'years_at_current_address', 'city', 'state', 'zipcode', 'loan_id',
       'loan_purpose', 'loan_type', 'sanction_amount', 'loan_amount',
       'processing_fee', 'gst', 'net_disbursement', 'loan_tenure_months',
       'principal_outstanding', 'bank_balance_at_application',
       'disbursal_date', 'installment_start_dt', 'default',
       'number_of_open_accounts', 'number_of_closed_accounts',
       'total_loan_months', 'delinquent_months', 'total_dpd', 'enquiry_count',
       'credit_utilization_ratio'],
      dtype='object')
[2024-11-11 08:10:50,615] INFO: common : 97] Successfully saved DataFrame to: artifacts\data_preprocessing\preprocessed_data.csv
[2024-11-11 08:10:50,615] INFO: main : 26] >>>>>>>>>>>Completed Data Pre-Processing Stage<<<<<<<<<<<<<
[2024-11-11 08:10:50,615] INFO: main : 36] >>>>>>>>>>>Starting Data Cleaning Stage<<<<<<<<<<<<<
[2024-11-11 08:10:50,633] INFO: common : 32] Successfully loaded yaml file: config\config.yaml
[2024-11-11 08:10:50,635] INFO: common : 32] Successfully loaded yaml file: params.yaml
[2024-11-11 08:10:50,637] INFO: common : 32] Successfully loaded yaml file: schema.yaml
[2024-11-11 08:10:50,637] INFO: common : 55] Created directory: artifacts
[2024-11-11 08:10:50,640] INFO: common : 55] Created directory: artifacts/data_cleaning
[2024-11-11 08:10:50,644] ERROR: main : 41] An unexpected error occurred: "'ConfigBox' object has no attribute 'target_columns'"
[2024-11-11 08:12:41,509] INFO: __init__ : 26] Credit Risk Model Building Started
[2024-11-11 08:14:22,031] INFO: __init__ : 26] Credit Risk Model Building Started
[2024-11-11 08:17:23,294] INFO: __init__ : 26] Credit Risk Model Building Started
[2024-11-11 08:17:25,431] INFO: main : 12] >>>>>>>>>>>Starting Data Ingestion Stage<<<<<<<<<<<<<
[2024-11-11 08:17:25,431] INFO: common : 32] Successfully loaded yaml file: config\config.yaml
[2024-11-11 08:17:25,431] INFO: common : 32] Successfully loaded yaml file: params.yaml
[2024-11-11 08:17:25,431] INFO: common : 32] Successfully loaded yaml file: schema.yaml
[2024-11-11 08:17:25,431] INFO: common : 55] Created directory: artifacts
[2024-11-11 08:17:25,431] INFO: common : 55] Created directory: artifacts/data_ingestion
[2024-11-11 08:17:25,431] INFO: data_ingestion : 17] Loading customers data...
[2024-11-11 08:17:25,532] INFO: common : 79] Successfully loaded DataFrame from: data\customers.csv
[2024-11-11 08:17:25,533] INFO: data_ingestion : 20] Loading loans data...
[2024-11-11 08:17:25,649] INFO: common : 79] Successfully loaded DataFrame from: data\loans.csv
[2024-11-11 08:17:25,649] INFO: data_ingestion : 23] Loading bureau data...
[2024-11-11 08:17:25,688] INFO: common : 79] Successfully loaded DataFrame from: data\bureau_data.csv
[2024-11-11 08:17:25,688] INFO: data_ingestion : 26] The Shape of customers data: (50000, 12)
[2024-11-11 08:17:25,699] INFO: data_ingestion : 27] The Shape of loans data: (50000, 15)
[2024-11-11 08:17:25,699] INFO: data_ingestion : 28] The Shape of bureau data: (50000, 8)
[2024-11-11 08:17:25,748] ERROR: common : 100] Error saving DataFrame to: artifacts\data_ingestion\data.csv - [Errno 22] Invalid argument: 'artifacts\\data_ingestion\\data.csv'
[2024-11-11 08:17:25,748] ERROR: data_ingestion_pipeline : 22] Error occurred during data ingestion: Error occurred in python script name [C:\Users\ambig\jupiter_notebook\Projects\Credit-Risk-Model\src\Credit_Risk_Model\utils\common.py] line number [95] error message[[Errno 22] Invalid argument: 'artifacts\\data_ingestion\\data.csv']
[2024-11-11 08:17:25,756] INFO: main : 14] >>>>>>>>>>>Completed Data Ingestion Stage<<<<<<<<<<<<<
[2024-11-11 08:17:25,756] INFO: main : 24] >>>>>>>>>>>Starting Data Pre-Processing Stage<<<<<<<<<<<<<
[2024-11-11 08:17:25,761] INFO: common : 32] Successfully loaded yaml file: config\config.yaml
[2024-11-11 08:17:25,762] INFO: common : 32] Successfully loaded yaml file: params.yaml
[2024-11-11 08:17:25,765] INFO: common : 32] Successfully loaded yaml file: schema.yaml
[2024-11-11 08:17:25,766] INFO: common : 55] Created directory: artifacts
[2024-11-11 08:17:25,766] INFO: common : 55] Created directory: artifacts/data_preprocessing
[2024-11-11 08:17:25,984] INFO: common : 79] Successfully loaded DataFrame from: artifacts\data_ingestion\data.csv
[2024-11-11 08:17:25,988] INFO: data_preprocessing : 26] The Valure counts for 'default' column: default
0    45703
1     4297
Name: count, dtype: int64
[2024-11-11 08:17:25,988] INFO: data_preprocessing : 42] No missing values found in column 'cust_id'
[2024-11-11 08:17:25,988] INFO: data_preprocessing : 42] No missing values found in column 'age'
[2024-11-11 08:17:25,995] INFO: data_preprocessing : 42] No missing values found in column 'gender'
[2024-11-11 08:17:25,998] INFO: data_preprocessing : 42] No missing values found in column 'marital_status'
[2024-11-11 08:17:26,002] INFO: data_preprocessing : 42] No missing values found in column 'employment_status'
[2024-11-11 08:17:26,003] INFO: data_preprocessing : 42] No missing values found in column 'income'
[2024-11-11 08:17:26,004] INFO: data_preprocessing : 42] No missing values found in column 'number_of_dependants'
[2024-11-11 08:17:26,007] WARNING: data_preprocessing : 33] Missing values found in column 'residence_type', replacing with 'Unknown'
[2024-11-11 08:17:26,020] INFO: data_preprocessing : 35] Missing values replaced in column 'residence_type' with mode 'Owned'
[2024-11-11 08:17:26,020] INFO: data_preprocessing : 42] No missing values found in column 'years_at_current_address'
[2024-11-11 08:17:26,025] INFO: data_preprocessing : 42] No missing values found in column 'city'
[2024-11-11 08:17:26,028] INFO: data_preprocessing : 42] No missing values found in column 'state'
[2024-11-11 08:17:26,029] INFO: data_preprocessing : 42] No missing values found in column 'zipcode'
[2024-11-11 08:17:26,033] INFO: data_preprocessing : 42] No missing values found in column 'loan_id'
[2024-11-11 08:17:26,036] INFO: data_preprocessing : 42] No missing values found in column 'loan_purpose'
[2024-11-11 08:17:26,040] INFO: data_preprocessing : 42] No missing values found in column 'loan_type'
[2024-11-11 08:17:26,041] INFO: data_preprocessing : 42] No missing values found in column 'sanction_amount'
[2024-11-11 08:17:26,042] INFO: data_preprocessing : 42] No missing values found in column 'loan_amount'
[2024-11-11 08:17:26,043] INFO: data_preprocessing : 42] No missing values found in column 'processing_fee'
[2024-11-11 08:17:26,044] INFO: data_preprocessing : 42] No missing values found in column 'gst'
[2024-11-11 08:17:26,044] INFO: data_preprocessing : 42] No missing values found in column 'net_disbursement'
[2024-11-11 08:17:26,044] INFO: data_preprocessing : 42] No missing values found in column 'loan_tenure_months'
[2024-11-11 08:17:26,047] INFO: data_preprocessing : 42] No missing values found in column 'principal_outstanding'
[2024-11-11 08:17:26,048] INFO: data_preprocessing : 42] No missing values found in column 'bank_balance_at_application'
[2024-11-11 08:17:26,052] INFO: data_preprocessing : 42] No missing values found in column 'disbursal_date'
[2024-11-11 08:17:26,055] INFO: data_preprocessing : 42] No missing values found in column 'installment_start_dt'
[2024-11-11 08:17:26,056] INFO: data_preprocessing : 42] No missing values found in column 'default'
[2024-11-11 08:17:26,057] INFO: data_preprocessing : 42] No missing values found in column 'number_of_open_accounts'
[2024-11-11 08:17:26,058] INFO: data_preprocessing : 42] No missing values found in column 'number_of_closed_accounts'
[2024-11-11 08:17:26,059] INFO: data_preprocessing : 42] No missing values found in column 'total_loan_months'
[2024-11-11 08:17:26,059] INFO: data_preprocessing : 42] No missing values found in column 'delinquent_months'
[2024-11-11 08:17:26,059] INFO: data_preprocessing : 42] No missing values found in column 'total_dpd'
[2024-11-11 08:17:26,059] INFO: data_preprocessing : 42] No missing values found in column 'enquiry_count'
[2024-11-11 08:17:26,063] INFO: data_preprocessing : 42] No missing values found in column 'credit_utilization_ratio'
[2024-11-11 08:17:26,132] INFO: data_preprocessing : 51] No duplicate rows found
[2024-11-11 08:17:26,133] INFO: data_preprocessing : 53] Index(['cust_id', 'age', 'gender', 'marital_status', 'employment_status',
       'income', 'number_of_dependants', 'residence_type',
       'years_at_current_address', 'city', 'state', 'zipcode', 'loan_id',
       'loan_purpose', 'loan_type', 'sanction_amount', 'loan_amount',
       'processing_fee', 'gst', 'net_disbursement', 'loan_tenure_months',
       'principal_outstanding', 'bank_balance_at_application',
       'disbursal_date', 'installment_start_dt', 'default',
       'number_of_open_accounts', 'number_of_closed_accounts',
       'total_loan_months', 'delinquent_months', 'total_dpd', 'enquiry_count',
       'credit_utilization_ratio'],
      dtype='object')
[2024-11-11 08:17:26,595] INFO: common : 97] Successfully saved DataFrame to: artifacts\data_preprocessing\preprocessed_data.csv
[2024-11-11 08:17:26,595] INFO: main : 26] >>>>>>>>>>>Completed Data Pre-Processing Stage<<<<<<<<<<<<<
[2024-11-11 08:17:26,595] INFO: main : 36] >>>>>>>>>>>Starting Data Cleaning Stage<<<<<<<<<<<<<
[2024-11-11 08:17:26,606] INFO: common : 32] Successfully loaded yaml file: config\config.yaml
[2024-11-11 08:17:26,609] INFO: common : 32] Successfully loaded yaml file: params.yaml
[2024-11-11 08:17:26,613] INFO: common : 32] Successfully loaded yaml file: schema.yaml
[2024-11-11 08:17:26,614] INFO: common : 55] Created directory: artifacts
[2024-11-11 08:17:26,616] INFO: common : 55] Created directory: artifacts/data_cleaning
[2024-11-11 08:17:26,616] ERROR: main : 41] An unexpected error occurred: "'ConfigBox' object has no attribute 'target_columns'"
[2024-11-11 08:18:33,533] INFO: __init__ : 26] Credit Risk Model Building Started
[2024-11-11 08:18:35,819] INFO: main : 12] >>>>>>>>>>>Starting Data Ingestion Stage<<<<<<<<<<<<<
[2024-11-11 08:18:35,822] INFO: common : 32] Successfully loaded yaml file: config\config.yaml
[2024-11-11 08:18:35,826] INFO: common : 32] Successfully loaded yaml file: params.yaml
[2024-11-11 08:18:35,829] INFO: common : 32] Successfully loaded yaml file: schema.yaml
[2024-11-11 08:18:35,830] INFO: common : 55] Created directory: artifacts
[2024-11-11 08:18:35,831] INFO: common : 55] Created directory: artifacts/data_ingestion
[2024-11-11 08:18:35,832] INFO: data_ingestion : 17] Loading customers data...
[2024-11-11 08:18:35,939] INFO: common : 79] Successfully loaded DataFrame from: data\customers.csv
[2024-11-11 08:18:35,939] INFO: data_ingestion : 20] Loading loans data...
[2024-11-11 08:18:36,065] INFO: common : 79] Successfully loaded DataFrame from: data\loans.csv
[2024-11-11 08:18:36,065] INFO: data_ingestion : 23] Loading bureau data...
[2024-11-11 08:18:36,121] INFO: common : 79] Successfully loaded DataFrame from: data\bureau_data.csv
[2024-11-11 08:18:36,122] INFO: data_ingestion : 26] The Shape of customers data: (50000, 12)
[2024-11-11 08:18:36,122] INFO: data_ingestion : 27] The Shape of loans data: (50000, 15)
[2024-11-11 08:18:36,124] INFO: data_ingestion : 28] The Shape of bureau data: (50000, 8)
[2024-11-11 08:18:36,700] INFO: common : 97] Successfully saved DataFrame to: artifacts\data_ingestion\data.csv
[2024-11-11 08:18:36,711] INFO: main : 14] >>>>>>>>>>>Completed Data Ingestion Stage<<<<<<<<<<<<<
[2024-11-11 08:18:36,712] INFO: main : 24] >>>>>>>>>>>Starting Data Pre-Processing Stage<<<<<<<<<<<<<
[2024-11-11 08:18:36,715] INFO: common : 32] Successfully loaded yaml file: config\config.yaml
[2024-11-11 08:18:36,717] INFO: common : 32] Successfully loaded yaml file: params.yaml
[2024-11-11 08:18:36,720] INFO: common : 32] Successfully loaded yaml file: schema.yaml
[2024-11-11 08:18:36,721] INFO: common : 55] Created directory: artifacts
[2024-11-11 08:18:36,722] INFO: common : 55] Created directory: artifacts/data_preprocessing
[2024-11-11 08:18:36,964] INFO: common : 79] Successfully loaded DataFrame from: artifacts\data_ingestion\data.csv
[2024-11-11 08:18:36,964] INFO: data_preprocessing : 26] The Valure counts for 'default' column: default
0    45703
1     4297
Name: count, dtype: int64
[2024-11-11 08:18:36,980] INFO: data_preprocessing : 42] No missing values found in column 'cust_id'
[2024-11-11 08:18:36,980] INFO: data_preprocessing : 42] No missing values found in column 'age'
[2024-11-11 08:18:36,984] INFO: data_preprocessing : 42] No missing values found in column 'gender'
[2024-11-11 08:18:36,987] INFO: data_preprocessing : 42] No missing values found in column 'marital_status'
[2024-11-11 08:18:36,990] INFO: data_preprocessing : 42] No missing values found in column 'employment_status'
[2024-11-11 08:18:36,991] INFO: data_preprocessing : 42] No missing values found in column 'income'
[2024-11-11 08:18:36,992] INFO: data_preprocessing : 42] No missing values found in column 'number_of_dependants'
[2024-11-11 08:18:36,995] WARNING: data_preprocessing : 33] Missing values found in column 'residence_type', replacing with 'Unknown'
[2024-11-11 08:18:36,999] INFO: data_preprocessing : 35] Missing values replaced in column 'residence_type' with mode 'Owned'
[2024-11-11 08:18:36,999] INFO: data_preprocessing : 42] No missing values found in column 'years_at_current_address'
[2024-11-11 08:18:37,011] INFO: data_preprocessing : 42] No missing values found in column 'city'
[2024-11-11 08:18:37,015] INFO: data_preprocessing : 42] No missing values found in column 'state'
[2024-11-11 08:18:37,015] INFO: data_preprocessing : 42] No missing values found in column 'zipcode'
[2024-11-11 08:18:37,019] INFO: data_preprocessing : 42] No missing values found in column 'loan_id'
[2024-11-11 08:18:37,022] INFO: data_preprocessing : 42] No missing values found in column 'loan_purpose'
[2024-11-11 08:18:37,026] INFO: data_preprocessing : 42] No missing values found in column 'loan_type'
[2024-11-11 08:18:37,027] INFO: data_preprocessing : 42] No missing values found in column 'sanction_amount'
[2024-11-11 08:18:37,028] INFO: data_preprocessing : 42] No missing values found in column 'loan_amount'
[2024-11-11 08:18:37,029] INFO: data_preprocessing : 42] No missing values found in column 'processing_fee'
[2024-11-11 08:18:37,029] INFO: data_preprocessing : 42] No missing values found in column 'gst'
[2024-11-11 08:18:37,030] INFO: data_preprocessing : 42] No missing values found in column 'net_disbursement'
[2024-11-11 08:18:37,030] INFO: data_preprocessing : 42] No missing values found in column 'loan_tenure_months'
[2024-11-11 08:18:37,032] INFO: data_preprocessing : 42] No missing values found in column 'principal_outstanding'
[2024-11-11 08:18:37,033] INFO: data_preprocessing : 42] No missing values found in column 'bank_balance_at_application'
[2024-11-11 08:18:37,036] INFO: data_preprocessing : 42] No missing values found in column 'disbursal_date'
[2024-11-11 08:18:37,039] INFO: data_preprocessing : 42] No missing values found in column 'installment_start_dt'
[2024-11-11 08:18:37,039] INFO: data_preprocessing : 42] No missing values found in column 'default'
[2024-11-11 08:18:37,039] INFO: data_preprocessing : 42] No missing values found in column 'number_of_open_accounts'
[2024-11-11 08:18:37,039] INFO: data_preprocessing : 42] No missing values found in column 'number_of_closed_accounts'
[2024-11-11 08:18:37,039] INFO: data_preprocessing : 42] No missing values found in column 'total_loan_months'
[2024-11-11 08:18:37,039] INFO: data_preprocessing : 42] No missing values found in column 'delinquent_months'
[2024-11-11 08:18:37,039] INFO: data_preprocessing : 42] No missing values found in column 'total_dpd'
[2024-11-11 08:18:37,039] INFO: data_preprocessing : 42] No missing values found in column 'enquiry_count'
[2024-11-11 08:18:37,047] INFO: data_preprocessing : 42] No missing values found in column 'credit_utilization_ratio'
[2024-11-11 08:18:37,119] INFO: data_preprocessing : 51] No duplicate rows found
[2024-11-11 08:18:37,119] INFO: data_preprocessing : 53] Index(['cust_id', 'age', 'gender', 'marital_status', 'employment_status',
       'income', 'number_of_dependants', 'residence_type',
       'years_at_current_address', 'city', 'state', 'zipcode', 'loan_id',
       'loan_purpose', 'loan_type', 'sanction_amount', 'loan_amount',
       'processing_fee', 'gst', 'net_disbursement', 'loan_tenure_months',
       'principal_outstanding', 'bank_balance_at_application',
       'disbursal_date', 'installment_start_dt', 'default',
       'number_of_open_accounts', 'number_of_closed_accounts',
       'total_loan_months', 'delinquent_months', 'total_dpd', 'enquiry_count',
       'credit_utilization_ratio'],
      dtype='object')
[2024-11-11 08:18:37,610] INFO: common : 97] Successfully saved DataFrame to: artifacts\data_preprocessing\preprocessed_data.csv
[2024-11-11 08:18:37,621] INFO: main : 26] >>>>>>>>>>>Completed Data Pre-Processing Stage<<<<<<<<<<<<<
[2024-11-11 08:18:37,621] INFO: main : 36] >>>>>>>>>>>Starting Data Cleaning Stage<<<<<<<<<<<<<
[2024-11-11 08:18:37,627] INFO: common : 32] Successfully loaded yaml file: config\config.yaml
[2024-11-11 08:18:37,630] INFO: common : 32] Successfully loaded yaml file: params.yaml
[2024-11-11 08:18:37,634] INFO: common : 32] Successfully loaded yaml file: schema.yaml
[2024-11-11 08:18:37,635] INFO: common : 55] Created directory: artifacts
[2024-11-11 08:18:37,636] INFO: common : 55] Created directory: artifacts/data_cleaning
[2024-11-11 08:18:37,637] ERROR: main : 41] An unexpected error occurred: "'ConfigBox' object has no attribute 'target_columns'"
[2024-11-11 08:21:13,035] INFO: __init__ : 26] Credit Risk Model Building Started
[2024-11-11 08:21:15,284] INFO: main : 12] >>>>>>>>>>>Starting Data Ingestion Stage<<<<<<<<<<<<<
[2024-11-11 08:21:15,284] INFO: common : 32] Successfully loaded yaml file: config\config.yaml
[2024-11-11 08:21:15,284] INFO: common : 32] Successfully loaded yaml file: params.yaml
[2024-11-11 08:21:15,284] INFO: common : 32] Successfully loaded yaml file: schema.yaml
[2024-11-11 08:21:15,284] INFO: common : 55] Created directory: artifacts
[2024-11-11 08:21:15,298] INFO: common : 55] Created directory: artifacts/data_ingestion
[2024-11-11 08:21:15,299] INFO: data_ingestion : 17] Loading customers data...
[2024-11-11 08:21:15,391] INFO: common : 79] Successfully loaded DataFrame from: data\customers.csv
[2024-11-11 08:21:15,391] INFO: data_ingestion : 20] Loading loans data...
[2024-11-11 08:21:15,500] INFO: common : 79] Successfully loaded DataFrame from: data\loans.csv
[2024-11-11 08:21:15,500] INFO: data_ingestion : 23] Loading bureau data...
[2024-11-11 08:21:15,551] INFO: common : 79] Successfully loaded DataFrame from: data\bureau_data.csv
[2024-11-11 08:21:15,551] INFO: data_ingestion : 26] The Shape of customers data: (50000, 12)
[2024-11-11 08:21:15,551] INFO: data_ingestion : 27] The Shape of loans data: (50000, 15)
[2024-11-11 08:21:15,555] INFO: data_ingestion : 28] The Shape of bureau data: (50000, 8)
[2024-11-11 08:21:16,087] INFO: common : 97] Successfully saved DataFrame to: artifacts\data_ingestion\data.csv
[2024-11-11 08:21:16,103] INFO: main : 14] >>>>>>>>>>>Completed Data Ingestion Stage<<<<<<<<<<<<<
[2024-11-11 08:21:16,103] INFO: main : 24] >>>>>>>>>>>Starting Data Pre-Processing Stage<<<<<<<<<<<<<
[2024-11-11 08:21:16,113] INFO: common : 32] Successfully loaded yaml file: config\config.yaml
[2024-11-11 08:21:16,115] INFO: common : 32] Successfully loaded yaml file: params.yaml
[2024-11-11 08:21:16,119] INFO: common : 32] Successfully loaded yaml file: schema.yaml
[2024-11-11 08:21:16,120] INFO: common : 55] Created directory: artifacts
[2024-11-11 08:21:16,121] INFO: common : 55] Created directory: artifacts/data_preprocessing
[2024-11-11 08:21:16,344] INFO: common : 79] Successfully loaded DataFrame from: artifacts\data_ingestion\data.csv
[2024-11-11 08:21:16,344] INFO: data_preprocessing : 26] The Valure counts for 'default' column: default
0    45703
1     4297
Name: count, dtype: int64
[2024-11-11 08:21:16,344] INFO: data_preprocessing : 42] No missing values found in column 'cust_id'
[2024-11-11 08:21:16,344] INFO: data_preprocessing : 42] No missing values found in column 'age'
[2024-11-11 08:21:16,359] INFO: data_preprocessing : 42] No missing values found in column 'gender'
[2024-11-11 08:21:16,362] INFO: data_preprocessing : 42] No missing values found in column 'marital_status'
[2024-11-11 08:21:16,367] INFO: data_preprocessing : 42] No missing values found in column 'employment_status'
[2024-11-11 08:21:16,368] INFO: data_preprocessing : 42] No missing values found in column 'income'
[2024-11-11 08:21:16,369] INFO: data_preprocessing : 42] No missing values found in column 'number_of_dependants'
[2024-11-11 08:21:16,371] WARNING: data_preprocessing : 33] Missing values found in column 'residence_type', replacing with 'Unknown'
[2024-11-11 08:21:16,384] INFO: data_preprocessing : 35] Missing values replaced in column 'residence_type' with mode 'Owned'
[2024-11-11 08:21:16,386] INFO: data_preprocessing : 42] No missing values found in column 'years_at_current_address'
[2024-11-11 08:21:16,386] INFO: data_preprocessing : 42] No missing values found in column 'city'
[2024-11-11 08:21:16,391] INFO: data_preprocessing : 42] No missing values found in column 'state'
[2024-11-11 08:21:16,392] INFO: data_preprocessing : 42] No missing values found in column 'zipcode'
[2024-11-11 08:21:16,396] INFO: data_preprocessing : 42] No missing values found in column 'loan_id'
[2024-11-11 08:21:16,396] INFO: data_preprocessing : 42] No missing values found in column 'loan_purpose'
[2024-11-11 08:21:16,402] INFO: data_preprocessing : 42] No missing values found in column 'loan_type'
[2024-11-11 08:21:16,403] INFO: data_preprocessing : 42] No missing values found in column 'sanction_amount'
[2024-11-11 08:21:16,405] INFO: data_preprocessing : 42] No missing values found in column 'loan_amount'
[2024-11-11 08:21:16,405] INFO: data_preprocessing : 42] No missing values found in column 'processing_fee'
[2024-11-11 08:21:16,407] INFO: data_preprocessing : 42] No missing values found in column 'gst'
[2024-11-11 08:21:16,407] INFO: data_preprocessing : 42] No missing values found in column 'net_disbursement'
[2024-11-11 08:21:16,407] INFO: data_preprocessing : 42] No missing values found in column 'loan_tenure_months'
[2024-11-11 08:21:16,407] INFO: data_preprocessing : 42] No missing values found in column 'principal_outstanding'
[2024-11-11 08:21:16,407] INFO: data_preprocessing : 42] No missing values found in column 'bank_balance_at_application'
[2024-11-11 08:21:16,413] INFO: data_preprocessing : 42] No missing values found in column 'disbursal_date'
[2024-11-11 08:21:16,416] INFO: data_preprocessing : 42] No missing values found in column 'installment_start_dt'
[2024-11-11 08:21:16,417] INFO: data_preprocessing : 42] No missing values found in column 'default'
[2024-11-11 08:21:16,418] INFO: data_preprocessing : 42] No missing values found in column 'number_of_open_accounts'
[2024-11-11 08:21:16,418] INFO: data_preprocessing : 42] No missing values found in column 'number_of_closed_accounts'
[2024-11-11 08:21:16,420] INFO: data_preprocessing : 42] No missing values found in column 'total_loan_months'
[2024-11-11 08:21:16,421] INFO: data_preprocessing : 42] No missing values found in column 'delinquent_months'
[2024-11-11 08:21:16,422] INFO: data_preprocessing : 42] No missing values found in column 'total_dpd'
[2024-11-11 08:21:16,423] INFO: data_preprocessing : 42] No missing values found in column 'enquiry_count'
[2024-11-11 08:21:16,424] INFO: data_preprocessing : 42] No missing values found in column 'credit_utilization_ratio'
[2024-11-11 08:21:16,485] INFO: data_preprocessing : 51] No duplicate rows found
[2024-11-11 08:21:16,485] INFO: data_preprocessing : 53] Index(['cust_id', 'age', 'gender', 'marital_status', 'employment_status',
       'income', 'number_of_dependants', 'residence_type',
       'years_at_current_address', 'city', 'state', 'zipcode', 'loan_id',
       'loan_purpose', 'loan_type', 'sanction_amount', 'loan_amount',
       'processing_fee', 'gst', 'net_disbursement', 'loan_tenure_months',
       'principal_outstanding', 'bank_balance_at_application',
       'disbursal_date', 'installment_start_dt', 'default',
       'number_of_open_accounts', 'number_of_closed_accounts',
       'total_loan_months', 'delinquent_months', 'total_dpd', 'enquiry_count',
       'credit_utilization_ratio'],
      dtype='object')
[2024-11-11 08:21:16,955] INFO: common : 97] Successfully saved DataFrame to: artifacts\data_preprocessing\preprocessed_data.csv
[2024-11-11 08:21:16,955] INFO: main : 26] >>>>>>>>>>>Completed Data Pre-Processing Stage<<<<<<<<<<<<<
[2024-11-11 08:21:16,955] INFO: main : 36] >>>>>>>>>>>Starting Data Cleaning Stage<<<<<<<<<<<<<
[2024-11-11 08:21:16,965] INFO: common : 32] Successfully loaded yaml file: config\config.yaml
[2024-11-11 08:21:16,968] INFO: common : 32] Successfully loaded yaml file: params.yaml
[2024-11-11 08:21:16,970] INFO: common : 32] Successfully loaded yaml file: schema.yaml
[2024-11-11 08:21:16,970] INFO: common : 55] Created directory: artifacts
[2024-11-11 08:21:16,974] INFO: common : 55] Created directory: artifacts/data_cleaning
[2024-11-11 08:21:17,179] INFO: common : 79] Successfully loaded DataFrame from: artifacts\data_preprocessing\preprocessed_data.csv
[2024-11-11 08:21:17,179] INFO: data_cleaning : 30] Initiating train test split...
[2024-11-11 08:21:17,211] INFO: data_cleaning : 32] Train test split completed successfully.
[2024-11-11 08:21:17,212] INFO: data_cleaning : 74] Train_df :Index(['cust_id', 'age', 'gender', 'marital_status', 'employment_status',
       'income', 'number_of_dependants', 'residence_type',
       'years_at_current_address', 'city', 'state', 'zipcode', 'loan_id',
       'loan_purpose', 'loan_type', 'sanction_amount', 'loan_amount',
       'processing_fee', 'gst', 'net_disbursement', 'loan_tenure_months',
       'principal_outstanding', 'bank_balance_at_application',
       'disbursal_date', 'installment_start_dt', 'default',
       'number_of_open_accounts', 'number_of_closed_accounts',
       'total_loan_months', 'delinquent_months', 'total_dpd', 'enquiry_count',
       'credit_utilization_ratio'],
      dtype='object')
[2024-11-11 08:21:17,228] INFO: data_cleaning : 79]  After outlier removal train_df :(40000, 33)
[2024-11-11 08:21:17,228] INFO: data_cleaning : 80]  After outlier removal test_df :(10000, 33)
[2024-11-11 08:21:17,233] INFO: data_cleaning : 85] Rule 1: GST should not be more than 20% :(0, 33)
[2024-11-11 08:21:17,234] INFO: data_cleaning : 89] Rule 2: Net disbursement should not be higher than loan_amount :(0, 33)
[2024-11-11 08:21:17,235] INFO: data_cleaning : 94] Rule 3 : Fixed loan_purpose column :loan_purpose
Personal     14037
Home         12006
Auto          7950
Education     6007
Name: count, dtype: int64
[2024-11-11 08:21:17,246] INFO: data_cleaning : 99] Rule 4 : Generated loan_to_income column(LTI)
[2024-11-11 08:21:17,254] INFO: data_cleaning : 104] Generated delinquency_ratio column :count    40000.000000
mean        10.424123
std         17.283345
min          0.000000
25%          0.000000
50%          3.800000
75%         13.200000
max        100.000000
Name: delinquency_ratio, dtype: float64
[2024-11-11 08:21:17,268] ERROR: main : 41] An unexpected error occurred: 'loan_status'
[2024-11-11 08:32:03,020] INFO: __init__ : 26] Credit Risk Model Building Started
[2024-11-11 08:32:05,208] INFO: main : 12] >>>>>>>>>>>Starting Data Ingestion Stage<<<<<<<<<<<<<
[2024-11-11 08:32:05,208] INFO: common : 32] Successfully loaded yaml file: config\config.yaml
[2024-11-11 08:32:05,221] INFO: common : 32] Successfully loaded yaml file: params.yaml
[2024-11-11 08:32:05,226] INFO: common : 32] Successfully loaded yaml file: schema.yaml
[2024-11-11 08:32:05,227] INFO: common : 55] Created directory: artifacts
[2024-11-11 08:32:05,228] INFO: common : 55] Created directory: artifacts/data_ingestion
[2024-11-11 08:32:05,228] INFO: data_ingestion : 17] Loading customers data...
[2024-11-11 08:32:05,323] INFO: common : 79] Successfully loaded DataFrame from: data\customers.csv
[2024-11-11 08:32:05,324] INFO: data_ingestion : 20] Loading loans data...
[2024-11-11 08:32:05,452] INFO: common : 79] Successfully loaded DataFrame from: data\loans.csv
[2024-11-11 08:32:05,452] INFO: data_ingestion : 23] Loading bureau data...
[2024-11-11 08:32:05,505] INFO: common : 79] Successfully loaded DataFrame from: data\bureau_data.csv
[2024-11-11 08:32:05,505] INFO: data_ingestion : 26] The Shape of customers data: (50000, 12)
[2024-11-11 08:32:05,505] INFO: data_ingestion : 27] The Shape of loans data: (50000, 15)
[2024-11-11 08:32:05,505] INFO: data_ingestion : 28] The Shape of bureau data: (50000, 8)
[2024-11-11 08:32:06,114] INFO: common : 97] Successfully saved DataFrame to: artifacts\data_ingestion\data.csv
[2024-11-11 08:32:06,114] INFO: main : 14] >>>>>>>>>>>Completed Data Ingestion Stage<<<<<<<<<<<<<
[2024-11-11 08:32:06,114] INFO: main : 24] >>>>>>>>>>>Starting Data Pre-Processing Stage<<<<<<<<<<<<<
[2024-11-11 08:32:06,127] INFO: common : 32] Successfully loaded yaml file: config\config.yaml
[2024-11-11 08:32:06,129] INFO: common : 32] Successfully loaded yaml file: params.yaml
[2024-11-11 08:32:06,130] INFO: common : 32] Successfully loaded yaml file: schema.yaml
[2024-11-11 08:32:06,130] INFO: common : 55] Created directory: artifacts
[2024-11-11 08:32:06,130] INFO: common : 55] Created directory: artifacts/data_preprocessing
[2024-11-11 08:32:06,362] INFO: common : 79] Successfully loaded DataFrame from: artifacts\data_ingestion\data.csv
[2024-11-11 08:32:06,362] INFO: data_preprocessing : 26] The Valure counts for 'default' column: default
0    45703
1     4297
Name: count, dtype: int64
[2024-11-11 08:32:06,362] INFO: data_preprocessing : 42] No missing values found in column 'cust_id'
[2024-11-11 08:32:06,362] INFO: data_preprocessing : 42] No missing values found in column 'age'
[2024-11-11 08:32:06,376] INFO: data_preprocessing : 42] No missing values found in column 'gender'
[2024-11-11 08:32:06,378] INFO: data_preprocessing : 42] No missing values found in column 'marital_status'
[2024-11-11 08:32:06,381] INFO: data_preprocessing : 42] No missing values found in column 'employment_status'
[2024-11-11 08:32:06,382] INFO: data_preprocessing : 42] No missing values found in column 'income'
[2024-11-11 08:32:06,384] INFO: data_preprocessing : 42] No missing values found in column 'number_of_dependants'
[2024-11-11 08:32:06,386] WARNING: data_preprocessing : 33] Missing values found in column 'residence_type', replacing with 'Unknown'
[2024-11-11 08:32:06,395] INFO: data_preprocessing : 35] Missing values replaced in column 'residence_type' with mode 'Owned'
[2024-11-11 08:32:06,401] INFO: data_preprocessing : 42] No missing values found in column 'years_at_current_address'
[2024-11-11 08:32:06,404] INFO: data_preprocessing : 42] No missing values found in column 'city'
[2024-11-11 08:32:06,408] INFO: data_preprocessing : 42] No missing values found in column 'state'
[2024-11-11 08:32:06,409] INFO: data_preprocessing : 42] No missing values found in column 'zipcode'
[2024-11-11 08:32:06,412] INFO: data_preprocessing : 42] No missing values found in column 'loan_id'
[2024-11-11 08:32:06,412] INFO: data_preprocessing : 42] No missing values found in column 'loan_purpose'
[2024-11-11 08:32:06,420] INFO: data_preprocessing : 42] No missing values found in column 'loan_type'
[2024-11-11 08:32:06,421] INFO: data_preprocessing : 42] No missing values found in column 'sanction_amount'
[2024-11-11 08:32:06,422] INFO: data_preprocessing : 42] No missing values found in column 'loan_amount'
[2024-11-11 08:32:06,423] INFO: data_preprocessing : 42] No missing values found in column 'processing_fee'
[2024-11-11 08:32:06,423] INFO: data_preprocessing : 42] No missing values found in column 'gst'
[2024-11-11 08:32:06,424] INFO: data_preprocessing : 42] No missing values found in column 'net_disbursement'
[2024-11-11 08:32:06,425] INFO: data_preprocessing : 42] No missing values found in column 'loan_tenure_months'
[2024-11-11 08:32:06,426] INFO: data_preprocessing : 42] No missing values found in column 'principal_outstanding'
[2024-11-11 08:32:06,427] INFO: data_preprocessing : 42] No missing values found in column 'bank_balance_at_application'
[2024-11-11 08:32:06,431] INFO: data_preprocessing : 42] No missing values found in column 'disbursal_date'
[2024-11-11 08:32:06,434] INFO: data_preprocessing : 42] No missing values found in column 'installment_start_dt'
[2024-11-11 08:32:06,435] INFO: data_preprocessing : 42] No missing values found in column 'default'
[2024-11-11 08:32:06,436] INFO: data_preprocessing : 42] No missing values found in column 'number_of_open_accounts'
[2024-11-11 08:32:06,437] INFO: data_preprocessing : 42] No missing values found in column 'number_of_closed_accounts'
[2024-11-11 08:32:06,438] INFO: data_preprocessing : 42] No missing values found in column 'total_loan_months'
[2024-11-11 08:32:06,439] INFO: data_preprocessing : 42] No missing values found in column 'delinquent_months'
[2024-11-11 08:32:06,440] INFO: data_preprocessing : 42] No missing values found in column 'total_dpd'
[2024-11-11 08:32:06,441] INFO: data_preprocessing : 42] No missing values found in column 'enquiry_count'
[2024-11-11 08:32:06,442] INFO: data_preprocessing : 42] No missing values found in column 'credit_utilization_ratio'
[2024-11-11 08:32:06,509] INFO: data_preprocessing : 51] No duplicate rows found
[2024-11-11 08:32:06,510] INFO: data_preprocessing : 53] Index(['cust_id', 'age', 'gender', 'marital_status', 'employment_status',
       'income', 'number_of_dependants', 'residence_type',
       'years_at_current_address', 'city', 'state', 'zipcode', 'loan_id',
       'loan_purpose', 'loan_type', 'sanction_amount', 'loan_amount',
       'processing_fee', 'gst', 'net_disbursement', 'loan_tenure_months',
       'principal_outstanding', 'bank_balance_at_application',
       'disbursal_date', 'installment_start_dt', 'default',
       'number_of_open_accounts', 'number_of_closed_accounts',
       'total_loan_months', 'delinquent_months', 'total_dpd', 'enquiry_count',
       'credit_utilization_ratio'],
      dtype='object')
[2024-11-11 08:32:06,997] INFO: common : 97] Successfully saved DataFrame to: artifacts\data_preprocessing\preprocessed_data.csv
[2024-11-11 08:32:06,997] INFO: main : 26] >>>>>>>>>>>Completed Data Pre-Processing Stage<<<<<<<<<<<<<
[2024-11-11 08:32:06,997] INFO: main : 36] >>>>>>>>>>>Starting Data Cleaning Stage<<<<<<<<<<<<<
[2024-11-11 08:32:06,997] INFO: common : 32] Successfully loaded yaml file: config\config.yaml
[2024-11-11 08:32:07,006] INFO: common : 32] Successfully loaded yaml file: params.yaml
[2024-11-11 08:32:07,010] INFO: common : 32] Successfully loaded yaml file: schema.yaml
[2024-11-11 08:32:07,011] INFO: common : 55] Created directory: artifacts
[2024-11-11 08:32:07,012] INFO: common : 55] Created directory: artifacts/data_cleaning
[2024-11-11 08:32:07,232] INFO: common : 79] Successfully loaded DataFrame from: artifacts\data_preprocessing\preprocessed_data.csv
[2024-11-11 08:32:07,232] INFO: data_cleaning : 30] Initiating train test split...
[2024-11-11 08:32:07,266] INFO: data_cleaning : 32] Train test split completed successfully.
[2024-11-11 08:32:07,266] INFO: data_cleaning : 74] Train_df :Index(['cust_id', 'age', 'gender', 'marital_status', 'employment_status',
       'income', 'number_of_dependants', 'residence_type',
       'years_at_current_address', 'city', 'state', 'zipcode', 'loan_id',
       'loan_purpose', 'loan_type', 'sanction_amount', 'loan_amount',
       'processing_fee', 'gst', 'net_disbursement', 'loan_tenure_months',
       'principal_outstanding', 'bank_balance_at_application',
       'disbursal_date', 'installment_start_dt', 'default',
       'number_of_open_accounts', 'number_of_closed_accounts',
       'total_loan_months', 'delinquent_months', 'total_dpd', 'enquiry_count',
       'credit_utilization_ratio'],
      dtype='object')
[2024-11-11 08:32:07,275] INFO: data_cleaning : 79]  After outlier removal train_df :(40000, 33)
[2024-11-11 08:32:07,275] INFO: data_cleaning : 80]  After outlier removal test_df :(10000, 33)
[2024-11-11 08:32:07,285] INFO: data_cleaning : 85] Rule 1: GST should not be more than 20% :(0, 33)
[2024-11-11 08:32:07,286] INFO: data_cleaning : 89] Rule 2: Net disbursement should not be higher than loan_amount :(0, 33)
[2024-11-11 08:32:07,291] INFO: data_cleaning : 94] Rule 3 : Fixed loan_purpose column :loan_purpose
Personal     14037
Home         12006
Auto          7950
Education     6007
Name: count, dtype: int64
[2024-11-11 08:32:07,299] INFO: data_cleaning : 99] Rule 4 : Generated loan_to_income column(LTI)
[2024-11-11 08:32:07,306] INFO: data_cleaning : 104] Generated delinquency_ratio column :count    40000.000000
mean        10.424123
std         17.283345
min          0.000000
25%          0.000000
50%          3.800000
75%         13.200000
max        100.000000
Name: delinquency_ratio, dtype: float64
[2024-11-11 08:32:07,310] INFO: data_cleaning : 118] Generated avg_dpd_per_delinquency column :count    40000.000000
mean         3.303845
std          2.902944
min          0.000000
25%          0.000000
50%          4.300000
75%          5.800000
max         10.000000
Name: avg_dpd_per_delinquency, dtype: float64
[2024-11-11 08:32:07,316] INFO: data_cleaning : 40] Removing columns...
[2024-11-11 08:32:07,316] ERROR: main : 41] An unexpected error occurred: 'DataCleaning' object has no attribute 'params'
[2024-11-11 08:34:28,686] INFO: __init__ : 26] Credit Risk Model Building Started
[2024-11-11 08:34:30,923] INFO: main : 12] >>>>>>>>>>>Starting Data Ingestion Stage<<<<<<<<<<<<<
[2024-11-11 08:34:30,923] INFO: common : 32] Successfully loaded yaml file: config\config.yaml
[2024-11-11 08:34:30,923] INFO: common : 32] Successfully loaded yaml file: params.yaml
[2024-11-11 08:34:30,941] INFO: common : 32] Successfully loaded yaml file: schema.yaml
[2024-11-11 08:34:30,942] INFO: common : 55] Created directory: artifacts
[2024-11-11 08:34:30,943] INFO: common : 55] Created directory: artifacts/data_ingestion
[2024-11-11 08:34:30,943] INFO: data_ingestion : 17] Loading customers data...
[2024-11-11 08:34:31,037] INFO: common : 79] Successfully loaded DataFrame from: data\customers.csv
[2024-11-11 08:34:31,038] INFO: data_ingestion : 20] Loading loans data...
[2024-11-11 08:34:31,169] INFO: common : 79] Successfully loaded DataFrame from: data\loans.csv
[2024-11-11 08:34:31,169] INFO: data_ingestion : 23] Loading bureau data...
[2024-11-11 08:34:31,218] INFO: common : 79] Successfully loaded DataFrame from: data\bureau_data.csv
[2024-11-11 08:34:31,219] INFO: data_ingestion : 26] The Shape of customers data: (50000, 12)
[2024-11-11 08:34:31,219] INFO: data_ingestion : 27] The Shape of loans data: (50000, 15)
[2024-11-11 08:34:31,221] INFO: data_ingestion : 28] The Shape of bureau data: (50000, 8)
[2024-11-11 08:34:31,762] INFO: common : 97] Successfully saved DataFrame to: artifacts\data_ingestion\data.csv
[2024-11-11 08:34:31,768] INFO: main : 14] >>>>>>>>>>>Completed Data Ingestion Stage<<<<<<<<<<<<<
[2024-11-11 08:34:31,768] INFO: main : 24] >>>>>>>>>>>Starting Data Pre-Processing Stage<<<<<<<<<<<<<
[2024-11-11 08:34:31,773] INFO: common : 32] Successfully loaded yaml file: config\config.yaml
[2024-11-11 08:34:31,775] INFO: common : 32] Successfully loaded yaml file: params.yaml
[2024-11-11 08:34:31,778] INFO: common : 32] Successfully loaded yaml file: schema.yaml
[2024-11-11 08:34:31,779] INFO: common : 55] Created directory: artifacts
[2024-11-11 08:34:31,779] INFO: common : 55] Created directory: artifacts/data_preprocessing
[2024-11-11 08:34:31,980] INFO: common : 79] Successfully loaded DataFrame from: artifacts\data_ingestion\data.csv
[2024-11-11 08:34:31,995] INFO: data_preprocessing : 26] The Valure counts for 'default' column: default
0    45703
1     4297
Name: count, dtype: int64
[2024-11-11 08:34:31,998] INFO: data_preprocessing : 42] No missing values found in column 'cust_id'
[2024-11-11 08:34:31,998] INFO: data_preprocessing : 42] No missing values found in column 'age'
[2024-11-11 08:34:32,003] INFO: data_preprocessing : 42] No missing values found in column 'gender'
[2024-11-11 08:34:32,007] INFO: data_preprocessing : 42] No missing values found in column 'marital_status'
[2024-11-11 08:34:32,011] INFO: data_preprocessing : 42] No missing values found in column 'employment_status'
[2024-11-11 08:34:32,011] INFO: data_preprocessing : 42] No missing values found in column 'income'
[2024-11-11 08:34:32,013] INFO: data_preprocessing : 42] No missing values found in column 'number_of_dependants'
[2024-11-11 08:34:32,015] WARNING: data_preprocessing : 33] Missing values found in column 'residence_type', replacing with 'Unknown'
[2024-11-11 08:34:32,026] INFO: data_preprocessing : 35] Missing values replaced in column 'residence_type' with mode 'Owned'
[2024-11-11 08:34:32,027] INFO: data_preprocessing : 42] No missing values found in column 'years_at_current_address'
[2024-11-11 08:34:32,027] INFO: data_preprocessing : 42] No missing values found in column 'city'
[2024-11-11 08:34:32,027] INFO: data_preprocessing : 42] No missing values found in column 'state'
[2024-11-11 08:34:32,027] INFO: data_preprocessing : 42] No missing values found in column 'zipcode'
[2024-11-11 08:34:32,037] INFO: data_preprocessing : 42] No missing values found in column 'loan_id'
[2024-11-11 08:34:32,039] INFO: data_preprocessing : 42] No missing values found in column 'loan_purpose'
[2024-11-11 08:34:32,042] INFO: data_preprocessing : 42] No missing values found in column 'loan_type'
[2024-11-11 08:34:32,043] INFO: data_preprocessing : 42] No missing values found in column 'sanction_amount'
[2024-11-11 08:34:32,043] INFO: data_preprocessing : 42] No missing values found in column 'loan_amount'
[2024-11-11 08:34:32,044] INFO: data_preprocessing : 42] No missing values found in column 'processing_fee'
[2024-11-11 08:34:32,045] INFO: data_preprocessing : 42] No missing values found in column 'gst'
[2024-11-11 08:34:32,045] INFO: data_preprocessing : 42] No missing values found in column 'net_disbursement'
[2024-11-11 08:34:32,046] INFO: data_preprocessing : 42] No missing values found in column 'loan_tenure_months'
[2024-11-11 08:34:32,046] INFO: data_preprocessing : 42] No missing values found in column 'principal_outstanding'
[2024-11-11 08:34:32,046] INFO: data_preprocessing : 42] No missing values found in column 'bank_balance_at_application'
[2024-11-11 08:34:32,050] INFO: data_preprocessing : 42] No missing values found in column 'disbursal_date'
[2024-11-11 08:34:32,053] INFO: data_preprocessing : 42] No missing values found in column 'installment_start_dt'
[2024-11-11 08:34:32,054] INFO: data_preprocessing : 42] No missing values found in column 'default'
[2024-11-11 08:34:32,055] INFO: data_preprocessing : 42] No missing values found in column 'number_of_open_accounts'
[2024-11-11 08:34:32,056] INFO: data_preprocessing : 42] No missing values found in column 'number_of_closed_accounts'
[2024-11-11 08:34:32,057] INFO: data_preprocessing : 42] No missing values found in column 'total_loan_months'
[2024-11-11 08:34:32,058] INFO: data_preprocessing : 42] No missing values found in column 'delinquent_months'
[2024-11-11 08:34:32,059] INFO: data_preprocessing : 42] No missing values found in column 'total_dpd'
[2024-11-11 08:34:32,059] INFO: data_preprocessing : 42] No missing values found in column 'enquiry_count'
[2024-11-11 08:34:32,061] INFO: data_preprocessing : 42] No missing values found in column 'credit_utilization_ratio'
[2024-11-11 08:34:32,124] INFO: data_preprocessing : 51] No duplicate rows found
[2024-11-11 08:34:32,124] INFO: data_preprocessing : 53] Index(['cust_id', 'age', 'gender', 'marital_status', 'employment_status',
       'income', 'number_of_dependants', 'residence_type',
       'years_at_current_address', 'city', 'state', 'zipcode', 'loan_id',
       'loan_purpose', 'loan_type', 'sanction_amount', 'loan_amount',
       'processing_fee', 'gst', 'net_disbursement', 'loan_tenure_months',
       'principal_outstanding', 'bank_balance_at_application',
       'disbursal_date', 'installment_start_dt', 'default',
       'number_of_open_accounts', 'number_of_closed_accounts',
       'total_loan_months', 'delinquent_months', 'total_dpd', 'enquiry_count',
       'credit_utilization_ratio'],
      dtype='object')
[2024-11-11 08:34:32,554] INFO: common : 97] Successfully saved DataFrame to: artifacts\data_preprocessing\preprocessed_data.csv
[2024-11-11 08:34:32,570] INFO: main : 26] >>>>>>>>>>>Completed Data Pre-Processing Stage<<<<<<<<<<<<<
[2024-11-11 08:34:32,570] INFO: main : 36] >>>>>>>>>>>Starting Data Cleaning Stage<<<<<<<<<<<<<
[2024-11-11 08:34:32,576] INFO: common : 32] Successfully loaded yaml file: config\config.yaml
[2024-11-11 08:34:32,579] INFO: common : 32] Successfully loaded yaml file: params.yaml
[2024-11-11 08:34:32,581] INFO: common : 32] Successfully loaded yaml file: schema.yaml
[2024-11-11 08:34:32,582] INFO: common : 55] Created directory: artifacts
[2024-11-11 08:34:32,583] INFO: common : 55] Created directory: artifacts/data_cleaning
[2024-11-11 08:34:32,810] INFO: common : 79] Successfully loaded DataFrame from: artifacts\data_preprocessing\preprocessed_data.csv
[2024-11-11 08:34:32,812] INFO: data_cleaning : 30] Initiating train test split...
[2024-11-11 08:34:32,830] INFO: data_cleaning : 32] Train test split completed successfully.
[2024-11-11 08:34:32,831] INFO: data_cleaning : 74] Train_df :Index(['cust_id', 'age', 'gender', 'marital_status', 'employment_status',
       'income', 'number_of_dependants', 'residence_type',
       'years_at_current_address', 'city', 'state', 'zipcode', 'loan_id',
       'loan_purpose', 'loan_type', 'sanction_amount', 'loan_amount',
       'processing_fee', 'gst', 'net_disbursement', 'loan_tenure_months',
       'principal_outstanding', 'bank_balance_at_application',
       'disbursal_date', 'installment_start_dt', 'default',
       'number_of_open_accounts', 'number_of_closed_accounts',
       'total_loan_months', 'delinquent_months', 'total_dpd', 'enquiry_count',
       'credit_utilization_ratio'],
      dtype='object')
[2024-11-11 08:34:32,837] INFO: data_cleaning : 79]  After outlier removal train_df :(40000, 33)
[2024-11-11 08:34:32,837] INFO: data_cleaning : 80]  After outlier removal test_df :(10000, 33)
[2024-11-11 08:34:32,850] INFO: data_cleaning : 85] Rule 1: GST should not be more than 20% :(0, 33)
[2024-11-11 08:34:32,851] INFO: data_cleaning : 89] Rule 2: Net disbursement should not be higher than loan_amount :(0, 33)
[2024-11-11 08:34:32,856] INFO: data_cleaning : 94] Rule 3 : Fixed loan_purpose column :loan_purpose
Personal     14037
Home         12006
Auto          7950
Education     6007
Name: count, dtype: int64
[2024-11-11 08:34:32,864] INFO: data_cleaning : 99] Rule 4 : Generated loan_to_income column(LTI)
[2024-11-11 08:34:32,871] INFO: data_cleaning : 104] Generated delinquency_ratio column :count    40000.000000
mean        10.424123
std         17.283345
min          0.000000
25%          0.000000
50%          3.800000
75%         13.200000
max        100.000000
Name: delinquency_ratio, dtype: float64
[2024-11-11 08:34:32,879] INFO: data_cleaning : 118] Generated avg_dpd_per_delinquency column :count    40000.000000
mean         3.303845
std          2.902944
min          0.000000
25%          0.000000
50%          4.300000
75%          5.800000
max         10.000000
Name: avg_dpd_per_delinquency, dtype: float64
[2024-11-11 08:34:32,882] INFO: data_cleaning : 40] Removing columns...
[2024-11-11 08:34:32,882] ERROR: main : 41] An unexpected error occurred: 'DataCleaning' object has no attribute 'columns_to_have'
[2024-11-11 08:35:15,558] INFO: __init__ : 26] Credit Risk Model Building Started
[2024-11-11 08:35:17,712] INFO: main : 12] >>>>>>>>>>>Starting Data Ingestion Stage<<<<<<<<<<<<<
[2024-11-11 08:35:17,715] INFO: common : 32] Successfully loaded yaml file: config\config.yaml
[2024-11-11 08:35:17,718] INFO: common : 32] Successfully loaded yaml file: params.yaml
[2024-11-11 08:35:17,721] INFO: common : 32] Successfully loaded yaml file: schema.yaml
[2024-11-11 08:35:17,723] INFO: common : 55] Created directory: artifacts
[2024-11-11 08:35:17,723] INFO: common : 55] Created directory: artifacts/data_ingestion
[2024-11-11 08:35:17,724] INFO: data_ingestion : 17] Loading customers data...
[2024-11-11 08:35:17,812] INFO: common : 79] Successfully loaded DataFrame from: data\customers.csv
[2024-11-11 08:35:17,812] INFO: data_ingestion : 20] Loading loans data...
[2024-11-11 08:35:17,935] INFO: common : 79] Successfully loaded DataFrame from: data\loans.csv
[2024-11-11 08:35:17,935] INFO: data_ingestion : 23] Loading bureau data...
[2024-11-11 08:35:17,976] INFO: common : 79] Successfully loaded DataFrame from: data\bureau_data.csv
[2024-11-11 08:35:17,976] INFO: data_ingestion : 26] The Shape of customers data: (50000, 12)
[2024-11-11 08:35:17,976] INFO: data_ingestion : 27] The Shape of loans data: (50000, 15)
[2024-11-11 08:35:17,976] INFO: data_ingestion : 28] The Shape of bureau data: (50000, 8)
[2024-11-11 08:35:18,496] INFO: common : 97] Successfully saved DataFrame to: artifacts\data_ingestion\data.csv
[2024-11-11 08:35:18,504] INFO: main : 14] >>>>>>>>>>>Completed Data Ingestion Stage<<<<<<<<<<<<<
[2024-11-11 08:35:18,504] INFO: main : 24] >>>>>>>>>>>Starting Data Pre-Processing Stage<<<<<<<<<<<<<
[2024-11-11 08:35:18,512] INFO: common : 32] Successfully loaded yaml file: config\config.yaml
[2024-11-11 08:35:18,514] INFO: common : 32] Successfully loaded yaml file: params.yaml
[2024-11-11 08:35:18,517] INFO: common : 32] Successfully loaded yaml file: schema.yaml
[2024-11-11 08:35:18,518] INFO: common : 55] Created directory: artifacts
[2024-11-11 08:35:18,518] INFO: common : 55] Created directory: artifacts/data_preprocessing
[2024-11-11 08:35:18,716] INFO: common : 79] Successfully loaded DataFrame from: artifacts\data_ingestion\data.csv
[2024-11-11 08:35:18,716] INFO: data_preprocessing : 26] The Valure counts for 'default' column: default
0    45703
1     4297
Name: count, dtype: int64
[2024-11-11 08:35:18,730] INFO: data_preprocessing : 42] No missing values found in column 'cust_id'
[2024-11-11 08:35:18,731] INFO: data_preprocessing : 42] No missing values found in column 'age'
[2024-11-11 08:35:18,734] INFO: data_preprocessing : 42] No missing values found in column 'gender'
[2024-11-11 08:35:18,737] INFO: data_preprocessing : 42] No missing values found in column 'marital_status'
[2024-11-11 08:35:18,739] INFO: data_preprocessing : 42] No missing values found in column 'employment_status'
[2024-11-11 08:35:18,739] INFO: data_preprocessing : 42] No missing values found in column 'income'
[2024-11-11 08:35:18,743] INFO: data_preprocessing : 42] No missing values found in column 'number_of_dependants'
[2024-11-11 08:35:18,747] WARNING: data_preprocessing : 33] Missing values found in column 'residence_type', replacing with 'Unknown'
[2024-11-11 08:35:18,754] INFO: data_preprocessing : 35] Missing values replaced in column 'residence_type' with mode 'Owned'
[2024-11-11 08:35:18,754] INFO: data_preprocessing : 42] No missing values found in column 'years_at_current_address'
[2024-11-11 08:35:18,765] INFO: data_preprocessing : 42] No missing values found in column 'city'
[2024-11-11 08:35:18,768] INFO: data_preprocessing : 42] No missing values found in column 'state'
[2024-11-11 08:35:18,769] INFO: data_preprocessing : 42] No missing values found in column 'zipcode'
[2024-11-11 08:35:18,773] INFO: data_preprocessing : 42] No missing values found in column 'loan_id'
[2024-11-11 08:35:18,776] INFO: data_preprocessing : 42] No missing values found in column 'loan_purpose'
[2024-11-11 08:35:18,779] INFO: data_preprocessing : 42] No missing values found in column 'loan_type'
[2024-11-11 08:35:18,780] INFO: data_preprocessing : 42] No missing values found in column 'sanction_amount'
[2024-11-11 08:35:18,782] INFO: data_preprocessing : 42] No missing values found in column 'loan_amount'
[2024-11-11 08:35:18,783] INFO: data_preprocessing : 42] No missing values found in column 'processing_fee'
[2024-11-11 08:35:18,784] INFO: data_preprocessing : 42] No missing values found in column 'gst'
[2024-11-11 08:35:18,785] INFO: data_preprocessing : 42] No missing values found in column 'net_disbursement'
[2024-11-11 08:35:18,786] INFO: data_preprocessing : 42] No missing values found in column 'loan_tenure_months'
[2024-11-11 08:35:18,787] INFO: data_preprocessing : 42] No missing values found in column 'principal_outstanding'
[2024-11-11 08:35:18,789] INFO: data_preprocessing : 42] No missing values found in column 'bank_balance_at_application'
[2024-11-11 08:35:18,792] INFO: data_preprocessing : 42] No missing values found in column 'disbursal_date'
[2024-11-11 08:35:18,796] INFO: data_preprocessing : 42] No missing values found in column 'installment_start_dt'
[2024-11-11 08:35:18,797] INFO: data_preprocessing : 42] No missing values found in column 'default'
[2024-11-11 08:35:18,798] INFO: data_preprocessing : 42] No missing values found in column 'number_of_open_accounts'
[2024-11-11 08:35:18,799] INFO: data_preprocessing : 42] No missing values found in column 'number_of_closed_accounts'
[2024-11-11 08:35:18,800] INFO: data_preprocessing : 42] No missing values found in column 'total_loan_months'
[2024-11-11 08:35:18,802] INFO: data_preprocessing : 42] No missing values found in column 'delinquent_months'
[2024-11-11 08:35:18,803] INFO: data_preprocessing : 42] No missing values found in column 'total_dpd'
[2024-11-11 08:35:18,804] INFO: data_preprocessing : 42] No missing values found in column 'enquiry_count'
[2024-11-11 08:35:18,805] INFO: data_preprocessing : 42] No missing values found in column 'credit_utilization_ratio'
[2024-11-11 08:35:18,871] INFO: data_preprocessing : 51] No duplicate rows found
[2024-11-11 08:35:18,871] INFO: data_preprocessing : 53] Index(['cust_id', 'age', 'gender', 'marital_status', 'employment_status',
       'income', 'number_of_dependants', 'residence_type',
       'years_at_current_address', 'city', 'state', 'zipcode', 'loan_id',
       'loan_purpose', 'loan_type', 'sanction_amount', 'loan_amount',
       'processing_fee', 'gst', 'net_disbursement', 'loan_tenure_months',
       'principal_outstanding', 'bank_balance_at_application',
       'disbursal_date', 'installment_start_dt', 'default',
       'number_of_open_accounts', 'number_of_closed_accounts',
       'total_loan_months', 'delinquent_months', 'total_dpd', 'enquiry_count',
       'credit_utilization_ratio'],
      dtype='object')
[2024-11-11 08:35:19,383] INFO: common : 97] Successfully saved DataFrame to: artifacts\data_preprocessing\preprocessed_data.csv
[2024-11-11 08:35:19,383] INFO: main : 26] >>>>>>>>>>>Completed Data Pre-Processing Stage<<<<<<<<<<<<<
[2024-11-11 08:35:19,383] INFO: main : 36] >>>>>>>>>>>Starting Data Cleaning Stage<<<<<<<<<<<<<
[2024-11-11 08:35:19,383] INFO: common : 32] Successfully loaded yaml file: config\config.yaml
[2024-11-11 08:35:19,399] INFO: common : 32] Successfully loaded yaml file: params.yaml
[2024-11-11 08:35:19,401] INFO: common : 32] Successfully loaded yaml file: schema.yaml
[2024-11-11 08:35:19,402] INFO: common : 55] Created directory: artifacts
[2024-11-11 08:35:19,403] INFO: common : 55] Created directory: artifacts/data_cleaning
[2024-11-11 08:35:19,614] INFO: common : 79] Successfully loaded DataFrame from: artifacts\data_preprocessing\preprocessed_data.csv
[2024-11-11 08:35:19,614] INFO: data_cleaning : 30] Initiating train test split...
[2024-11-11 08:35:19,640] INFO: data_cleaning : 32] Train test split completed successfully.
[2024-11-11 08:35:19,641] INFO: data_cleaning : 74] Train_df :Index(['cust_id', 'age', 'gender', 'marital_status', 'employment_status',
       'income', 'number_of_dependants', 'residence_type',
       'years_at_current_address', 'city', 'state', 'zipcode', 'loan_id',
       'loan_purpose', 'loan_type', 'sanction_amount', 'loan_amount',
       'processing_fee', 'gst', 'net_disbursement', 'loan_tenure_months',
       'principal_outstanding', 'bank_balance_at_application',
       'disbursal_date', 'installment_start_dt', 'default',
       'number_of_open_accounts', 'number_of_closed_accounts',
       'total_loan_months', 'delinquent_months', 'total_dpd', 'enquiry_count',
       'credit_utilization_ratio'],
      dtype='object')
[2024-11-11 08:35:19,659] INFO: data_cleaning : 79]  After outlier removal train_df :(40000, 33)
[2024-11-11 08:35:19,660] INFO: data_cleaning : 80]  After outlier removal test_df :(10000, 33)
[2024-11-11 08:35:19,661] INFO: data_cleaning : 85] Rule 1: GST should not be more than 20% :(0, 33)
[2024-11-11 08:35:19,662] INFO: data_cleaning : 89] Rule 2: Net disbursement should not be higher than loan_amount :(0, 33)
[2024-11-11 08:35:19,670] INFO: data_cleaning : 94] Rule 3 : Fixed loan_purpose column :loan_purpose
Personal     14037
Home         12006
Auto          7950
Education     6007
Name: count, dtype: int64
[2024-11-11 08:35:19,675] INFO: data_cleaning : 99] Rule 4 : Generated loan_to_income column(LTI)
[2024-11-11 08:35:19,679] INFO: data_cleaning : 104] Generated delinquency_ratio column :count    40000.000000
mean        10.424123
std         17.283345
min          0.000000
25%          0.000000
50%          3.800000
75%         13.200000
max        100.000000
Name: delinquency_ratio, dtype: float64
[2024-11-11 08:35:19,689] INFO: data_cleaning : 118] Generated avg_dpd_per_delinquency column :count    40000.000000
mean         3.303845
std          2.902944
min          0.000000
25%          0.000000
50%          4.300000
75%          5.800000
max         10.000000
Name: avg_dpd_per_delinquency, dtype: float64
[2024-11-11 08:35:19,691] INFO: data_cleaning : 40] Removing columns...
[2024-11-11 08:35:19,691] ERROR: main : 41] An unexpected error occurred: 'DataCleaning' object has no attribute 'columns_to_have'
[2024-11-11 08:36:08,736] INFO: __init__ : 26] Credit Risk Model Building Started
[2024-11-11 08:36:10,697] INFO: main : 12] >>>>>>>>>>>Starting Data Ingestion Stage<<<<<<<<<<<<<
[2024-11-11 08:36:10,706] INFO: common : 32] Successfully loaded yaml file: config\config.yaml
[2024-11-11 08:36:10,708] INFO: common : 32] Successfully loaded yaml file: params.yaml
[2024-11-11 08:36:10,712] INFO: common : 32] Successfully loaded yaml file: schema.yaml
[2024-11-11 08:36:10,713] INFO: common : 55] Created directory: artifacts
[2024-11-11 08:36:10,713] INFO: common : 55] Created directory: artifacts/data_ingestion
[2024-11-11 08:36:10,714] INFO: data_ingestion : 17] Loading customers data...
[2024-11-11 08:36:10,811] INFO: common : 79] Successfully loaded DataFrame from: data\customers.csv
[2024-11-11 08:36:10,812] INFO: data_ingestion : 20] Loading loans data...
[2024-11-11 08:36:10,966] INFO: common : 79] Successfully loaded DataFrame from: data\loans.csv
[2024-11-11 08:36:10,966] INFO: data_ingestion : 23] Loading bureau data...
[2024-11-11 08:36:11,021] INFO: common : 79] Successfully loaded DataFrame from: data\bureau_data.csv
[2024-11-11 08:36:11,021] INFO: data_ingestion : 26] The Shape of customers data: (50000, 12)
[2024-11-11 08:36:11,021] INFO: data_ingestion : 27] The Shape of loans data: (50000, 15)
[2024-11-11 08:36:11,021] INFO: data_ingestion : 28] The Shape of bureau data: (50000, 8)
[2024-11-11 08:36:11,585] INFO: common : 97] Successfully saved DataFrame to: artifacts\data_ingestion\data.csv
[2024-11-11 08:36:11,586] INFO: main : 14] >>>>>>>>>>>Completed Data Ingestion Stage<<<<<<<<<<<<<
[2024-11-11 08:36:11,586] INFO: main : 24] >>>>>>>>>>>Starting Data Pre-Processing Stage<<<<<<<<<<<<<
[2024-11-11 08:36:11,595] INFO: common : 32] Successfully loaded yaml file: config\config.yaml
[2024-11-11 08:36:11,597] INFO: common : 32] Successfully loaded yaml file: params.yaml
[2024-11-11 08:36:11,599] INFO: common : 32] Successfully loaded yaml file: schema.yaml
[2024-11-11 08:36:11,599] INFO: common : 55] Created directory: artifacts
[2024-11-11 08:36:11,601] INFO: common : 55] Created directory: artifacts/data_preprocessing
[2024-11-11 08:36:11,834] INFO: common : 79] Successfully loaded DataFrame from: artifacts\data_ingestion\data.csv
[2024-11-11 08:36:11,837] INFO: data_preprocessing : 26] The Valure counts for 'default' column: default
0    45703
1     4297
Name: count, dtype: int64
[2024-11-11 08:36:11,837] INFO: data_preprocessing : 42] No missing values found in column 'cust_id'
[2024-11-11 08:36:11,837] INFO: data_preprocessing : 42] No missing values found in column 'age'
[2024-11-11 08:36:11,845] INFO: data_preprocessing : 42] No missing values found in column 'gender'
[2024-11-11 08:36:11,848] INFO: data_preprocessing : 42] No missing values found in column 'marital_status'
[2024-11-11 08:36:11,852] INFO: data_preprocessing : 42] No missing values found in column 'employment_status'
[2024-11-11 08:36:11,854] INFO: data_preprocessing : 42] No missing values found in column 'income'
[2024-11-11 08:36:11,855] INFO: data_preprocessing : 42] No missing values found in column 'number_of_dependants'
[2024-11-11 08:36:11,857] WARNING: data_preprocessing : 33] Missing values found in column 'residence_type', replacing with 'Unknown'
[2024-11-11 08:36:11,872] INFO: data_preprocessing : 35] Missing values replaced in column 'residence_type' with mode 'Owned'
[2024-11-11 08:36:11,873] INFO: data_preprocessing : 42] No missing values found in column 'years_at_current_address'
[2024-11-11 08:36:11,873] INFO: data_preprocessing : 42] No missing values found in column 'city'
[2024-11-11 08:36:11,880] INFO: data_preprocessing : 42] No missing values found in column 'state'
[2024-11-11 08:36:11,881] INFO: data_preprocessing : 42] No missing values found in column 'zipcode'
[2024-11-11 08:36:11,884] INFO: data_preprocessing : 42] No missing values found in column 'loan_id'
[2024-11-11 08:36:11,888] INFO: data_preprocessing : 42] No missing values found in column 'loan_purpose'
[2024-11-11 08:36:11,892] INFO: data_preprocessing : 42] No missing values found in column 'loan_type'
[2024-11-11 08:36:11,892] INFO: data_preprocessing : 42] No missing values found in column 'sanction_amount'
[2024-11-11 08:36:11,894] INFO: data_preprocessing : 42] No missing values found in column 'loan_amount'
[2024-11-11 08:36:11,895] INFO: data_preprocessing : 42] No missing values found in column 'processing_fee'
[2024-11-11 08:36:11,896] INFO: data_preprocessing : 42] No missing values found in column 'gst'
[2024-11-11 08:36:11,897] INFO: data_preprocessing : 42] No missing values found in column 'net_disbursement'
[2024-11-11 08:36:11,897] INFO: data_preprocessing : 42] No missing values found in column 'loan_tenure_months'
[2024-11-11 08:36:11,898] INFO: data_preprocessing : 42] No missing values found in column 'principal_outstanding'
[2024-11-11 08:36:11,899] INFO: data_preprocessing : 42] No missing values found in column 'bank_balance_at_application'
[2024-11-11 08:36:11,903] INFO: data_preprocessing : 42] No missing values found in column 'disbursal_date'
[2024-11-11 08:36:11,907] INFO: data_preprocessing : 42] No missing values found in column 'installment_start_dt'
[2024-11-11 08:36:11,908] INFO: data_preprocessing : 42] No missing values found in column 'default'
[2024-11-11 08:36:11,909] INFO: data_preprocessing : 42] No missing values found in column 'number_of_open_accounts'
[2024-11-11 08:36:11,910] INFO: data_preprocessing : 42] No missing values found in column 'number_of_closed_accounts'
[2024-11-11 08:36:11,911] INFO: data_preprocessing : 42] No missing values found in column 'total_loan_months'
[2024-11-11 08:36:11,911] INFO: data_preprocessing : 42] No missing values found in column 'delinquent_months'
[2024-11-11 08:36:11,911] INFO: data_preprocessing : 42] No missing values found in column 'total_dpd'
[2024-11-11 08:36:11,914] INFO: data_preprocessing : 42] No missing values found in column 'enquiry_count'
[2024-11-11 08:36:11,915] INFO: data_preprocessing : 42] No missing values found in column 'credit_utilization_ratio'
[2024-11-11 08:36:11,987] INFO: data_preprocessing : 51] No duplicate rows found
[2024-11-11 08:36:11,989] INFO: data_preprocessing : 53] Index(['cust_id', 'age', 'gender', 'marital_status', 'employment_status',
       'income', 'number_of_dependants', 'residence_type',
       'years_at_current_address', 'city', 'state', 'zipcode', 'loan_id',
       'loan_purpose', 'loan_type', 'sanction_amount', 'loan_amount',
       'processing_fee', 'gst', 'net_disbursement', 'loan_tenure_months',
       'principal_outstanding', 'bank_balance_at_application',
       'disbursal_date', 'installment_start_dt', 'default',
       'number_of_open_accounts', 'number_of_closed_accounts',
       'total_loan_months', 'delinquent_months', 'total_dpd', 'enquiry_count',
       'credit_utilization_ratio'],
      dtype='object')
[2024-11-11 08:36:12,493] INFO: common : 97] Successfully saved DataFrame to: artifacts\data_preprocessing\preprocessed_data.csv
[2024-11-11 08:36:12,493] INFO: main : 26] >>>>>>>>>>>Completed Data Pre-Processing Stage<<<<<<<<<<<<<
[2024-11-11 08:36:12,493] INFO: main : 36] >>>>>>>>>>>Starting Data Cleaning Stage<<<<<<<<<<<<<
[2024-11-11 08:36:12,509] INFO: common : 32] Successfully loaded yaml file: config\config.yaml
[2024-11-11 08:36:12,511] INFO: common : 32] Successfully loaded yaml file: params.yaml
[2024-11-11 08:36:12,514] INFO: common : 32] Successfully loaded yaml file: schema.yaml
[2024-11-11 08:36:12,515] INFO: common : 55] Created directory: artifacts
[2024-11-11 08:36:12,516] INFO: common : 55] Created directory: artifacts/data_cleaning
[2024-11-11 08:36:12,731] INFO: common : 79] Successfully loaded DataFrame from: artifacts\data_preprocessing\preprocessed_data.csv
[2024-11-11 08:36:12,731] INFO: data_cleaning : 30] Initiating train test split...
[2024-11-11 08:36:12,760] INFO: data_cleaning : 32] Train test split completed successfully.
[2024-11-11 08:36:12,760] INFO: data_cleaning : 74] Train_df :Index(['cust_id', 'age', 'gender', 'marital_status', 'employment_status',
       'income', 'number_of_dependants', 'residence_type',
       'years_at_current_address', 'city', 'state', 'zipcode', 'loan_id',
       'loan_purpose', 'loan_type', 'sanction_amount', 'loan_amount',
       'processing_fee', 'gst', 'net_disbursement', 'loan_tenure_months',
       'principal_outstanding', 'bank_balance_at_application',
       'disbursal_date', 'installment_start_dt', 'default',
       'number_of_open_accounts', 'number_of_closed_accounts',
       'total_loan_months', 'delinquent_months', 'total_dpd', 'enquiry_count',
       'credit_utilization_ratio'],
      dtype='object')
[2024-11-11 08:36:12,776] INFO: data_cleaning : 79]  After outlier removal train_df :(40000, 33)
[2024-11-11 08:36:12,776] INFO: data_cleaning : 80]  After outlier removal test_df :(10000, 33)
[2024-11-11 08:36:12,782] INFO: data_cleaning : 85] Rule 1: GST should not be more than 20% :(0, 33)
[2024-11-11 08:36:12,783] INFO: data_cleaning : 89] Rule 2: Net disbursement should not be higher than loan_amount :(0, 33)
[2024-11-11 08:36:12,794] INFO: data_cleaning : 94] Rule 3 : Fixed loan_purpose column :loan_purpose
Personal     14037
Home         12006
Auto          7950
Education     6007
Name: count, dtype: int64
[2024-11-11 08:36:12,794] INFO: data_cleaning : 99] Rule 4 : Generated loan_to_income column(LTI)
[2024-11-11 08:36:12,804] INFO: data_cleaning : 104] Generated delinquency_ratio column :count    40000.000000
mean        10.424123
std         17.283345
min          0.000000
25%          0.000000
50%          3.800000
75%         13.200000
max        100.000000
Name: delinquency_ratio, dtype: float64
[2024-11-11 08:36:12,810] INFO: data_cleaning : 118] Generated avg_dpd_per_delinquency column :count    40000.000000
mean         3.303845
std          2.902944
min          0.000000
25%          0.000000
50%          4.300000
75%          5.800000
max         10.000000
Name: avg_dpd_per_delinquency, dtype: float64
[2024-11-11 08:36:12,810] INFO: data_cleaning : 40] Removing columns...
[2024-11-11 08:36:12,813] ERROR: main : 41] An unexpected error occurred: 'DataCleaning' object has no attribute 'params'
[2024-11-11 08:39:57,344] INFO: __init__ : 26] Credit Risk Model Building Started
[2024-11-11 08:39:59,778] INFO: main : 12] >>>>>>>>>>>Starting Data Ingestion Stage<<<<<<<<<<<<<
[2024-11-11 08:39:59,778] INFO: common : 32] Successfully loaded yaml file: config\config.yaml
[2024-11-11 08:39:59,778] INFO: common : 32] Successfully loaded yaml file: params.yaml
[2024-11-11 08:39:59,786] INFO: common : 32] Successfully loaded yaml file: schema.yaml
[2024-11-11 08:39:59,787] INFO: common : 55] Created directory: artifacts
[2024-11-11 08:39:59,788] INFO: common : 55] Created directory: artifacts/data_ingestion
[2024-11-11 08:39:59,789] INFO: data_ingestion : 17] Loading customers data...
[2024-11-11 08:39:59,889] INFO: common : 79] Successfully loaded DataFrame from: data\customers.csv
[2024-11-11 08:39:59,889] INFO: data_ingestion : 20] Loading loans data...
[2024-11-11 08:40:00,053] INFO: common : 79] Successfully loaded DataFrame from: data\loans.csv
[2024-11-11 08:40:00,053] INFO: data_ingestion : 23] Loading bureau data...
[2024-11-11 08:40:00,105] INFO: common : 79] Successfully loaded DataFrame from: data\bureau_data.csv
[2024-11-11 08:40:00,105] INFO: data_ingestion : 26] The Shape of customers data: (50000, 12)
[2024-11-11 08:40:00,105] INFO: data_ingestion : 27] The Shape of loans data: (50000, 15)
[2024-11-11 08:40:00,105] INFO: data_ingestion : 28] The Shape of bureau data: (50000, 8)
[2024-11-11 08:40:00,753] INFO: common : 97] Successfully saved DataFrame to: artifacts\data_ingestion\data.csv
[2024-11-11 08:40:00,770] INFO: main : 14] >>>>>>>>>>>Completed Data Ingestion Stage<<<<<<<<<<<<<
[2024-11-11 08:40:00,771] INFO: main : 24] >>>>>>>>>>>Starting Data Pre-Processing Stage<<<<<<<<<<<<<
[2024-11-11 08:40:00,774] INFO: common : 32] Successfully loaded yaml file: config\config.yaml
[2024-11-11 08:40:00,776] INFO: common : 32] Successfully loaded yaml file: params.yaml
[2024-11-11 08:40:00,779] INFO: common : 32] Successfully loaded yaml file: schema.yaml
[2024-11-11 08:40:00,780] INFO: common : 55] Created directory: artifacts
[2024-11-11 08:40:00,781] INFO: common : 55] Created directory: artifacts/data_preprocessing
[2024-11-11 08:40:01,019] INFO: common : 79] Successfully loaded DataFrame from: artifacts\data_ingestion\data.csv
[2024-11-11 08:40:01,035] INFO: data_preprocessing : 26] The Valure counts for 'default' column: default
0    45703
1     4297
Name: count, dtype: int64
[2024-11-11 08:40:01,035] INFO: data_preprocessing : 42] No missing values found in column 'cust_id'
[2024-11-11 08:40:01,035] INFO: data_preprocessing : 42] No missing values found in column 'age'
[2024-11-11 08:40:01,048] INFO: data_preprocessing : 42] No missing values found in column 'gender'
[2024-11-11 08:40:01,051] INFO: data_preprocessing : 42] No missing values found in column 'marital_status'
[2024-11-11 08:40:01,055] INFO: data_preprocessing : 42] No missing values found in column 'employment_status'
[2024-11-11 08:40:01,056] INFO: data_preprocessing : 42] No missing values found in column 'income'
[2024-11-11 08:40:01,057] INFO: data_preprocessing : 42] No missing values found in column 'number_of_dependants'
[2024-11-11 08:40:01,059] WARNING: data_preprocessing : 33] Missing values found in column 'residence_type', replacing with 'Unknown'
[2024-11-11 08:40:01,072] INFO: data_preprocessing : 35] Missing values replaced in column 'residence_type' with mode 'Owned'
[2024-11-11 08:40:01,072] INFO: data_preprocessing : 42] No missing values found in column 'years_at_current_address'
[2024-11-11 08:40:01,078] INFO: data_preprocessing : 42] No missing values found in column 'city'
[2024-11-11 08:40:01,082] INFO: data_preprocessing : 42] No missing values found in column 'state'
[2024-11-11 08:40:01,084] INFO: data_preprocessing : 42] No missing values found in column 'zipcode'
[2024-11-11 08:40:01,088] INFO: data_preprocessing : 42] No missing values found in column 'loan_id'
[2024-11-11 08:40:01,089] INFO: data_preprocessing : 42] No missing values found in column 'loan_purpose'
[2024-11-11 08:40:01,094] INFO: data_preprocessing : 42] No missing values found in column 'loan_type'
[2024-11-11 08:40:01,096] INFO: data_preprocessing : 42] No missing values found in column 'sanction_amount'
[2024-11-11 08:40:01,097] INFO: data_preprocessing : 42] No missing values found in column 'loan_amount'
[2024-11-11 08:40:01,098] INFO: data_preprocessing : 42] No missing values found in column 'processing_fee'
[2024-11-11 08:40:01,099] INFO: data_preprocessing : 42] No missing values found in column 'gst'
[2024-11-11 08:40:01,099] INFO: data_preprocessing : 42] No missing values found in column 'net_disbursement'
[2024-11-11 08:40:01,099] INFO: data_preprocessing : 42] No missing values found in column 'loan_tenure_months'
[2024-11-11 08:40:01,099] INFO: data_preprocessing : 42] No missing values found in column 'principal_outstanding'
[2024-11-11 08:40:01,103] INFO: data_preprocessing : 42] No missing values found in column 'bank_balance_at_application'
[2024-11-11 08:40:01,107] INFO: data_preprocessing : 42] No missing values found in column 'disbursal_date'
[2024-11-11 08:40:01,111] INFO: data_preprocessing : 42] No missing values found in column 'installment_start_dt'
[2024-11-11 08:40:01,112] INFO: data_preprocessing : 42] No missing values found in column 'default'
[2024-11-11 08:40:01,114] INFO: data_preprocessing : 42] No missing values found in column 'number_of_open_accounts'
[2024-11-11 08:40:01,115] INFO: data_preprocessing : 42] No missing values found in column 'number_of_closed_accounts'
[2024-11-11 08:40:01,116] INFO: data_preprocessing : 42] No missing values found in column 'total_loan_months'
[2024-11-11 08:40:01,117] INFO: data_preprocessing : 42] No missing values found in column 'delinquent_months'
[2024-11-11 08:40:01,118] INFO: data_preprocessing : 42] No missing values found in column 'total_dpd'
[2024-11-11 08:40:01,120] INFO: data_preprocessing : 42] No missing values found in column 'enquiry_count'
[2024-11-11 08:40:01,121] INFO: data_preprocessing : 42] No missing values found in column 'credit_utilization_ratio'
[2024-11-11 08:40:01,205] INFO: data_preprocessing : 51] No duplicate rows found
[2024-11-11 08:40:01,206] INFO: data_preprocessing : 53] Index(['cust_id', 'age', 'gender', 'marital_status', 'employment_status',
       'income', 'number_of_dependants', 'residence_type',
       'years_at_current_address', 'city', 'state', 'zipcode', 'loan_id',
       'loan_purpose', 'loan_type', 'sanction_amount', 'loan_amount',
       'processing_fee', 'gst', 'net_disbursement', 'loan_tenure_months',
       'principal_outstanding', 'bank_balance_at_application',
       'disbursal_date', 'installment_start_dt', 'default',
       'number_of_open_accounts', 'number_of_closed_accounts',
       'total_loan_months', 'delinquent_months', 'total_dpd', 'enquiry_count',
       'credit_utilization_ratio'],
      dtype='object')
[2024-11-11 08:40:01,755] INFO: common : 97] Successfully saved DataFrame to: artifacts\data_preprocessing\preprocessed_data.csv
[2024-11-11 08:40:01,774] INFO: main : 26] >>>>>>>>>>>Completed Data Pre-Processing Stage<<<<<<<<<<<<<
[2024-11-11 08:40:01,774] INFO: main : 36] >>>>>>>>>>>Starting Data Cleaning Stage<<<<<<<<<<<<<
[2024-11-11 08:40:01,777] INFO: common : 32] Successfully loaded yaml file: config\config.yaml
[2024-11-11 08:40:01,779] INFO: common : 32] Successfully loaded yaml file: params.yaml
[2024-11-11 08:40:01,782] INFO: common : 32] Successfully loaded yaml file: schema.yaml
[2024-11-11 08:40:01,783] INFO: common : 55] Created directory: artifacts
[2024-11-11 08:40:01,784] INFO: common : 55] Created directory: artifacts/data_cleaning
[2024-11-11 08:40:02,037] INFO: common : 79] Successfully loaded DataFrame from: artifacts\data_preprocessing\preprocessed_data.csv
[2024-11-11 08:40:02,037] INFO: data_cleaning : 31] Initiating train test split...
[2024-11-11 08:40:02,057] INFO: data_cleaning : 33] Train test split completed successfully.
[2024-11-11 08:40:02,057] INFO: data_cleaning : 74] Train_df :Index(['cust_id', 'age', 'gender', 'marital_status', 'employment_status',
       'income', 'number_of_dependants', 'residence_type',
       'years_at_current_address', 'city', 'state', 'zipcode', 'loan_id',
       'loan_purpose', 'loan_type', 'sanction_amount', 'loan_amount',
       'processing_fee', 'gst', 'net_disbursement', 'loan_tenure_months',
       'principal_outstanding', 'bank_balance_at_application',
       'disbursal_date', 'installment_start_dt', 'default',
       'number_of_open_accounts', 'number_of_closed_accounts',
       'total_loan_months', 'delinquent_months', 'total_dpd', 'enquiry_count',
       'credit_utilization_ratio'],
      dtype='object')
[2024-11-11 08:40:02,078] INFO: data_cleaning : 79]  After outlier removal train_df :(40000, 33)
[2024-11-11 08:40:02,078] INFO: data_cleaning : 80]  After outlier removal test_df :(10000, 33)
[2024-11-11 08:40:02,082] INFO: data_cleaning : 85] Rule 1: GST should not be more than 20% :(0, 33)
[2024-11-11 08:40:02,084] INFO: data_cleaning : 89] Rule 2: Net disbursement should not be higher than loan_amount :(0, 33)
[2024-11-11 08:40:02,094] INFO: data_cleaning : 94] Rule 3 : Fixed loan_purpose column :loan_purpose
Personal     14037
Home         12006
Auto          7950
Education     6007
Name: count, dtype: int64
[2024-11-11 08:40:02,102] INFO: data_cleaning : 99] Rule 4 : Generated loan_to_income column(LTI)
[2024-11-11 08:40:02,112] INFO: data_cleaning : 104] Generated delinquency_ratio column :count    40000.000000
mean        10.424123
std         17.283345
min          0.000000
25%          0.000000
50%          3.800000
75%         13.200000
max        100.000000
Name: delinquency_ratio, dtype: float64
[2024-11-11 08:40:02,120] INFO: data_cleaning : 118] Generated avg_dpd_per_delinquency column :count    40000.000000
mean         3.303845
std          2.902944
min          0.000000
25%          0.000000
50%          4.300000
75%          5.800000
max         10.000000
Name: avg_dpd_per_delinquency, dtype: float64
[2024-11-11 08:40:02,122] INFO: data_cleaning : 41] Removing columns...
[2024-11-11 08:40:02,122] ERROR: main : 41] An unexpected error occurred: 'DataCleaning' object has no attribute 'params'
[2024-11-11 08:40:33,536] INFO: __init__ : 26] Credit Risk Model Building Started
[2024-11-11 08:40:35,604] INFO: main : 12] >>>>>>>>>>>Starting Data Ingestion Stage<<<<<<<<<<<<<
[2024-11-11 08:40:35,604] INFO: common : 32] Successfully loaded yaml file: config\config.yaml
[2024-11-11 08:40:35,604] INFO: common : 32] Successfully loaded yaml file: params.yaml
[2024-11-11 08:40:35,604] INFO: common : 32] Successfully loaded yaml file: schema.yaml
[2024-11-11 08:40:35,604] INFO: common : 55] Created directory: artifacts
[2024-11-11 08:40:35,615] INFO: common : 55] Created directory: artifacts/data_ingestion
[2024-11-11 08:40:35,615] INFO: data_ingestion : 17] Loading customers data...
[2024-11-11 08:40:35,717] INFO: common : 79] Successfully loaded DataFrame from: data\customers.csv
[2024-11-11 08:40:35,718] INFO: data_ingestion : 20] Loading loans data...
[2024-11-11 08:40:35,869] INFO: common : 79] Successfully loaded DataFrame from: data\loans.csv
[2024-11-11 08:40:35,869] INFO: data_ingestion : 23] Loading bureau data...
[2024-11-11 08:40:35,921] INFO: common : 79] Successfully loaded DataFrame from: data\bureau_data.csv
[2024-11-11 08:40:35,922] INFO: data_ingestion : 26] The Shape of customers data: (50000, 12)
[2024-11-11 08:40:35,923] INFO: data_ingestion : 27] The Shape of loans data: (50000, 15)
[2024-11-11 08:40:35,923] INFO: data_ingestion : 28] The Shape of bureau data: (50000, 8)
[2024-11-11 08:40:35,977] ERROR: common : 100] Error saving DataFrame to: artifacts\data_ingestion\data.csv - [Errno 22] Invalid argument: 'artifacts\\data_ingestion\\data.csv'
[2024-11-11 08:40:35,977] ERROR: data_ingestion_pipeline : 22] Error occurred during data ingestion: Error occurred in python script name [C:\Users\ambig\jupiter_notebook\Projects\Credit-Risk-Model\src\Credit_Risk_Model\utils\common.py] line number [95] error message[[Errno 22] Invalid argument: 'artifacts\\data_ingestion\\data.csv']
[2024-11-11 08:40:35,991] INFO: main : 14] >>>>>>>>>>>Completed Data Ingestion Stage<<<<<<<<<<<<<
[2024-11-11 08:40:35,991] INFO: main : 24] >>>>>>>>>>>Starting Data Pre-Processing Stage<<<<<<<<<<<<<
[2024-11-11 08:40:35,994] INFO: common : 32] Successfully loaded yaml file: config\config.yaml
[2024-11-11 08:40:35,997] INFO: common : 32] Successfully loaded yaml file: params.yaml
[2024-11-11 08:40:36,000] INFO: common : 32] Successfully loaded yaml file: schema.yaml
[2024-11-11 08:40:36,001] INFO: common : 55] Created directory: artifacts
[2024-11-11 08:40:36,002] INFO: common : 55] Created directory: artifacts/data_preprocessing
[2024-11-11 08:40:36,252] INFO: common : 79] Successfully loaded DataFrame from: artifacts\data_ingestion\data.csv
[2024-11-11 08:40:36,252] INFO: data_preprocessing : 26] The Valure counts for 'default' column: default
0    45703
1     4297
Name: count, dtype: int64
[2024-11-11 08:40:36,266] INFO: data_preprocessing : 42] No missing values found in column 'cust_id'
[2024-11-11 08:40:36,266] INFO: data_preprocessing : 42] No missing values found in column 'age'
[2024-11-11 08:40:36,273] INFO: data_preprocessing : 42] No missing values found in column 'gender'
[2024-11-11 08:40:36,275] INFO: data_preprocessing : 42] No missing values found in column 'marital_status'
[2024-11-11 08:40:36,280] INFO: data_preprocessing : 42] No missing values found in column 'employment_status'
[2024-11-11 08:40:36,281] INFO: data_preprocessing : 42] No missing values found in column 'income'
[2024-11-11 08:40:36,282] INFO: data_preprocessing : 42] No missing values found in column 'number_of_dependants'
[2024-11-11 08:40:36,284] WARNING: data_preprocessing : 33] Missing values found in column 'residence_type', replacing with 'Unknown'
[2024-11-11 08:40:36,293] INFO: data_preprocessing : 35] Missing values replaced in column 'residence_type' with mode 'Owned'
[2024-11-11 08:40:36,293] INFO: data_preprocessing : 42] No missing values found in column 'years_at_current_address'
[2024-11-11 08:40:36,303] INFO: data_preprocessing : 42] No missing values found in column 'city'
[2024-11-11 08:40:36,307] INFO: data_preprocessing : 42] No missing values found in column 'state'
[2024-11-11 08:40:36,309] INFO: data_preprocessing : 42] No missing values found in column 'zipcode'
[2024-11-11 08:40:36,312] INFO: data_preprocessing : 42] No missing values found in column 'loan_id'
[2024-11-11 08:40:36,314] INFO: data_preprocessing : 42] No missing values found in column 'loan_purpose'
[2024-11-11 08:40:36,319] INFO: data_preprocessing : 42] No missing values found in column 'loan_type'
[2024-11-11 08:40:36,321] INFO: data_preprocessing : 42] No missing values found in column 'sanction_amount'
[2024-11-11 08:40:36,322] INFO: data_preprocessing : 42] No missing values found in column 'loan_amount'
[2024-11-11 08:40:36,323] INFO: data_preprocessing : 42] No missing values found in column 'processing_fee'
[2024-11-11 08:40:36,324] INFO: data_preprocessing : 42] No missing values found in column 'gst'
[2024-11-11 08:40:36,324] INFO: data_preprocessing : 42] No missing values found in column 'net_disbursement'
[2024-11-11 08:40:36,327] INFO: data_preprocessing : 42] No missing values found in column 'loan_tenure_months'
[2024-11-11 08:40:36,328] INFO: data_preprocessing : 42] No missing values found in column 'principal_outstanding'
[2024-11-11 08:40:36,329] INFO: data_preprocessing : 42] No missing values found in column 'bank_balance_at_application'
[2024-11-11 08:40:36,332] INFO: data_preprocessing : 42] No missing values found in column 'disbursal_date'
[2024-11-11 08:40:36,336] INFO: data_preprocessing : 42] No missing values found in column 'installment_start_dt'
[2024-11-11 08:40:36,337] INFO: data_preprocessing : 42] No missing values found in column 'default'
[2024-11-11 08:40:36,338] INFO: data_preprocessing : 42] No missing values found in column 'number_of_open_accounts'
[2024-11-11 08:40:36,339] INFO: data_preprocessing : 42] No missing values found in column 'number_of_closed_accounts'
[2024-11-11 08:40:36,340] INFO: data_preprocessing : 42] No missing values found in column 'total_loan_months'
[2024-11-11 08:40:36,341] INFO: data_preprocessing : 42] No missing values found in column 'delinquent_months'
[2024-11-11 08:40:36,342] INFO: data_preprocessing : 42] No missing values found in column 'total_dpd'
[2024-11-11 08:40:36,343] INFO: data_preprocessing : 42] No missing values found in column 'enquiry_count'
[2024-11-11 08:40:36,344] INFO: data_preprocessing : 42] No missing values found in column 'credit_utilization_ratio'
[2024-11-11 08:40:36,424] INFO: data_preprocessing : 51] No duplicate rows found
[2024-11-11 08:40:36,425] INFO: data_preprocessing : 53] Index(['cust_id', 'age', 'gender', 'marital_status', 'employment_status',
       'income', 'number_of_dependants', 'residence_type',
       'years_at_current_address', 'city', 'state', 'zipcode', 'loan_id',
       'loan_purpose', 'loan_type', 'sanction_amount', 'loan_amount',
       'processing_fee', 'gst', 'net_disbursement', 'loan_tenure_months',
       'principal_outstanding', 'bank_balance_at_application',
       'disbursal_date', 'installment_start_dt', 'default',
       'number_of_open_accounts', 'number_of_closed_accounts',
       'total_loan_months', 'delinquent_months', 'total_dpd', 'enquiry_count',
       'credit_utilization_ratio'],
      dtype='object')
[2024-11-11 08:40:36,979] INFO: common : 97] Successfully saved DataFrame to: artifacts\data_preprocessing\preprocessed_data.csv
[2024-11-11 08:40:36,979] INFO: main : 26] >>>>>>>>>>>Completed Data Pre-Processing Stage<<<<<<<<<<<<<
[2024-11-11 08:40:36,979] INFO: main : 36] >>>>>>>>>>>Starting Data Cleaning Stage<<<<<<<<<<<<<
[2024-11-11 08:40:36,997] INFO: common : 32] Successfully loaded yaml file: config\config.yaml
[2024-11-11 08:40:36,999] INFO: common : 32] Successfully loaded yaml file: params.yaml
[2024-11-11 08:40:37,003] INFO: common : 32] Successfully loaded yaml file: schema.yaml
[2024-11-11 08:40:37,004] INFO: common : 55] Created directory: artifacts
[2024-11-11 08:40:37,004] INFO: common : 55] Created directory: artifacts/data_cleaning
[2024-11-11 08:40:37,230] INFO: common : 79] Successfully loaded DataFrame from: artifacts\data_preprocessing\preprocessed_data.csv
[2024-11-11 08:40:37,246] INFO: data_cleaning : 31] Initiating train test split...
[2024-11-11 08:40:37,267] INFO: data_cleaning : 33] Train test split completed successfully.
[2024-11-11 08:40:37,268] INFO: data_cleaning : 74] Train_df :Index(['cust_id', 'age', 'gender', 'marital_status', 'employment_status',
       'income', 'number_of_dependants', 'residence_type',
       'years_at_current_address', 'city', 'state', 'zipcode', 'loan_id',
       'loan_purpose', 'loan_type', 'sanction_amount', 'loan_amount',
       'processing_fee', 'gst', 'net_disbursement', 'loan_tenure_months',
       'principal_outstanding', 'bank_balance_at_application',
       'disbursal_date', 'installment_start_dt', 'default',
       'number_of_open_accounts', 'number_of_closed_accounts',
       'total_loan_months', 'delinquent_months', 'total_dpd', 'enquiry_count',
       'credit_utilization_ratio'],
      dtype='object')
[2024-11-11 08:40:37,276] INFO: data_cleaning : 79]  After outlier removal train_df :(40000, 33)
[2024-11-11 08:40:37,286] INFO: data_cleaning : 80]  After outlier removal test_df :(10000, 33)
[2024-11-11 08:40:37,289] INFO: data_cleaning : 85] Rule 1: GST should not be more than 20% :(0, 33)
[2024-11-11 08:40:37,290] INFO: data_cleaning : 89] Rule 2: Net disbursement should not be higher than loan_amount :(0, 33)
[2024-11-11 08:40:37,294] INFO: data_cleaning : 94] Rule 3 : Fixed loan_purpose column :loan_purpose
Personal     14037
Home         12006
Auto          7950
Education     6007
Name: count, dtype: int64
[2024-11-11 08:40:37,303] INFO: data_cleaning : 99] Rule 4 : Generated loan_to_income column(LTI)
[2024-11-11 08:40:37,310] INFO: data_cleaning : 104] Generated delinquency_ratio column :count    40000.000000
mean        10.424123
std         17.283345
min          0.000000
25%          0.000000
50%          3.800000
75%         13.200000
max        100.000000
Name: delinquency_ratio, dtype: float64
[2024-11-11 08:40:37,317] INFO: data_cleaning : 118] Generated avg_dpd_per_delinquency column :count    40000.000000
mean         3.303845
std          2.902944
min          0.000000
25%          0.000000
50%          4.300000
75%          5.800000
max         10.000000
Name: avg_dpd_per_delinquency, dtype: float64
[2024-11-11 08:40:37,321] INFO: data_cleaning : 41] Removing columns...
[2024-11-11 08:40:37,327] INFO: data_cleaning : 43] Columns removed successfully.
[2024-11-11 08:40:37,331] INFO: data_cleaning : 41] Removing columns...
[2024-11-11 08:40:37,333] INFO: data_cleaning : 43] Columns removed successfully.
[2024-11-11 08:40:37,342] ERROR: main : 41] An unexpected error occurred: 'loan_status'
[2024-11-11 08:42:55,911] INFO: __init__ : 26] Credit Risk Model Building Started
[2024-11-11 08:42:58,321] INFO: main : 12] >>>>>>>>>>>Starting Data Ingestion Stage<<<<<<<<<<<<<
[2024-11-11 08:42:58,340] INFO: common : 32] Successfully loaded yaml file: config\config.yaml
[2024-11-11 08:42:58,342] INFO: common : 32] Successfully loaded yaml file: params.yaml
[2024-11-11 08:42:58,345] INFO: common : 32] Successfully loaded yaml file: schema.yaml
[2024-11-11 08:42:58,346] INFO: common : 55] Created directory: artifacts
[2024-11-11 08:42:58,347] INFO: common : 55] Created directory: artifacts/data_ingestion
[2024-11-11 08:42:58,347] INFO: data_ingestion : 17] Loading customers data...
[2024-11-11 08:42:58,457] INFO: common : 79] Successfully loaded DataFrame from: data\customers.csv
[2024-11-11 08:42:58,457] INFO: data_ingestion : 20] Loading loans data...
[2024-11-11 08:42:58,608] INFO: common : 79] Successfully loaded DataFrame from: data\loans.csv
[2024-11-11 08:42:58,608] INFO: data_ingestion : 23] Loading bureau data...
[2024-11-11 08:42:58,656] INFO: common : 79] Successfully loaded DataFrame from: data\bureau_data.csv
[2024-11-11 08:42:58,656] INFO: data_ingestion : 26] The Shape of customers data: (50000, 12)
[2024-11-11 08:42:58,656] INFO: data_ingestion : 27] The Shape of loans data: (50000, 15)
[2024-11-11 08:42:58,656] INFO: data_ingestion : 28] The Shape of bureau data: (50000, 8)
[2024-11-11 08:42:59,313] INFO: common : 97] Successfully saved DataFrame to: artifacts\data_ingestion\data.csv
[2024-11-11 08:42:59,322] INFO: main : 14] >>>>>>>>>>>Completed Data Ingestion Stage<<<<<<<<<<<<<
[2024-11-11 08:42:59,322] INFO: main : 24] >>>>>>>>>>>Starting Data Pre-Processing Stage<<<<<<<<<<<<<
[2024-11-11 08:42:59,327] INFO: common : 32] Successfully loaded yaml file: config\config.yaml
[2024-11-11 08:42:59,327] INFO: common : 32] Successfully loaded yaml file: params.yaml
[2024-11-11 08:42:59,332] INFO: common : 32] Successfully loaded yaml file: schema.yaml
[2024-11-11 08:42:59,333] INFO: common : 55] Created directory: artifacts
[2024-11-11 08:42:59,334] INFO: common : 55] Created directory: artifacts/data_preprocessing
[2024-11-11 08:42:59,577] INFO: common : 79] Successfully loaded DataFrame from: artifacts\data_ingestion\data.csv
[2024-11-11 08:42:59,580] INFO: data_preprocessing : 26] The Valure counts for 'default' column: default
0    45703
1     4297
Name: count, dtype: int64
[2024-11-11 08:42:59,585] INFO: data_preprocessing : 42] No missing values found in column 'cust_id'
[2024-11-11 08:42:59,586] INFO: data_preprocessing : 42] No missing values found in column 'age'
[2024-11-11 08:42:59,589] INFO: data_preprocessing : 42] No missing values found in column 'gender'
[2024-11-11 08:42:59,593] INFO: data_preprocessing : 42] No missing values found in column 'marital_status'
[2024-11-11 08:42:59,596] INFO: data_preprocessing : 42] No missing values found in column 'employment_status'
[2024-11-11 08:42:59,597] INFO: data_preprocessing : 42] No missing values found in column 'income'
[2024-11-11 08:42:59,598] INFO: data_preprocessing : 42] No missing values found in column 'number_of_dependants'
[2024-11-11 08:42:59,601] WARNING: data_preprocessing : 33] Missing values found in column 'residence_type', replacing with 'Unknown'
[2024-11-11 08:42:59,611] INFO: data_preprocessing : 35] Missing values replaced in column 'residence_type' with mode 'Owned'
[2024-11-11 08:42:59,611] INFO: data_preprocessing : 42] No missing values found in column 'years_at_current_address'
[2024-11-11 08:42:59,620] INFO: data_preprocessing : 42] No missing values found in column 'city'
[2024-11-11 08:42:59,627] INFO: data_preprocessing : 42] No missing values found in column 'state'
[2024-11-11 08:42:59,628] INFO: data_preprocessing : 42] No missing values found in column 'zipcode'
[2024-11-11 08:42:59,631] INFO: data_preprocessing : 42] No missing values found in column 'loan_id'
[2024-11-11 08:42:59,635] INFO: data_preprocessing : 42] No missing values found in column 'loan_purpose'
[2024-11-11 08:42:59,639] INFO: data_preprocessing : 42] No missing values found in column 'loan_type'
[2024-11-11 08:42:59,639] INFO: data_preprocessing : 42] No missing values found in column 'sanction_amount'
[2024-11-11 08:42:59,640] INFO: data_preprocessing : 42] No missing values found in column 'loan_amount'
[2024-11-11 08:42:59,641] INFO: data_preprocessing : 42] No missing values found in column 'processing_fee'
[2024-11-11 08:42:59,643] INFO: data_preprocessing : 42] No missing values found in column 'gst'
[2024-11-11 08:42:59,644] INFO: data_preprocessing : 42] No missing values found in column 'net_disbursement'
[2024-11-11 08:42:59,645] INFO: data_preprocessing : 42] No missing values found in column 'loan_tenure_months'
[2024-11-11 08:42:59,646] INFO: data_preprocessing : 42] No missing values found in column 'principal_outstanding'
[2024-11-11 08:42:59,647] INFO: data_preprocessing : 42] No missing values found in column 'bank_balance_at_application'
[2024-11-11 08:42:59,650] INFO: data_preprocessing : 42] No missing values found in column 'disbursal_date'
[2024-11-11 08:42:59,653] INFO: data_preprocessing : 42] No missing values found in column 'installment_start_dt'
[2024-11-11 08:42:59,655] INFO: data_preprocessing : 42] No missing values found in column 'default'
[2024-11-11 08:42:59,656] INFO: data_preprocessing : 42] No missing values found in column 'number_of_open_accounts'
[2024-11-11 08:42:59,657] INFO: data_preprocessing : 42] No missing values found in column 'number_of_closed_accounts'
[2024-11-11 08:42:59,658] INFO: data_preprocessing : 42] No missing values found in column 'total_loan_months'
[2024-11-11 08:42:59,658] INFO: data_preprocessing : 42] No missing values found in column 'delinquent_months'
[2024-11-11 08:42:59,658] INFO: data_preprocessing : 42] No missing values found in column 'total_dpd'
[2024-11-11 08:42:59,661] INFO: data_preprocessing : 42] No missing values found in column 'enquiry_count'
[2024-11-11 08:42:59,663] INFO: data_preprocessing : 42] No missing values found in column 'credit_utilization_ratio'
[2024-11-11 08:42:59,721] INFO: data_preprocessing : 51] No duplicate rows found
[2024-11-11 08:42:59,736] INFO: data_preprocessing : 53] Index(['cust_id', 'age', 'gender', 'marital_status', 'employment_status',
       'income', 'number_of_dependants', 'residence_type',
       'years_at_current_address', 'city', 'state', 'zipcode', 'loan_id',
       'loan_purpose', 'loan_type', 'sanction_amount', 'loan_amount',
       'processing_fee', 'gst', 'net_disbursement', 'loan_tenure_months',
       'principal_outstanding', 'bank_balance_at_application',
       'disbursal_date', 'installment_start_dt', 'default',
       'number_of_open_accounts', 'number_of_closed_accounts',
       'total_loan_months', 'delinquent_months', 'total_dpd', 'enquiry_count',
       'credit_utilization_ratio'],
      dtype='object')
[2024-11-11 08:43:00,236] INFO: common : 97] Successfully saved DataFrame to: artifacts\data_preprocessing\preprocessed_data.csv
[2024-11-11 08:43:00,243] INFO: main : 26] >>>>>>>>>>>Completed Data Pre-Processing Stage<<<<<<<<<<<<<
[2024-11-11 08:43:00,243] INFO: main : 36] >>>>>>>>>>>Starting Data Cleaning Stage<<<<<<<<<<<<<
[2024-11-11 08:43:00,243] INFO: common : 32] Successfully loaded yaml file: config\config.yaml
[2024-11-11 08:43:00,251] INFO: common : 32] Successfully loaded yaml file: params.yaml
[2024-11-11 08:43:00,254] INFO: common : 32] Successfully loaded yaml file: schema.yaml
[2024-11-11 08:43:00,255] INFO: common : 55] Created directory: artifacts
[2024-11-11 08:43:00,255] INFO: common : 55] Created directory: artifacts/data_cleaning
[2024-11-11 08:43:00,469] INFO: common : 79] Successfully loaded DataFrame from: artifacts\data_preprocessing\preprocessed_data.csv
[2024-11-11 08:43:00,469] INFO: data_cleaning : 31] Initiating train test split...
[2024-11-11 08:43:00,490] INFO: data_cleaning : 33] Train test split completed successfully.
[2024-11-11 08:43:00,491] INFO: data_cleaning : 74] Train_df :Index(['cust_id', 'age', 'gender', 'marital_status', 'employment_status',
       'income', 'number_of_dependants', 'residence_type',
       'years_at_current_address', 'city', 'state', 'zipcode', 'loan_id',
       'loan_purpose', 'loan_type', 'sanction_amount', 'loan_amount',
       'processing_fee', 'gst', 'net_disbursement', 'loan_tenure_months',
       'principal_outstanding', 'bank_balance_at_application',
       'disbursal_date', 'installment_start_dt', 'default',
       'number_of_open_accounts', 'number_of_closed_accounts',
       'total_loan_months', 'delinquent_months', 'total_dpd', 'enquiry_count',
       'credit_utilization_ratio'],
      dtype='object')
[2024-11-11 08:43:00,498] INFO: data_cleaning : 79]  After outlier removal train_df :(40000, 33)
[2024-11-11 08:43:00,498] INFO: data_cleaning : 80]  After outlier removal test_df :(10000, 33)
[2024-11-11 08:43:00,512] INFO: data_cleaning : 85] Rule 1: GST should not be more than 20% :(0, 33)
[2024-11-11 08:43:00,513] INFO: data_cleaning : 89] Rule 2: Net disbursement should not be higher than loan_amount :(0, 33)
[2024-11-11 08:43:00,522] INFO: data_cleaning : 94] Rule 3 : Fixed loan_purpose column :loan_purpose
Personal     14037
Home         12006
Auto          7950
Education     6007
Name: count, dtype: int64
[2024-11-11 08:43:00,525] INFO: data_cleaning : 99] Rule 4 : Generated loan_to_income column(LTI)
[2024-11-11 08:43:00,527] INFO: data_cleaning : 104] Generated delinquency_ratio column :count    40000.000000
mean        10.424123
std         17.283345
min          0.000000
25%          0.000000
50%          3.800000
75%         13.200000
max        100.000000
Name: delinquency_ratio, dtype: float64
[2024-11-11 08:43:00,539] INFO: data_cleaning : 118] Generated avg_dpd_per_delinquency column :count    40000.000000
mean         3.303845
std          2.902944
min          0.000000
25%          0.000000
50%          4.300000
75%          5.800000
max         10.000000
Name: avg_dpd_per_delinquency, dtype: float64
[2024-11-11 08:43:00,541] ERROR: main : 41] An unexpected error occurred: 'loan_status'
[2024-11-11 08:44:12,102] INFO: __init__ : 26] Credit Risk Model Building Started
[2024-11-11 08:44:14,093] INFO: main : 12] >>>>>>>>>>>Starting Data Ingestion Stage<<<<<<<<<<<<<
[2024-11-11 08:44:14,102] INFO: common : 32] Successfully loaded yaml file: config\config.yaml
[2024-11-11 08:44:14,104] INFO: common : 32] Successfully loaded yaml file: params.yaml
[2024-11-11 08:44:14,107] INFO: common : 32] Successfully loaded yaml file: schema.yaml
[2024-11-11 08:44:14,108] INFO: common : 55] Created directory: artifacts
[2024-11-11 08:44:14,109] INFO: common : 55] Created directory: artifacts/data_ingestion
[2024-11-11 08:44:14,109] INFO: data_ingestion : 17] Loading customers data...
[2024-11-11 08:44:14,198] INFO: common : 79] Successfully loaded DataFrame from: data\customers.csv
[2024-11-11 08:44:14,198] INFO: data_ingestion : 20] Loading loans data...
[2024-11-11 08:44:14,315] INFO: common : 79] Successfully loaded DataFrame from: data\loans.csv
[2024-11-11 08:44:14,315] INFO: data_ingestion : 23] Loading bureau data...
[2024-11-11 08:44:14,346] INFO: common : 79] Successfully loaded DataFrame from: data\bureau_data.csv
[2024-11-11 08:44:14,353] INFO: data_ingestion : 26] The Shape of customers data: (50000, 12)
[2024-11-11 08:44:14,353] INFO: data_ingestion : 27] The Shape of loans data: (50000, 15)
[2024-11-11 08:44:14,354] INFO: data_ingestion : 28] The Shape of bureau data: (50000, 8)
[2024-11-11 08:44:14,819] INFO: common : 97] Successfully saved DataFrame to: artifacts\data_ingestion\data.csv
[2024-11-11 08:44:14,820] INFO: main : 14] >>>>>>>>>>>Completed Data Ingestion Stage<<<<<<<<<<<<<
[2024-11-11 08:44:14,820] INFO: main : 24] >>>>>>>>>>>Starting Data Pre-Processing Stage<<<<<<<<<<<<<
[2024-11-11 08:44:14,831] INFO: common : 32] Successfully loaded yaml file: config\config.yaml
[2024-11-11 08:44:14,832] INFO: common : 32] Successfully loaded yaml file: params.yaml
[2024-11-11 08:44:14,835] INFO: common : 32] Successfully loaded yaml file: schema.yaml
[2024-11-11 08:44:14,835] INFO: common : 55] Created directory: artifacts
[2024-11-11 08:44:14,836] INFO: common : 55] Created directory: artifacts/data_preprocessing
[2024-11-11 08:44:15,049] INFO: common : 79] Successfully loaded DataFrame from: artifacts\data_ingestion\data.csv
[2024-11-11 08:44:15,049] INFO: data_preprocessing : 26] The Valure counts for 'default' column: default
0    45703
1     4297
Name: count, dtype: int64
[2024-11-11 08:44:15,049] INFO: data_preprocessing : 42] No missing values found in column 'cust_id'
[2024-11-11 08:44:15,049] INFO: data_preprocessing : 42] No missing values found in column 'age'
[2024-11-11 08:44:15,066] INFO: data_preprocessing : 42] No missing values found in column 'gender'
[2024-11-11 08:44:15,069] INFO: data_preprocessing : 42] No missing values found in column 'marital_status'
[2024-11-11 08:44:15,073] INFO: data_preprocessing : 42] No missing values found in column 'employment_status'
[2024-11-11 08:44:15,074] INFO: data_preprocessing : 42] No missing values found in column 'income'
[2024-11-11 08:44:15,075] INFO: data_preprocessing : 42] No missing values found in column 'number_of_dependants'
[2024-11-11 08:44:15,077] WARNING: data_preprocessing : 33] Missing values found in column 'residence_type', replacing with 'Unknown'
[2024-11-11 08:44:15,090] INFO: data_preprocessing : 35] Missing values replaced in column 'residence_type' with mode 'Owned'
[2024-11-11 08:44:15,092] INFO: data_preprocessing : 42] No missing values found in column 'years_at_current_address'
[2024-11-11 08:44:15,095] INFO: data_preprocessing : 42] No missing values found in column 'city'
[2024-11-11 08:44:15,095] INFO: data_preprocessing : 42] No missing values found in column 'state'
[2024-11-11 08:44:15,099] INFO: data_preprocessing : 42] No missing values found in column 'zipcode'
[2024-11-11 08:44:15,102] INFO: data_preprocessing : 42] No missing values found in column 'loan_id'
[2024-11-11 08:44:15,105] INFO: data_preprocessing : 42] No missing values found in column 'loan_purpose'
[2024-11-11 08:44:15,108] INFO: data_preprocessing : 42] No missing values found in column 'loan_type'
[2024-11-11 08:44:15,109] INFO: data_preprocessing : 42] No missing values found in column 'sanction_amount'
[2024-11-11 08:44:15,111] INFO: data_preprocessing : 42] No missing values found in column 'loan_amount'
[2024-11-11 08:44:15,111] INFO: data_preprocessing : 42] No missing values found in column 'processing_fee'
[2024-11-11 08:44:15,112] INFO: data_preprocessing : 42] No missing values found in column 'gst'
[2024-11-11 08:44:15,112] INFO: data_preprocessing : 42] No missing values found in column 'net_disbursement'
[2024-11-11 08:44:15,112] INFO: data_preprocessing : 42] No missing values found in column 'loan_tenure_months'
[2024-11-11 08:44:15,112] INFO: data_preprocessing : 42] No missing values found in column 'principal_outstanding'
[2024-11-11 08:44:15,112] INFO: data_preprocessing : 42] No missing values found in column 'bank_balance_at_application'
[2024-11-11 08:44:15,118] INFO: data_preprocessing : 42] No missing values found in column 'disbursal_date'
[2024-11-11 08:44:15,121] INFO: data_preprocessing : 42] No missing values found in column 'installment_start_dt'
[2024-11-11 08:44:15,122] INFO: data_preprocessing : 42] No missing values found in column 'default'
[2024-11-11 08:44:15,122] INFO: data_preprocessing : 42] No missing values found in column 'number_of_open_accounts'
[2024-11-11 08:44:15,124] INFO: data_preprocessing : 42] No missing values found in column 'number_of_closed_accounts'
[2024-11-11 08:44:15,125] INFO: data_preprocessing : 42] No missing values found in column 'total_loan_months'
[2024-11-11 08:44:15,126] INFO: data_preprocessing : 42] No missing values found in column 'delinquent_months'
[2024-11-11 08:44:15,127] INFO: data_preprocessing : 42] No missing values found in column 'total_dpd'
[2024-11-11 08:44:15,128] INFO: data_preprocessing : 42] No missing values found in column 'enquiry_count'
[2024-11-11 08:44:15,128] INFO: data_preprocessing : 42] No missing values found in column 'credit_utilization_ratio'
[2024-11-11 08:44:15,189] INFO: data_preprocessing : 51] No duplicate rows found
[2024-11-11 08:44:15,189] INFO: data_preprocessing : 53] Index(['cust_id', 'age', 'gender', 'marital_status', 'employment_status',
       'income', 'number_of_dependants', 'residence_type',
       'years_at_current_address', 'city', 'state', 'zipcode', 'loan_id',
       'loan_purpose', 'loan_type', 'sanction_amount', 'loan_amount',
       'processing_fee', 'gst', 'net_disbursement', 'loan_tenure_months',
       'principal_outstanding', 'bank_balance_at_application',
       'disbursal_date', 'installment_start_dt', 'default',
       'number_of_open_accounts', 'number_of_closed_accounts',
       'total_loan_months', 'delinquent_months', 'total_dpd', 'enquiry_count',
       'credit_utilization_ratio'],
      dtype='object')
[2024-11-11 08:44:15,668] INFO: common : 97] Successfully saved DataFrame to: artifacts\data_preprocessing\preprocessed_data.csv
[2024-11-11 08:44:15,668] INFO: main : 26] >>>>>>>>>>>Completed Data Pre-Processing Stage<<<<<<<<<<<<<
[2024-11-11 08:44:15,668] INFO: main : 36] >>>>>>>>>>>Starting Data Cleaning Stage<<<<<<<<<<<<<
[2024-11-11 08:44:15,684] INFO: common : 32] Successfully loaded yaml file: config\config.yaml
[2024-11-11 08:44:15,686] INFO: common : 32] Successfully loaded yaml file: params.yaml
[2024-11-11 08:44:15,689] INFO: common : 32] Successfully loaded yaml file: schema.yaml
[2024-11-11 08:44:15,689] INFO: common : 55] Created directory: artifacts
[2024-11-11 08:44:15,690] INFO: common : 55] Created directory: artifacts/data_cleaning
[2024-11-11 08:44:15,890] INFO: common : 79] Successfully loaded DataFrame from: artifacts\data_preprocessing\preprocessed_data.csv
[2024-11-11 08:44:15,892] INFO: data_cleaning : 31] Initiating train test split...
[2024-11-11 08:44:15,909] INFO: data_cleaning : 33] Train test split completed successfully.
[2024-11-11 08:44:15,909] INFO: data_cleaning : 74] Train_df :Index(['cust_id', 'age', 'gender', 'marital_status', 'employment_status',
       'income', 'number_of_dependants', 'residence_type',
       'years_at_current_address', 'city', 'state', 'zipcode', 'loan_id',
       'loan_purpose', 'loan_type', 'sanction_amount', 'loan_amount',
       'processing_fee', 'gst', 'net_disbursement', 'loan_tenure_months',
       'principal_outstanding', 'bank_balance_at_application',
       'disbursal_date', 'installment_start_dt', 'default',
       'number_of_open_accounts', 'number_of_closed_accounts',
       'total_loan_months', 'delinquent_months', 'total_dpd', 'enquiry_count',
       'credit_utilization_ratio'],
      dtype='object')
[2024-11-11 08:44:15,926] INFO: data_cleaning : 79]  After outlier removal train_df :(40000, 33)
[2024-11-11 08:44:15,927] INFO: data_cleaning : 80]  After outlier removal test_df :(10000, 33)
[2024-11-11 08:44:15,928] INFO: data_cleaning : 85] Rule 1: GST should not be more than 20% :(0, 33)
[2024-11-11 08:44:15,929] INFO: data_cleaning : 89] Rule 2: Net disbursement should not be higher than loan_amount :(0, 33)
[2024-11-11 08:44:15,938] INFO: data_cleaning : 94] Rule 3 : Fixed loan_purpose column :loan_purpose
Personal     14037
Home         12006
Auto          7950
Education     6007
Name: count, dtype: int64
[2024-11-11 08:44:15,941] INFO: data_cleaning : 99] Rule 4 : Generated loan_to_income column(LTI)
[2024-11-11 08:44:15,949] INFO: data_cleaning : 104] Generated delinquency_ratio column :count    40000.000000
mean        10.424123
std         17.283345
min          0.000000
25%          0.000000
50%          3.800000
75%         13.200000
max        100.000000
Name: delinquency_ratio, dtype: float64
[2024-11-11 08:44:15,958] INFO: data_cleaning : 118] Generated avg_dpd_per_delinquency column :count    40000.000000
mean         3.303845
std          2.902944
min          0.000000
25%          0.000000
50%          4.300000
75%          5.800000
max         10.000000
Name: avg_dpd_per_delinquency, dtype: float64
[2024-11-11 08:44:15,961] INFO: data_cleaning : 41] Removing columns...
[2024-11-11 08:44:15,961] INFO: data_cleaning : 43] Columns removed successfully.
[2024-11-11 08:44:15,968] INFO: data_cleaning : 41] Removing columns...
[2024-11-11 08:44:15,971] INFO: data_cleaning : 43] Columns removed successfully.
[2024-11-11 08:44:15,972] ERROR: main : 41] An unexpected error occurred: 'DataCleaning' object has no attribute 'schema'
[2024-11-11 08:46:50,837] INFO: __init__ : 26] Credit Risk Model Building Started
[2024-11-11 08:46:53,177] INFO: main : 12] >>>>>>>>>>>Starting Data Ingestion Stage<<<<<<<<<<<<<
[2024-11-11 08:46:53,190] INFO: common : 32] Successfully loaded yaml file: config\config.yaml
[2024-11-11 08:46:53,190] INFO: common : 32] Successfully loaded yaml file: params.yaml
[2024-11-11 08:46:53,196] INFO: common : 32] Successfully loaded yaml file: schema.yaml
[2024-11-11 08:46:53,198] INFO: common : 55] Created directory: artifacts
[2024-11-11 08:46:53,198] INFO: common : 55] Created directory: artifacts/data_ingestion
[2024-11-11 08:46:53,199] INFO: data_ingestion : 17] Loading customers data...
[2024-11-11 08:46:53,272] INFO: common : 79] Successfully loaded DataFrame from: data\customers.csv
[2024-11-11 08:46:53,272] INFO: data_ingestion : 20] Loading loans data...
[2024-11-11 08:46:53,404] INFO: common : 79] Successfully loaded DataFrame from: data\loans.csv
[2024-11-11 08:46:53,404] INFO: data_ingestion : 23] Loading bureau data...
[2024-11-11 08:46:53,456] INFO: common : 79] Successfully loaded DataFrame from: data\bureau_data.csv
[2024-11-11 08:46:53,456] INFO: data_ingestion : 26] The Shape of customers data: (50000, 12)
[2024-11-11 08:46:53,456] INFO: data_ingestion : 27] The Shape of loans data: (50000, 15)
[2024-11-11 08:46:53,456] INFO: data_ingestion : 28] The Shape of bureau data: (50000, 8)
[2024-11-11 08:46:53,952] INFO: common : 97] Successfully saved DataFrame to: artifacts\data_ingestion\data.csv
[2024-11-11 08:46:53,966] INFO: main : 14] >>>>>>>>>>>Completed Data Ingestion Stage<<<<<<<<<<<<<
[2024-11-11 08:46:53,967] INFO: main : 24] >>>>>>>>>>>Starting Data Pre-Processing Stage<<<<<<<<<<<<<
[2024-11-11 08:46:53,970] INFO: common : 32] Successfully loaded yaml file: config\config.yaml
[2024-11-11 08:46:53,972] INFO: common : 32] Successfully loaded yaml file: params.yaml
[2024-11-11 08:46:53,975] INFO: common : 32] Successfully loaded yaml file: schema.yaml
[2024-11-11 08:46:53,975] INFO: common : 55] Created directory: artifacts
[2024-11-11 08:46:53,976] INFO: common : 55] Created directory: artifacts/data_preprocessing
[2024-11-11 08:46:54,182] INFO: common : 79] Successfully loaded DataFrame from: artifacts\data_ingestion\data.csv
[2024-11-11 08:46:54,182] INFO: data_preprocessing : 26] The Valure counts for 'default' column: default
0    45703
1     4297
Name: count, dtype: int64
[2024-11-11 08:46:54,182] INFO: data_preprocessing : 42] No missing values found in column 'cust_id'
[2024-11-11 08:46:54,182] INFO: data_preprocessing : 42] No missing values found in column 'age'
[2024-11-11 08:46:54,198] INFO: data_preprocessing : 42] No missing values found in column 'gender'
[2024-11-11 08:46:54,200] INFO: data_preprocessing : 42] No missing values found in column 'marital_status'
[2024-11-11 08:46:54,204] INFO: data_preprocessing : 42] No missing values found in column 'employment_status'
[2024-11-11 08:46:54,205] INFO: data_preprocessing : 42] No missing values found in column 'income'
[2024-11-11 08:46:54,206] INFO: data_preprocessing : 42] No missing values found in column 'number_of_dependants'
[2024-11-11 08:46:54,208] WARNING: data_preprocessing : 33] Missing values found in column 'residence_type', replacing with 'Unknown'
[2024-11-11 08:46:54,216] INFO: data_preprocessing : 35] Missing values replaced in column 'residence_type' with mode 'Owned'
[2024-11-11 08:46:54,220] INFO: data_preprocessing : 42] No missing values found in column 'years_at_current_address'
[2024-11-11 08:46:54,222] INFO: data_preprocessing : 42] No missing values found in column 'city'
[2024-11-11 08:46:54,222] INFO: data_preprocessing : 42] No missing values found in column 'state'
[2024-11-11 08:46:54,222] INFO: data_preprocessing : 42] No missing values found in column 'zipcode'
[2024-11-11 08:46:54,230] INFO: data_preprocessing : 42] No missing values found in column 'loan_id'
[2024-11-11 08:46:54,234] INFO: data_preprocessing : 42] No missing values found in column 'loan_purpose'
[2024-11-11 08:46:54,236] INFO: data_preprocessing : 42] No missing values found in column 'loan_type'
[2024-11-11 08:46:54,237] INFO: data_preprocessing : 42] No missing values found in column 'sanction_amount'
[2024-11-11 08:46:54,239] INFO: data_preprocessing : 42] No missing values found in column 'loan_amount'
[2024-11-11 08:46:54,239] INFO: data_preprocessing : 42] No missing values found in column 'processing_fee'
[2024-11-11 08:46:54,240] INFO: data_preprocessing : 42] No missing values found in column 'gst'
[2024-11-11 08:46:54,240] INFO: data_preprocessing : 42] No missing values found in column 'net_disbursement'
[2024-11-11 08:46:54,242] INFO: data_preprocessing : 42] No missing values found in column 'loan_tenure_months'
[2024-11-11 08:46:54,243] INFO: data_preprocessing : 42] No missing values found in column 'principal_outstanding'
[2024-11-11 08:46:54,244] INFO: data_preprocessing : 42] No missing values found in column 'bank_balance_at_application'
[2024-11-11 08:46:54,246] INFO: data_preprocessing : 42] No missing values found in column 'disbursal_date'
[2024-11-11 08:46:54,249] INFO: data_preprocessing : 42] No missing values found in column 'installment_start_dt'
[2024-11-11 08:46:54,250] INFO: data_preprocessing : 42] No missing values found in column 'default'
[2024-11-11 08:46:54,250] INFO: data_preprocessing : 42] No missing values found in column 'number_of_open_accounts'
[2024-11-11 08:46:54,252] INFO: data_preprocessing : 42] No missing values found in column 'number_of_closed_accounts'
[2024-11-11 08:46:54,253] INFO: data_preprocessing : 42] No missing values found in column 'total_loan_months'
[2024-11-11 08:46:54,254] INFO: data_preprocessing : 42] No missing values found in column 'delinquent_months'
[2024-11-11 08:46:54,255] INFO: data_preprocessing : 42] No missing values found in column 'total_dpd'
[2024-11-11 08:46:54,256] INFO: data_preprocessing : 42] No missing values found in column 'enquiry_count'
[2024-11-11 08:46:54,256] INFO: data_preprocessing : 42] No missing values found in column 'credit_utilization_ratio'
[2024-11-11 08:46:54,323] INFO: data_preprocessing : 51] No duplicate rows found
[2024-11-11 08:46:54,323] INFO: data_preprocessing : 53] Index(['cust_id', 'age', 'gender', 'marital_status', 'employment_status',
       'income', 'number_of_dependants', 'residence_type',
       'years_at_current_address', 'city', 'state', 'zipcode', 'loan_id',
       'loan_purpose', 'loan_type', 'sanction_amount', 'loan_amount',
       'processing_fee', 'gst', 'net_disbursement', 'loan_tenure_months',
       'principal_outstanding', 'bank_balance_at_application',
       'disbursal_date', 'installment_start_dt', 'default',
       'number_of_open_accounts', 'number_of_closed_accounts',
       'total_loan_months', 'delinquent_months', 'total_dpd', 'enquiry_count',
       'credit_utilization_ratio'],
      dtype='object')
[2024-11-11 08:46:54,830] INFO: common : 97] Successfully saved DataFrame to: artifacts\data_preprocessing\preprocessed_data.csv
[2024-11-11 08:46:54,848] INFO: main : 26] >>>>>>>>>>>Completed Data Pre-Processing Stage<<<<<<<<<<<<<
[2024-11-11 08:46:54,848] INFO: main : 36] >>>>>>>>>>>Starting Data Cleaning Stage<<<<<<<<<<<<<
[2024-11-11 08:46:54,852] INFO: common : 32] Successfully loaded yaml file: config\config.yaml
[2024-11-11 08:46:54,854] INFO: common : 32] Successfully loaded yaml file: params.yaml
[2024-11-11 08:46:54,855] INFO: common : 32] Successfully loaded yaml file: schema.yaml
[2024-11-11 08:46:54,855] INFO: common : 55] Created directory: artifacts
[2024-11-11 08:46:54,860] INFO: common : 55] Created directory: artifacts/data_cleaning
[2024-11-11 08:46:54,860] ERROR: main : 41] An unexpected error occurred: "'ConfigBox' object has no attribute 'columns'"
[2024-11-11 08:47:50,104] INFO: __init__ : 26] Credit Risk Model Building Started
[2024-11-11 08:47:55,991] INFO: main : 12] >>>>>>>>>>>Starting Data Ingestion Stage<<<<<<<<<<<<<
[2024-11-11 08:47:55,998] INFO: common : 32] Successfully loaded yaml file: config\config.yaml
[2024-11-11 08:47:56,005] INFO: common : 32] Successfully loaded yaml file: params.yaml
[2024-11-11 08:47:56,016] INFO: common : 32] Successfully loaded yaml file: schema.yaml
[2024-11-11 08:47:56,024] INFO: common : 55] Created directory: artifacts
[2024-11-11 08:47:56,027] INFO: common : 55] Created directory: artifacts/data_ingestion
[2024-11-11 08:47:56,030] INFO: data_ingestion : 17] Loading customers data...
[2024-11-11 08:47:56,325] INFO: common : 79] Successfully loaded DataFrame from: data\customers.csv
[2024-11-11 08:47:56,340] INFO: data_ingestion : 20] Loading loans data...
[2024-11-11 08:47:56,780] INFO: common : 79] Successfully loaded DataFrame from: data\loans.csv
[2024-11-11 08:47:56,788] INFO: data_ingestion : 23] Loading bureau data...
[2024-11-11 08:47:56,955] INFO: common : 79] Successfully loaded DataFrame from: data\bureau_data.csv
[2024-11-11 08:47:56,958] INFO: data_ingestion : 26] The Shape of customers data: (50000, 12)
[2024-11-11 08:47:56,958] INFO: data_ingestion : 27] The Shape of loans data: (50000, 15)
[2024-11-11 08:47:56,960] INFO: data_ingestion : 28] The Shape of bureau data: (50000, 8)
[2024-11-11 08:47:58,505] INFO: common : 97] Successfully saved DataFrame to: artifacts\data_ingestion\data.csv
[2024-11-11 08:47:58,527] INFO: main : 14] >>>>>>>>>>>Completed Data Ingestion Stage<<<<<<<<<<<<<
[2024-11-11 08:47:58,527] INFO: main : 24] >>>>>>>>>>>Starting Data Pre-Processing Stage<<<<<<<<<<<<<
[2024-11-11 08:47:58,538] INFO: common : 32] Successfully loaded yaml file: config\config.yaml
[2024-11-11 08:47:58,544] INFO: common : 32] Successfully loaded yaml file: params.yaml
[2024-11-11 08:47:58,551] INFO: common : 32] Successfully loaded yaml file: schema.yaml
[2024-11-11 08:47:58,552] INFO: common : 55] Created directory: artifacts
[2024-11-11 08:47:58,553] INFO: common : 55] Created directory: artifacts/data_preprocessing
[2024-11-11 08:47:59,088] INFO: common : 79] Successfully loaded DataFrame from: artifacts\data_ingestion\data.csv
[2024-11-11 08:47:59,090] INFO: data_preprocessing : 26] The Valure counts for 'default' column: default
0    45703
1     4297
Name: count, dtype: int64
[2024-11-11 08:47:59,102] INFO: data_preprocessing : 42] No missing values found in column 'cust_id'
[2024-11-11 08:47:59,106] INFO: data_preprocessing : 42] No missing values found in column 'age'
[2024-11-11 08:47:59,113] INFO: data_preprocessing : 42] No missing values found in column 'gender'
[2024-11-11 08:47:59,120] INFO: data_preprocessing : 42] No missing values found in column 'marital_status'
[2024-11-11 08:47:59,126] INFO: data_preprocessing : 42] No missing values found in column 'employment_status'
[2024-11-11 08:47:59,128] INFO: data_preprocessing : 42] No missing values found in column 'income'
[2024-11-11 08:47:59,129] INFO: data_preprocessing : 42] No missing values found in column 'number_of_dependants'
[2024-11-11 08:47:59,136] WARNING: data_preprocessing : 33] Missing values found in column 'residence_type', replacing with 'Unknown'
[2024-11-11 08:47:59,166] INFO: data_preprocessing : 35] Missing values replaced in column 'residence_type' with mode 'Owned'
[2024-11-11 08:47:59,166] INFO: data_preprocessing : 42] No missing values found in column 'years_at_current_address'
[2024-11-11 08:47:59,175] INFO: data_preprocessing : 42] No missing values found in column 'city'
[2024-11-11 08:47:59,181] INFO: data_preprocessing : 42] No missing values found in column 'state'
[2024-11-11 08:47:59,182] INFO: data_preprocessing : 42] No missing values found in column 'zipcode'
[2024-11-11 08:47:59,187] INFO: data_preprocessing : 42] No missing values found in column 'loan_id'
[2024-11-11 08:47:59,193] INFO: data_preprocessing : 42] No missing values found in column 'loan_purpose'
[2024-11-11 08:47:59,199] INFO: data_preprocessing : 42] No missing values found in column 'loan_type'
[2024-11-11 08:47:59,201] INFO: data_preprocessing : 42] No missing values found in column 'sanction_amount'
[2024-11-11 08:47:59,201] INFO: data_preprocessing : 42] No missing values found in column 'loan_amount'
[2024-11-11 08:47:59,201] INFO: data_preprocessing : 42] No missing values found in column 'processing_fee'
[2024-11-11 08:47:59,205] INFO: data_preprocessing : 42] No missing values found in column 'gst'
[2024-11-11 08:47:59,207] INFO: data_preprocessing : 42] No missing values found in column 'net_disbursement'
[2024-11-11 08:47:59,208] INFO: data_preprocessing : 42] No missing values found in column 'loan_tenure_months'
[2024-11-11 08:47:59,210] INFO: data_preprocessing : 42] No missing values found in column 'principal_outstanding'
[2024-11-11 08:47:59,213] INFO: data_preprocessing : 42] No missing values found in column 'bank_balance_at_application'
[2024-11-11 08:47:59,220] INFO: data_preprocessing : 42] No missing values found in column 'disbursal_date'
[2024-11-11 08:47:59,228] INFO: data_preprocessing : 42] No missing values found in column 'installment_start_dt'
[2024-11-11 08:47:59,229] INFO: data_preprocessing : 42] No missing values found in column 'default'
[2024-11-11 08:47:59,231] INFO: data_preprocessing : 42] No missing values found in column 'number_of_open_accounts'
[2024-11-11 08:47:59,234] INFO: data_preprocessing : 42] No missing values found in column 'number_of_closed_accounts'
[2024-11-11 08:47:59,236] INFO: data_preprocessing : 42] No missing values found in column 'total_loan_months'
[2024-11-11 08:47:59,238] INFO: data_preprocessing : 42] No missing values found in column 'delinquent_months'
[2024-11-11 08:47:59,240] INFO: data_preprocessing : 42] No missing values found in column 'total_dpd'
[2024-11-11 08:47:59,242] INFO: data_preprocessing : 42] No missing values found in column 'enquiry_count'
[2024-11-11 08:47:59,244] INFO: data_preprocessing : 42] No missing values found in column 'credit_utilization_ratio'
[2024-11-11 08:47:59,390] INFO: data_preprocessing : 51] No duplicate rows found
[2024-11-11 08:47:59,390] INFO: data_preprocessing : 53] Index(['cust_id', 'age', 'gender', 'marital_status', 'employment_status',
       'income', 'number_of_dependants', 'residence_type',
       'years_at_current_address', 'city', 'state', 'zipcode', 'loan_id',
       'loan_purpose', 'loan_type', 'sanction_amount', 'loan_amount',
       'processing_fee', 'gst', 'net_disbursement', 'loan_tenure_months',
       'principal_outstanding', 'bank_balance_at_application',
       'disbursal_date', 'installment_start_dt', 'default',
       'number_of_open_accounts', 'number_of_closed_accounts',
       'total_loan_months', 'delinquent_months', 'total_dpd', 'enquiry_count',
       'credit_utilization_ratio'],
      dtype='object')
[2024-11-11 08:48:00,197] INFO: common : 97] Successfully saved DataFrame to: artifacts\data_preprocessing\preprocessed_data.csv
[2024-11-11 08:48:00,202] INFO: main : 26] >>>>>>>>>>>Completed Data Pre-Processing Stage<<<<<<<<<<<<<
[2024-11-11 08:48:00,203] INFO: main : 36] >>>>>>>>>>>Starting Data Cleaning Stage<<<<<<<<<<<<<
[2024-11-11 08:48:00,207] INFO: common : 32] Successfully loaded yaml file: config\config.yaml
[2024-11-11 08:48:00,210] INFO: common : 32] Successfully loaded yaml file: params.yaml
[2024-11-11 08:48:00,213] INFO: common : 32] Successfully loaded yaml file: schema.yaml
[2024-11-11 08:48:00,214] INFO: common : 55] Created directory: artifacts
[2024-11-11 08:48:00,215] INFO: common : 55] Created directory: artifacts/data_cleaning
[2024-11-11 08:48:00,216] ERROR: main : 41] An unexpected error occurred: "'ConfigBox' object has no attribute 'columns'"
[2024-11-11 08:49:16,748] INFO: __init__ : 26] Credit Risk Model Building Started
[2024-11-11 08:49:18,852] INFO: main : 12] >>>>>>>>>>>Starting Data Ingestion Stage<<<<<<<<<<<<<
[2024-11-11 08:49:18,852] INFO: common : 32] Successfully loaded yaml file: config\config.yaml
[2024-11-11 08:49:18,861] INFO: common : 32] Successfully loaded yaml file: params.yaml
[2024-11-11 08:49:18,865] INFO: common : 32] Successfully loaded yaml file: schema.yaml
[2024-11-11 08:49:18,866] INFO: common : 55] Created directory: artifacts
[2024-11-11 08:49:18,867] INFO: common : 55] Created directory: artifacts/data_ingestion
[2024-11-11 08:49:18,867] INFO: data_ingestion : 17] Loading customers data...
[2024-11-11 08:49:18,970] INFO: common : 79] Successfully loaded DataFrame from: data\customers.csv
[2024-11-11 08:49:18,971] INFO: data_ingestion : 20] Loading loans data...
[2024-11-11 08:49:19,088] INFO: common : 79] Successfully loaded DataFrame from: data\loans.csv
[2024-11-11 08:49:19,088] INFO: data_ingestion : 23] Loading bureau data...
[2024-11-11 08:49:19,138] INFO: common : 79] Successfully loaded DataFrame from: data\bureau_data.csv
[2024-11-11 08:49:19,139] INFO: data_ingestion : 26] The Shape of customers data: (50000, 12)
[2024-11-11 08:49:19,139] INFO: data_ingestion : 27] The Shape of loans data: (50000, 15)
[2024-11-11 08:49:19,140] INFO: data_ingestion : 28] The Shape of bureau data: (50000, 8)
[2024-11-11 08:49:19,651] INFO: common : 97] Successfully saved DataFrame to: artifacts\data_ingestion\data.csv
[2024-11-11 08:49:19,665] INFO: main : 14] >>>>>>>>>>>Completed Data Ingestion Stage<<<<<<<<<<<<<
[2024-11-11 08:49:19,674] INFO: main : 24] >>>>>>>>>>>Starting Data Pre-Processing Stage<<<<<<<<<<<<<
[2024-11-11 08:49:19,677] INFO: common : 32] Successfully loaded yaml file: config\config.yaml
[2024-11-11 08:49:19,677] INFO: common : 32] Successfully loaded yaml file: params.yaml
[2024-11-11 08:49:19,683] INFO: common : 32] Successfully loaded yaml file: schema.yaml
[2024-11-11 08:49:19,684] INFO: common : 55] Created directory: artifacts
[2024-11-11 08:49:19,685] INFO: common : 55] Created directory: artifacts/data_preprocessing
[2024-11-11 08:49:19,914] INFO: common : 79] Successfully loaded DataFrame from: artifacts\data_ingestion\data.csv
[2024-11-11 08:49:19,914] INFO: data_preprocessing : 26] The Valure counts for 'default' column: default
0    45703
1     4297
Name: count, dtype: int64
[2024-11-11 08:49:19,914] INFO: data_preprocessing : 42] No missing values found in column 'cust_id'
[2024-11-11 08:49:19,914] INFO: data_preprocessing : 42] No missing values found in column 'age'
[2024-11-11 08:49:19,928] INFO: data_preprocessing : 42] No missing values found in column 'gender'
[2024-11-11 08:49:19,931] INFO: data_preprocessing : 42] No missing values found in column 'marital_status'
[2024-11-11 08:49:19,934] INFO: data_preprocessing : 42] No missing values found in column 'employment_status'
[2024-11-11 08:49:19,935] INFO: data_preprocessing : 42] No missing values found in column 'income'
[2024-11-11 08:49:19,936] INFO: data_preprocessing : 42] No missing values found in column 'number_of_dependants'
[2024-11-11 08:49:19,940] WARNING: data_preprocessing : 33] Missing values found in column 'residence_type', replacing with 'Unknown'
[2024-11-11 08:49:19,946] INFO: data_preprocessing : 35] Missing values replaced in column 'residence_type' with mode 'Owned'
[2024-11-11 08:49:19,946] INFO: data_preprocessing : 42] No missing values found in column 'years_at_current_address'
[2024-11-11 08:49:19,955] INFO: data_preprocessing : 42] No missing values found in column 'city'
[2024-11-11 08:49:19,958] INFO: data_preprocessing : 42] No missing values found in column 'state'
[2024-11-11 08:49:19,958] INFO: data_preprocessing : 42] No missing values found in column 'zipcode'
[2024-11-11 08:49:19,963] INFO: data_preprocessing : 42] No missing values found in column 'loan_id'
[2024-11-11 08:49:19,966] INFO: data_preprocessing : 42] No missing values found in column 'loan_purpose'
[2024-11-11 08:49:19,969] INFO: data_preprocessing : 42] No missing values found in column 'loan_type'
[2024-11-11 08:49:19,970] INFO: data_preprocessing : 42] No missing values found in column 'sanction_amount'
[2024-11-11 08:49:19,971] INFO: data_preprocessing : 42] No missing values found in column 'loan_amount'
[2024-11-11 08:49:19,971] INFO: data_preprocessing : 42] No missing values found in column 'processing_fee'
[2024-11-11 08:49:19,973] INFO: data_preprocessing : 42] No missing values found in column 'gst'
[2024-11-11 08:49:19,974] INFO: data_preprocessing : 42] No missing values found in column 'net_disbursement'
[2024-11-11 08:49:19,975] INFO: data_preprocessing : 42] No missing values found in column 'loan_tenure_months'
[2024-11-11 08:49:19,976] INFO: data_preprocessing : 42] No missing values found in column 'principal_outstanding'
[2024-11-11 08:49:19,977] INFO: data_preprocessing : 42] No missing values found in column 'bank_balance_at_application'
[2024-11-11 08:49:19,980] INFO: data_preprocessing : 42] No missing values found in column 'disbursal_date'
[2024-11-11 08:49:19,982] INFO: data_preprocessing : 42] No missing values found in column 'installment_start_dt'
[2024-11-11 08:49:19,984] INFO: data_preprocessing : 42] No missing values found in column 'default'
[2024-11-11 08:49:19,985] INFO: data_preprocessing : 42] No missing values found in column 'number_of_open_accounts'
[2024-11-11 08:49:19,986] INFO: data_preprocessing : 42] No missing values found in column 'number_of_closed_accounts'
[2024-11-11 08:49:19,987] INFO: data_preprocessing : 42] No missing values found in column 'total_loan_months'
[2024-11-11 08:49:19,987] INFO: data_preprocessing : 42] No missing values found in column 'delinquent_months'
[2024-11-11 08:49:19,987] INFO: data_preprocessing : 42] No missing values found in column 'total_dpd'
[2024-11-11 08:49:19,988] INFO: data_preprocessing : 42] No missing values found in column 'enquiry_count'
[2024-11-11 08:49:19,989] INFO: data_preprocessing : 42] No missing values found in column 'credit_utilization_ratio'
[2024-11-11 08:49:20,055] INFO: data_preprocessing : 51] No duplicate rows found
[2024-11-11 08:49:20,056] INFO: data_preprocessing : 53] Index(['cust_id', 'age', 'gender', 'marital_status', 'employment_status',
       'income', 'number_of_dependants', 'residence_type',
       'years_at_current_address', 'city', 'state', 'zipcode', 'loan_id',
       'loan_purpose', 'loan_type', 'sanction_amount', 'loan_amount',
       'processing_fee', 'gst', 'net_disbursement', 'loan_tenure_months',
       'principal_outstanding', 'bank_balance_at_application',
       'disbursal_date', 'installment_start_dt', 'default',
       'number_of_open_accounts', 'number_of_closed_accounts',
       'total_loan_months', 'delinquent_months', 'total_dpd', 'enquiry_count',
       'credit_utilization_ratio'],
      dtype='object')
[2024-11-11 08:49:20,526] INFO: common : 97] Successfully saved DataFrame to: artifacts\data_preprocessing\preprocessed_data.csv
[2024-11-11 08:49:20,526] INFO: main : 26] >>>>>>>>>>>Completed Data Pre-Processing Stage<<<<<<<<<<<<<
[2024-11-11 08:49:20,526] INFO: main : 36] >>>>>>>>>>>Starting Data Cleaning Stage<<<<<<<<<<<<<
[2024-11-11 08:49:20,536] INFO: common : 32] Successfully loaded yaml file: config\config.yaml
[2024-11-11 08:49:20,537] INFO: common : 32] Successfully loaded yaml file: params.yaml
[2024-11-11 08:49:20,541] INFO: common : 32] Successfully loaded yaml file: schema.yaml
[2024-11-11 08:49:20,542] INFO: common : 55] Created directory: artifacts
[2024-11-11 08:49:20,543] INFO: common : 55] Created directory: artifacts/data_cleaning
[2024-11-11 08:49:20,765] INFO: common : 79] Successfully loaded DataFrame from: artifacts\data_preprocessing\preprocessed_data.csv
[2024-11-11 08:49:20,765] INFO: data_cleaning : 33] Initiating train test split...
[2024-11-11 08:49:20,793] INFO: data_cleaning : 35] Train test split completed successfully.
[2024-11-11 08:49:20,794] INFO: data_cleaning : 76] Train_df :Index(['cust_id', 'age', 'gender', 'marital_status', 'employment_status',
       'income', 'number_of_dependants', 'residence_type',
       'years_at_current_address', 'city', 'state', 'zipcode', 'loan_id',
       'loan_purpose', 'loan_type', 'sanction_amount', 'loan_amount',
       'processing_fee', 'gst', 'net_disbursement', 'loan_tenure_months',
       'principal_outstanding', 'bank_balance_at_application',
       'disbursal_date', 'installment_start_dt', 'default',
       'number_of_open_accounts', 'number_of_closed_accounts',
       'total_loan_months', 'delinquent_months', 'total_dpd', 'enquiry_count',
       'credit_utilization_ratio'],
      dtype='object')
[2024-11-11 08:49:20,812] INFO: data_cleaning : 81]  After outlier removal train_df :(40000, 33)
[2024-11-11 08:49:20,812] INFO: data_cleaning : 82]  After outlier removal test_df :(10000, 33)
[2024-11-11 08:49:20,817] INFO: data_cleaning : 87] Rule 1: GST should not be more than 20% :(0, 33)
[2024-11-11 08:49:20,818] INFO: data_cleaning : 91] Rule 2: Net disbursement should not be higher than loan_amount :(0, 33)
[2024-11-11 08:49:20,829] INFO: data_cleaning : 96] Rule 3 : Fixed loan_purpose column :loan_purpose
Personal     14037
Home         12006
Auto          7950
Education     6007
Name: count, dtype: int64
[2024-11-11 08:49:20,829] INFO: data_cleaning : 101] Rule 4 : Generated loan_to_income column(LTI)
[2024-11-11 08:49:20,839] INFO: data_cleaning : 106] Generated delinquency_ratio column :count    40000.000000
mean        10.424123
std         17.283345
min          0.000000
25%          0.000000
50%          3.800000
75%         13.200000
max        100.000000
Name: delinquency_ratio, dtype: float64
[2024-11-11 08:49:20,846] INFO: data_cleaning : 120] Generated avg_dpd_per_delinquency column :count    40000.000000
mean         3.303845
std          2.902944
min          0.000000
25%          0.000000
50%          4.300000
75%          5.800000
max         10.000000
Name: avg_dpd_per_delinquency, dtype: float64
[2024-11-11 08:49:20,846] INFO: data_cleaning : 43] Removing columns...
[2024-11-11 08:49:20,855] INFO: data_cleaning : 45] Columns removed successfully.
[2024-11-11 08:49:20,857] INFO: data_cleaning : 43] Removing columns...
[2024-11-11 08:49:20,860] INFO: data_cleaning : 45] Columns removed successfully.
[2024-11-11 08:49:20,861] ERROR: data_cleaning : 54] Column mismatch. Missing or extra columns.
[2024-11-11 08:49:20,862] ERROR: main : 41] An unexpected error occurred: CustomException.__init__() missing 1 required positional argument: 'error_detail'
[2024-11-11 09:41:39,325] INFO: __init__ : 26] Credit Risk Model Building Started
[2024-11-11 09:41:42,971] INFO: main : 12] >>>>>>>>>>>Starting Data Ingestion Stage<<<<<<<<<<<<<
[2024-11-11 09:41:42,991] INFO: common : 32] Successfully loaded yaml file: config\config.yaml
[2024-11-11 09:41:42,991] INFO: common : 32] Successfully loaded yaml file: params.yaml
[2024-11-11 09:41:43,003] INFO: common : 32] Successfully loaded yaml file: schema.yaml
[2024-11-11 09:41:43,003] INFO: common : 55] Created directory: artifacts
[2024-11-11 09:41:43,003] INFO: common : 55] Created directory: artifacts/data_ingestion
[2024-11-11 09:41:43,003] INFO: data_ingestion : 17] Loading customers data...
[2024-11-11 09:41:43,268] INFO: common : 79] Successfully loaded DataFrame from: data\customers.csv
[2024-11-11 09:41:43,270] INFO: data_ingestion : 20] Loading loans data...
[2024-11-11 09:41:43,702] INFO: common : 79] Successfully loaded DataFrame from: data\loans.csv
[2024-11-11 09:41:43,702] INFO: data_ingestion : 23] Loading bureau data...
[2024-11-11 09:41:43,858] INFO: common : 79] Successfully loaded DataFrame from: data\bureau_data.csv
[2024-11-11 09:41:43,860] INFO: data_ingestion : 26] The Shape of customers data: (50000, 12)
[2024-11-11 09:41:43,861] INFO: data_ingestion : 27] The Shape of loans data: (50000, 15)
[2024-11-11 09:41:43,862] INFO: data_ingestion : 28] The Shape of bureau data: (50000, 8)
[2024-11-11 09:41:45,748] INFO: common : 97] Successfully saved DataFrame to: artifacts\data_ingestion\data.csv
[2024-11-11 09:41:45,774] INFO: main : 14] >>>>>>>>>>>Completed Data Ingestion Stage<<<<<<<<<<<<<
[2024-11-11 09:41:45,775] INFO: main : 24] >>>>>>>>>>>Starting Data Pre-Processing Stage<<<<<<<<<<<<<
[2024-11-11 09:41:45,783] INFO: common : 32] Successfully loaded yaml file: config\config.yaml
[2024-11-11 09:41:45,788] INFO: common : 32] Successfully loaded yaml file: params.yaml
[2024-11-11 09:41:45,796] INFO: common : 32] Successfully loaded yaml file: schema.yaml
[2024-11-11 09:41:45,798] INFO: common : 55] Created directory: artifacts
[2024-11-11 09:41:45,800] INFO: common : 55] Created directory: artifacts/data_preprocessing
[2024-11-11 09:41:46,478] INFO: common : 79] Successfully loaded DataFrame from: artifacts\data_ingestion\data.csv
[2024-11-11 09:41:46,486] INFO: data_preprocessing : 26] The Valure counts for 'default' column: default
0    45703
1     4297
Name: count, dtype: int64
[2024-11-11 09:41:46,498] INFO: data_preprocessing : 42] No missing values found in column 'cust_id'
[2024-11-11 09:41:46,499] INFO: data_preprocessing : 42] No missing values found in column 'age'
[2024-11-11 09:41:46,507] INFO: data_preprocessing : 42] No missing values found in column 'gender'
[2024-11-11 09:41:46,514] INFO: data_preprocessing : 42] No missing values found in column 'marital_status'
[2024-11-11 09:41:46,523] INFO: data_preprocessing : 42] No missing values found in column 'employment_status'
[2024-11-11 09:41:46,526] INFO: data_preprocessing : 42] No missing values found in column 'income'
[2024-11-11 09:41:46,528] INFO: data_preprocessing : 42] No missing values found in column 'number_of_dependants'
[2024-11-11 09:41:46,536] WARNING: data_preprocessing : 33] Missing values found in column 'residence_type', replacing with 'Unknown'
[2024-11-11 09:41:46,573] INFO: data_preprocessing : 35] Missing values replaced in column 'residence_type' with mode 'Owned'
[2024-11-11 09:41:46,573] INFO: data_preprocessing : 42] No missing values found in column 'years_at_current_address'
[2024-11-11 09:41:46,582] INFO: data_preprocessing : 42] No missing values found in column 'city'
[2024-11-11 09:41:46,591] INFO: data_preprocessing : 42] No missing values found in column 'state'
[2024-11-11 09:41:46,593] INFO: data_preprocessing : 42] No missing values found in column 'zipcode'
[2024-11-11 09:41:46,600] INFO: data_preprocessing : 42] No missing values found in column 'loan_id'
[2024-11-11 09:41:46,604] INFO: data_preprocessing : 42] No missing values found in column 'loan_purpose'
[2024-11-11 09:41:46,615] INFO: data_preprocessing : 42] No missing values found in column 'loan_type'
[2024-11-11 09:41:46,616] INFO: data_preprocessing : 42] No missing values found in column 'sanction_amount'
[2024-11-11 09:41:46,616] INFO: data_preprocessing : 42] No missing values found in column 'loan_amount'
[2024-11-11 09:41:46,616] INFO: data_preprocessing : 42] No missing values found in column 'processing_fee'
[2024-11-11 09:41:46,623] INFO: data_preprocessing : 42] No missing values found in column 'gst'
[2024-11-11 09:41:46,623] INFO: data_preprocessing : 42] No missing values found in column 'net_disbursement'
[2024-11-11 09:41:46,627] INFO: data_preprocessing : 42] No missing values found in column 'loan_tenure_months'
[2024-11-11 09:41:46,629] INFO: data_preprocessing : 42] No missing values found in column 'principal_outstanding'
[2024-11-11 09:41:46,631] INFO: data_preprocessing : 42] No missing values found in column 'bank_balance_at_application'
[2024-11-11 09:41:46,636] INFO: data_preprocessing : 42] No missing values found in column 'disbursal_date'
[2024-11-11 09:41:46,646] INFO: data_preprocessing : 42] No missing values found in column 'installment_start_dt'
[2024-11-11 09:41:46,648] INFO: data_preprocessing : 42] No missing values found in column 'default'
[2024-11-11 09:41:46,649] INFO: data_preprocessing : 42] No missing values found in column 'number_of_open_accounts'
[2024-11-11 09:41:46,649] INFO: data_preprocessing : 42] No missing values found in column 'number_of_closed_accounts'
[2024-11-11 09:41:46,654] INFO: data_preprocessing : 42] No missing values found in column 'total_loan_months'
[2024-11-11 09:41:46,654] INFO: data_preprocessing : 42] No missing values found in column 'delinquent_months'
[2024-11-11 09:41:46,654] INFO: data_preprocessing : 42] No missing values found in column 'total_dpd'
[2024-11-11 09:41:46,654] INFO: data_preprocessing : 42] No missing values found in column 'enquiry_count'
[2024-11-11 09:41:46,662] INFO: data_preprocessing : 42] No missing values found in column 'credit_utilization_ratio'
[2024-11-11 09:41:46,817] INFO: data_preprocessing : 51] No duplicate rows found
[2024-11-11 09:41:46,817] INFO: data_preprocessing : 53] Index(['cust_id', 'age', 'gender', 'marital_status', 'employment_status',
       'income', 'number_of_dependants', 'residence_type',
       'years_at_current_address', 'city', 'state', 'zipcode', 'loan_id',
       'loan_purpose', 'loan_type', 'sanction_amount', 'loan_amount',
       'processing_fee', 'gst', 'net_disbursement', 'loan_tenure_months',
       'principal_outstanding', 'bank_balance_at_application',
       'disbursal_date', 'installment_start_dt', 'default',
       'number_of_open_accounts', 'number_of_closed_accounts',
       'total_loan_months', 'delinquent_months', 'total_dpd', 'enquiry_count',
       'credit_utilization_ratio'],
      dtype='object')
[2024-11-11 09:41:47,970] INFO: common : 97] Successfully saved DataFrame to: artifacts\data_preprocessing\preprocessed_data.csv
[2024-11-11 09:41:47,976] INFO: main : 26] >>>>>>>>>>>Completed Data Pre-Processing Stage<<<<<<<<<<<<<
[2024-11-11 09:41:47,976] INFO: main : 36] >>>>>>>>>>>Starting Data Cleaning Stage<<<<<<<<<<<<<
[2024-11-11 09:41:47,988] INFO: common : 32] Successfully loaded yaml file: config\config.yaml
[2024-11-11 09:41:47,992] INFO: common : 32] Successfully loaded yaml file: params.yaml
[2024-11-11 09:41:47,999] INFO: common : 32] Successfully loaded yaml file: schema.yaml
[2024-11-11 09:41:48,001] INFO: common : 55] Created directory: artifacts
[2024-11-11 09:41:48,002] INFO: common : 55] Created directory: artifacts/data_cleaning
[2024-11-11 09:41:48,414] INFO: common : 79] Successfully loaded DataFrame from: artifacts\data_preprocessing\preprocessed_data.csv
[2024-11-11 09:41:48,414] INFO: data_cleaning : 33] Initiating train test split...
[2024-11-11 09:41:48,461] INFO: data_cleaning : 35] Train test split completed successfully.
[2024-11-11 09:41:48,463] INFO: data_cleaning : 76] Train_df :Index(['cust_id', 'age', 'gender', 'marital_status', 'employment_status',
       'income', 'number_of_dependants', 'residence_type',
       'years_at_current_address', 'city', 'state', 'zipcode', 'loan_id',
       'loan_purpose', 'loan_type', 'sanction_amount', 'loan_amount',
       'processing_fee', 'gst', 'net_disbursement', 'loan_tenure_months',
       'principal_outstanding', 'bank_balance_at_application',
       'disbursal_date', 'installment_start_dt', 'default',
       'number_of_open_accounts', 'number_of_closed_accounts',
       'total_loan_months', 'delinquent_months', 'total_dpd', 'enquiry_count',
       'credit_utilization_ratio'],
      dtype='object')
[2024-11-11 09:41:48,490] INFO: data_cleaning : 81]  After outlier removal train_df :(40000, 33)
[2024-11-11 09:41:48,490] INFO: data_cleaning : 82]  After outlier removal test_df :(10000, 33)
[2024-11-11 09:41:48,497] INFO: data_cleaning : 87] Rule 1: GST should not be more than 20% :(0, 33)
[2024-11-11 09:41:48,499] INFO: data_cleaning : 91] Rule 2: Net disbursement should not be higher than loan_amount :(0, 33)
[2024-11-11 09:41:48,520] INFO: data_cleaning : 96] Rule 3 : Fixed loan_purpose column :loan_purpose
Personal     14037
Home         12006
Auto          7950
Education     6007
Name: count, dtype: int64
[2024-11-11 09:41:48,523] INFO: data_cleaning : 101] Rule 4 : Generated loan_to_income column(LTI)
[2024-11-11 09:41:48,533] INFO: data_cleaning : 106] Generated delinquency_ratio column :count    40000.000000
mean        10.424123
std         17.283345
min          0.000000
25%          0.000000
50%          3.800000
75%         13.200000
max        100.000000
Name: delinquency_ratio, dtype: float64
[2024-11-11 09:41:48,553] INFO: data_cleaning : 120] Generated avg_dpd_per_delinquency column :count    40000.000000
mean         3.303845
std          2.902944
min          0.000000
25%          0.000000
50%          4.300000
75%          5.800000
max         10.000000
Name: avg_dpd_per_delinquency, dtype: float64
[2024-11-11 09:41:48,556] INFO: data_cleaning : 43] Removing columns...
[2024-11-11 09:41:48,557] INFO: data_cleaning : 45] Columns removed successfully.
[2024-11-11 09:41:48,564] INFO: data_cleaning : 43] Removing columns...
[2024-11-11 09:41:48,568] INFO: data_cleaning : 45] Columns removed successfully.
[2024-11-11 09:41:48,569] ERROR: main : 41] An unexpected error occurred: 'DataCleaning' object has no attribute 'schema'
[2024-11-11 09:44:05,708] INFO: __init__ : 26] Credit Risk Model Building Started
[2024-11-11 09:44:07,823] INFO: main : 12] >>>>>>>>>>>Starting Data Ingestion Stage<<<<<<<<<<<<<
[2024-11-11 09:44:07,823] INFO: common : 32] Successfully loaded yaml file: config\config.yaml
[2024-11-11 09:44:07,823] INFO: common : 32] Successfully loaded yaml file: params.yaml
[2024-11-11 09:44:07,835] INFO: common : 32] Successfully loaded yaml file: schema.yaml
[2024-11-11 09:44:07,836] INFO: common : 55] Created directory: artifacts
[2024-11-11 09:44:07,836] INFO: common : 55] Created directory: artifacts/data_ingestion
[2024-11-11 09:44:07,837] INFO: data_ingestion : 17] Loading customers data...
[2024-11-11 09:44:07,933] INFO: common : 79] Successfully loaded DataFrame from: data\customers.csv
[2024-11-11 09:44:07,934] INFO: data_ingestion : 20] Loading loans data...
[2024-11-11 09:44:08,065] INFO: common : 79] Successfully loaded DataFrame from: data\loans.csv
[2024-11-11 09:44:08,065] INFO: data_ingestion : 23] Loading bureau data...
[2024-11-11 09:44:08,115] INFO: common : 79] Successfully loaded DataFrame from: data\bureau_data.csv
[2024-11-11 09:44:08,115] INFO: data_ingestion : 26] The Shape of customers data: (50000, 12)
[2024-11-11 09:44:08,115] INFO: data_ingestion : 27] The Shape of loans data: (50000, 15)
[2024-11-11 09:44:08,115] INFO: data_ingestion : 28] The Shape of bureau data: (50000, 8)
[2024-11-11 09:44:08,647] INFO: common : 97] Successfully saved DataFrame to: artifacts\data_ingestion\data.csv
[2024-11-11 09:44:08,662] INFO: main : 14] >>>>>>>>>>>Completed Data Ingestion Stage<<<<<<<<<<<<<
[2024-11-11 09:44:08,663] INFO: main : 24] >>>>>>>>>>>Starting Data Pre-Processing Stage<<<<<<<<<<<<<
[2024-11-11 09:44:08,667] INFO: common : 32] Successfully loaded yaml file: config\config.yaml
[2024-11-11 09:44:08,671] INFO: common : 32] Successfully loaded yaml file: params.yaml
[2024-11-11 09:44:08,674] INFO: common : 32] Successfully loaded yaml file: schema.yaml
[2024-11-11 09:44:08,675] INFO: common : 55] Created directory: artifacts
[2024-11-11 09:44:08,677] INFO: common : 55] Created directory: artifacts/data_preprocessing
[2024-11-11 09:44:08,971] INFO: common : 79] Successfully loaded DataFrame from: artifacts\data_ingestion\data.csv
[2024-11-11 09:44:08,971] INFO: data_preprocessing : 26] The Valure counts for 'default' column: default
0    45703
1     4297
Name: count, dtype: int64
[2024-11-11 09:44:08,988] INFO: data_preprocessing : 42] No missing values found in column 'cust_id'
[2024-11-11 09:44:08,989] INFO: data_preprocessing : 42] No missing values found in column 'age'
[2024-11-11 09:44:08,995] INFO: data_preprocessing : 42] No missing values found in column 'gender'
[2024-11-11 09:44:08,999] INFO: data_preprocessing : 42] No missing values found in column 'marital_status'
[2024-11-11 09:44:09,003] INFO: data_preprocessing : 42] No missing values found in column 'employment_status'
[2024-11-11 09:44:09,005] INFO: data_preprocessing : 42] No missing values found in column 'income'
[2024-11-11 09:44:09,006] INFO: data_preprocessing : 42] No missing values found in column 'number_of_dependants'
[2024-11-11 09:44:09,007] WARNING: data_preprocessing : 33] Missing values found in column 'residence_type', replacing with 'Unknown'
[2024-11-11 09:44:09,024] INFO: data_preprocessing : 35] Missing values replaced in column 'residence_type' with mode 'Owned'
[2024-11-11 09:44:09,024] INFO: data_preprocessing : 42] No missing values found in column 'years_at_current_address'
[2024-11-11 09:44:09,030] INFO: data_preprocessing : 42] No missing values found in column 'city'
[2024-11-11 09:44:09,035] INFO: data_preprocessing : 42] No missing values found in column 'state'
[2024-11-11 09:44:09,036] INFO: data_preprocessing : 42] No missing values found in column 'zipcode'
[2024-11-11 09:44:09,040] INFO: data_preprocessing : 42] No missing values found in column 'loan_id'
[2024-11-11 09:44:09,043] INFO: data_preprocessing : 42] No missing values found in column 'loan_purpose'
[2024-11-11 09:44:09,047] INFO: data_preprocessing : 42] No missing values found in column 'loan_type'
[2024-11-11 09:44:09,048] INFO: data_preprocessing : 42] No missing values found in column 'sanction_amount'
[2024-11-11 09:44:09,050] INFO: data_preprocessing : 42] No missing values found in column 'loan_amount'
[2024-11-11 09:44:09,052] INFO: data_preprocessing : 42] No missing values found in column 'processing_fee'
[2024-11-11 09:44:09,053] INFO: data_preprocessing : 42] No missing values found in column 'gst'
[2024-11-11 09:44:09,054] INFO: data_preprocessing : 42] No missing values found in column 'net_disbursement'
[2024-11-11 09:44:09,055] INFO: data_preprocessing : 42] No missing values found in column 'loan_tenure_months'
[2024-11-11 09:44:09,056] INFO: data_preprocessing : 42] No missing values found in column 'principal_outstanding'
[2024-11-11 09:44:09,056] INFO: data_preprocessing : 42] No missing values found in column 'bank_balance_at_application'
[2024-11-11 09:44:09,056] INFO: data_preprocessing : 42] No missing values found in column 'disbursal_date'
[2024-11-11 09:44:09,064] INFO: data_preprocessing : 42] No missing values found in column 'installment_start_dt'
[2024-11-11 09:44:09,065] INFO: data_preprocessing : 42] No missing values found in column 'default'
[2024-11-11 09:44:09,066] INFO: data_preprocessing : 42] No missing values found in column 'number_of_open_accounts'
[2024-11-11 09:44:09,067] INFO: data_preprocessing : 42] No missing values found in column 'number_of_closed_accounts'
[2024-11-11 09:44:09,068] INFO: data_preprocessing : 42] No missing values found in column 'total_loan_months'
[2024-11-11 09:44:09,068] INFO: data_preprocessing : 42] No missing values found in column 'delinquent_months'
[2024-11-11 09:44:09,071] INFO: data_preprocessing : 42] No missing values found in column 'total_dpd'
[2024-11-11 09:44:09,072] INFO: data_preprocessing : 42] No missing values found in column 'enquiry_count'
[2024-11-11 09:44:09,073] INFO: data_preprocessing : 42] No missing values found in column 'credit_utilization_ratio'
[2024-11-11 09:44:09,165] INFO: data_preprocessing : 51] No duplicate rows found
[2024-11-11 09:44:09,166] INFO: data_preprocessing : 53] Index(['cust_id', 'age', 'gender', 'marital_status', 'employment_status',
       'income', 'number_of_dependants', 'residence_type',
       'years_at_current_address', 'city', 'state', 'zipcode', 'loan_id',
       'loan_purpose', 'loan_type', 'sanction_amount', 'loan_amount',
       'processing_fee', 'gst', 'net_disbursement', 'loan_tenure_months',
       'principal_outstanding', 'bank_balance_at_application',
       'disbursal_date', 'installment_start_dt', 'default',
       'number_of_open_accounts', 'number_of_closed_accounts',
       'total_loan_months', 'delinquent_months', 'total_dpd', 'enquiry_count',
       'credit_utilization_ratio'],
      dtype='object')
[2024-11-11 09:44:09,736] INFO: common : 97] Successfully saved DataFrame to: artifacts\data_preprocessing\preprocessed_data.csv
[2024-11-11 09:44:09,736] INFO: main : 26] >>>>>>>>>>>Completed Data Pre-Processing Stage<<<<<<<<<<<<<
[2024-11-11 09:44:09,736] INFO: main : 36] >>>>>>>>>>>Starting Data Cleaning Stage<<<<<<<<<<<<<
[2024-11-11 09:44:09,751] INFO: common : 32] Successfully loaded yaml file: config\config.yaml
[2024-11-11 09:44:09,754] INFO: common : 32] Successfully loaded yaml file: params.yaml
[2024-11-11 09:44:09,758] INFO: common : 32] Successfully loaded yaml file: schema.yaml
[2024-11-11 09:44:09,759] INFO: common : 55] Created directory: artifacts
[2024-11-11 09:44:09,760] INFO: common : 55] Created directory: artifacts/data_cleaning
[2024-11-11 09:44:09,993] INFO: common : 79] Successfully loaded DataFrame from: artifacts\data_preprocessing\preprocessed_data.csv
[2024-11-11 09:44:09,993] INFO: data_cleaning : 34] Initiating train test split...
[2024-11-11 09:44:10,022] INFO: data_cleaning : 36] Train test split completed successfully.
[2024-11-11 09:44:10,022] INFO: data_cleaning : 77] Train_df :Index(['cust_id', 'age', 'gender', 'marital_status', 'employment_status',
       'income', 'number_of_dependants', 'residence_type',
       'years_at_current_address', 'city', 'state', 'zipcode', 'loan_id',
       'loan_purpose', 'loan_type', 'sanction_amount', 'loan_amount',
       'processing_fee', 'gst', 'net_disbursement', 'loan_tenure_months',
       'principal_outstanding', 'bank_balance_at_application',
       'disbursal_date', 'installment_start_dt', 'default',
       'number_of_open_accounts', 'number_of_closed_accounts',
       'total_loan_months', 'delinquent_months', 'total_dpd', 'enquiry_count',
       'credit_utilization_ratio'],
      dtype='object')
[2024-11-11 09:44:10,040] INFO: data_cleaning : 82]  After outlier removal train_df :(40000, 33)
[2024-11-11 09:44:10,048] INFO: data_cleaning : 83]  After outlier removal test_df :(10000, 33)
[2024-11-11 09:44:10,049] INFO: data_cleaning : 88] Rule 1: GST should not be more than 20% :(0, 33)
[2024-11-11 09:44:10,050] INFO: data_cleaning : 92] Rule 2: Net disbursement should not be higher than loan_amount :(0, 33)
[2024-11-11 09:44:10,050] INFO: data_cleaning : 97] Rule 3 : Fixed loan_purpose column :loan_purpose
Personal     14037
Home         12006
Auto          7950
Education     6007
Name: count, dtype: int64
[2024-11-11 09:44:10,064] INFO: data_cleaning : 102] Rule 4 : Generated loan_to_income column(LTI)
[2024-11-11 09:44:10,068] INFO: data_cleaning : 107] Generated delinquency_ratio column :count    40000.000000
mean        10.424123
std         17.283345
min          0.000000
25%          0.000000
50%          3.800000
75%         13.200000
max        100.000000
Name: delinquency_ratio, dtype: float64
[2024-11-11 09:44:10,078] INFO: data_cleaning : 121] Generated avg_dpd_per_delinquency column :count    40000.000000
mean         3.303845
std          2.902944
min          0.000000
25%          0.000000
50%          4.300000
75%          5.800000
max         10.000000
Name: avg_dpd_per_delinquency, dtype: float64
[2024-11-11 09:44:10,079] INFO: data_cleaning : 44] Removing columns...
[2024-11-11 09:44:10,083] INFO: data_cleaning : 46] Columns removed successfully.
[2024-11-11 09:44:10,084] INFO: data_cleaning : 44] Removing columns...
[2024-11-11 09:44:10,084] INFO: data_cleaning : 46] Columns removed successfully.
[2024-11-11 09:44:10,084] ERROR: main : 41] An unexpected error occurred: 'ConfigBox' object is not callable
[2024-11-11 09:45:16,169] INFO: __init__ : 26] Credit Risk Model Building Started
[2024-11-11 09:45:18,481] INFO: main : 12] >>>>>>>>>>>Starting Data Ingestion Stage<<<<<<<<<<<<<
[2024-11-11 09:45:18,493] INFO: common : 32] Successfully loaded yaml file: config\config.yaml
[2024-11-11 09:45:18,493] INFO: common : 32] Successfully loaded yaml file: params.yaml
[2024-11-11 09:45:18,500] INFO: common : 32] Successfully loaded yaml file: schema.yaml
[2024-11-11 09:45:18,501] INFO: common : 55] Created directory: artifacts
[2024-11-11 09:45:18,502] INFO: common : 55] Created directory: artifacts/data_ingestion
[2024-11-11 09:45:18,503] INFO: data_ingestion : 17] Loading customers data...
[2024-11-11 09:45:18,598] INFO: common : 79] Successfully loaded DataFrame from: data\customers.csv
[2024-11-11 09:45:18,599] INFO: data_ingestion : 20] Loading loans data...
[2024-11-11 09:45:18,731] INFO: common : 79] Successfully loaded DataFrame from: data\loans.csv
[2024-11-11 09:45:18,731] INFO: data_ingestion : 23] Loading bureau data...
[2024-11-11 09:45:18,773] INFO: common : 79] Successfully loaded DataFrame from: data\bureau_data.csv
[2024-11-11 09:45:18,773] INFO: data_ingestion : 26] The Shape of customers data: (50000, 12)
[2024-11-11 09:45:18,773] INFO: data_ingestion : 27] The Shape of loans data: (50000, 15)
[2024-11-11 09:45:18,782] INFO: data_ingestion : 28] The Shape of bureau data: (50000, 8)
[2024-11-11 09:45:19,337] INFO: common : 97] Successfully saved DataFrame to: artifacts\data_ingestion\data.csv
[2024-11-11 09:45:19,353] INFO: main : 14] >>>>>>>>>>>Completed Data Ingestion Stage<<<<<<<<<<<<<
[2024-11-11 09:45:19,362] INFO: main : 24] >>>>>>>>>>>Starting Data Pre-Processing Stage<<<<<<<<<<<<<
[2024-11-11 09:45:19,365] INFO: common : 32] Successfully loaded yaml file: config\config.yaml
[2024-11-11 09:45:19,367] INFO: common : 32] Successfully loaded yaml file: params.yaml
[2024-11-11 09:45:19,370] INFO: common : 32] Successfully loaded yaml file: schema.yaml
[2024-11-11 09:45:19,371] INFO: common : 55] Created directory: artifacts
[2024-11-11 09:45:19,371] INFO: common : 55] Created directory: artifacts/data_preprocessing
[2024-11-11 09:45:19,597] INFO: common : 79] Successfully loaded DataFrame from: artifacts\data_ingestion\data.csv
[2024-11-11 09:45:19,597] INFO: data_preprocessing : 26] The Valure counts for 'default' column: default
0    45703
1     4297
Name: count, dtype: int64
[2024-11-11 09:45:19,609] INFO: data_preprocessing : 42] No missing values found in column 'cust_id'
[2024-11-11 09:45:19,611] INFO: data_preprocessing : 42] No missing values found in column 'age'
[2024-11-11 09:45:19,613] INFO: data_preprocessing : 42] No missing values found in column 'gender'
[2024-11-11 09:45:19,617] INFO: data_preprocessing : 42] No missing values found in column 'marital_status'
[2024-11-11 09:45:19,619] INFO: data_preprocessing : 42] No missing values found in column 'employment_status'
[2024-11-11 09:45:19,619] INFO: data_preprocessing : 42] No missing values found in column 'income'
[2024-11-11 09:45:19,619] INFO: data_preprocessing : 42] No missing values found in column 'number_of_dependants'
[2024-11-11 09:45:19,625] WARNING: data_preprocessing : 33] Missing values found in column 'residence_type', replacing with 'Unknown'
[2024-11-11 09:45:19,638] INFO: data_preprocessing : 35] Missing values replaced in column 'residence_type' with mode 'Owned'
[2024-11-11 09:45:19,639] INFO: data_preprocessing : 42] No missing values found in column 'years_at_current_address'
[2024-11-11 09:45:19,642] INFO: data_preprocessing : 42] No missing values found in column 'city'
[2024-11-11 09:45:19,645] INFO: data_preprocessing : 42] No missing values found in column 'state'
[2024-11-11 09:45:19,646] INFO: data_preprocessing : 42] No missing values found in column 'zipcode'
[2024-11-11 09:45:19,649] INFO: data_preprocessing : 42] No missing values found in column 'loan_id'
[2024-11-11 09:45:19,651] INFO: data_preprocessing : 42] No missing values found in column 'loan_purpose'
[2024-11-11 09:45:19,655] INFO: data_preprocessing : 42] No missing values found in column 'loan_type'
[2024-11-11 09:45:19,656] INFO: data_preprocessing : 42] No missing values found in column 'sanction_amount'
[2024-11-11 09:45:19,657] INFO: data_preprocessing : 42] No missing values found in column 'loan_amount'
[2024-11-11 09:45:19,657] INFO: data_preprocessing : 42] No missing values found in column 'processing_fee'
[2024-11-11 09:45:19,658] INFO: data_preprocessing : 42] No missing values found in column 'gst'
[2024-11-11 09:45:19,658] INFO: data_preprocessing : 42] No missing values found in column 'net_disbursement'
[2024-11-11 09:45:19,659] INFO: data_preprocessing : 42] No missing values found in column 'loan_tenure_months'
[2024-11-11 09:45:19,659] INFO: data_preprocessing : 42] No missing values found in column 'principal_outstanding'
[2024-11-11 09:45:19,659] INFO: data_preprocessing : 42] No missing values found in column 'bank_balance_at_application'
[2024-11-11 09:45:19,663] INFO: data_preprocessing : 42] No missing values found in column 'disbursal_date'
[2024-11-11 09:45:19,666] INFO: data_preprocessing : 42] No missing values found in column 'installment_start_dt'
[2024-11-11 09:45:19,667] INFO: data_preprocessing : 42] No missing values found in column 'default'
[2024-11-11 09:45:19,667] INFO: data_preprocessing : 42] No missing values found in column 'number_of_open_accounts'
[2024-11-11 09:45:19,669] INFO: data_preprocessing : 42] No missing values found in column 'number_of_closed_accounts'
[2024-11-11 09:45:19,670] INFO: data_preprocessing : 42] No missing values found in column 'total_loan_months'
[2024-11-11 09:45:19,670] INFO: data_preprocessing : 42] No missing values found in column 'delinquent_months'
[2024-11-11 09:45:19,671] INFO: data_preprocessing : 42] No missing values found in column 'total_dpd'
[2024-11-11 09:45:19,671] INFO: data_preprocessing : 42] No missing values found in column 'enquiry_count'
[2024-11-11 09:45:19,672] INFO: data_preprocessing : 42] No missing values found in column 'credit_utilization_ratio'
[2024-11-11 09:45:19,740] INFO: data_preprocessing : 51] No duplicate rows found
[2024-11-11 09:45:19,740] INFO: data_preprocessing : 53] Index(['cust_id', 'age', 'gender', 'marital_status', 'employment_status',
       'income', 'number_of_dependants', 'residence_type',
       'years_at_current_address', 'city', 'state', 'zipcode', 'loan_id',
       'loan_purpose', 'loan_type', 'sanction_amount', 'loan_amount',
       'processing_fee', 'gst', 'net_disbursement', 'loan_tenure_months',
       'principal_outstanding', 'bank_balance_at_application',
       'disbursal_date', 'installment_start_dt', 'default',
       'number_of_open_accounts', 'number_of_closed_accounts',
       'total_loan_months', 'delinquent_months', 'total_dpd', 'enquiry_count',
       'credit_utilization_ratio'],
      dtype='object')
[2024-11-11 09:45:20,294] INFO: common : 97] Successfully saved DataFrame to: artifacts\data_preprocessing\preprocessed_data.csv
[2024-11-11 09:45:20,294] INFO: main : 26] >>>>>>>>>>>Completed Data Pre-Processing Stage<<<<<<<<<<<<<
[2024-11-11 09:45:20,294] INFO: main : 36] >>>>>>>>>>>Starting Data Cleaning Stage<<<<<<<<<<<<<
[2024-11-11 09:45:20,294] INFO: common : 32] Successfully loaded yaml file: config\config.yaml
[2024-11-11 09:45:20,307] INFO: common : 32] Successfully loaded yaml file: params.yaml
[2024-11-11 09:45:20,310] INFO: common : 32] Successfully loaded yaml file: schema.yaml
[2024-11-11 09:45:20,312] INFO: common : 55] Created directory: artifacts
[2024-11-11 09:45:20,313] INFO: common : 55] Created directory: artifacts/data_cleaning
[2024-11-11 09:45:20,526] INFO: common : 79] Successfully loaded DataFrame from: artifacts\data_preprocessing\preprocessed_data.csv
[2024-11-11 09:45:20,526] INFO: data_cleaning : 34] Initiating train test split...
[2024-11-11 09:45:20,560] INFO: data_cleaning : 36] Train test split completed successfully.
[2024-11-11 09:45:20,561] INFO: data_cleaning : 77] Train_df :Index(['cust_id', 'age', 'gender', 'marital_status', 'employment_status',
       'income', 'number_of_dependants', 'residence_type',
       'years_at_current_address', 'city', 'state', 'zipcode', 'loan_id',
       'loan_purpose', 'loan_type', 'sanction_amount', 'loan_amount',
       'processing_fee', 'gst', 'net_disbursement', 'loan_tenure_months',
       'principal_outstanding', 'bank_balance_at_application',
       'disbursal_date', 'installment_start_dt', 'default',
       'number_of_open_accounts', 'number_of_closed_accounts',
       'total_loan_months', 'delinquent_months', 'total_dpd', 'enquiry_count',
       'credit_utilization_ratio'],
      dtype='object')
[2024-11-11 09:45:20,584] INFO: data_cleaning : 82]  After outlier removal train_df :(40000, 33)
[2024-11-11 09:45:20,584] INFO: data_cleaning : 83]  After outlier removal test_df :(10000, 33)
[2024-11-11 09:45:20,584] INFO: data_cleaning : 88] Rule 1: GST should not be more than 20% :(0, 33)
[2024-11-11 09:45:20,584] INFO: data_cleaning : 92] Rule 2: Net disbursement should not be higher than loan_amount :(0, 33)
[2024-11-11 09:45:20,603] INFO: data_cleaning : 97] Rule 3 : Fixed loan_purpose column :loan_purpose
Personal     14037
Home         12006
Auto          7950
Education     6007
Name: count, dtype: int64
[2024-11-11 09:45:20,606] INFO: data_cleaning : 102] Rule 4 : Generated loan_to_income column(LTI)
[2024-11-11 09:45:20,616] INFO: data_cleaning : 107] Generated delinquency_ratio column :count    40000.000000
mean        10.424123
std         17.283345
min          0.000000
25%          0.000000
50%          3.800000
75%         13.200000
max        100.000000
Name: delinquency_ratio, dtype: float64
[2024-11-11 09:45:20,627] INFO: data_cleaning : 121] Generated avg_dpd_per_delinquency column :count    40000.000000
mean         3.303845
std          2.902944
min          0.000000
25%          0.000000
50%          4.300000
75%          5.800000
max         10.000000
Name: avg_dpd_per_delinquency, dtype: float64
[2024-11-11 09:45:20,628] INFO: data_cleaning : 44] Removing columns...
[2024-11-11 09:45:20,632] INFO: data_cleaning : 46] Columns removed successfully.
[2024-11-11 09:45:20,634] INFO: data_cleaning : 44] Removing columns...
[2024-11-11 09:45:20,636] INFO: data_cleaning : 46] Columns removed successfully.
[2024-11-11 09:45:20,636] ERROR: data_cleaning : 65] Dtype mismatch in 'age': Expected int, got int64
[2024-11-11 09:45:20,638] ERROR: data_cleaning : 65] Dtype mismatch in 'residence_type': Expected category, got object
[2024-11-11 09:45:20,638] ERROR: data_cleaning : 65] Dtype mismatch in 'loan_purpose': Expected category, got object
[2024-11-11 09:45:20,639] ERROR: data_cleaning : 65] Dtype mismatch in 'loan_type': Expected category, got object
[2024-11-11 09:45:20,639] ERROR: data_cleaning : 65] Dtype mismatch in 'loan_tenure_months': Expected int, got int64
[2024-11-11 09:45:20,640] ERROR: data_cleaning : 65] Dtype mismatch in 'number_of_open_accounts': Expected int, got int64
[2024-11-11 09:45:20,640] ERROR: data_cleaning : 65] Dtype mismatch in 'credit_utilization_ratio': Expected float, got int64
[2024-11-11 09:45:20,640] ERROR: main : 41] An unexpected error occurred: CustomException.__init__() missing 1 required positional argument: 'error_detail'
[2024-11-11 09:48:40,171] INFO: __init__ : 26] Credit Risk Model Building Started
[2024-11-11 09:48:42,349] INFO: main : 12] >>>>>>>>>>>Starting Data Ingestion Stage<<<<<<<<<<<<<
[2024-11-11 09:48:42,349] INFO: common : 32] Successfully loaded yaml file: config\config.yaml
[2024-11-11 09:48:42,362] INFO: common : 32] Successfully loaded yaml file: params.yaml
[2024-11-11 09:48:42,368] INFO: common : 32] Successfully loaded yaml file: schema.yaml
[2024-11-11 09:48:42,370] INFO: common : 55] Created directory: artifacts
[2024-11-11 09:48:42,370] INFO: common : 55] Created directory: artifacts/data_ingestion
[2024-11-11 09:48:42,371] INFO: data_ingestion : 17] Loading customers data...
[2024-11-11 09:48:42,483] INFO: common : 79] Successfully loaded DataFrame from: data\customers.csv
[2024-11-11 09:48:42,483] INFO: data_ingestion : 20] Loading loans data...
[2024-11-11 09:48:42,630] INFO: common : 79] Successfully loaded DataFrame from: data\loans.csv
[2024-11-11 09:48:42,630] INFO: data_ingestion : 23] Loading bureau data...
[2024-11-11 09:48:42,683] INFO: common : 79] Successfully loaded DataFrame from: data\bureau_data.csv
[2024-11-11 09:48:42,683] INFO: data_ingestion : 26] The Shape of customers data: (50000, 12)
[2024-11-11 09:48:42,683] INFO: data_ingestion : 27] The Shape of loans data: (50000, 15)
[2024-11-11 09:48:42,683] INFO: data_ingestion : 28] The Shape of bureau data: (50000, 8)
[2024-11-11 09:48:43,396] INFO: common : 97] Successfully saved DataFrame to: artifacts\data_ingestion\data.csv
[2024-11-11 09:48:43,396] INFO: main : 14] >>>>>>>>>>>Completed Data Ingestion Stage<<<<<<<<<<<<<
[2024-11-11 09:48:43,396] INFO: main : 24] >>>>>>>>>>>Starting Data Pre-Processing Stage<<<<<<<<<<<<<
[2024-11-11 09:48:43,413] INFO: common : 32] Successfully loaded yaml file: config\config.yaml
[2024-11-11 09:48:43,415] INFO: common : 32] Successfully loaded yaml file: params.yaml
[2024-11-11 09:48:43,419] INFO: common : 32] Successfully loaded yaml file: schema.yaml
[2024-11-11 09:48:43,420] INFO: common : 55] Created directory: artifacts
[2024-11-11 09:48:43,420] INFO: common : 55] Created directory: artifacts/data_preprocessing
[2024-11-11 09:48:43,644] INFO: common : 79] Successfully loaded DataFrame from: artifacts\data_ingestion\data.csv
[2024-11-11 09:48:43,644] INFO: data_preprocessing : 26] The Valure counts for 'default' column: default
0    45703
1     4297
Name: count, dtype: int64
[2024-11-11 09:48:43,644] INFO: data_preprocessing : 42] No missing values found in column 'cust_id'
[2024-11-11 09:48:43,644] INFO: data_preprocessing : 42] No missing values found in column 'age'
[2024-11-11 09:48:43,656] INFO: data_preprocessing : 42] No missing values found in column 'gender'
[2024-11-11 09:48:43,659] INFO: data_preprocessing : 42] No missing values found in column 'marital_status'
[2024-11-11 09:48:43,663] INFO: data_preprocessing : 42] No missing values found in column 'employment_status'
[2024-11-11 09:48:43,664] INFO: data_preprocessing : 42] No missing values found in column 'income'
[2024-11-11 09:48:43,665] INFO: data_preprocessing : 42] No missing values found in column 'number_of_dependants'
[2024-11-11 09:48:43,668] WARNING: data_preprocessing : 33] Missing values found in column 'residence_type', replacing with 'Unknown'
[2024-11-11 09:48:43,677] INFO: data_preprocessing : 35] Missing values replaced in column 'residence_type' with mode 'Owned'
[2024-11-11 09:48:43,682] INFO: data_preprocessing : 42] No missing values found in column 'years_at_current_address'
[2024-11-11 09:48:43,685] INFO: data_preprocessing : 42] No missing values found in column 'city'
[2024-11-11 09:48:43,689] INFO: data_preprocessing : 42] No missing values found in column 'state'
[2024-11-11 09:48:43,689] INFO: data_preprocessing : 42] No missing values found in column 'zipcode'
[2024-11-11 09:48:43,693] INFO: data_preprocessing : 42] No missing values found in column 'loan_id'
[2024-11-11 09:48:43,695] INFO: data_preprocessing : 42] No missing values found in column 'loan_purpose'
[2024-11-11 09:48:43,698] INFO: data_preprocessing : 42] No missing values found in column 'loan_type'
[2024-11-11 09:48:43,699] INFO: data_preprocessing : 42] No missing values found in column 'sanction_amount'
[2024-11-11 09:48:43,701] INFO: data_preprocessing : 42] No missing values found in column 'loan_amount'
[2024-11-11 09:48:43,702] INFO: data_preprocessing : 42] No missing values found in column 'processing_fee'
[2024-11-11 09:48:43,703] INFO: data_preprocessing : 42] No missing values found in column 'gst'
[2024-11-11 09:48:43,703] INFO: data_preprocessing : 42] No missing values found in column 'net_disbursement'
[2024-11-11 09:48:43,703] INFO: data_preprocessing : 42] No missing values found in column 'loan_tenure_months'
[2024-11-11 09:48:43,703] INFO: data_preprocessing : 42] No missing values found in column 'principal_outstanding'
[2024-11-11 09:48:43,706] INFO: data_preprocessing : 42] No missing values found in column 'bank_balance_at_application'
[2024-11-11 09:48:43,709] INFO: data_preprocessing : 42] No missing values found in column 'disbursal_date'
[2024-11-11 09:48:43,712] INFO: data_preprocessing : 42] No missing values found in column 'installment_start_dt'
[2024-11-11 09:48:43,712] INFO: data_preprocessing : 42] No missing values found in column 'default'
[2024-11-11 09:48:43,712] INFO: data_preprocessing : 42] No missing values found in column 'number_of_open_accounts'
[2024-11-11 09:48:43,712] INFO: data_preprocessing : 42] No missing values found in column 'number_of_closed_accounts'
[2024-11-11 09:48:43,712] INFO: data_preprocessing : 42] No missing values found in column 'total_loan_months'
[2024-11-11 09:48:43,715] INFO: data_preprocessing : 42] No missing values found in column 'delinquent_months'
[2024-11-11 09:48:43,715] INFO: data_preprocessing : 42] No missing values found in column 'total_dpd'
[2024-11-11 09:48:43,716] INFO: data_preprocessing : 42] No missing values found in column 'enquiry_count'
[2024-11-11 09:48:43,718] INFO: data_preprocessing : 42] No missing values found in column 'credit_utilization_ratio'
[2024-11-11 09:48:43,789] INFO: data_preprocessing : 51] No duplicate rows found
[2024-11-11 09:48:43,789] INFO: data_preprocessing : 53] Index(['cust_id', 'age', 'gender', 'marital_status', 'employment_status',
       'income', 'number_of_dependants', 'residence_type',
       'years_at_current_address', 'city', 'state', 'zipcode', 'loan_id',
       'loan_purpose', 'loan_type', 'sanction_amount', 'loan_amount',
       'processing_fee', 'gst', 'net_disbursement', 'loan_tenure_months',
       'principal_outstanding', 'bank_balance_at_application',
       'disbursal_date', 'installment_start_dt', 'default',
       'number_of_open_accounts', 'number_of_closed_accounts',
       'total_loan_months', 'delinquent_months', 'total_dpd', 'enquiry_count',
       'credit_utilization_ratio'],
      dtype='object')
[2024-11-11 09:48:44,340] INFO: common : 97] Successfully saved DataFrame to: artifacts\data_preprocessing\preprocessed_data.csv
[2024-11-11 09:48:44,340] INFO: main : 26] >>>>>>>>>>>Completed Data Pre-Processing Stage<<<<<<<<<<<<<
[2024-11-11 09:48:44,340] INFO: main : 36] >>>>>>>>>>>Starting Data Cleaning Stage<<<<<<<<<<<<<
[2024-11-11 09:48:44,354] INFO: common : 32] Successfully loaded yaml file: config\config.yaml
[2024-11-11 09:48:44,355] INFO: common : 32] Successfully loaded yaml file: params.yaml
[2024-11-11 09:48:44,355] INFO: common : 32] Successfully loaded yaml file: schema.yaml
[2024-11-11 09:48:44,355] INFO: common : 55] Created directory: artifacts
[2024-11-11 09:48:44,355] INFO: common : 55] Created directory: artifacts/data_cleaning
[2024-11-11 09:48:44,594] INFO: common : 79] Successfully loaded DataFrame from: artifacts\data_preprocessing\preprocessed_data.csv
[2024-11-11 09:48:44,594] INFO: data_cleaning : 34] Initiating train test split...
[2024-11-11 09:48:44,614] INFO: data_cleaning : 36] Train test split completed successfully.
[2024-11-11 09:48:44,615] INFO: data_cleaning : 91] Train_df :Index(['cust_id', 'age', 'gender', 'marital_status', 'employment_status',
       'income', 'number_of_dependants', 'residence_type',
       'years_at_current_address', 'city', 'state', 'zipcode', 'loan_id',
       'loan_purpose', 'loan_type', 'sanction_amount', 'loan_amount',
       'processing_fee', 'gst', 'net_disbursement', 'loan_tenure_months',
       'principal_outstanding', 'bank_balance_at_application',
       'disbursal_date', 'installment_start_dt', 'default',
       'number_of_open_accounts', 'number_of_closed_accounts',
       'total_loan_months', 'delinquent_months', 'total_dpd', 'enquiry_count',
       'credit_utilization_ratio'],
      dtype='object')
[2024-11-11 09:48:44,637] INFO: data_cleaning : 96]  After outlier removal train_df :(40000, 33)
[2024-11-11 09:48:44,638] INFO: data_cleaning : 97]  After outlier removal test_df :(10000, 33)
[2024-11-11 09:48:44,639] INFO: data_cleaning : 102] Rule 1: GST should not be more than 20% :(0, 33)
[2024-11-11 09:48:44,640] INFO: data_cleaning : 106] Rule 2: Net disbursement should not be higher than loan_amount :(0, 33)
[2024-11-11 09:48:44,651] INFO: data_cleaning : 111] Rule 3 : Fixed loan_purpose column :loan_purpose
Personal     14037
Home         12006
Auto          7950
Education     6007
Name: count, dtype: int64
[2024-11-11 09:48:44,654] INFO: data_cleaning : 116] Rule 4 : Generated loan_to_income column(LTI)
[2024-11-11 09:48:44,661] INFO: data_cleaning : 121] Generated delinquency_ratio column :count    40000.000000
mean        10.424123
std         17.283345
min          0.000000
25%          0.000000
50%          3.800000
75%         13.200000
max        100.000000
Name: delinquency_ratio, dtype: float64
[2024-11-11 09:48:44,667] INFO: data_cleaning : 135] Generated avg_dpd_per_delinquency column :count    40000.000000
mean         3.303845
std          2.902944
min          0.000000
25%          0.000000
50%          4.300000
75%          5.800000
max         10.000000
Name: avg_dpd_per_delinquency, dtype: float64
[2024-11-11 09:48:44,667] INFO: data_cleaning : 44] Removing columns...
[2024-11-11 09:48:44,673] INFO: data_cleaning : 46] Columns removed successfully.
[2024-11-11 09:48:44,675] INFO: data_cleaning : 44] Removing columns...
[2024-11-11 09:48:44,676] INFO: data_cleaning : 46] Columns removed successfully.
[2024-11-11 09:48:44,677] ERROR: data_cleaning : 72] Dtype mismatch in 'age': Expected int, got int64
[2024-11-11 09:48:44,679] INFO: data_cleaning : 76] Converted column 'age' to int.
[2024-11-11 09:48:44,679] ERROR: data_cleaning : 72] Dtype mismatch in 'residence_type': Expected category, got object
[2024-11-11 09:48:44,687] INFO: data_cleaning : 76] Converted column 'residence_type' to category.
[2024-11-11 09:48:44,688] ERROR: data_cleaning : 72] Dtype mismatch in 'loan_purpose': Expected category, got object
[2024-11-11 09:48:44,690] INFO: data_cleaning : 76] Converted column 'loan_purpose' to category.
[2024-11-11 09:48:44,690] ERROR: data_cleaning : 72] Dtype mismatch in 'loan_type': Expected category, got object
[2024-11-11 09:48:44,695] INFO: data_cleaning : 76] Converted column 'loan_type' to category.
[2024-11-11 09:48:44,695] ERROR: data_cleaning : 72] Dtype mismatch in 'loan_tenure_months': Expected int, got int64
[2024-11-11 09:48:44,696] INFO: data_cleaning : 76] Converted column 'loan_tenure_months' to int.
[2024-11-11 09:48:44,697] ERROR: data_cleaning : 72] Dtype mismatch in 'number_of_open_accounts': Expected int, got int64
[2024-11-11 09:48:44,698] INFO: data_cleaning : 76] Converted column 'number_of_open_accounts' to int.
[2024-11-11 09:48:44,699] ERROR: data_cleaning : 72] Dtype mismatch in 'credit_utilization_ratio': Expected float, got int64
[2024-11-11 09:48:44,700] INFO: data_cleaning : 76] Converted column 'credit_utilization_ratio' to float.
[2024-11-11 09:48:44,701] INFO: data_cleaning : 81] Schema validation successful: Columns and dtypes match.
[2024-11-11 09:48:44,702] ERROR: data_cleaning : 72] Dtype mismatch in 'age': Expected int, got int64
[2024-11-11 09:48:44,703] INFO: data_cleaning : 76] Converted column 'age' to int.
[2024-11-11 09:48:44,703] ERROR: data_cleaning : 72] Dtype mismatch in 'residence_type': Expected category, got object
[2024-11-11 09:48:44,703] INFO: data_cleaning : 76] Converted column 'residence_type' to category.
[2024-11-11 09:48:44,703] ERROR: data_cleaning : 72] Dtype mismatch in 'loan_purpose': Expected category, got object
[2024-11-11 09:48:44,703] INFO: data_cleaning : 76] Converted column 'loan_purpose' to category.
[2024-11-11 09:48:44,703] ERROR: data_cleaning : 72] Dtype mismatch in 'loan_type': Expected category, got object
[2024-11-11 09:48:44,711] INFO: data_cleaning : 76] Converted column 'loan_type' to category.
[2024-11-11 09:48:44,711] ERROR: data_cleaning : 72] Dtype mismatch in 'loan_tenure_months': Expected int, got int64
[2024-11-11 09:48:44,711] INFO: data_cleaning : 76] Converted column 'loan_tenure_months' to int.
[2024-11-11 09:48:44,711] ERROR: data_cleaning : 72] Dtype mismatch in 'number_of_open_accounts': Expected int, got int64
[2024-11-11 09:48:44,713] INFO: data_cleaning : 76] Converted column 'number_of_open_accounts' to int.
[2024-11-11 09:48:44,714] ERROR: data_cleaning : 72] Dtype mismatch in 'credit_utilization_ratio': Expected float, got int64
[2024-11-11 09:48:44,714] INFO: data_cleaning : 76] Converted column 'credit_utilization_ratio' to float.
[2024-11-11 09:48:44,715] INFO: data_cleaning : 81] Schema validation successful: Columns and dtypes match.
[2024-11-11 09:48:44,719] INFO: data_cleaning : 164] Categorical Columns : Index([], dtype='object')
[2024-11-11 09:48:44,721] INFO: data_cleaning : 165] Numerical Columns : Index(['credit_utilization_ratio', 'loan_to_income', 'delinquency_ratio',
       'avg_dpd_per_delinquency'],
      dtype='object')
[2024-11-11 09:48:44,735] ERROR: main : 41] An unexpected error occurred: cannot concatenate object of type '<class 'numpy.ndarray'>'; only Series and DataFrame objs are valid
[2024-11-11 09:50:49,304] INFO: __init__ : 26] Credit Risk Model Building Started
[2024-11-11 09:50:51,572] INFO: main : 12] >>>>>>>>>>>Starting Data Ingestion Stage<<<<<<<<<<<<<
[2024-11-11 09:50:51,572] INFO: common : 32] Successfully loaded yaml file: config\config.yaml
[2024-11-11 09:50:51,572] INFO: common : 32] Successfully loaded yaml file: params.yaml
[2024-11-11 09:50:51,587] INFO: common : 32] Successfully loaded yaml file: schema.yaml
[2024-11-11 09:50:51,588] INFO: common : 55] Created directory: artifacts
[2024-11-11 09:50:51,589] INFO: common : 55] Created directory: artifacts/data_ingestion
[2024-11-11 09:50:51,590] INFO: data_ingestion : 17] Loading customers data...
[2024-11-11 09:50:51,701] INFO: common : 79] Successfully loaded DataFrame from: data\customers.csv
[2024-11-11 09:50:51,701] INFO: data_ingestion : 20] Loading loans data...
[2024-11-11 09:50:51,837] INFO: common : 79] Successfully loaded DataFrame from: data\loans.csv
[2024-11-11 09:50:51,837] INFO: data_ingestion : 23] Loading bureau data...
[2024-11-11 09:50:51,901] INFO: common : 79] Successfully loaded DataFrame from: data\bureau_data.csv
[2024-11-11 09:50:51,903] INFO: data_ingestion : 26] The Shape of customers data: (50000, 12)
[2024-11-11 09:50:51,903] INFO: data_ingestion : 27] The Shape of loans data: (50000, 15)
[2024-11-11 09:50:51,903] INFO: data_ingestion : 28] The Shape of bureau data: (50000, 8)
[2024-11-11 09:50:52,523] INFO: common : 97] Successfully saved DataFrame to: artifacts\data_ingestion\data.csv
[2024-11-11 09:50:52,533] INFO: main : 14] >>>>>>>>>>>Completed Data Ingestion Stage<<<<<<<<<<<<<
[2024-11-11 09:50:52,534] INFO: main : 24] >>>>>>>>>>>Starting Data Pre-Processing Stage<<<<<<<<<<<<<
[2024-11-11 09:50:52,538] INFO: common : 32] Successfully loaded yaml file: config\config.yaml
[2024-11-11 09:50:52,541] INFO: common : 32] Successfully loaded yaml file: params.yaml
[2024-11-11 09:50:52,544] INFO: common : 32] Successfully loaded yaml file: schema.yaml
[2024-11-11 09:50:52,545] INFO: common : 55] Created directory: artifacts
[2024-11-11 09:50:52,546] INFO: common : 55] Created directory: artifacts/data_preprocessing
[2024-11-11 09:50:52,776] INFO: common : 79] Successfully loaded DataFrame from: artifacts\data_ingestion\data.csv
[2024-11-11 09:50:52,791] INFO: data_preprocessing : 26] The Valure counts for 'default' column: default
0    45703
1     4297
Name: count, dtype: int64
[2024-11-11 09:50:52,791] INFO: data_preprocessing : 42] No missing values found in column 'cust_id'
[2024-11-11 09:50:52,791] INFO: data_preprocessing : 42] No missing values found in column 'age'
[2024-11-11 09:50:52,801] INFO: data_preprocessing : 42] No missing values found in column 'gender'
[2024-11-11 09:50:52,805] INFO: data_preprocessing : 42] No missing values found in column 'marital_status'
[2024-11-11 09:50:52,808] INFO: data_preprocessing : 42] No missing values found in column 'employment_status'
[2024-11-11 09:50:52,809] INFO: data_preprocessing : 42] No missing values found in column 'income'
[2024-11-11 09:50:52,810] INFO: data_preprocessing : 42] No missing values found in column 'number_of_dependants'
[2024-11-11 09:50:52,812] WARNING: data_preprocessing : 33] Missing values found in column 'residence_type', replacing with 'Unknown'
[2024-11-11 09:50:52,823] INFO: data_preprocessing : 35] Missing values replaced in column 'residence_type' with mode 'Owned'
[2024-11-11 09:50:52,823] INFO: data_preprocessing : 42] No missing values found in column 'years_at_current_address'
[2024-11-11 09:50:52,829] INFO: data_preprocessing : 42] No missing values found in column 'city'
[2024-11-11 09:50:52,835] INFO: data_preprocessing : 42] No missing values found in column 'state'
[2024-11-11 09:50:52,835] INFO: data_preprocessing : 42] No missing values found in column 'zipcode'
[2024-11-11 09:50:52,835] INFO: data_preprocessing : 42] No missing values found in column 'loan_id'
[2024-11-11 09:50:52,850] INFO: data_preprocessing : 42] No missing values found in column 'loan_purpose'
[2024-11-11 09:50:52,854] INFO: data_preprocessing : 42] No missing values found in column 'loan_type'
[2024-11-11 09:50:52,854] INFO: data_preprocessing : 42] No missing values found in column 'sanction_amount'
[2024-11-11 09:50:52,854] INFO: data_preprocessing : 42] No missing values found in column 'loan_amount'
[2024-11-11 09:50:52,854] INFO: data_preprocessing : 42] No missing values found in column 'processing_fee'
[2024-11-11 09:50:52,854] INFO: data_preprocessing : 42] No missing values found in column 'gst'
[2024-11-11 09:50:52,854] INFO: data_preprocessing : 42] No missing values found in column 'net_disbursement'
[2024-11-11 09:50:52,854] INFO: data_preprocessing : 42] No missing values found in column 'loan_tenure_months'
[2024-11-11 09:50:52,854] INFO: data_preprocessing : 42] No missing values found in column 'principal_outstanding'
[2024-11-11 09:50:52,866] INFO: data_preprocessing : 42] No missing values found in column 'bank_balance_at_application'
[2024-11-11 09:50:52,871] INFO: data_preprocessing : 42] No missing values found in column 'disbursal_date'
[2024-11-11 09:50:52,873] INFO: data_preprocessing : 42] No missing values found in column 'installment_start_dt'
[2024-11-11 09:50:52,873] INFO: data_preprocessing : 42] No missing values found in column 'default'
[2024-11-11 09:50:52,873] INFO: data_preprocessing : 42] No missing values found in column 'number_of_open_accounts'
[2024-11-11 09:50:52,873] INFO: data_preprocessing : 42] No missing values found in column 'number_of_closed_accounts'
[2024-11-11 09:50:52,873] INFO: data_preprocessing : 42] No missing values found in column 'total_loan_months'
[2024-11-11 09:50:52,873] INFO: data_preprocessing : 42] No missing values found in column 'delinquent_months'
[2024-11-11 09:50:52,882] INFO: data_preprocessing : 42] No missing values found in column 'total_dpd'
[2024-11-11 09:50:52,884] INFO: data_preprocessing : 42] No missing values found in column 'enquiry_count'
[2024-11-11 09:50:52,885] INFO: data_preprocessing : 42] No missing values found in column 'credit_utilization_ratio'
[2024-11-11 09:50:52,952] INFO: data_preprocessing : 51] No duplicate rows found
[2024-11-11 09:50:52,966] INFO: data_preprocessing : 53] Index(['cust_id', 'age', 'gender', 'marital_status', 'employment_status',
       'income', 'number_of_dependants', 'residence_type',
       'years_at_current_address', 'city', 'state', 'zipcode', 'loan_id',
       'loan_purpose', 'loan_type', 'sanction_amount', 'loan_amount',
       'processing_fee', 'gst', 'net_disbursement', 'loan_tenure_months',
       'principal_outstanding', 'bank_balance_at_application',
       'disbursal_date', 'installment_start_dt', 'default',
       'number_of_open_accounts', 'number_of_closed_accounts',
       'total_loan_months', 'delinquent_months', 'total_dpd', 'enquiry_count',
       'credit_utilization_ratio'],
      dtype='object')
[2024-11-11 09:50:53,497] INFO: common : 97] Successfully saved DataFrame to: artifacts\data_preprocessing\preprocessed_data.csv
[2024-11-11 09:50:53,514] INFO: main : 26] >>>>>>>>>>>Completed Data Pre-Processing Stage<<<<<<<<<<<<<
[2024-11-11 09:50:53,516] INFO: main : 36] >>>>>>>>>>>Starting Data Cleaning Stage<<<<<<<<<<<<<
[2024-11-11 09:50:53,520] INFO: common : 32] Successfully loaded yaml file: config\config.yaml
[2024-11-11 09:50:53,522] INFO: common : 32] Successfully loaded yaml file: params.yaml
[2024-11-11 09:50:53,526] INFO: common : 32] Successfully loaded yaml file: schema.yaml
[2024-11-11 09:50:53,526] INFO: common : 55] Created directory: artifacts
[2024-11-11 09:50:53,526] INFO: common : 55] Created directory: artifacts/data_cleaning
[2024-11-11 09:50:53,759] INFO: common : 79] Successfully loaded DataFrame from: artifacts\data_preprocessing\preprocessed_data.csv
[2024-11-11 09:50:53,759] INFO: data_cleaning : 34] Initiating train test split...
[2024-11-11 09:50:53,791] INFO: data_cleaning : 36] Train test split completed successfully.
[2024-11-11 09:50:53,792] INFO: data_cleaning : 91] Train_df :Index(['cust_id', 'age', 'gender', 'marital_status', 'employment_status',
       'income', 'number_of_dependants', 'residence_type',
       'years_at_current_address', 'city', 'state', 'zipcode', 'loan_id',
       'loan_purpose', 'loan_type', 'sanction_amount', 'loan_amount',
       'processing_fee', 'gst', 'net_disbursement', 'loan_tenure_months',
       'principal_outstanding', 'bank_balance_at_application',
       'disbursal_date', 'installment_start_dt', 'default',
       'number_of_open_accounts', 'number_of_closed_accounts',
       'total_loan_months', 'delinquent_months', 'total_dpd', 'enquiry_count',
       'credit_utilization_ratio'],
      dtype='object')
[2024-11-11 09:50:53,808] INFO: data_cleaning : 96]  After outlier removal train_df :(40000, 33)
[2024-11-11 09:50:53,808] INFO: data_cleaning : 97]  After outlier removal test_df :(10000, 33)
[2024-11-11 09:50:53,812] INFO: data_cleaning : 102] Rule 1: GST should not be more than 20% :(0, 33)
[2024-11-11 09:50:53,813] INFO: data_cleaning : 106] Rule 2: Net disbursement should not be higher than loan_amount :(0, 33)
[2024-11-11 09:50:53,825] INFO: data_cleaning : 111] Rule 3 : Fixed loan_purpose column :loan_purpose
Personal     14037
Home         12006
Auto          7950
Education     6007
Name: count, dtype: int64
[2024-11-11 09:50:53,825] INFO: data_cleaning : 116] Rule 4 : Generated loan_to_income column(LTI)
[2024-11-11 09:50:53,837] INFO: data_cleaning : 121] Generated delinquency_ratio column :count    40000.000000
mean        10.424123
std         17.283345
min          0.000000
25%          0.000000
50%          3.800000
75%         13.200000
max        100.000000
Name: delinquency_ratio, dtype: float64
[2024-11-11 09:50:53,845] INFO: data_cleaning : 135] Generated avg_dpd_per_delinquency column :count    40000.000000
mean         3.303845
std          2.902944
min          0.000000
25%          0.000000
50%          4.300000
75%          5.800000
max         10.000000
Name: avg_dpd_per_delinquency, dtype: float64
[2024-11-11 09:50:53,847] INFO: data_cleaning : 44] Removing columns...
[2024-11-11 09:50:53,850] INFO: data_cleaning : 46] Columns removed successfully.
[2024-11-11 09:50:53,854] INFO: data_cleaning : 44] Removing columns...
[2024-11-11 09:50:53,855] INFO: data_cleaning : 46] Columns removed successfully.
[2024-11-11 09:50:53,858] ERROR: data_cleaning : 72] Dtype mismatch in 'age': Expected int, got int64
[2024-11-11 09:50:53,859] INFO: data_cleaning : 76] Converted column 'age' to int.
[2024-11-11 09:50:53,859] ERROR: data_cleaning : 72] Dtype mismatch in 'residence_type': Expected category, got object
[2024-11-11 09:50:53,865] INFO: data_cleaning : 76] Converted column 'residence_type' to category.
[2024-11-11 09:50:53,865] ERROR: data_cleaning : 72] Dtype mismatch in 'loan_purpose': Expected category, got object
[2024-11-11 09:50:53,870] INFO: data_cleaning : 76] Converted column 'loan_purpose' to category.
[2024-11-11 09:50:53,871] ERROR: data_cleaning : 72] Dtype mismatch in 'loan_type': Expected category, got object
[2024-11-11 09:50:53,874] INFO: data_cleaning : 76] Converted column 'loan_type' to category.
[2024-11-11 09:50:53,874] ERROR: data_cleaning : 72] Dtype mismatch in 'loan_tenure_months': Expected int, got int64
[2024-11-11 09:50:53,874] INFO: data_cleaning : 76] Converted column 'loan_tenure_months' to int.
[2024-11-11 09:50:53,874] ERROR: data_cleaning : 72] Dtype mismatch in 'number_of_open_accounts': Expected int, got int64
[2024-11-11 09:50:53,874] INFO: data_cleaning : 76] Converted column 'number_of_open_accounts' to int.
[2024-11-11 09:50:53,874] ERROR: data_cleaning : 72] Dtype mismatch in 'credit_utilization_ratio': Expected float, got int64
[2024-11-11 09:50:53,874] INFO: data_cleaning : 76] Converted column 'credit_utilization_ratio' to float.
[2024-11-11 09:50:53,874] INFO: data_cleaning : 81] Schema validation successful: Columns and dtypes match.
[2024-11-11 09:50:53,874] ERROR: data_cleaning : 72] Dtype mismatch in 'age': Expected int, got int64
[2024-11-11 09:50:53,874] INFO: data_cleaning : 76] Converted column 'age' to int.
[2024-11-11 09:50:53,881] ERROR: data_cleaning : 72] Dtype mismatch in 'residence_type': Expected category, got object
[2024-11-11 09:50:53,882] INFO: data_cleaning : 76] Converted column 'residence_type' to category.
[2024-11-11 09:50:53,883] ERROR: data_cleaning : 72] Dtype mismatch in 'loan_purpose': Expected category, got object
[2024-11-11 09:50:53,885] INFO: data_cleaning : 76] Converted column 'loan_purpose' to category.
[2024-11-11 09:50:53,885] ERROR: data_cleaning : 72] Dtype mismatch in 'loan_type': Expected category, got object
[2024-11-11 09:50:53,887] INFO: data_cleaning : 76] Converted column 'loan_type' to category.
[2024-11-11 09:50:53,887] ERROR: data_cleaning : 72] Dtype mismatch in 'loan_tenure_months': Expected int, got int64
[2024-11-11 09:50:53,888] INFO: data_cleaning : 76] Converted column 'loan_tenure_months' to int.
[2024-11-11 09:50:53,890] ERROR: data_cleaning : 72] Dtype mismatch in 'number_of_open_accounts': Expected int, got int64
[2024-11-11 09:50:53,891] INFO: data_cleaning : 76] Converted column 'number_of_open_accounts' to int.
[2024-11-11 09:50:53,891] ERROR: data_cleaning : 72] Dtype mismatch in 'credit_utilization_ratio': Expected float, got int64
[2024-11-11 09:50:53,891] INFO: data_cleaning : 76] Converted column 'credit_utilization_ratio' to float.
[2024-11-11 09:50:53,892] INFO: data_cleaning : 81] Schema validation successful: Columns and dtypes match.
[2024-11-11 09:50:53,892] INFO: data_cleaning : 164] Categorical Columns : Index(['residence_type', 'loan_purpose', 'loan_type'], dtype='object')
[2024-11-11 09:50:53,892] INFO: data_cleaning : 165] Numerical Columns : Index(['credit_utilization_ratio', 'loan_to_income', 'delinquency_ratio',
       'avg_dpd_per_delinquency'],
      dtype='object')
[2024-11-11 09:50:53,907] ERROR: main : 41] An unexpected error occurred: LabelEncoder.fit_transform() takes 2 positional arguments but 3 were given
[2024-11-11 09:55:33,762] INFO: __init__ : 26] Credit Risk Model Building Started
[2024-11-11 09:55:36,041] INFO: main : 12] >>>>>>>>>>>Starting Data Ingestion Stage<<<<<<<<<<<<<
[2024-11-11 09:55:36,051] INFO: common : 32] Successfully loaded yaml file: config\config.yaml
[2024-11-11 09:55:36,055] INFO: common : 32] Successfully loaded yaml file: params.yaml
[2024-11-11 09:55:36,058] INFO: common : 32] Successfully loaded yaml file: schema.yaml
[2024-11-11 09:55:36,059] INFO: common : 55] Created directory: artifacts
[2024-11-11 09:55:36,060] INFO: common : 55] Created directory: artifacts/data_ingestion
[2024-11-11 09:55:36,060] INFO: data_ingestion : 17] Loading customers data...
[2024-11-11 09:55:36,174] INFO: common : 79] Successfully loaded DataFrame from: data\customers.csv
[2024-11-11 09:55:36,175] INFO: data_ingestion : 20] Loading loans data...
[2024-11-11 09:55:36,316] INFO: common : 79] Successfully loaded DataFrame from: data\loans.csv
[2024-11-11 09:55:36,316] INFO: data_ingestion : 23] Loading bureau data...
[2024-11-11 09:55:36,367] INFO: common : 79] Successfully loaded DataFrame from: data\bureau_data.csv
[2024-11-11 09:55:36,367] INFO: data_ingestion : 26] The Shape of customers data: (50000, 12)
[2024-11-11 09:55:36,367] INFO: data_ingestion : 27] The Shape of loans data: (50000, 15)
[2024-11-11 09:55:36,367] INFO: data_ingestion : 28] The Shape of bureau data: (50000, 8)
[2024-11-11 09:55:36,980] INFO: common : 97] Successfully saved DataFrame to: artifacts\data_ingestion\data.csv
[2024-11-11 09:55:36,980] INFO: main : 14] >>>>>>>>>>>Completed Data Ingestion Stage<<<<<<<<<<<<<
[2024-11-11 09:55:36,980] INFO: main : 24] >>>>>>>>>>>Starting Data Pre-Processing Stage<<<<<<<<<<<<<
[2024-11-11 09:55:36,995] INFO: common : 32] Successfully loaded yaml file: config\config.yaml
[2024-11-11 09:55:36,997] INFO: common : 32] Successfully loaded yaml file: params.yaml
[2024-11-11 09:55:37,002] INFO: common : 32] Successfully loaded yaml file: schema.yaml
[2024-11-11 09:55:37,002] INFO: common : 55] Created directory: artifacts
[2024-11-11 09:55:37,002] INFO: common : 55] Created directory: artifacts/data_preprocessing
[2024-11-11 09:55:37,244] INFO: common : 79] Successfully loaded DataFrame from: artifacts\data_ingestion\data.csv
[2024-11-11 09:55:37,260] INFO: data_preprocessing : 26] The Valure counts for 'default' column: default
0    45703
1     4297
Name: count, dtype: int64
[2024-11-11 09:55:37,266] INFO: data_preprocessing : 42] No missing values found in column 'cust_id'
[2024-11-11 09:55:37,267] INFO: data_preprocessing : 42] No missing values found in column 'age'
[2024-11-11 09:55:37,270] INFO: data_preprocessing : 42] No missing values found in column 'gender'
[2024-11-11 09:55:37,275] INFO: data_preprocessing : 42] No missing values found in column 'marital_status'
[2024-11-11 09:55:37,278] INFO: data_preprocessing : 42] No missing values found in column 'employment_status'
[2024-11-11 09:55:37,278] INFO: data_preprocessing : 42] No missing values found in column 'income'
[2024-11-11 09:55:37,278] INFO: data_preprocessing : 42] No missing values found in column 'number_of_dependants'
[2024-11-11 09:55:37,284] WARNING: data_preprocessing : 33] Missing values found in column 'residence_type', replacing with 'Unknown'
[2024-11-11 09:55:37,287] INFO: data_preprocessing : 35] Missing values replaced in column 'residence_type' with mode 'Owned'
[2024-11-11 09:55:37,287] INFO: data_preprocessing : 42] No missing values found in column 'years_at_current_address'
[2024-11-11 09:55:37,301] INFO: data_preprocessing : 42] No missing values found in column 'city'
[2024-11-11 09:55:37,304] INFO: data_preprocessing : 42] No missing values found in column 'state'
[2024-11-11 09:55:37,304] INFO: data_preprocessing : 42] No missing values found in column 'zipcode'
[2024-11-11 09:55:37,309] INFO: data_preprocessing : 42] No missing values found in column 'loan_id'
[2024-11-11 09:55:37,312] INFO: data_preprocessing : 42] No missing values found in column 'loan_purpose'
[2024-11-11 09:55:37,316] INFO: data_preprocessing : 42] No missing values found in column 'loan_type'
[2024-11-11 09:55:37,317] INFO: data_preprocessing : 42] No missing values found in column 'sanction_amount'
[2024-11-11 09:55:37,318] INFO: data_preprocessing : 42] No missing values found in column 'loan_amount'
[2024-11-11 09:55:37,319] INFO: data_preprocessing : 42] No missing values found in column 'processing_fee'
[2024-11-11 09:55:37,320] INFO: data_preprocessing : 42] No missing values found in column 'gst'
[2024-11-11 09:55:37,320] INFO: data_preprocessing : 42] No missing values found in column 'net_disbursement'
[2024-11-11 09:55:37,322] INFO: data_preprocessing : 42] No missing values found in column 'loan_tenure_months'
[2024-11-11 09:55:37,323] INFO: data_preprocessing : 42] No missing values found in column 'principal_outstanding'
[2024-11-11 09:55:37,323] INFO: data_preprocessing : 42] No missing values found in column 'bank_balance_at_application'
[2024-11-11 09:55:37,327] INFO: data_preprocessing : 42] No missing values found in column 'disbursal_date'
[2024-11-11 09:55:37,330] INFO: data_preprocessing : 42] No missing values found in column 'installment_start_dt'
[2024-11-11 09:55:37,331] INFO: data_preprocessing : 42] No missing values found in column 'default'
[2024-11-11 09:55:37,332] INFO: data_preprocessing : 42] No missing values found in column 'number_of_open_accounts'
[2024-11-11 09:55:37,333] INFO: data_preprocessing : 42] No missing values found in column 'number_of_closed_accounts'
[2024-11-11 09:55:37,334] INFO: data_preprocessing : 42] No missing values found in column 'total_loan_months'
[2024-11-11 09:55:37,335] INFO: data_preprocessing : 42] No missing values found in column 'delinquent_months'
[2024-11-11 09:55:37,335] INFO: data_preprocessing : 42] No missing values found in column 'total_dpd'
[2024-11-11 09:55:37,337] INFO: data_preprocessing : 42] No missing values found in column 'enquiry_count'
[2024-11-11 09:55:37,338] INFO: data_preprocessing : 42] No missing values found in column 'credit_utilization_ratio'
[2024-11-11 09:55:37,402] INFO: data_preprocessing : 51] No duplicate rows found
[2024-11-11 09:55:37,402] INFO: data_preprocessing : 53] Index(['cust_id', 'age', 'gender', 'marital_status', 'employment_status',
       'income', 'number_of_dependants', 'residence_type',
       'years_at_current_address', 'city', 'state', 'zipcode', 'loan_id',
       'loan_purpose', 'loan_type', 'sanction_amount', 'loan_amount',
       'processing_fee', 'gst', 'net_disbursement', 'loan_tenure_months',
       'principal_outstanding', 'bank_balance_at_application',
       'disbursal_date', 'installment_start_dt', 'default',
       'number_of_open_accounts', 'number_of_closed_accounts',
       'total_loan_months', 'delinquent_months', 'total_dpd', 'enquiry_count',
       'credit_utilization_ratio'],
      dtype='object')
[2024-11-11 09:55:37,986] INFO: common : 97] Successfully saved DataFrame to: artifacts\data_preprocessing\preprocessed_data.csv
[2024-11-11 09:55:37,986] INFO: main : 26] >>>>>>>>>>>Completed Data Pre-Processing Stage<<<<<<<<<<<<<
[2024-11-11 09:55:37,986] INFO: main : 36] >>>>>>>>>>>Starting Data Cleaning Stage<<<<<<<<<<<<<
[2024-11-11 09:55:37,986] INFO: common : 32] Successfully loaded yaml file: config\config.yaml
[2024-11-11 09:55:38,000] INFO: common : 32] Successfully loaded yaml file: params.yaml
[2024-11-11 09:55:38,003] INFO: common : 32] Successfully loaded yaml file: schema.yaml
[2024-11-11 09:55:38,004] INFO: common : 55] Created directory: artifacts
[2024-11-11 09:55:38,006] INFO: common : 55] Created directory: artifacts/data_cleaning
[2024-11-11 09:55:38,243] INFO: common : 79] Successfully loaded DataFrame from: artifacts\data_preprocessing\preprocessed_data.csv
[2024-11-11 09:55:38,243] INFO: data_cleaning : 34] Initiating train test split...
[2024-11-11 09:55:38,259] INFO: data_cleaning : 36] Train test split completed successfully.
[2024-11-11 09:55:38,259] INFO: data_cleaning : 91] Train_df :Index(['cust_id', 'age', 'gender', 'marital_status', 'employment_status',
       'income', 'number_of_dependants', 'residence_type',
       'years_at_current_address', 'city', 'state', 'zipcode', 'loan_id',
       'loan_purpose', 'loan_type', 'sanction_amount', 'loan_amount',
       'processing_fee', 'gst', 'net_disbursement', 'loan_tenure_months',
       'principal_outstanding', 'bank_balance_at_application',
       'disbursal_date', 'installment_start_dt', 'default',
       'number_of_open_accounts', 'number_of_closed_accounts',
       'total_loan_months', 'delinquent_months', 'total_dpd', 'enquiry_count',
       'credit_utilization_ratio'],
      dtype='object')
[2024-11-11 09:55:38,283] INFO: data_cleaning : 96]  After outlier removal train_df :(40000, 33)
[2024-11-11 09:55:38,284] INFO: data_cleaning : 97]  After outlier removal test_df :(10000, 33)
[2024-11-11 09:55:38,285] INFO: data_cleaning : 102] Rule 1: GST should not be more than 20% :(0, 33)
[2024-11-11 09:55:38,287] INFO: data_cleaning : 106] Rule 2: Net disbursement should not be higher than loan_amount :(0, 33)
[2024-11-11 09:55:38,291] INFO: data_cleaning : 111] Rule 3 : Fixed loan_purpose column :loan_purpose
Personal     14037
Home         12006
Auto          7950
Education     6007
Name: count, dtype: int64
[2024-11-11 09:55:38,300] INFO: data_cleaning : 116] Rule 4 : Generated loan_to_income column(LTI)
[2024-11-11 09:55:38,304] INFO: data_cleaning : 121] Generated delinquency_ratio column :count    40000.000000
mean        10.424123
std         17.283345
min          0.000000
25%          0.000000
50%          3.800000
75%         13.200000
max        100.000000
Name: delinquency_ratio, dtype: float64
[2024-11-11 09:55:38,315] INFO: data_cleaning : 135] Generated avg_dpd_per_delinquency column :count    40000.000000
mean         3.303845
std          2.902944
min          0.000000
25%          0.000000
50%          4.300000
75%          5.800000
max         10.000000
Name: avg_dpd_per_delinquency, dtype: float64
[2024-11-11 09:55:38,318] INFO: data_cleaning : 44] Removing columns...
[2024-11-11 09:55:38,322] INFO: data_cleaning : 46] Columns removed successfully.
[2024-11-11 09:55:38,325] INFO: data_cleaning : 44] Removing columns...
[2024-11-11 09:55:38,327] INFO: data_cleaning : 46] Columns removed successfully.
[2024-11-11 09:55:38,329] ERROR: data_cleaning : 72] Dtype mismatch in 'age': Expected int, got int64
[2024-11-11 09:55:38,329] INFO: data_cleaning : 76] Converted column 'age' to int.
[2024-11-11 09:55:38,331] ERROR: data_cleaning : 72] Dtype mismatch in 'residence_type': Expected category, got object
[2024-11-11 09:55:38,334] INFO: data_cleaning : 76] Converted column 'residence_type' to category.
[2024-11-11 09:55:38,334] ERROR: data_cleaning : 72] Dtype mismatch in 'loan_purpose': Expected category, got object
[2024-11-11 09:55:38,336] INFO: data_cleaning : 76] Converted column 'loan_purpose' to category.
[2024-11-11 09:55:38,336] ERROR: data_cleaning : 72] Dtype mismatch in 'loan_type': Expected category, got object
[2024-11-11 09:55:38,336] INFO: data_cleaning : 76] Converted column 'loan_type' to category.
[2024-11-11 09:55:38,336] ERROR: data_cleaning : 72] Dtype mismatch in 'loan_tenure_months': Expected int, got int64
[2024-11-11 09:55:38,336] INFO: data_cleaning : 76] Converted column 'loan_tenure_months' to int.
[2024-11-11 09:55:38,344] ERROR: data_cleaning : 72] Dtype mismatch in 'number_of_open_accounts': Expected int, got int64
[2024-11-11 09:55:38,346] INFO: data_cleaning : 76] Converted column 'number_of_open_accounts' to int.
[2024-11-11 09:55:38,346] ERROR: data_cleaning : 72] Dtype mismatch in 'credit_utilization_ratio': Expected float, got int64
[2024-11-11 09:55:38,347] INFO: data_cleaning : 76] Converted column 'credit_utilization_ratio' to float.
[2024-11-11 09:55:38,348] INFO: data_cleaning : 81] Schema validation successful: Columns and dtypes match.
[2024-11-11 09:55:38,348] ERROR: data_cleaning : 72] Dtype mismatch in 'age': Expected int, got int64
[2024-11-11 09:55:38,349] INFO: data_cleaning : 76] Converted column 'age' to int.
[2024-11-11 09:55:38,350] ERROR: data_cleaning : 72] Dtype mismatch in 'residence_type': Expected category, got object
[2024-11-11 09:55:38,352] INFO: data_cleaning : 76] Converted column 'residence_type' to category.
[2024-11-11 09:55:38,352] ERROR: data_cleaning : 72] Dtype mismatch in 'loan_purpose': Expected category, got object
[2024-11-11 09:55:38,353] INFO: data_cleaning : 76] Converted column 'loan_purpose' to category.
[2024-11-11 09:55:38,355] ERROR: data_cleaning : 72] Dtype mismatch in 'loan_type': Expected category, got object
[2024-11-11 09:55:38,356] INFO: data_cleaning : 76] Converted column 'loan_type' to category.
[2024-11-11 09:55:38,358] ERROR: data_cleaning : 72] Dtype mismatch in 'loan_tenure_months': Expected int, got int64
[2024-11-11 09:55:38,358] INFO: data_cleaning : 76] Converted column 'loan_tenure_months' to int.
[2024-11-11 09:55:38,358] ERROR: data_cleaning : 72] Dtype mismatch in 'number_of_open_accounts': Expected int, got int64
[2024-11-11 09:55:38,358] INFO: data_cleaning : 76] Converted column 'number_of_open_accounts' to int.
[2024-11-11 09:55:38,361] ERROR: data_cleaning : 72] Dtype mismatch in 'credit_utilization_ratio': Expected float, got int64
[2024-11-11 09:55:38,362] INFO: data_cleaning : 76] Converted column 'credit_utilization_ratio' to float.
[2024-11-11 09:55:38,362] INFO: data_cleaning : 81] Schema validation successful: Columns and dtypes match.
[2024-11-11 09:55:38,364] INFO: data_cleaning : 164] Categorical Columns : Index(['residence_type', 'loan_purpose', 'loan_type'], dtype='object')
[2024-11-11 09:55:38,365] INFO: data_cleaning : 165] Numerical Columns : Index(['credit_utilization_ratio', 'loan_to_income', 'delinquency_ratio',
       'avg_dpd_per_delinquency'],
      dtype='object')
[2024-11-11 09:55:38,407] ERROR: main : 41] An unexpected error occurred: Cannot center sparse matrices: pass `with_mean=False` instead. See docstring for motivation and alternatives.
[2024-11-11 09:56:52,303] INFO: __init__ : 26] Credit Risk Model Building Started
[2024-11-11 09:56:54,407] INFO: main : 12] >>>>>>>>>>>Starting Data Ingestion Stage<<<<<<<<<<<<<
[2024-11-11 09:56:54,407] INFO: common : 32] Successfully loaded yaml file: config\config.yaml
[2024-11-11 09:56:54,407] INFO: common : 32] Successfully loaded yaml file: params.yaml
[2024-11-11 09:56:54,421] INFO: common : 32] Successfully loaded yaml file: schema.yaml
[2024-11-11 09:56:54,422] INFO: common : 55] Created directory: artifacts
[2024-11-11 09:56:54,423] INFO: common : 55] Created directory: artifacts/data_ingestion
[2024-11-11 09:56:54,423] INFO: data_ingestion : 17] Loading customers data...
[2024-11-11 09:56:54,530] INFO: common : 79] Successfully loaded DataFrame from: data\customers.csv
[2024-11-11 09:56:54,531] INFO: data_ingestion : 20] Loading loans data...
[2024-11-11 09:56:54,668] INFO: common : 79] Successfully loaded DataFrame from: data\loans.csv
[2024-11-11 09:56:54,668] INFO: data_ingestion : 23] Loading bureau data...
[2024-11-11 09:56:54,719] INFO: common : 79] Successfully loaded DataFrame from: data\bureau_data.csv
[2024-11-11 09:56:54,719] INFO: data_ingestion : 26] The Shape of customers data: (50000, 12)
[2024-11-11 09:56:54,719] INFO: data_ingestion : 27] The Shape of loans data: (50000, 15)
[2024-11-11 09:56:54,719] INFO: data_ingestion : 28] The Shape of bureau data: (50000, 8)
[2024-11-11 09:56:55,344] INFO: common : 97] Successfully saved DataFrame to: artifacts\data_ingestion\data.csv
[2024-11-11 09:56:55,359] INFO: main : 14] >>>>>>>>>>>Completed Data Ingestion Stage<<<<<<<<<<<<<
[2024-11-11 09:56:55,359] INFO: main : 24] >>>>>>>>>>>Starting Data Pre-Processing Stage<<<<<<<<<<<<<
[2024-11-11 09:56:55,367] INFO: common : 32] Successfully loaded yaml file: config\config.yaml
[2024-11-11 09:56:55,369] INFO: common : 32] Successfully loaded yaml file: params.yaml
[2024-11-11 09:56:55,372] INFO: common : 32] Successfully loaded yaml file: schema.yaml
[2024-11-11 09:56:55,373] INFO: common : 55] Created directory: artifacts
[2024-11-11 09:56:55,374] INFO: common : 55] Created directory: artifacts/data_preprocessing
[2024-11-11 09:56:55,628] INFO: common : 79] Successfully loaded DataFrame from: artifacts\data_ingestion\data.csv
[2024-11-11 09:56:55,628] INFO: data_preprocessing : 26] The Valure counts for 'default' column: default
0    45703
1     4297
Name: count, dtype: int64
[2024-11-11 09:56:55,628] INFO: data_preprocessing : 42] No missing values found in column 'cust_id'
[2024-11-11 09:56:55,644] INFO: data_preprocessing : 42] No missing values found in column 'age'
[2024-11-11 09:56:55,648] INFO: data_preprocessing : 42] No missing values found in column 'gender'
[2024-11-11 09:56:55,653] INFO: data_preprocessing : 42] No missing values found in column 'marital_status'
[2024-11-11 09:56:55,657] INFO: data_preprocessing : 42] No missing values found in column 'employment_status'
[2024-11-11 09:56:55,657] INFO: data_preprocessing : 42] No missing values found in column 'income'
[2024-11-11 09:56:55,657] INFO: data_preprocessing : 42] No missing values found in column 'number_of_dependants'
[2024-11-11 09:56:55,662] WARNING: data_preprocessing : 33] Missing values found in column 'residence_type', replacing with 'Unknown'
[2024-11-11 09:56:55,676] INFO: data_preprocessing : 35] Missing values replaced in column 'residence_type' with mode 'Owned'
[2024-11-11 09:56:55,676] INFO: data_preprocessing : 42] No missing values found in column 'years_at_current_address'
[2024-11-11 09:56:55,681] INFO: data_preprocessing : 42] No missing values found in column 'city'
[2024-11-11 09:56:55,684] INFO: data_preprocessing : 42] No missing values found in column 'state'
[2024-11-11 09:56:55,686] INFO: data_preprocessing : 42] No missing values found in column 'zipcode'
[2024-11-11 09:56:55,689] INFO: data_preprocessing : 42] No missing values found in column 'loan_id'
[2024-11-11 09:56:55,694] INFO: data_preprocessing : 42] No missing values found in column 'loan_purpose'
[2024-11-11 09:56:55,697] INFO: data_preprocessing : 42] No missing values found in column 'loan_type'
[2024-11-11 09:56:55,698] INFO: data_preprocessing : 42] No missing values found in column 'sanction_amount'
[2024-11-11 09:56:55,698] INFO: data_preprocessing : 42] No missing values found in column 'loan_amount'
[2024-11-11 09:56:55,698] INFO: data_preprocessing : 42] No missing values found in column 'processing_fee'
[2024-11-11 09:56:55,701] INFO: data_preprocessing : 42] No missing values found in column 'gst'
[2024-11-11 09:56:55,702] INFO: data_preprocessing : 42] No missing values found in column 'net_disbursement'
[2024-11-11 09:56:55,703] INFO: data_preprocessing : 42] No missing values found in column 'loan_tenure_months'
[2024-11-11 09:56:55,704] INFO: data_preprocessing : 42] No missing values found in column 'principal_outstanding'
[2024-11-11 09:56:55,705] INFO: data_preprocessing : 42] No missing values found in column 'bank_balance_at_application'
[2024-11-11 09:56:55,705] INFO: data_preprocessing : 42] No missing values found in column 'disbursal_date'
[2024-11-11 09:56:55,712] INFO: data_preprocessing : 42] No missing values found in column 'installment_start_dt'
[2024-11-11 09:56:55,712] INFO: data_preprocessing : 42] No missing values found in column 'default'
[2024-11-11 09:56:55,713] INFO: data_preprocessing : 42] No missing values found in column 'number_of_open_accounts'
[2024-11-11 09:56:55,714] INFO: data_preprocessing : 42] No missing values found in column 'number_of_closed_accounts'
[2024-11-11 09:56:55,715] INFO: data_preprocessing : 42] No missing values found in column 'total_loan_months'
[2024-11-11 09:56:55,715] INFO: data_preprocessing : 42] No missing values found in column 'delinquent_months'
[2024-11-11 09:56:55,718] INFO: data_preprocessing : 42] No missing values found in column 'total_dpd'
[2024-11-11 09:56:55,719] INFO: data_preprocessing : 42] No missing values found in column 'enquiry_count'
[2024-11-11 09:56:55,719] INFO: data_preprocessing : 42] No missing values found in column 'credit_utilization_ratio'
[2024-11-11 09:56:55,797] INFO: data_preprocessing : 51] No duplicate rows found
[2024-11-11 09:56:55,797] INFO: data_preprocessing : 53] Index(['cust_id', 'age', 'gender', 'marital_status', 'employment_status',
       'income', 'number_of_dependants', 'residence_type',
       'years_at_current_address', 'city', 'state', 'zipcode', 'loan_id',
       'loan_purpose', 'loan_type', 'sanction_amount', 'loan_amount',
       'processing_fee', 'gst', 'net_disbursement', 'loan_tenure_months',
       'principal_outstanding', 'bank_balance_at_application',
       'disbursal_date', 'installment_start_dt', 'default',
       'number_of_open_accounts', 'number_of_closed_accounts',
       'total_loan_months', 'delinquent_months', 'total_dpd', 'enquiry_count',
       'credit_utilization_ratio'],
      dtype='object')
[2024-11-11 09:56:55,803] ERROR: common : 100] Error saving DataFrame to: artifacts\data_preprocessing\preprocessed_data.csv - [Errno 22] Invalid argument: 'artifacts\\data_preprocessing\\preprocessed_data.csv'
[2024-11-11 09:56:55,803] ERROR: data_preprocessing : 60] An error occurred during data preprocessing: Error occurred in python script name [C:\Users\ambig\jupiter_notebook\Projects\Credit-Risk-Model\src\Credit_Risk_Model\utils\common.py] line number [95] error message[[Errno 22] Invalid argument: 'artifacts\\data_preprocessing\\preprocessed_data.csv']
[2024-11-11 09:56:55,804] ERROR: data_preprocessing_pipeline : 22] Error Occurred: Error occurred in python script name [C:\Users\ambig\jupiter_notebook\Projects\Credit-Risk-Model\src\Credit_Risk_Model\components\data_preprocessing.py] line number [56] error message[Error occurred in python script name [C:\Users\ambig\jupiter_notebook\Projects\Credit-Risk-Model\src\Credit_Risk_Model\utils\common.py] line number [95] error message[[Errno 22] Invalid argument: 'artifacts\\data_preprocessing\\preprocessed_data.csv']]
[2024-11-11 09:56:55,805] ERROR: main : 29] An unexpected error occurred: Error occurred in python script name [C:\Users\ambig\jupiter_notebook\Projects\Credit-Risk-Model\src\Credit_Risk_Model\pipeline\data_preprocessing_pipeline.py] line number [19] error message[Error occurred in python script name [C:\Users\ambig\jupiter_notebook\Projects\Credit-Risk-Model\src\Credit_Risk_Model\components\data_preprocessing.py] line number [56] error message[Error occurred in python script name [C:\Users\ambig\jupiter_notebook\Projects\Credit-Risk-Model\src\Credit_Risk_Model\utils\common.py] line number [95] error message[[Errno 22] Invalid argument: 'artifacts\\data_preprocessing\\preprocessed_data.csv']]]
[2024-11-11 10:34:55,546] INFO: __init__ : 26] Credit Risk Model Building Started
[2024-11-11 10:35:03,145] INFO: main : 12] >>>>>>>>>>>Starting Data Ingestion Stage<<<<<<<<<<<<<
[2024-11-11 10:35:03,152] INFO: common : 32] Successfully loaded yaml file: config\config.yaml
[2024-11-11 10:35:03,160] INFO: common : 32] Successfully loaded yaml file: params.yaml
[2024-11-11 10:35:03,165] INFO: common : 32] Successfully loaded yaml file: schema.yaml
[2024-11-11 10:35:03,166] INFO: common : 55] Created directory: artifacts
[2024-11-11 10:35:03,166] INFO: common : 55] Created directory: artifacts/data_ingestion
[2024-11-11 10:35:03,167] INFO: data_ingestion : 17] Loading customers data...
[2024-11-11 10:35:03,317] INFO: common : 79] Successfully loaded DataFrame from: data\customers.csv
[2024-11-11 10:35:03,318] INFO: data_ingestion : 20] Loading loans data...
[2024-11-11 10:35:03,516] INFO: common : 79] Successfully loaded DataFrame from: data\loans.csv
[2024-11-11 10:35:03,516] INFO: data_ingestion : 23] Loading bureau data...
[2024-11-11 10:35:03,604] INFO: common : 79] Successfully loaded DataFrame from: data\bureau_data.csv
[2024-11-11 10:35:03,606] INFO: data_ingestion : 26] The Shape of customers data: (50000, 12)
[2024-11-11 10:35:03,607] INFO: data_ingestion : 27] The Shape of loans data: (50000, 15)
[2024-11-11 10:35:03,607] INFO: data_ingestion : 28] The Shape of bureau data: (50000, 8)
[2024-11-11 10:35:05,204] INFO: common : 97] Successfully saved DataFrame to: artifacts\data_ingestion\data.csv
[2024-11-11 10:35:05,232] INFO: main : 14] >>>>>>>>>>>Completed Data Ingestion Stage<<<<<<<<<<<<<
[2024-11-11 10:35:05,233] INFO: main : 24] >>>>>>>>>>>Starting Data Pre-Processing Stage<<<<<<<<<<<<<
[2024-11-11 10:35:05,240] INFO: common : 32] Successfully loaded yaml file: config\config.yaml
[2024-11-11 10:35:05,247] INFO: common : 32] Successfully loaded yaml file: params.yaml
[2024-11-11 10:35:05,259] INFO: common : 32] Successfully loaded yaml file: schema.yaml
[2024-11-11 10:35:05,261] INFO: common : 55] Created directory: artifacts
[2024-11-11 10:35:05,263] INFO: common : 55] Created directory: artifacts/data_preprocessing
[2024-11-11 10:35:05,978] INFO: common : 79] Successfully loaded DataFrame from: artifacts\data_ingestion\data.csv
[2024-11-11 10:35:05,986] INFO: data_preprocessing : 26] The Valure counts for 'default' column: default
0    45703
1     4297
Name: count, dtype: int64
[2024-11-11 10:35:05,999] INFO: data_preprocessing : 42] No missing values found in column 'cust_id'
[2024-11-11 10:35:06,000] INFO: data_preprocessing : 42] No missing values found in column 'age'
[2024-11-11 10:35:06,013] INFO: data_preprocessing : 42] No missing values found in column 'gender'
[2024-11-11 10:35:06,022] INFO: data_preprocessing : 42] No missing values found in column 'marital_status'
[2024-11-11 10:35:06,034] INFO: data_preprocessing : 42] No missing values found in column 'employment_status'
[2024-11-11 10:35:06,040] INFO: data_preprocessing : 42] No missing values found in column 'income'
[2024-11-11 10:35:06,069] INFO: data_preprocessing : 42] No missing values found in column 'number_of_dependants'
[2024-11-11 10:35:06,100] WARNING: data_preprocessing : 33] Missing values found in column 'residence_type', replacing with 'Unknown'
[2024-11-11 10:35:06,167] INFO: data_preprocessing : 35] Missing values replaced in column 'residence_type' with mode 'Owned'
[2024-11-11 10:35:06,177] INFO: data_preprocessing : 42] No missing values found in column 'years_at_current_address'
[2024-11-11 10:35:06,191] INFO: data_preprocessing : 42] No missing values found in column 'city'
[2024-11-11 10:35:06,197] INFO: data_preprocessing : 42] No missing values found in column 'state'
[2024-11-11 10:35:06,208] INFO: data_preprocessing : 42] No missing values found in column 'zipcode'
[2024-11-11 10:35:06,214] INFO: data_preprocessing : 42] No missing values found in column 'loan_id'
[2024-11-11 10:35:06,222] INFO: data_preprocessing : 42] No missing values found in column 'loan_purpose'
[2024-11-11 10:35:06,230] INFO: data_preprocessing : 42] No missing values found in column 'loan_type'
[2024-11-11 10:35:06,240] INFO: data_preprocessing : 42] No missing values found in column 'sanction_amount'
[2024-11-11 10:35:06,247] INFO: data_preprocessing : 42] No missing values found in column 'loan_amount'
[2024-11-11 10:35:06,251] INFO: data_preprocessing : 42] No missing values found in column 'processing_fee'
[2024-11-11 10:35:06,257] INFO: data_preprocessing : 42] No missing values found in column 'gst'
[2024-11-11 10:35:06,281] INFO: data_preprocessing : 42] No missing values found in column 'net_disbursement'
[2024-11-11 10:35:06,287] INFO: data_preprocessing : 42] No missing values found in column 'loan_tenure_months'
[2024-11-11 10:35:06,319] INFO: data_preprocessing : 42] No missing values found in column 'principal_outstanding'
[2024-11-11 10:35:06,324] INFO: data_preprocessing : 42] No missing values found in column 'bank_balance_at_application'
[2024-11-11 10:35:06,355] INFO: data_preprocessing : 42] No missing values found in column 'disbursal_date'
[2024-11-11 10:35:06,397] INFO: data_preprocessing : 42] No missing values found in column 'installment_start_dt'
[2024-11-11 10:35:06,462] INFO: data_preprocessing : 42] No missing values found in column 'default'
[2024-11-11 10:35:06,502] INFO: data_preprocessing : 42] No missing values found in column 'number_of_open_accounts'
[2024-11-11 10:35:06,534] INFO: data_preprocessing : 42] No missing values found in column 'number_of_closed_accounts'
[2024-11-11 10:35:06,567] INFO: data_preprocessing : 42] No missing values found in column 'total_loan_months'
[2024-11-11 10:35:06,652] INFO: data_preprocessing : 42] No missing values found in column 'delinquent_months'
[2024-11-11 10:35:06,730] INFO: data_preprocessing : 42] No missing values found in column 'total_dpd'
[2024-11-11 10:35:06,745] INFO: data_preprocessing : 42] No missing values found in column 'enquiry_count'
[2024-11-11 10:35:06,750] INFO: data_preprocessing : 42] No missing values found in column 'credit_utilization_ratio'
[2024-11-11 10:35:07,103] INFO: data_preprocessing : 51] No duplicate rows found
[2024-11-11 10:35:07,103] INFO: data_preprocessing : 53] Index(['cust_id', 'age', 'gender', 'marital_status', 'employment_status',
       'income', 'number_of_dependants', 'residence_type',
       'years_at_current_address', 'city', 'state', 'zipcode', 'loan_id',
       'loan_purpose', 'loan_type', 'sanction_amount', 'loan_amount',
       'processing_fee', 'gst', 'net_disbursement', 'loan_tenure_months',
       'principal_outstanding', 'bank_balance_at_application',
       'disbursal_date', 'installment_start_dt', 'default',
       'number_of_open_accounts', 'number_of_closed_accounts',
       'total_loan_months', 'delinquent_months', 'total_dpd', 'enquiry_count',
       'credit_utilization_ratio'],
      dtype='object')
[2024-11-11 10:35:09,717] INFO: common : 97] Successfully saved DataFrame to: artifacts\data_preprocessing\preprocessed_data.csv
[2024-11-11 10:35:09,721] INFO: main : 26] >>>>>>>>>>>Completed Data Pre-Processing Stage<<<<<<<<<<<<<
[2024-11-11 10:35:09,730] INFO: main : 36] >>>>>>>>>>>Starting Data Cleaning Stage<<<<<<<<<<<<<
[2024-11-11 10:35:09,738] INFO: common : 32] Successfully loaded yaml file: config\config.yaml
[2024-11-11 10:35:09,746] INFO: common : 32] Successfully loaded yaml file: params.yaml
[2024-11-11 10:35:09,754] INFO: common : 32] Successfully loaded yaml file: schema.yaml
[2024-11-11 10:35:09,754] INFO: common : 55] Created directory: artifacts
[2024-11-11 10:35:09,758] INFO: common : 55] Created directory: artifacts/data_cleaning
[2024-11-11 10:35:10,524] INFO: common : 79] Successfully loaded DataFrame from: artifacts\data_preprocessing\preprocessed_data.csv
[2024-11-11 10:35:10,525] INFO: data_cleaning : 34] Initiating train test split...
[2024-11-11 10:35:10,582] INFO: data_cleaning : 36] Train test split completed successfully.
[2024-11-11 10:35:10,582] INFO: data_cleaning : 91] Train_df :Index(['cust_id', 'age', 'gender', 'marital_status', 'employment_status',
       'income', 'number_of_dependants', 'residence_type',
       'years_at_current_address', 'city', 'state', 'zipcode', 'loan_id',
       'loan_purpose', 'loan_type', 'sanction_amount', 'loan_amount',
       'processing_fee', 'gst', 'net_disbursement', 'loan_tenure_months',
       'principal_outstanding', 'bank_balance_at_application',
       'disbursal_date', 'installment_start_dt', 'default',
       'number_of_open_accounts', 'number_of_closed_accounts',
       'total_loan_months', 'delinquent_months', 'total_dpd', 'enquiry_count',
       'credit_utilization_ratio'],
      dtype='object')
[2024-11-11 10:35:10,626] INFO: data_cleaning : 96]  After outlier removal train_df :(40000, 33)
[2024-11-11 10:35:10,627] INFO: data_cleaning : 97]  After outlier removal test_df :(10000, 33)
[2024-11-11 10:35:10,631] INFO: data_cleaning : 102] Rule 1: GST should not be more than 20% :(0, 33)
[2024-11-11 10:35:10,631] INFO: data_cleaning : 106] Rule 2: Net disbursement should not be higher than loan_amount :(0, 33)
[2024-11-11 10:35:10,666] INFO: data_cleaning : 111] Rule 3 : Fixed loan_purpose column :loan_purpose
Personal     14037
Home         12006
Auto          7950
Education     6007
Name: count, dtype: int64
[2024-11-11 10:35:10,683] INFO: data_cleaning : 116] Rule 4 : Generated loan_to_income column(LTI)
[2024-11-11 10:35:10,716] INFO: data_cleaning : 121] Generated delinquency_ratio column :count    40000.000000
mean        10.424123
std         17.283345
min          0.000000
25%          0.000000
50%          3.800000
75%         13.200000
max        100.000000
Name: delinquency_ratio, dtype: float64
[2024-11-11 10:35:10,738] INFO: data_cleaning : 135] Generated avg_dpd_per_delinquency column :count    40000.000000
mean         3.303845
std          2.902944
min          0.000000
25%          0.000000
50%          4.300000
75%          5.800000
max         10.000000
Name: avg_dpd_per_delinquency, dtype: float64
[2024-11-11 10:35:10,738] INFO: data_cleaning : 44] Removing columns...
[2024-11-11 10:35:10,745] INFO: data_cleaning : 46] Columns removed successfully.
[2024-11-11 10:35:10,757] INFO: data_cleaning : 44] Removing columns...
[2024-11-11 10:35:10,757] INFO: data_cleaning : 46] Columns removed successfully.
[2024-11-11 10:35:10,767] ERROR: data_cleaning : 72] Dtype mismatch in 'age': Expected int, got int64
[2024-11-11 10:35:10,767] INFO: data_cleaning : 76] Converted column 'age' to int.
[2024-11-11 10:35:10,767] ERROR: data_cleaning : 72] Dtype mismatch in 'residence_type': Expected category, got object
[2024-11-11 10:35:10,779] INFO: data_cleaning : 76] Converted column 'residence_type' to category.
[2024-11-11 10:35:10,782] ERROR: data_cleaning : 72] Dtype mismatch in 'loan_purpose': Expected category, got object
[2024-11-11 10:35:10,790] INFO: data_cleaning : 76] Converted column 'loan_purpose' to category.
[2024-11-11 10:35:10,792] ERROR: data_cleaning : 72] Dtype mismatch in 'loan_type': Expected category, got object
[2024-11-11 10:35:10,795] INFO: data_cleaning : 76] Converted column 'loan_type' to category.
[2024-11-11 10:35:10,795] ERROR: data_cleaning : 72] Dtype mismatch in 'loan_tenure_months': Expected int, got int64
[2024-11-11 10:35:10,802] INFO: data_cleaning : 76] Converted column 'loan_tenure_months' to int.
[2024-11-11 10:35:10,802] ERROR: data_cleaning : 72] Dtype mismatch in 'number_of_open_accounts': Expected int, got int64
[2024-11-11 10:35:10,805] INFO: data_cleaning : 76] Converted column 'number_of_open_accounts' to int.
[2024-11-11 10:35:10,806] ERROR: data_cleaning : 72] Dtype mismatch in 'credit_utilization_ratio': Expected float, got int64
[2024-11-11 10:35:10,809] INFO: data_cleaning : 76] Converted column 'credit_utilization_ratio' to float.
[2024-11-11 10:35:10,809] INFO: data_cleaning : 81] Schema validation successful: Columns and dtypes match.
[2024-11-11 10:35:10,812] ERROR: data_cleaning : 72] Dtype mismatch in 'age': Expected int, got int64
[2024-11-11 10:35:10,818] INFO: data_cleaning : 76] Converted column 'age' to int.
[2024-11-11 10:35:10,818] ERROR: data_cleaning : 72] Dtype mismatch in 'residence_type': Expected category, got object
[2024-11-11 10:35:10,823] INFO: data_cleaning : 76] Converted column 'residence_type' to category.
[2024-11-11 10:35:10,823] ERROR: data_cleaning : 72] Dtype mismatch in 'loan_purpose': Expected category, got object
[2024-11-11 10:35:10,833] INFO: data_cleaning : 76] Converted column 'loan_purpose' to category.
[2024-11-11 10:35:10,834] ERROR: data_cleaning : 72] Dtype mismatch in 'loan_type': Expected category, got object
[2024-11-11 10:35:10,840] INFO: data_cleaning : 76] Converted column 'loan_type' to category.
[2024-11-11 10:35:10,842] ERROR: data_cleaning : 72] Dtype mismatch in 'loan_tenure_months': Expected int, got int64
[2024-11-11 10:35:10,845] INFO: data_cleaning : 76] Converted column 'loan_tenure_months' to int.
[2024-11-11 10:35:10,845] ERROR: data_cleaning : 72] Dtype mismatch in 'number_of_open_accounts': Expected int, got int64
[2024-11-11 10:35:10,850] INFO: data_cleaning : 76] Converted column 'number_of_open_accounts' to int.
[2024-11-11 10:35:10,851] ERROR: data_cleaning : 72] Dtype mismatch in 'credit_utilization_ratio': Expected float, got int64
[2024-11-11 10:35:10,853] INFO: data_cleaning : 76] Converted column 'credit_utilization_ratio' to float.
[2024-11-11 10:35:10,853] INFO: data_cleaning : 81] Schema validation successful: Columns and dtypes match.
[2024-11-11 10:35:10,861] INFO: data_cleaning : 164] Categorical Columns : Index(['residence_type', 'loan_purpose', 'loan_type'], dtype='object')
[2024-11-11 10:35:10,862] INFO: data_cleaning : 165] Numerical Columns : Index(['credit_utilization_ratio', 'loan_to_income', 'delinquency_ratio',
       'avg_dpd_per_delinquency'],
      dtype='object')
[2024-11-11 10:35:11,064] ERROR: main : 41] An unexpected error occurred: cannot concatenate object of type '<class 'numpy.ndarray'>'; only Series and DataFrame objs are valid
[2024-11-11 10:39:19,183] INFO: __init__ : 26] Credit Risk Model Building Started
[2024-11-11 10:39:21,884] INFO: main : 12] >>>>>>>>>>>Starting Data Ingestion Stage<<<<<<<<<<<<<
[2024-11-11 10:39:21,892] INFO: common : 32] Successfully loaded yaml file: config\config.yaml
[2024-11-11 10:39:21,892] INFO: common : 32] Successfully loaded yaml file: params.yaml
[2024-11-11 10:39:21,911] INFO: common : 32] Successfully loaded yaml file: schema.yaml
[2024-11-11 10:39:21,911] INFO: common : 55] Created directory: artifacts
[2024-11-11 10:39:21,914] INFO: common : 55] Created directory: artifacts/data_ingestion
[2024-11-11 10:39:21,914] INFO: data_ingestion : 17] Loading customers data...
[2024-11-11 10:39:22,034] INFO: common : 79] Successfully loaded DataFrame from: data\customers.csv
[2024-11-11 10:39:22,034] INFO: data_ingestion : 20] Loading loans data...
[2024-11-11 10:39:22,195] INFO: common : 79] Successfully loaded DataFrame from: data\loans.csv
[2024-11-11 10:39:22,195] INFO: data_ingestion : 23] Loading bureau data...
[2024-11-11 10:39:22,263] INFO: common : 79] Successfully loaded DataFrame from: data\bureau_data.csv
[2024-11-11 10:39:22,263] INFO: data_ingestion : 26] The Shape of customers data: (50000, 12)
[2024-11-11 10:39:22,263] INFO: data_ingestion : 27] The Shape of loans data: (50000, 15)
[2024-11-11 10:39:22,263] INFO: data_ingestion : 28] The Shape of bureau data: (50000, 8)
[2024-11-11 10:39:22,880] INFO: common : 97] Successfully saved DataFrame to: artifacts\data_ingestion\data.csv
[2024-11-11 10:39:22,889] INFO: main : 14] >>>>>>>>>>>Completed Data Ingestion Stage<<<<<<<<<<<<<
[2024-11-11 10:39:22,890] INFO: main : 24] >>>>>>>>>>>Starting Data Pre-Processing Stage<<<<<<<<<<<<<
[2024-11-11 10:39:22,894] INFO: common : 32] Successfully loaded yaml file: config\config.yaml
[2024-11-11 10:39:22,897] INFO: common : 32] Successfully loaded yaml file: params.yaml
[2024-11-11 10:39:22,900] INFO: common : 32] Successfully loaded yaml file: schema.yaml
[2024-11-11 10:39:22,901] INFO: common : 55] Created directory: artifacts
[2024-11-11 10:39:22,902] INFO: common : 55] Created directory: artifacts/data_preprocessing
[2024-11-11 10:39:23,153] INFO: common : 79] Successfully loaded DataFrame from: artifacts\data_ingestion\data.csv
[2024-11-11 10:39:23,163] INFO: data_preprocessing : 26] The Valure counts for 'default' column: default
0    45703
1     4297
Name: count, dtype: int64
[2024-11-11 10:39:23,167] INFO: data_preprocessing : 42] No missing values found in column 'cust_id'
[2024-11-11 10:39:23,168] INFO: data_preprocessing : 42] No missing values found in column 'age'
[2024-11-11 10:39:23,172] INFO: data_preprocessing : 42] No missing values found in column 'gender'
[2024-11-11 10:39:23,175] INFO: data_preprocessing : 42] No missing values found in column 'marital_status'
[2024-11-11 10:39:23,180] INFO: data_preprocessing : 42] No missing values found in column 'employment_status'
[2024-11-11 10:39:23,182] INFO: data_preprocessing : 42] No missing values found in column 'income'
[2024-11-11 10:39:23,183] INFO: data_preprocessing : 42] No missing values found in column 'number_of_dependants'
[2024-11-11 10:39:23,185] WARNING: data_preprocessing : 33] Missing values found in column 'residence_type', replacing with 'Unknown'
[2024-11-11 10:39:23,197] INFO: data_preprocessing : 35] Missing values replaced in column 'residence_type' with mode 'Owned'
[2024-11-11 10:39:23,197] INFO: data_preprocessing : 42] No missing values found in column 'years_at_current_address'
[2024-11-11 10:39:23,201] INFO: data_preprocessing : 42] No missing values found in column 'city'
[2024-11-11 10:39:23,201] INFO: data_preprocessing : 42] No missing values found in column 'state'
[2024-11-11 10:39:23,201] INFO: data_preprocessing : 42] No missing values found in column 'zipcode'
[2024-11-11 10:39:23,209] INFO: data_preprocessing : 42] No missing values found in column 'loan_id'
[2024-11-11 10:39:23,214] INFO: data_preprocessing : 42] No missing values found in column 'loan_purpose'
[2024-11-11 10:39:23,217] INFO: data_preprocessing : 42] No missing values found in column 'loan_type'
[2024-11-11 10:39:23,217] INFO: data_preprocessing : 42] No missing values found in column 'sanction_amount'
[2024-11-11 10:39:23,217] INFO: data_preprocessing : 42] No missing values found in column 'loan_amount'
[2024-11-11 10:39:23,217] INFO: data_preprocessing : 42] No missing values found in column 'processing_fee'
[2024-11-11 10:39:23,217] INFO: data_preprocessing : 42] No missing values found in column 'gst'
[2024-11-11 10:39:23,217] INFO: data_preprocessing : 42] No missing values found in column 'net_disbursement'
[2024-11-11 10:39:23,217] INFO: data_preprocessing : 42] No missing values found in column 'loan_tenure_months'
[2024-11-11 10:39:23,217] INFO: data_preprocessing : 42] No missing values found in column 'principal_outstanding'
[2024-11-11 10:39:23,224] INFO: data_preprocessing : 42] No missing values found in column 'bank_balance_at_application'
[2024-11-11 10:39:23,226] INFO: data_preprocessing : 42] No missing values found in column 'disbursal_date'
[2024-11-11 10:39:23,230] INFO: data_preprocessing : 42] No missing values found in column 'installment_start_dt'
[2024-11-11 10:39:23,230] INFO: data_preprocessing : 42] No missing values found in column 'default'
[2024-11-11 10:39:23,230] INFO: data_preprocessing : 42] No missing values found in column 'number_of_open_accounts'
[2024-11-11 10:39:23,230] INFO: data_preprocessing : 42] No missing values found in column 'number_of_closed_accounts'
[2024-11-11 10:39:23,230] INFO: data_preprocessing : 42] No missing values found in column 'total_loan_months'
[2024-11-11 10:39:23,230] INFO: data_preprocessing : 42] No missing values found in column 'delinquent_months'
[2024-11-11 10:39:23,230] INFO: data_preprocessing : 42] No missing values found in column 'total_dpd'
[2024-11-11 10:39:23,230] INFO: data_preprocessing : 42] No missing values found in column 'enquiry_count'
[2024-11-11 10:39:23,230] INFO: data_preprocessing : 42] No missing values found in column 'credit_utilization_ratio'
[2024-11-11 10:39:23,311] INFO: data_preprocessing : 51] No duplicate rows found
[2024-11-11 10:39:23,311] INFO: data_preprocessing : 53] Index(['cust_id', 'age', 'gender', 'marital_status', 'employment_status',
       'income', 'number_of_dependants', 'residence_type',
       'years_at_current_address', 'city', 'state', 'zipcode', 'loan_id',
       'loan_purpose', 'loan_type', 'sanction_amount', 'loan_amount',
       'processing_fee', 'gst', 'net_disbursement', 'loan_tenure_months',
       'principal_outstanding', 'bank_balance_at_application',
       'disbursal_date', 'installment_start_dt', 'default',
       'number_of_open_accounts', 'number_of_closed_accounts',
       'total_loan_months', 'delinquent_months', 'total_dpd', 'enquiry_count',
       'credit_utilization_ratio'],
      dtype='object')
[2024-11-11 10:39:23,832] INFO: common : 97] Successfully saved DataFrame to: artifacts\data_preprocessing\preprocessed_data.csv
[2024-11-11 10:39:23,842] INFO: main : 26] >>>>>>>>>>>Completed Data Pre-Processing Stage<<<<<<<<<<<<<
[2024-11-11 10:39:23,842] INFO: main : 36] >>>>>>>>>>>Starting Data Cleaning Stage<<<<<<<<<<<<<
[2024-11-11 10:39:23,845] INFO: common : 32] Successfully loaded yaml file: config\config.yaml
[2024-11-11 10:39:23,845] INFO: common : 32] Successfully loaded yaml file: params.yaml
[2024-11-11 10:39:23,849] INFO: common : 32] Successfully loaded yaml file: schema.yaml
[2024-11-11 10:39:23,849] INFO: common : 55] Created directory: artifacts
[2024-11-11 10:39:23,849] INFO: common : 55] Created directory: artifacts/data_cleaning
[2024-11-11 10:39:24,071] INFO: common : 79] Successfully loaded DataFrame from: artifacts\data_preprocessing\preprocessed_data.csv
[2024-11-11 10:39:24,071] INFO: data_cleaning : 34] Initiating train test split...
[2024-11-11 10:39:24,092] INFO: data_cleaning : 36] Train test split completed successfully.
[2024-11-11 10:39:24,095] INFO: data_cleaning : 91] Train_df :Index(['cust_id', 'age', 'gender', 'marital_status', 'employment_status',
       'income', 'number_of_dependants', 'residence_type',
       'years_at_current_address', 'city', 'state', 'zipcode', 'loan_id',
       'loan_purpose', 'loan_type', 'sanction_amount', 'loan_amount',
       'processing_fee', 'gst', 'net_disbursement', 'loan_tenure_months',
       'principal_outstanding', 'bank_balance_at_application',
       'disbursal_date', 'installment_start_dt', 'default',
       'number_of_open_accounts', 'number_of_closed_accounts',
       'total_loan_months', 'delinquent_months', 'total_dpd', 'enquiry_count',
       'credit_utilization_ratio'],
      dtype='object')
[2024-11-11 10:39:24,113] INFO: data_cleaning : 96]  After outlier removal train_df :(40000, 33)
[2024-11-11 10:39:24,113] INFO: data_cleaning : 97]  After outlier removal test_df :(10000, 33)
[2024-11-11 10:39:24,115] INFO: data_cleaning : 102] Rule 1: GST should not be more than 20% :(0, 33)
[2024-11-11 10:39:24,115] INFO: data_cleaning : 106] Rule 2: Net disbursement should not be higher than loan_amount :(0, 33)
[2024-11-11 10:39:24,123] INFO: data_cleaning : 111] Rule 3 : Fixed loan_purpose column :loan_purpose
Personal     14037
Home         12006
Auto          7950
Education     6007
Name: count, dtype: int64
[2024-11-11 10:39:24,127] INFO: data_cleaning : 116] Rule 4 : Generated loan_to_income column(LTI)
[2024-11-11 10:39:24,137] INFO: data_cleaning : 121] Generated delinquency_ratio column :count    40000.000000
mean        10.424123
std         17.283345
min          0.000000
25%          0.000000
50%          3.800000
75%         13.200000
max        100.000000
Name: delinquency_ratio, dtype: float64
[2024-11-11 10:39:24,143] INFO: data_cleaning : 135] Generated avg_dpd_per_delinquency column :count    40000.000000
mean         3.303845
std          2.902944
min          0.000000
25%          0.000000
50%          4.300000
75%          5.800000
max         10.000000
Name: avg_dpd_per_delinquency, dtype: float64
[2024-11-11 10:39:24,145] INFO: data_cleaning : 44] Removing columns...
[2024-11-11 10:39:24,148] INFO: data_cleaning : 46] Columns removed successfully.
[2024-11-11 10:39:24,151] INFO: data_cleaning : 44] Removing columns...
[2024-11-11 10:39:24,153] INFO: data_cleaning : 46] Columns removed successfully.
[2024-11-11 10:39:24,154] ERROR: data_cleaning : 72] Dtype mismatch in 'age': Expected int, got int64
[2024-11-11 10:39:24,155] INFO: data_cleaning : 76] Converted column 'age' to int.
[2024-11-11 10:39:24,155] ERROR: data_cleaning : 72] Dtype mismatch in 'loan_type': Expected onject, got object
[2024-11-11 10:39:24,155] ERROR: data_cleaning : 78] Failed to convert column 'loan_type' to onject: data type 'onject' not understood
[2024-11-11 10:39:24,156] ERROR: main : 41] An unexpected error occurred: CustomException.__init__() missing 1 required positional argument: 'error_detail'
[2024-11-11 10:39:52,631] INFO: __init__ : 26] Credit Risk Model Building Started
[2024-11-11 10:39:53,883] INFO: main : 12] >>>>>>>>>>>Starting Data Ingestion Stage<<<<<<<<<<<<<
[2024-11-11 10:39:53,886] INFO: common : 32] Successfully loaded yaml file: config\config.yaml
[2024-11-11 10:39:53,886] INFO: common : 32] Successfully loaded yaml file: params.yaml
[2024-11-11 10:39:53,897] INFO: common : 32] Successfully loaded yaml file: schema.yaml
[2024-11-11 10:39:53,897] INFO: common : 55] Created directory: artifacts
[2024-11-11 10:39:53,897] INFO: common : 55] Created directory: artifacts/data_ingestion
[2024-11-11 10:39:53,900] INFO: data_ingestion : 17] Loading customers data...
[2024-11-11 10:39:53,964] INFO: common : 79] Successfully loaded DataFrame from: data\customers.csv
[2024-11-11 10:39:53,964] INFO: data_ingestion : 20] Loading loans data...
[2024-11-11 10:39:54,052] INFO: common : 79] Successfully loaded DataFrame from: data\loans.csv
[2024-11-11 10:39:54,052] INFO: data_ingestion : 23] Loading bureau data...
[2024-11-11 10:39:54,084] INFO: common : 79] Successfully loaded DataFrame from: data\bureau_data.csv
[2024-11-11 10:39:54,084] INFO: data_ingestion : 26] The Shape of customers data: (50000, 12)
[2024-11-11 10:39:54,084] INFO: data_ingestion : 27] The Shape of loans data: (50000, 15)
[2024-11-11 10:39:54,084] INFO: data_ingestion : 28] The Shape of bureau data: (50000, 8)
[2024-11-11 10:39:54,376] INFO: common : 97] Successfully saved DataFrame to: artifacts\data_ingestion\data.csv
[2024-11-11 10:39:54,390] INFO: main : 14] >>>>>>>>>>>Completed Data Ingestion Stage<<<<<<<<<<<<<
[2024-11-11 10:39:54,390] INFO: main : 24] >>>>>>>>>>>Starting Data Pre-Processing Stage<<<<<<<<<<<<<
[2024-11-11 10:39:54,398] INFO: common : 32] Successfully loaded yaml file: config\config.yaml
[2024-11-11 10:39:54,399] INFO: common : 32] Successfully loaded yaml file: params.yaml
[2024-11-11 10:39:54,404] INFO: common : 32] Successfully loaded yaml file: schema.yaml
[2024-11-11 10:39:54,404] INFO: common : 55] Created directory: artifacts
[2024-11-11 10:39:54,404] INFO: common : 55] Created directory: artifacts/data_preprocessing
[2024-11-11 10:39:54,537] INFO: common : 79] Successfully loaded DataFrame from: artifacts\data_ingestion\data.csv
[2024-11-11 10:39:54,550] INFO: data_preprocessing : 26] The Valure counts for 'default' column: default
0    45703
1     4297
Name: count, dtype: int64
[2024-11-11 10:39:54,550] INFO: data_preprocessing : 42] No missing values found in column 'cust_id'
[2024-11-11 10:39:54,550] INFO: data_preprocessing : 42] No missing values found in column 'age'
[2024-11-11 10:39:54,558] INFO: data_preprocessing : 42] No missing values found in column 'gender'
[2024-11-11 10:39:54,559] INFO: data_preprocessing : 42] No missing values found in column 'marital_status'
[2024-11-11 10:39:54,563] INFO: data_preprocessing : 42] No missing values found in column 'employment_status'
[2024-11-11 10:39:54,563] INFO: data_preprocessing : 42] No missing values found in column 'income'
[2024-11-11 10:39:54,563] INFO: data_preprocessing : 42] No missing values found in column 'number_of_dependants'
[2024-11-11 10:39:54,566] WARNING: data_preprocessing : 33] Missing values found in column 'residence_type', replacing with 'Unknown'
[2024-11-11 10:39:54,569] INFO: data_preprocessing : 35] Missing values replaced in column 'residence_type' with mode 'Owned'
[2024-11-11 10:39:54,575] INFO: data_preprocessing : 42] No missing values found in column 'years_at_current_address'
[2024-11-11 10:39:54,577] INFO: data_preprocessing : 42] No missing values found in column 'city'
[2024-11-11 10:39:54,580] INFO: data_preprocessing : 42] No missing values found in column 'state'
[2024-11-11 10:39:54,581] INFO: data_preprocessing : 42] No missing values found in column 'zipcode'
[2024-11-11 10:39:54,582] INFO: data_preprocessing : 42] No missing values found in column 'loan_id'
[2024-11-11 10:39:54,582] INFO: data_preprocessing : 42] No missing values found in column 'loan_purpose'
[2024-11-11 10:39:54,587] INFO: data_preprocessing : 42] No missing values found in column 'loan_type'
[2024-11-11 10:39:54,587] INFO: data_preprocessing : 42] No missing values found in column 'sanction_amount'
[2024-11-11 10:39:54,587] INFO: data_preprocessing : 42] No missing values found in column 'loan_amount'
[2024-11-11 10:39:54,587] INFO: data_preprocessing : 42] No missing values found in column 'processing_fee'
[2024-11-11 10:39:54,587] INFO: data_preprocessing : 42] No missing values found in column 'gst'
[2024-11-11 10:39:54,587] INFO: data_preprocessing : 42] No missing values found in column 'net_disbursement'
[2024-11-11 10:39:54,587] INFO: data_preprocessing : 42] No missing values found in column 'loan_tenure_months'
[2024-11-11 10:39:54,587] INFO: data_preprocessing : 42] No missing values found in column 'principal_outstanding'
[2024-11-11 10:39:54,587] INFO: data_preprocessing : 42] No missing values found in column 'bank_balance_at_application'
[2024-11-11 10:39:54,592] INFO: data_preprocessing : 42] No missing values found in column 'disbursal_date'
[2024-11-11 10:39:54,592] INFO: data_preprocessing : 42] No missing values found in column 'installment_start_dt'
[2024-11-11 10:39:54,596] INFO: data_preprocessing : 42] No missing values found in column 'default'
[2024-11-11 10:39:54,596] INFO: data_preprocessing : 42] No missing values found in column 'number_of_open_accounts'
[2024-11-11 10:39:54,596] INFO: data_preprocessing : 42] No missing values found in column 'number_of_closed_accounts'
[2024-11-11 10:39:54,596] INFO: data_preprocessing : 42] No missing values found in column 'total_loan_months'
[2024-11-11 10:39:54,596] INFO: data_preprocessing : 42] No missing values found in column 'delinquent_months'
[2024-11-11 10:39:54,596] INFO: data_preprocessing : 42] No missing values found in column 'total_dpd'
[2024-11-11 10:39:54,596] INFO: data_preprocessing : 42] No missing values found in column 'enquiry_count'
[2024-11-11 10:39:54,596] INFO: data_preprocessing : 42] No missing values found in column 'credit_utilization_ratio'
[2024-11-11 10:39:54,638] INFO: data_preprocessing : 51] No duplicate rows found
[2024-11-11 10:39:54,638] INFO: data_preprocessing : 53] Index(['cust_id', 'age', 'gender', 'marital_status', 'employment_status',
       'income', 'number_of_dependants', 'residence_type',
       'years_at_current_address', 'city', 'state', 'zipcode', 'loan_id',
       'loan_purpose', 'loan_type', 'sanction_amount', 'loan_amount',
       'processing_fee', 'gst', 'net_disbursement', 'loan_tenure_months',
       'principal_outstanding', 'bank_balance_at_application',
       'disbursal_date', 'installment_start_dt', 'default',
       'number_of_open_accounts', 'number_of_closed_accounts',
       'total_loan_months', 'delinquent_months', 'total_dpd', 'enquiry_count',
       'credit_utilization_ratio'],
      dtype='object')
[2024-11-11 10:39:54,940] INFO: common : 97] Successfully saved DataFrame to: artifacts\data_preprocessing\preprocessed_data.csv
[2024-11-11 10:39:54,940] INFO: main : 26] >>>>>>>>>>>Completed Data Pre-Processing Stage<<<<<<<<<<<<<
[2024-11-11 10:39:54,940] INFO: main : 36] >>>>>>>>>>>Starting Data Cleaning Stage<<<<<<<<<<<<<
[2024-11-11 10:39:54,940] INFO: common : 32] Successfully loaded yaml file: config\config.yaml
[2024-11-11 10:39:54,940] INFO: common : 32] Successfully loaded yaml file: params.yaml
[2024-11-11 10:39:54,957] INFO: common : 32] Successfully loaded yaml file: schema.yaml
[2024-11-11 10:39:54,957] INFO: common : 55] Created directory: artifacts
[2024-11-11 10:39:54,957] INFO: common : 55] Created directory: artifacts/data_cleaning
[2024-11-11 10:39:55,082] INFO: common : 79] Successfully loaded DataFrame from: artifacts\data_preprocessing\preprocessed_data.csv
[2024-11-11 10:39:55,082] INFO: data_cleaning : 34] Initiating train test split...
[2024-11-11 10:39:55,096] INFO: data_cleaning : 36] Train test split completed successfully.
[2024-11-11 10:39:55,096] INFO: data_cleaning : 91] Train_df :Index(['cust_id', 'age', 'gender', 'marital_status', 'employment_status',
       'income', 'number_of_dependants', 'residence_type',
       'years_at_current_address', 'city', 'state', 'zipcode', 'loan_id',
       'loan_purpose', 'loan_type', 'sanction_amount', 'loan_amount',
       'processing_fee', 'gst', 'net_disbursement', 'loan_tenure_months',
       'principal_outstanding', 'bank_balance_at_application',
       'disbursal_date', 'installment_start_dt', 'default',
       'number_of_open_accounts', 'number_of_closed_accounts',
       'total_loan_months', 'delinquent_months', 'total_dpd', 'enquiry_count',
       'credit_utilization_ratio'],
      dtype='object')
[2024-11-11 10:39:55,119] INFO: data_cleaning : 96]  After outlier removal train_df :(40000, 33)
[2024-11-11 10:39:55,119] INFO: data_cleaning : 97]  After outlier removal test_df :(10000, 33)
[2024-11-11 10:39:55,119] INFO: data_cleaning : 102] Rule 1: GST should not be more than 20% :(0, 33)
[2024-11-11 10:39:55,123] INFO: data_cleaning : 106] Rule 2: Net disbursement should not be higher than loan_amount :(0, 33)
[2024-11-11 10:39:55,128] INFO: data_cleaning : 111] Rule 3 : Fixed loan_purpose column :loan_purpose
Personal     14037
Home         12006
Auto          7950
Education     6007
Name: count, dtype: int64
[2024-11-11 10:39:55,133] INFO: data_cleaning : 116] Rule 4 : Generated loan_to_income column(LTI)
[2024-11-11 10:39:55,134] INFO: data_cleaning : 121] Generated delinquency_ratio column :count    40000.000000
mean        10.424123
std         17.283345
min          0.000000
25%          0.000000
50%          3.800000
75%         13.200000
max        100.000000
Name: delinquency_ratio, dtype: float64
[2024-11-11 10:39:55,142] INFO: data_cleaning : 135] Generated avg_dpd_per_delinquency column :count    40000.000000
mean         3.303845
std          2.902944
min          0.000000
25%          0.000000
50%          4.300000
75%          5.800000
max         10.000000
Name: avg_dpd_per_delinquency, dtype: float64
[2024-11-11 10:39:55,142] INFO: data_cleaning : 44] Removing columns...
[2024-11-11 10:39:55,145] INFO: data_cleaning : 46] Columns removed successfully.
[2024-11-11 10:39:55,145] INFO: data_cleaning : 44] Removing columns...
[2024-11-11 10:39:55,151] INFO: data_cleaning : 46] Columns removed successfully.
[2024-11-11 10:39:55,151] ERROR: data_cleaning : 72] Dtype mismatch in 'age': Expected int, got int64
[2024-11-11 10:39:55,151] INFO: data_cleaning : 76] Converted column 'age' to int.
[2024-11-11 10:39:55,151] ERROR: data_cleaning : 72] Dtype mismatch in 'loan_tenure_months': Expected int, got int64
[2024-11-11 10:39:55,151] INFO: data_cleaning : 76] Converted column 'loan_tenure_months' to int.
[2024-11-11 10:39:55,151] ERROR: data_cleaning : 72] Dtype mismatch in 'number_of_open_accounts': Expected int, got int64
[2024-11-11 10:39:55,151] INFO: data_cleaning : 76] Converted column 'number_of_open_accounts' to int.
[2024-11-11 10:39:55,151] ERROR: data_cleaning : 72] Dtype mismatch in 'credit_utilization_ratio': Expected int, got int64
[2024-11-11 10:39:55,156] INFO: data_cleaning : 76] Converted column 'credit_utilization_ratio' to int.
[2024-11-11 10:39:55,157] INFO: data_cleaning : 81] Schema validation successful: Columns and dtypes match.
[2024-11-11 10:39:55,157] ERROR: data_cleaning : 72] Dtype mismatch in 'age': Expected int, got int64
[2024-11-11 10:39:55,158] INFO: data_cleaning : 76] Converted column 'age' to int.
[2024-11-11 10:39:55,158] ERROR: data_cleaning : 72] Dtype mismatch in 'loan_tenure_months': Expected int, got int64
[2024-11-11 10:39:55,159] INFO: data_cleaning : 76] Converted column 'loan_tenure_months' to int.
[2024-11-11 10:39:55,159] ERROR: data_cleaning : 72] Dtype mismatch in 'number_of_open_accounts': Expected int, got int64
[2024-11-11 10:39:55,159] INFO: data_cleaning : 76] Converted column 'number_of_open_accounts' to int.
[2024-11-11 10:39:55,159] ERROR: data_cleaning : 72] Dtype mismatch in 'credit_utilization_ratio': Expected int, got int64
[2024-11-11 10:39:55,161] INFO: data_cleaning : 76] Converted column 'credit_utilization_ratio' to int.
[2024-11-11 10:39:55,161] INFO: data_cleaning : 81] Schema validation successful: Columns and dtypes match.
[2024-11-11 10:39:55,166] INFO: data_cleaning : 164] Categorical Columns : Index(['residence_type', 'loan_purpose', 'loan_type'], dtype='object')
[2024-11-11 10:39:55,167] INFO: data_cleaning : 165] Numerical Columns : Index(['loan_to_income', 'delinquency_ratio', 'avg_dpd_per_delinquency'], dtype='object')
[2024-11-11 10:39:55,211] ERROR: main : 41] An unexpected error occurred: Shape of passed values is (40000, 12), indices imply (40000, 6)
[2024-11-11 10:41:53,125] INFO: __init__ : 26] Credit Risk Model Building Started
[2024-11-11 10:41:55,451] INFO: main : 12] >>>>>>>>>>>Starting Data Ingestion Stage<<<<<<<<<<<<<
[2024-11-11 10:41:55,451] INFO: common : 32] Successfully loaded yaml file: config\config.yaml
[2024-11-11 10:41:55,451] INFO: common : 32] Successfully loaded yaml file: params.yaml
[2024-11-11 10:41:55,465] INFO: common : 32] Successfully loaded yaml file: schema.yaml
[2024-11-11 10:41:55,465] INFO: common : 55] Created directory: artifacts
[2024-11-11 10:41:55,465] INFO: common : 55] Created directory: artifacts/data_ingestion
[2024-11-11 10:41:55,465] INFO: data_ingestion : 17] Loading customers data...
[2024-11-11 10:41:55,603] INFO: common : 79] Successfully loaded DataFrame from: data\customers.csv
[2024-11-11 10:41:55,603] INFO: data_ingestion : 20] Loading loans data...
[2024-11-11 10:41:55,786] INFO: common : 79] Successfully loaded DataFrame from: data\loans.csv
[2024-11-11 10:41:55,786] INFO: data_ingestion : 23] Loading bureau data...
[2024-11-11 10:41:55,846] INFO: common : 79] Successfully loaded DataFrame from: data\bureau_data.csv
[2024-11-11 10:41:55,846] INFO: data_ingestion : 26] The Shape of customers data: (50000, 12)
[2024-11-11 10:41:55,846] INFO: data_ingestion : 27] The Shape of loans data: (50000, 15)
[2024-11-11 10:41:55,846] INFO: data_ingestion : 28] The Shape of bureau data: (50000, 8)
[2024-11-11 10:41:56,556] INFO: common : 97] Successfully saved DataFrame to: artifacts\data_ingestion\data.csv
[2024-11-11 10:41:56,556] INFO: main : 14] >>>>>>>>>>>Completed Data Ingestion Stage<<<<<<<<<<<<<
[2024-11-11 10:41:56,556] INFO: main : 24] >>>>>>>>>>>Starting Data Pre-Processing Stage<<<<<<<<<<<<<
[2024-11-11 10:41:56,570] INFO: common : 32] Successfully loaded yaml file: config\config.yaml
[2024-11-11 10:41:56,571] INFO: common : 32] Successfully loaded yaml file: params.yaml
[2024-11-11 10:41:56,576] INFO: common : 32] Successfully loaded yaml file: schema.yaml
[2024-11-11 10:41:56,576] INFO: common : 55] Created directory: artifacts
[2024-11-11 10:41:56,576] INFO: common : 55] Created directory: artifacts/data_preprocessing
[2024-11-11 10:41:56,839] INFO: common : 79] Successfully loaded DataFrame from: artifacts\data_ingestion\data.csv
[2024-11-11 10:41:56,839] INFO: data_preprocessing : 26] The Valure counts for 'default' column: default
0    45703
1     4297
Name: count, dtype: int64
[2024-11-11 10:41:56,839] INFO: data_preprocessing : 42] No missing values found in column 'cust_id'
[2024-11-11 10:41:56,839] INFO: data_preprocessing : 42] No missing values found in column 'age'
[2024-11-11 10:41:56,851] INFO: data_preprocessing : 42] No missing values found in column 'gender'
[2024-11-11 10:41:56,852] INFO: data_preprocessing : 42] No missing values found in column 'marital_status'
[2024-11-11 10:41:56,858] INFO: data_preprocessing : 42] No missing values found in column 'employment_status'
[2024-11-11 10:41:56,858] INFO: data_preprocessing : 42] No missing values found in column 'income'
[2024-11-11 10:41:56,858] INFO: data_preprocessing : 42] No missing values found in column 'number_of_dependants'
[2024-11-11 10:41:56,858] WARNING: data_preprocessing : 33] Missing values found in column 'residence_type', replacing with 'Unknown'
[2024-11-11 10:41:56,874] INFO: data_preprocessing : 35] Missing values replaced in column 'residence_type' with mode 'Owned'
[2024-11-11 10:41:56,878] INFO: data_preprocessing : 42] No missing values found in column 'years_at_current_address'
[2024-11-11 10:41:56,882] INFO: data_preprocessing : 42] No missing values found in column 'city'
[2024-11-11 10:41:56,882] INFO: data_preprocessing : 42] No missing values found in column 'state'
[2024-11-11 10:41:56,882] INFO: data_preprocessing : 42] No missing values found in column 'zipcode'
[2024-11-11 10:41:56,889] INFO: data_preprocessing : 42] No missing values found in column 'loan_id'
[2024-11-11 10:41:56,894] INFO: data_preprocessing : 42] No missing values found in column 'loan_purpose'
[2024-11-11 10:41:56,896] INFO: data_preprocessing : 42] No missing values found in column 'loan_type'
[2024-11-11 10:41:56,896] INFO: data_preprocessing : 42] No missing values found in column 'sanction_amount'
[2024-11-11 10:41:56,900] INFO: data_preprocessing : 42] No missing values found in column 'loan_amount'
[2024-11-11 10:41:56,900] INFO: data_preprocessing : 42] No missing values found in column 'processing_fee'
[2024-11-11 10:41:56,900] INFO: data_preprocessing : 42] No missing values found in column 'gst'
[2024-11-11 10:41:56,900] INFO: data_preprocessing : 42] No missing values found in column 'net_disbursement'
[2024-11-11 10:41:56,900] INFO: data_preprocessing : 42] No missing values found in column 'loan_tenure_months'
[2024-11-11 10:41:56,904] INFO: data_preprocessing : 42] No missing values found in column 'principal_outstanding'
[2024-11-11 10:41:56,906] INFO: data_preprocessing : 42] No missing values found in column 'bank_balance_at_application'
[2024-11-11 10:41:56,907] INFO: data_preprocessing : 42] No missing values found in column 'disbursal_date'
[2024-11-11 10:41:56,914] INFO: data_preprocessing : 42] No missing values found in column 'installment_start_dt'
[2024-11-11 10:41:56,914] INFO: data_preprocessing : 42] No missing values found in column 'default'
[2024-11-11 10:41:56,916] INFO: data_preprocessing : 42] No missing values found in column 'number_of_open_accounts'
[2024-11-11 10:41:56,916] INFO: data_preprocessing : 42] No missing values found in column 'number_of_closed_accounts'
[2024-11-11 10:41:56,916] INFO: data_preprocessing : 42] No missing values found in column 'total_loan_months'
[2024-11-11 10:41:56,916] INFO: data_preprocessing : 42] No missing values found in column 'delinquent_months'
[2024-11-11 10:41:56,919] INFO: data_preprocessing : 42] No missing values found in column 'total_dpd'
[2024-11-11 10:41:56,921] INFO: data_preprocessing : 42] No missing values found in column 'enquiry_count'
[2024-11-11 10:41:56,921] INFO: data_preprocessing : 42] No missing values found in column 'credit_utilization_ratio'
[2024-11-11 10:41:56,994] INFO: data_preprocessing : 51] No duplicate rows found
[2024-11-11 10:41:56,994] INFO: data_preprocessing : 53] Index(['cust_id', 'age', 'gender', 'marital_status', 'employment_status',
       'income', 'number_of_dependants', 'residence_type',
       'years_at_current_address', 'city', 'state', 'zipcode', 'loan_id',
       'loan_purpose', 'loan_type', 'sanction_amount', 'loan_amount',
       'processing_fee', 'gst', 'net_disbursement', 'loan_tenure_months',
       'principal_outstanding', 'bank_balance_at_application',
       'disbursal_date', 'installment_start_dt', 'default',
       'number_of_open_accounts', 'number_of_closed_accounts',
       'total_loan_months', 'delinquent_months', 'total_dpd', 'enquiry_count',
       'credit_utilization_ratio'],
      dtype='object')
[2024-11-11 10:41:57,573] INFO: common : 97] Successfully saved DataFrame to: artifacts\data_preprocessing\preprocessed_data.csv
[2024-11-11 10:41:57,573] INFO: main : 26] >>>>>>>>>>>Completed Data Pre-Processing Stage<<<<<<<<<<<<<
[2024-11-11 10:41:57,573] INFO: main : 36] >>>>>>>>>>>Starting Data Cleaning Stage<<<<<<<<<<<<<
[2024-11-11 10:41:57,588] INFO: common : 32] Successfully loaded yaml file: config\config.yaml
[2024-11-11 10:41:57,588] INFO: common : 32] Successfully loaded yaml file: params.yaml
[2024-11-11 10:41:57,593] INFO: common : 32] Successfully loaded yaml file: schema.yaml
[2024-11-11 10:41:57,594] INFO: common : 55] Created directory: artifacts
[2024-11-11 10:41:57,594] INFO: common : 55] Created directory: artifacts/data_cleaning
[2024-11-11 10:41:57,886] INFO: common : 79] Successfully loaded DataFrame from: artifacts\data_preprocessing\preprocessed_data.csv
[2024-11-11 10:41:57,886] INFO: data_cleaning : 34] Initiating train test split...
[2024-11-11 10:41:57,911] INFO: data_cleaning : 36] Train test split completed successfully.
[2024-11-11 10:41:57,911] INFO: data_cleaning : 91] Train_df :Index(['cust_id', 'age', 'gender', 'marital_status', 'employment_status',
       'income', 'number_of_dependants', 'residence_type',
       'years_at_current_address', 'city', 'state', 'zipcode', 'loan_id',
       'loan_purpose', 'loan_type', 'sanction_amount', 'loan_amount',
       'processing_fee', 'gst', 'net_disbursement', 'loan_tenure_months',
       'principal_outstanding', 'bank_balance_at_application',
       'disbursal_date', 'installment_start_dt', 'default',
       'number_of_open_accounts', 'number_of_closed_accounts',
       'total_loan_months', 'delinquent_months', 'total_dpd', 'enquiry_count',
       'credit_utilization_ratio'],
      dtype='object')
[2024-11-11 10:41:57,931] INFO: data_cleaning : 96]  After outlier removal train_df :(40000, 33)
[2024-11-11 10:41:57,935] INFO: data_cleaning : 97]  After outlier removal test_df :(10000, 33)
[2024-11-11 10:41:57,935] INFO: data_cleaning : 102] Rule 1: GST should not be more than 20% :(0, 33)
[2024-11-11 10:41:57,935] INFO: data_cleaning : 106] Rule 2: Net disbursement should not be higher than loan_amount :(0, 33)
[2024-11-11 10:41:57,947] INFO: data_cleaning : 111] Rule 3 : Fixed loan_purpose column :loan_purpose
Personal     14037
Home         12006
Auto          7950
Education     6007
Name: count, dtype: int64
[2024-11-11 10:41:57,952] INFO: data_cleaning : 116] Rule 4 : Generated loan_to_income column(LTI)
[2024-11-11 10:41:57,960] INFO: data_cleaning : 121] Generated delinquency_ratio column :count    40000.000000
mean        10.424123
std         17.283345
min          0.000000
25%          0.000000
50%          3.800000
75%         13.200000
max        100.000000
Name: delinquency_ratio, dtype: float64
[2024-11-11 10:41:57,970] INFO: data_cleaning : 135] Generated avg_dpd_per_delinquency column :count    40000.000000
mean         3.303845
std          2.902944
min          0.000000
25%          0.000000
50%          4.300000
75%          5.800000
max         10.000000
Name: avg_dpd_per_delinquency, dtype: float64
[2024-11-11 10:41:57,970] INFO: data_cleaning : 44] Removing columns...
[2024-11-11 10:41:57,976] INFO: data_cleaning : 46] Columns removed successfully.
[2024-11-11 10:41:57,976] INFO: data_cleaning : 44] Removing columns...
[2024-11-11 10:41:57,980] INFO: data_cleaning : 46] Columns removed successfully.
[2024-11-11 10:41:57,984] ERROR: data_cleaning : 72] Dtype mismatch in 'age': Expected int, got int64
[2024-11-11 10:41:57,984] INFO: data_cleaning : 76] Converted column 'age' to int.
[2024-11-11 10:41:57,984] ERROR: data_cleaning : 72] Dtype mismatch in 'loan_tenure_months': Expected int, got int64
[2024-11-11 10:41:57,984] INFO: data_cleaning : 76] Converted column 'loan_tenure_months' to int.
[2024-11-11 10:41:57,984] ERROR: data_cleaning : 72] Dtype mismatch in 'number_of_open_accounts': Expected int, got int64
[2024-11-11 10:41:57,984] INFO: data_cleaning : 76] Converted column 'number_of_open_accounts' to int.
[2024-11-11 10:41:57,984] ERROR: data_cleaning : 72] Dtype mismatch in 'credit_utilization_ratio': Expected int, got int64
[2024-11-11 10:41:57,989] INFO: data_cleaning : 76] Converted column 'credit_utilization_ratio' to int.
[2024-11-11 10:41:57,990] INFO: data_cleaning : 81] Schema validation successful: Columns and dtypes match.
[2024-11-11 10:41:57,991] ERROR: data_cleaning : 72] Dtype mismatch in 'age': Expected int, got int64
[2024-11-11 10:41:57,992] INFO: data_cleaning : 76] Converted column 'age' to int.
[2024-11-11 10:41:57,992] ERROR: data_cleaning : 72] Dtype mismatch in 'loan_tenure_months': Expected int, got int64
[2024-11-11 10:41:57,992] INFO: data_cleaning : 76] Converted column 'loan_tenure_months' to int.
[2024-11-11 10:41:57,992] ERROR: data_cleaning : 72] Dtype mismatch in 'number_of_open_accounts': Expected int, got int64
[2024-11-11 10:41:57,992] INFO: data_cleaning : 76] Converted column 'number_of_open_accounts' to int.
[2024-11-11 10:41:57,992] ERROR: data_cleaning : 72] Dtype mismatch in 'credit_utilization_ratio': Expected int, got int64
[2024-11-11 10:41:57,997] INFO: data_cleaning : 76] Converted column 'credit_utilization_ratio' to int.
[2024-11-11 10:41:57,997] INFO: data_cleaning : 81] Schema validation successful: Columns and dtypes match.
[2024-11-11 10:41:58,001] INFO: data_cleaning : 164] Categorical Columns : Index(['residence_type', 'loan_purpose', 'loan_type'], dtype='object')
[2024-11-11 10:41:58,001] INFO: data_cleaning : 165] Numerical Columns : Index(['loan_to_income', 'delinquency_ratio', 'avg_dpd_per_delinquency'], dtype='object')
[2024-11-11 10:41:58,076] ERROR: main : 41] An unexpected error occurred: Shape of passed values is (40000, 12), indices imply (40000, 3)
[2024-11-11 10:43:19,180] INFO: __init__ : 26] Credit Risk Model Building Started
[2024-11-11 10:43:21,387] INFO: main : 12] >>>>>>>>>>>Starting Data Ingestion Stage<<<<<<<<<<<<<
[2024-11-11 10:43:21,390] INFO: common : 32] Successfully loaded yaml file: config\config.yaml
[2024-11-11 10:43:21,390] INFO: common : 32] Successfully loaded yaml file: params.yaml
[2024-11-11 10:43:21,390] INFO: common : 32] Successfully loaded yaml file: schema.yaml
[2024-11-11 10:43:21,390] INFO: common : 55] Created directory: artifacts
[2024-11-11 10:43:21,390] INFO: common : 55] Created directory: artifacts/data_ingestion
[2024-11-11 10:43:21,390] INFO: data_ingestion : 17] Loading customers data...
[2024-11-11 10:43:21,479] INFO: common : 79] Successfully loaded DataFrame from: data\customers.csv
[2024-11-11 10:43:21,479] INFO: data_ingestion : 20] Loading loans data...
[2024-11-11 10:43:21,602] INFO: common : 79] Successfully loaded DataFrame from: data\loans.csv
[2024-11-11 10:43:21,602] INFO: data_ingestion : 23] Loading bureau data...
[2024-11-11 10:43:21,647] INFO: common : 79] Successfully loaded DataFrame from: data\bureau_data.csv
[2024-11-11 10:43:21,647] INFO: data_ingestion : 26] The Shape of customers data: (50000, 12)
[2024-11-11 10:43:21,647] INFO: data_ingestion : 27] The Shape of loans data: (50000, 15)
[2024-11-11 10:43:21,647] INFO: data_ingestion : 28] The Shape of bureau data: (50000, 8)
[2024-11-11 10:43:22,147] INFO: common : 97] Successfully saved DataFrame to: artifacts\data_ingestion\data.csv
[2024-11-11 10:43:22,147] INFO: main : 14] >>>>>>>>>>>Completed Data Ingestion Stage<<<<<<<<<<<<<
[2024-11-11 10:43:22,147] INFO: main : 24] >>>>>>>>>>>Starting Data Pre-Processing Stage<<<<<<<<<<<<<
[2024-11-11 10:43:22,162] INFO: common : 32] Successfully loaded yaml file: config\config.yaml
[2024-11-11 10:43:22,162] INFO: common : 32] Successfully loaded yaml file: params.yaml
[2024-11-11 10:43:22,162] INFO: common : 32] Successfully loaded yaml file: schema.yaml
[2024-11-11 10:43:22,162] INFO: common : 55] Created directory: artifacts
[2024-11-11 10:43:22,162] INFO: common : 55] Created directory: artifacts/data_preprocessing
[2024-11-11 10:43:22,387] INFO: common : 79] Successfully loaded DataFrame from: artifacts\data_ingestion\data.csv
[2024-11-11 10:43:22,390] INFO: data_preprocessing : 26] The Valure counts for 'default' column: default
0    45703
1     4297
Name: count, dtype: int64
[2024-11-11 10:43:22,390] INFO: data_preprocessing : 42] No missing values found in column 'cust_id'
[2024-11-11 10:43:22,395] INFO: data_preprocessing : 42] No missing values found in column 'age'
[2024-11-11 10:43:22,396] INFO: data_preprocessing : 42] No missing values found in column 'gender'
[2024-11-11 10:43:22,396] INFO: data_preprocessing : 42] No missing values found in column 'marital_status'
[2024-11-11 10:43:22,404] INFO: data_preprocessing : 42] No missing values found in column 'employment_status'
[2024-11-11 10:43:22,404] INFO: data_preprocessing : 42] No missing values found in column 'income'
[2024-11-11 10:43:22,404] INFO: data_preprocessing : 42] No missing values found in column 'number_of_dependants'
[2024-11-11 10:43:22,404] WARNING: data_preprocessing : 33] Missing values found in column 'residence_type', replacing with 'Unknown'
[2024-11-11 10:43:22,421] INFO: data_preprocessing : 35] Missing values replaced in column 'residence_type' with mode 'Owned'
[2024-11-11 10:43:22,422] INFO: data_preprocessing : 42] No missing values found in column 'years_at_current_address'
[2024-11-11 10:43:22,422] INFO: data_preprocessing : 42] No missing values found in column 'city'
[2024-11-11 10:43:22,428] INFO: data_preprocessing : 42] No missing values found in column 'state'
[2024-11-11 10:43:22,429] INFO: data_preprocessing : 42] No missing values found in column 'zipcode'
[2024-11-11 10:43:22,430] INFO: data_preprocessing : 42] No missing values found in column 'loan_id'
[2024-11-11 10:43:22,435] INFO: data_preprocessing : 42] No missing values found in column 'loan_purpose'
[2024-11-11 10:43:22,437] INFO: data_preprocessing : 42] No missing values found in column 'loan_type'
[2024-11-11 10:43:22,437] INFO: data_preprocessing : 42] No missing values found in column 'sanction_amount'
[2024-11-11 10:43:22,437] INFO: data_preprocessing : 42] No missing values found in column 'loan_amount'
[2024-11-11 10:43:22,437] INFO: data_preprocessing : 42] No missing values found in column 'processing_fee'
[2024-11-11 10:43:22,441] INFO: data_preprocessing : 42] No missing values found in column 'gst'
[2024-11-11 10:43:22,443] INFO: data_preprocessing : 42] No missing values found in column 'net_disbursement'
[2024-11-11 10:43:22,443] INFO: data_preprocessing : 42] No missing values found in column 'loan_tenure_months'
[2024-11-11 10:43:22,443] INFO: data_preprocessing : 42] No missing values found in column 'principal_outstanding'
[2024-11-11 10:43:22,443] INFO: data_preprocessing : 42] No missing values found in column 'bank_balance_at_application'
[2024-11-11 10:43:22,447] INFO: data_preprocessing : 42] No missing values found in column 'disbursal_date'
[2024-11-11 10:43:22,450] INFO: data_preprocessing : 42] No missing values found in column 'installment_start_dt'
[2024-11-11 10:43:22,450] INFO: data_preprocessing : 42] No missing values found in column 'default'
[2024-11-11 10:43:22,450] INFO: data_preprocessing : 42] No missing values found in column 'number_of_open_accounts'
[2024-11-11 10:43:22,450] INFO: data_preprocessing : 42] No missing values found in column 'number_of_closed_accounts'
[2024-11-11 10:43:22,450] INFO: data_preprocessing : 42] No missing values found in column 'total_loan_months'
[2024-11-11 10:43:22,454] INFO: data_preprocessing : 42] No missing values found in column 'delinquent_months'
[2024-11-11 10:43:22,454] INFO: data_preprocessing : 42] No missing values found in column 'total_dpd'
[2024-11-11 10:43:22,454] INFO: data_preprocessing : 42] No missing values found in column 'enquiry_count'
[2024-11-11 10:43:22,454] INFO: data_preprocessing : 42] No missing values found in column 'credit_utilization_ratio'
[2024-11-11 10:43:22,513] INFO: data_preprocessing : 51] No duplicate rows found
[2024-11-11 10:43:22,513] INFO: data_preprocessing : 53] Index(['cust_id', 'age', 'gender', 'marital_status', 'employment_status',
       'income', 'number_of_dependants', 'residence_type',
       'years_at_current_address', 'city', 'state', 'zipcode', 'loan_id',
       'loan_purpose', 'loan_type', 'sanction_amount', 'loan_amount',
       'processing_fee', 'gst', 'net_disbursement', 'loan_tenure_months',
       'principal_outstanding', 'bank_balance_at_application',
       'disbursal_date', 'installment_start_dt', 'default',
       'number_of_open_accounts', 'number_of_closed_accounts',
       'total_loan_months', 'delinquent_months', 'total_dpd', 'enquiry_count',
       'credit_utilization_ratio'],
      dtype='object')
[2024-11-11 10:43:23,023] INFO: common : 97] Successfully saved DataFrame to: artifacts\data_preprocessing\preprocessed_data.csv
[2024-11-11 10:43:23,027] INFO: main : 26] >>>>>>>>>>>Completed Data Pre-Processing Stage<<<<<<<<<<<<<
[2024-11-11 10:43:23,028] INFO: main : 36] >>>>>>>>>>>Starting Data Cleaning Stage<<<<<<<<<<<<<
[2024-11-11 10:43:23,030] INFO: common : 32] Successfully loaded yaml file: config\config.yaml
[2024-11-11 10:43:23,032] INFO: common : 32] Successfully loaded yaml file: params.yaml
[2024-11-11 10:43:23,035] INFO: common : 32] Successfully loaded yaml file: schema.yaml
[2024-11-11 10:43:23,035] INFO: common : 55] Created directory: artifacts
[2024-11-11 10:43:23,035] INFO: common : 55] Created directory: artifacts/data_cleaning
[2024-11-11 10:43:23,271] INFO: common : 79] Successfully loaded DataFrame from: artifacts\data_preprocessing\preprocessed_data.csv
[2024-11-11 10:43:23,271] INFO: data_cleaning : 34] Initiating train test split...
[2024-11-11 10:43:23,302] INFO: data_cleaning : 36] Train test split completed successfully.
[2024-11-11 10:43:23,304] INFO: data_cleaning : 91] Train_df :Index(['cust_id', 'age', 'gender', 'marital_status', 'employment_status',
       'income', 'number_of_dependants', 'residence_type',
       'years_at_current_address', 'city', 'state', 'zipcode', 'loan_id',
       'loan_purpose', 'loan_type', 'sanction_amount', 'loan_amount',
       'processing_fee', 'gst', 'net_disbursement', 'loan_tenure_months',
       'principal_outstanding', 'bank_balance_at_application',
       'disbursal_date', 'installment_start_dt', 'default',
       'number_of_open_accounts', 'number_of_closed_accounts',
       'total_loan_months', 'delinquent_months', 'total_dpd', 'enquiry_count',
       'credit_utilization_ratio'],
      dtype='object')
[2024-11-11 10:43:23,324] INFO: data_cleaning : 96]  After outlier removal train_df :(40000, 33)
[2024-11-11 10:43:23,324] INFO: data_cleaning : 97]  After outlier removal test_df :(10000, 33)
[2024-11-11 10:43:23,326] INFO: data_cleaning : 102] Rule 1: GST should not be more than 20% :(0, 33)
[2024-11-11 10:43:23,327] INFO: data_cleaning : 106] Rule 2: Net disbursement should not be higher than loan_amount :(0, 33)
[2024-11-11 10:43:23,333] INFO: data_cleaning : 111] Rule 3 : Fixed loan_purpose column :loan_purpose
Personal     14037
Home         12006
Auto          7950
Education     6007
Name: count, dtype: int64
[2024-11-11 10:43:23,340] INFO: data_cleaning : 116] Rule 4 : Generated loan_to_income column(LTI)
[2024-11-11 10:43:23,348] INFO: data_cleaning : 121] Generated delinquency_ratio column :count    40000.000000
mean        10.424123
std         17.283345
min          0.000000
25%          0.000000
50%          3.800000
75%         13.200000
max        100.000000
Name: delinquency_ratio, dtype: float64
[2024-11-11 10:43:23,350] INFO: data_cleaning : 135] Generated avg_dpd_per_delinquency column :count    40000.000000
mean         3.303845
std          2.902944
min          0.000000
25%          0.000000
50%          4.300000
75%          5.800000
max         10.000000
Name: avg_dpd_per_delinquency, dtype: float64
[2024-11-11 10:43:23,356] INFO: data_cleaning : 44] Removing columns...
[2024-11-11 10:43:23,357] INFO: data_cleaning : 46] Columns removed successfully.
[2024-11-11 10:43:23,357] INFO: data_cleaning : 44] Removing columns...
[2024-11-11 10:43:23,366] INFO: data_cleaning : 46] Columns removed successfully.
[2024-11-11 10:43:23,366] ERROR: data_cleaning : 72] Dtype mismatch in 'age': Expected int, got int64
[2024-11-11 10:43:23,366] INFO: data_cleaning : 76] Converted column 'age' to int.
[2024-11-11 10:43:23,366] ERROR: data_cleaning : 72] Dtype mismatch in 'loan_tenure_months': Expected int, got int64
[2024-11-11 10:43:23,371] INFO: data_cleaning : 76] Converted column 'loan_tenure_months' to int.
[2024-11-11 10:43:23,371] ERROR: data_cleaning : 72] Dtype mismatch in 'number_of_open_accounts': Expected int, got int64
[2024-11-11 10:43:23,372] INFO: data_cleaning : 76] Converted column 'number_of_open_accounts' to int.
[2024-11-11 10:43:23,373] ERROR: data_cleaning : 72] Dtype mismatch in 'credit_utilization_ratio': Expected int, got int64
[2024-11-11 10:43:23,373] INFO: data_cleaning : 76] Converted column 'credit_utilization_ratio' to int.
[2024-11-11 10:43:23,373] INFO: data_cleaning : 81] Schema validation successful: Columns and dtypes match.
[2024-11-11 10:43:23,373] ERROR: data_cleaning : 72] Dtype mismatch in 'age': Expected int, got int64
[2024-11-11 10:43:23,373] INFO: data_cleaning : 76] Converted column 'age' to int.
[2024-11-11 10:43:23,376] ERROR: data_cleaning : 72] Dtype mismatch in 'loan_tenure_months': Expected int, got int64
[2024-11-11 10:43:23,376] INFO: data_cleaning : 76] Converted column 'loan_tenure_months' to int.
[2024-11-11 10:43:23,376] ERROR: data_cleaning : 72] Dtype mismatch in 'number_of_open_accounts': Expected int, got int64
[2024-11-11 10:43:23,378] INFO: data_cleaning : 76] Converted column 'number_of_open_accounts' to int.
[2024-11-11 10:43:23,378] ERROR: data_cleaning : 72] Dtype mismatch in 'credit_utilization_ratio': Expected int, got int64
[2024-11-11 10:43:23,378] INFO: data_cleaning : 76] Converted column 'credit_utilization_ratio' to int.
[2024-11-11 10:43:23,380] INFO: data_cleaning : 81] Schema validation successful: Columns and dtypes match.
[2024-11-11 10:43:23,382] INFO: data_cleaning : 165] Categorical Columns : Index(['residence_type', 'loan_purpose', 'loan_type'], dtype='object')
[2024-11-11 10:43:23,382] INFO: data_cleaning : 166] Numerical Columns : Index(['loan_to_income', 'delinquency_ratio', 'avg_dpd_per_delinquency'], dtype='object')
[2024-11-11 10:43:23,461] ERROR: main : 41] An unexpected error occurred: Shape of passed values is (40000, 12), indices imply (40000, 10)
[2024-11-11 10:46:03,779] INFO: __init__ : 26] Credit Risk Model Building Started
[2024-11-11 10:46:05,837] INFO: main : 12] >>>>>>>>>>>Starting Data Ingestion Stage<<<<<<<<<<<<<
[2024-11-11 10:46:05,837] INFO: common : 32] Successfully loaded yaml file: config\config.yaml
[2024-11-11 10:46:05,837] INFO: common : 32] Successfully loaded yaml file: params.yaml
[2024-11-11 10:46:05,848] INFO: common : 32] Successfully loaded yaml file: schema.yaml
[2024-11-11 10:46:05,848] INFO: common : 55] Created directory: artifacts
[2024-11-11 10:46:05,848] INFO: common : 55] Created directory: artifacts/data_ingestion
[2024-11-11 10:46:05,848] INFO: data_ingestion : 17] Loading customers data...
[2024-11-11 10:46:05,935] INFO: common : 79] Successfully loaded DataFrame from: data\customers.csv
[2024-11-11 10:46:05,944] INFO: data_ingestion : 20] Loading loans data...
[2024-11-11 10:46:06,069] INFO: common : 79] Successfully loaded DataFrame from: data\loans.csv
[2024-11-11 10:46:06,069] INFO: data_ingestion : 23] Loading bureau data...
[2024-11-11 10:46:06,113] INFO: common : 79] Successfully loaded DataFrame from: data\bureau_data.csv
[2024-11-11 10:46:06,113] INFO: data_ingestion : 26] The Shape of customers data: (50000, 12)
[2024-11-11 10:46:06,113] INFO: data_ingestion : 27] The Shape of loans data: (50000, 15)
[2024-11-11 10:46:06,113] INFO: data_ingestion : 28] The Shape of bureau data: (50000, 8)
[2024-11-11 10:46:06,686] INFO: common : 97] Successfully saved DataFrame to: artifacts\data_ingestion\data.csv
[2024-11-11 10:46:06,686] INFO: main : 14] >>>>>>>>>>>Completed Data Ingestion Stage<<<<<<<<<<<<<
[2024-11-11 10:46:06,686] INFO: main : 24] >>>>>>>>>>>Starting Data Pre-Processing Stage<<<<<<<<<<<<<
[2024-11-11 10:46:06,703] INFO: common : 32] Successfully loaded yaml file: config\config.yaml
[2024-11-11 10:46:06,703] INFO: common : 32] Successfully loaded yaml file: params.yaml
[2024-11-11 10:46:06,707] INFO: common : 32] Successfully loaded yaml file: schema.yaml
[2024-11-11 10:46:06,708] INFO: common : 55] Created directory: artifacts
[2024-11-11 10:46:06,708] INFO: common : 55] Created directory: artifacts/data_preprocessing
[2024-11-11 10:46:06,960] INFO: common : 79] Successfully loaded DataFrame from: artifacts\data_ingestion\data.csv
[2024-11-11 10:46:06,976] INFO: data_preprocessing : 26] The Valure counts for 'default' column: default
0    45703
1     4297
Name: count, dtype: int64
[2024-11-11 10:46:06,980] INFO: data_preprocessing : 42] No missing values found in column 'cust_id'
[2024-11-11 10:46:06,981] INFO: data_preprocessing : 42] No missing values found in column 'age'
[2024-11-11 10:46:06,984] INFO: data_preprocessing : 42] No missing values found in column 'gender'
[2024-11-11 10:46:06,986] INFO: data_preprocessing : 42] No missing values found in column 'marital_status'
[2024-11-11 10:46:06,986] INFO: data_preprocessing : 42] No missing values found in column 'employment_status'
[2024-11-11 10:46:06,986] INFO: data_preprocessing : 42] No missing values found in column 'income'
[2024-11-11 10:46:06,992] INFO: data_preprocessing : 42] No missing values found in column 'number_of_dependants'
[2024-11-11 10:46:06,995] WARNING: data_preprocessing : 33] Missing values found in column 'residence_type', replacing with 'Unknown'
[2024-11-11 10:46:07,001] INFO: data_preprocessing : 35] Missing values replaced in column 'residence_type' with mode 'Owned'
[2024-11-11 10:46:07,001] INFO: data_preprocessing : 42] No missing values found in column 'years_at_current_address'
[2024-11-11 10:46:07,015] INFO: data_preprocessing : 42] No missing values found in column 'city'
[2024-11-11 10:46:07,015] INFO: data_preprocessing : 42] No missing values found in column 'state'
[2024-11-11 10:46:07,020] INFO: data_preprocessing : 42] No missing values found in column 'zipcode'
[2024-11-11 10:46:07,021] INFO: data_preprocessing : 42] No missing values found in column 'loan_id'
[2024-11-11 10:46:07,026] INFO: data_preprocessing : 42] No missing values found in column 'loan_purpose'
[2024-11-11 10:46:07,029] INFO: data_preprocessing : 42] No missing values found in column 'loan_type'
[2024-11-11 10:46:07,029] INFO: data_preprocessing : 42] No missing values found in column 'sanction_amount'
[2024-11-11 10:46:07,031] INFO: data_preprocessing : 42] No missing values found in column 'loan_amount'
[2024-11-11 10:46:07,031] INFO: data_preprocessing : 42] No missing values found in column 'processing_fee'
[2024-11-11 10:46:07,031] INFO: data_preprocessing : 42] No missing values found in column 'gst'
[2024-11-11 10:46:07,031] INFO: data_preprocessing : 42] No missing values found in column 'net_disbursement'
[2024-11-11 10:46:07,035] INFO: data_preprocessing : 42] No missing values found in column 'loan_tenure_months'
[2024-11-11 10:46:07,036] INFO: data_preprocessing : 42] No missing values found in column 'principal_outstanding'
[2024-11-11 10:46:07,036] INFO: data_preprocessing : 42] No missing values found in column 'bank_balance_at_application'
[2024-11-11 10:46:07,037] INFO: data_preprocessing : 42] No missing values found in column 'disbursal_date'
[2024-11-11 10:46:07,043] INFO: data_preprocessing : 42] No missing values found in column 'installment_start_dt'
[2024-11-11 10:46:07,043] INFO: data_preprocessing : 42] No missing values found in column 'default'
[2024-11-11 10:46:07,043] INFO: data_preprocessing : 42] No missing values found in column 'number_of_open_accounts'
[2024-11-11 10:46:07,043] INFO: data_preprocessing : 42] No missing values found in column 'number_of_closed_accounts'
[2024-11-11 10:46:07,046] INFO: data_preprocessing : 42] No missing values found in column 'total_loan_months'
[2024-11-11 10:46:07,046] INFO: data_preprocessing : 42] No missing values found in column 'delinquent_months'
[2024-11-11 10:46:07,047] INFO: data_preprocessing : 42] No missing values found in column 'total_dpd'
[2024-11-11 10:46:07,047] INFO: data_preprocessing : 42] No missing values found in column 'enquiry_count'
[2024-11-11 10:46:07,049] INFO: data_preprocessing : 42] No missing values found in column 'credit_utilization_ratio'
[2024-11-11 10:46:07,116] INFO: data_preprocessing : 51] No duplicate rows found
[2024-11-11 10:46:07,116] INFO: data_preprocessing : 53] Index(['cust_id', 'age', 'gender', 'marital_status', 'employment_status',
       'income', 'number_of_dependants', 'residence_type',
       'years_at_current_address', 'city', 'state', 'zipcode', 'loan_id',
       'loan_purpose', 'loan_type', 'sanction_amount', 'loan_amount',
       'processing_fee', 'gst', 'net_disbursement', 'loan_tenure_months',
       'principal_outstanding', 'bank_balance_at_application',
       'disbursal_date', 'installment_start_dt', 'default',
       'number_of_open_accounts', 'number_of_closed_accounts',
       'total_loan_months', 'delinquent_months', 'total_dpd', 'enquiry_count',
       'credit_utilization_ratio'],
      dtype='object')
[2024-11-11 10:46:07,595] INFO: common : 97] Successfully saved DataFrame to: artifacts\data_preprocessing\preprocessed_data.csv
[2024-11-11 10:46:07,609] INFO: main : 26] >>>>>>>>>>>Completed Data Pre-Processing Stage<<<<<<<<<<<<<
[2024-11-11 10:46:07,609] INFO: main : 36] >>>>>>>>>>>Starting Data Cleaning Stage<<<<<<<<<<<<<
[2024-11-11 10:46:07,614] INFO: common : 32] Successfully loaded yaml file: config\config.yaml
[2024-11-11 10:46:07,617] INFO: common : 32] Successfully loaded yaml file: params.yaml
[2024-11-11 10:46:07,619] INFO: common : 32] Successfully loaded yaml file: schema.yaml
[2024-11-11 10:46:07,621] INFO: common : 55] Created directory: artifacts
[2024-11-11 10:46:07,621] INFO: common : 55] Created directory: artifacts/data_cleaning
[2024-11-11 10:46:07,822] INFO: common : 79] Successfully loaded DataFrame from: artifacts\data_preprocessing\preprocessed_data.csv
[2024-11-11 10:46:07,822] INFO: data_cleaning : 34] Initiating train test split...
[2024-11-11 10:46:07,837] INFO: data_cleaning : 36] Train test split completed successfully.
[2024-11-11 10:46:07,853] INFO: data_cleaning : 91] Train_df :Index(['cust_id', 'age', 'gender', 'marital_status', 'employment_status',
       'income', 'number_of_dependants', 'residence_type',
       'years_at_current_address', 'city', 'state', 'zipcode', 'loan_id',
       'loan_purpose', 'loan_type', 'sanction_amount', 'loan_amount',
       'processing_fee', 'gst', 'net_disbursement', 'loan_tenure_months',
       'principal_outstanding', 'bank_balance_at_application',
       'disbursal_date', 'installment_start_dt', 'default',
       'number_of_open_accounts', 'number_of_closed_accounts',
       'total_loan_months', 'delinquent_months', 'total_dpd', 'enquiry_count',
       'credit_utilization_ratio'],
      dtype='object')
[2024-11-11 10:46:07,864] INFO: data_cleaning : 96]  After outlier removal train_df :(40000, 33)
[2024-11-11 10:46:07,864] INFO: data_cleaning : 97]  After outlier removal test_df :(10000, 33)
[2024-11-11 10:46:07,872] INFO: data_cleaning : 102] Rule 1: GST should not be more than 20% :(0, 33)
[2024-11-11 10:46:07,872] INFO: data_cleaning : 106] Rule 2: Net disbursement should not be higher than loan_amount :(0, 33)
[2024-11-11 10:46:07,881] INFO: data_cleaning : 111] Rule 3 : Fixed loan_purpose column :loan_purpose
Personal     14037
Home         12006
Auto          7950
Education     6007
Name: count, dtype: int64
[2024-11-11 10:46:07,881] INFO: data_cleaning : 116] Rule 4 : Generated loan_to_income column(LTI)
[2024-11-11 10:46:07,891] INFO: data_cleaning : 121] Generated delinquency_ratio column :count    40000.000000
mean        10.424123
std         17.283345
min          0.000000
25%          0.000000
50%          3.800000
75%         13.200000
max        100.000000
Name: delinquency_ratio, dtype: float64
[2024-11-11 10:46:07,898] INFO: data_cleaning : 135] Generated avg_dpd_per_delinquency column :count    40000.000000
mean         3.303845
std          2.902944
min          0.000000
25%          0.000000
50%          4.300000
75%          5.800000
max         10.000000
Name: avg_dpd_per_delinquency, dtype: float64
[2024-11-11 10:46:07,902] INFO: data_cleaning : 44] Removing columns...
[2024-11-11 10:46:07,902] INFO: data_cleaning : 46] Columns removed successfully.
[2024-11-11 10:46:07,907] INFO: data_cleaning : 44] Removing columns...
[2024-11-11 10:46:07,907] INFO: data_cleaning : 46] Columns removed successfully.
[2024-11-11 10:46:07,907] ERROR: data_cleaning : 72] Dtype mismatch in 'age': Expected int, got int64
[2024-11-11 10:46:07,907] INFO: data_cleaning : 76] Converted column 'age' to int.
[2024-11-11 10:46:07,912] ERROR: data_cleaning : 72] Dtype mismatch in 'loan_tenure_months': Expected int, got int64
[2024-11-11 10:46:07,913] INFO: data_cleaning : 76] Converted column 'loan_tenure_months' to int.
[2024-11-11 10:46:07,914] ERROR: data_cleaning : 72] Dtype mismatch in 'number_of_open_accounts': Expected int, got int64
[2024-11-11 10:46:07,914] INFO: data_cleaning : 76] Converted column 'number_of_open_accounts' to int.
[2024-11-11 10:46:07,914] ERROR: data_cleaning : 72] Dtype mismatch in 'credit_utilization_ratio': Expected int, got int64
[2024-11-11 10:46:07,914] INFO: data_cleaning : 76] Converted column 'credit_utilization_ratio' to int.
[2024-11-11 10:46:07,914] INFO: data_cleaning : 81] Schema validation successful: Columns and dtypes match.
[2024-11-11 10:46:07,914] ERROR: data_cleaning : 72] Dtype mismatch in 'age': Expected int, got int64
[2024-11-11 10:46:07,914] INFO: data_cleaning : 76] Converted column 'age' to int.
[2024-11-11 10:46:07,918] ERROR: data_cleaning : 72] Dtype mismatch in 'loan_tenure_months': Expected int, got int64
[2024-11-11 10:46:07,919] INFO: data_cleaning : 76] Converted column 'loan_tenure_months' to int.
[2024-11-11 10:46:07,919] ERROR: data_cleaning : 72] Dtype mismatch in 'number_of_open_accounts': Expected int, got int64
[2024-11-11 10:46:07,919] INFO: data_cleaning : 76] Converted column 'number_of_open_accounts' to int.
[2024-11-11 10:46:07,919] ERROR: data_cleaning : 72] Dtype mismatch in 'credit_utilization_ratio': Expected int, got int64
[2024-11-11 10:46:07,919] INFO: data_cleaning : 76] Converted column 'credit_utilization_ratio' to int.
[2024-11-11 10:46:07,921] INFO: data_cleaning : 81] Schema validation successful: Columns and dtypes match.
[2024-11-11 10:46:07,921] INFO: data_cleaning : 165] Categorical Columns : Index(['residence_type', 'loan_purpose', 'loan_type'], dtype='object')
[2024-11-11 10:46:07,921] INFO: data_cleaning : 166] Numerical Columns : Index(['age', 'loan_tenure_months', 'number_of_open_accounts',
       'credit_utilization_ratio', 'loan_to_income', 'delinquency_ratio',
       'avg_dpd_per_delinquency'],
      dtype='object')
[2024-11-11 10:46:08,023] ERROR: main : 41] An unexpected error occurred: Shape of passed values is (40000, 16), indices imply (40000, 10)
[2024-11-11 10:46:44,718] INFO: __init__ : 26] Credit Risk Model Building Started
[2024-11-11 10:46:46,811] INFO: main : 12] >>>>>>>>>>>Starting Data Ingestion Stage<<<<<<<<<<<<<
[2024-11-11 10:46:46,814] INFO: common : 32] Successfully loaded yaml file: config\config.yaml
[2024-11-11 10:46:46,816] INFO: common : 32] Successfully loaded yaml file: params.yaml
[2024-11-11 10:46:46,819] INFO: common : 32] Successfully loaded yaml file: schema.yaml
[2024-11-11 10:46:46,820] INFO: common : 55] Created directory: artifacts
[2024-11-11 10:46:46,821] INFO: common : 55] Created directory: artifacts/data_ingestion
[2024-11-11 10:46:46,821] INFO: data_ingestion : 17] Loading customers data...
[2024-11-11 10:46:46,901] INFO: common : 79] Successfully loaded DataFrame from: data\customers.csv
[2024-11-11 10:46:46,901] INFO: data_ingestion : 20] Loading loans data...
[2024-11-11 10:46:47,010] INFO: common : 79] Successfully loaded DataFrame from: data\loans.csv
[2024-11-11 10:46:47,010] INFO: data_ingestion : 23] Loading bureau data...
[2024-11-11 10:46:47,058] INFO: common : 79] Successfully loaded DataFrame from: data\bureau_data.csv
[2024-11-11 10:46:47,058] INFO: data_ingestion : 26] The Shape of customers data: (50000, 12)
[2024-11-11 10:46:47,058] INFO: data_ingestion : 27] The Shape of loans data: (50000, 15)
[2024-11-11 10:46:47,058] INFO: data_ingestion : 28] The Shape of bureau data: (50000, 8)
[2024-11-11 10:46:47,609] INFO: common : 97] Successfully saved DataFrame to: artifacts\data_ingestion\data.csv
[2024-11-11 10:46:47,623] INFO: main : 14] >>>>>>>>>>>Completed Data Ingestion Stage<<<<<<<<<<<<<
[2024-11-11 10:46:47,623] INFO: main : 24] >>>>>>>>>>>Starting Data Pre-Processing Stage<<<<<<<<<<<<<
[2024-11-11 10:46:47,628] INFO: common : 32] Successfully loaded yaml file: config\config.yaml
[2024-11-11 10:46:47,631] INFO: common : 32] Successfully loaded yaml file: params.yaml
[2024-11-11 10:46:47,631] INFO: common : 32] Successfully loaded yaml file: schema.yaml
[2024-11-11 10:46:47,631] INFO: common : 55] Created directory: artifacts
[2024-11-11 10:46:47,631] INFO: common : 55] Created directory: artifacts/data_preprocessing
[2024-11-11 10:46:47,846] INFO: common : 79] Successfully loaded DataFrame from: artifacts\data_ingestion\data.csv
[2024-11-11 10:46:47,846] INFO: data_preprocessing : 26] The Valure counts for 'default' column: default
0    45703
1     4297
Name: count, dtype: int64
[2024-11-11 10:46:47,846] INFO: data_preprocessing : 42] No missing values found in column 'cust_id'
[2024-11-11 10:46:47,846] INFO: data_preprocessing : 42] No missing values found in column 'age'
[2024-11-11 10:46:47,861] INFO: data_preprocessing : 42] No missing values found in column 'gender'
[2024-11-11 10:46:47,864] INFO: data_preprocessing : 42] No missing values found in column 'marital_status'
[2024-11-11 10:46:47,867] INFO: data_preprocessing : 42] No missing values found in column 'employment_status'
[2024-11-11 10:46:47,867] INFO: data_preprocessing : 42] No missing values found in column 'income'
[2024-11-11 10:46:47,867] INFO: data_preprocessing : 42] No missing values found in column 'number_of_dependants'
[2024-11-11 10:46:47,867] WARNING: data_preprocessing : 33] Missing values found in column 'residence_type', replacing with 'Unknown'
[2024-11-11 10:46:47,881] INFO: data_preprocessing : 35] Missing values replaced in column 'residence_type' with mode 'Owned'
[2024-11-11 10:46:47,881] INFO: data_preprocessing : 42] No missing values found in column 'years_at_current_address'
[2024-11-11 10:46:47,884] INFO: data_preprocessing : 42] No missing values found in column 'city'
[2024-11-11 10:46:47,890] INFO: data_preprocessing : 42] No missing values found in column 'state'
[2024-11-11 10:46:47,890] INFO: data_preprocessing : 42] No missing values found in column 'zipcode'
[2024-11-11 10:46:47,893] INFO: data_preprocessing : 42] No missing values found in column 'loan_id'
[2024-11-11 10:46:47,896] INFO: data_preprocessing : 42] No missing values found in column 'loan_purpose'
[2024-11-11 10:46:47,900] INFO: data_preprocessing : 42] No missing values found in column 'loan_type'
[2024-11-11 10:46:47,900] INFO: data_preprocessing : 42] No missing values found in column 'sanction_amount'
[2024-11-11 10:46:47,900] INFO: data_preprocessing : 42] No missing values found in column 'loan_amount'
[2024-11-11 10:46:47,900] INFO: data_preprocessing : 42] No missing values found in column 'processing_fee'
[2024-11-11 10:46:47,904] INFO: data_preprocessing : 42] No missing values found in column 'gst'
[2024-11-11 10:46:47,904] INFO: data_preprocessing : 42] No missing values found in column 'net_disbursement'
[2024-11-11 10:46:47,904] INFO: data_preprocessing : 42] No missing values found in column 'loan_tenure_months'
[2024-11-11 10:46:47,904] INFO: data_preprocessing : 42] No missing values found in column 'principal_outstanding'
[2024-11-11 10:46:47,904] INFO: data_preprocessing : 42] No missing values found in column 'bank_balance_at_application'
[2024-11-11 10:46:47,908] INFO: data_preprocessing : 42] No missing values found in column 'disbursal_date'
[2024-11-11 10:46:47,911] INFO: data_preprocessing : 42] No missing values found in column 'installment_start_dt'
[2024-11-11 10:46:47,911] INFO: data_preprocessing : 42] No missing values found in column 'default'
[2024-11-11 10:46:47,911] INFO: data_preprocessing : 42] No missing values found in column 'number_of_open_accounts'
[2024-11-11 10:46:47,914] INFO: data_preprocessing : 42] No missing values found in column 'number_of_closed_accounts'
[2024-11-11 10:46:47,914] INFO: data_preprocessing : 42] No missing values found in column 'total_loan_months'
[2024-11-11 10:46:47,914] INFO: data_preprocessing : 42] No missing values found in column 'delinquent_months'
[2024-11-11 10:46:47,914] INFO: data_preprocessing : 42] No missing values found in column 'total_dpd'
[2024-11-11 10:46:47,917] INFO: data_preprocessing : 42] No missing values found in column 'enquiry_count'
[2024-11-11 10:46:47,917] INFO: data_preprocessing : 42] No missing values found in column 'credit_utilization_ratio'
[2024-11-11 10:46:47,982] INFO: data_preprocessing : 51] No duplicate rows found
[2024-11-11 10:46:47,982] INFO: data_preprocessing : 53] Index(['cust_id', 'age', 'gender', 'marital_status', 'employment_status',
       'income', 'number_of_dependants', 'residence_type',
       'years_at_current_address', 'city', 'state', 'zipcode', 'loan_id',
       'loan_purpose', 'loan_type', 'sanction_amount', 'loan_amount',
       'processing_fee', 'gst', 'net_disbursement', 'loan_tenure_months',
       'principal_outstanding', 'bank_balance_at_application',
       'disbursal_date', 'installment_start_dt', 'default',
       'number_of_open_accounts', 'number_of_closed_accounts',
       'total_loan_months', 'delinquent_months', 'total_dpd', 'enquiry_count',
       'credit_utilization_ratio'],
      dtype='object')
[2024-11-11 10:46:48,420] INFO: common : 97] Successfully saved DataFrame to: artifacts\data_preprocessing\preprocessed_data.csv
[2024-11-11 10:46:48,428] INFO: main : 26] >>>>>>>>>>>Completed Data Pre-Processing Stage<<<<<<<<<<<<<
[2024-11-11 10:46:48,428] INFO: main : 36] >>>>>>>>>>>Starting Data Cleaning Stage<<<<<<<<<<<<<
[2024-11-11 10:46:48,434] INFO: common : 32] Successfully loaded yaml file: config\config.yaml
[2024-11-11 10:46:48,436] INFO: common : 32] Successfully loaded yaml file: params.yaml
[2024-11-11 10:46:48,436] INFO: common : 32] Successfully loaded yaml file: schema.yaml
[2024-11-11 10:46:48,436] INFO: common : 55] Created directory: artifacts
[2024-11-11 10:46:48,440] INFO: common : 55] Created directory: artifacts/data_cleaning
[2024-11-11 10:46:48,663] INFO: common : 79] Successfully loaded DataFrame from: artifacts\data_preprocessing\preprocessed_data.csv
[2024-11-11 10:46:48,666] INFO: data_cleaning : 34] Initiating train test split...
[2024-11-11 10:46:48,683] INFO: data_cleaning : 36] Train test split completed successfully.
[2024-11-11 10:46:48,683] INFO: data_cleaning : 91] Train_df :Index(['cust_id', 'age', 'gender', 'marital_status', 'employment_status',
       'income', 'number_of_dependants', 'residence_type',
       'years_at_current_address', 'city', 'state', 'zipcode', 'loan_id',
       'loan_purpose', 'loan_type', 'sanction_amount', 'loan_amount',
       'processing_fee', 'gst', 'net_disbursement', 'loan_tenure_months',
       'principal_outstanding', 'bank_balance_at_application',
       'disbursal_date', 'installment_start_dt', 'default',
       'number_of_open_accounts', 'number_of_closed_accounts',
       'total_loan_months', 'delinquent_months', 'total_dpd', 'enquiry_count',
       'credit_utilization_ratio'],
      dtype='object')
[2024-11-11 10:46:48,705] INFO: data_cleaning : 96]  After outlier removal train_df :(40000, 33)
[2024-11-11 10:46:48,705] INFO: data_cleaning : 97]  After outlier removal test_df :(10000, 33)
[2024-11-11 10:46:48,705] INFO: data_cleaning : 102] Rule 1: GST should not be more than 20% :(0, 33)
[2024-11-11 10:46:48,705] INFO: data_cleaning : 106] Rule 2: Net disbursement should not be higher than loan_amount :(0, 33)
[2024-11-11 10:46:48,715] INFO: data_cleaning : 111] Rule 3 : Fixed loan_purpose column :loan_purpose
Personal     14037
Home         12006
Auto          7950
Education     6007
Name: count, dtype: int64
[2024-11-11 10:46:48,722] INFO: data_cleaning : 116] Rule 4 : Generated loan_to_income column(LTI)
[2024-11-11 10:46:48,729] INFO: data_cleaning : 121] Generated delinquency_ratio column :count    40000.000000
mean        10.424123
std         17.283345
min          0.000000
25%          0.000000
50%          3.800000
75%         13.200000
max        100.000000
Name: delinquency_ratio, dtype: float64
[2024-11-11 10:46:48,738] INFO: data_cleaning : 135] Generated avg_dpd_per_delinquency column :count    40000.000000
mean         3.303845
std          2.902944
min          0.000000
25%          0.000000
50%          4.300000
75%          5.800000
max         10.000000
Name: avg_dpd_per_delinquency, dtype: float64
[2024-11-11 10:46:48,740] INFO: data_cleaning : 44] Removing columns...
[2024-11-11 10:46:48,740] INFO: data_cleaning : 46] Columns removed successfully.
[2024-11-11 10:46:48,745] INFO: data_cleaning : 44] Removing columns...
[2024-11-11 10:46:48,747] INFO: data_cleaning : 46] Columns removed successfully.
[2024-11-11 10:46:48,747] ERROR: data_cleaning : 72] Dtype mismatch in 'age': Expected int, got int64
[2024-11-11 10:46:48,747] INFO: data_cleaning : 76] Converted column 'age' to int.
[2024-11-11 10:46:48,747] ERROR: data_cleaning : 72] Dtype mismatch in 'loan_tenure_months': Expected int, got int64
[2024-11-11 10:46:48,747] INFO: data_cleaning : 76] Converted column 'loan_tenure_months' to int.
[2024-11-11 10:46:48,747] ERROR: data_cleaning : 72] Dtype mismatch in 'number_of_open_accounts': Expected int, got int64
[2024-11-11 10:46:48,747] INFO: data_cleaning : 76] Converted column 'number_of_open_accounts' to int.
[2024-11-11 10:46:48,754] ERROR: data_cleaning : 72] Dtype mismatch in 'credit_utilization_ratio': Expected int, got int64
[2024-11-11 10:46:48,754] INFO: data_cleaning : 76] Converted column 'credit_utilization_ratio' to int.
[2024-11-11 10:46:48,754] INFO: data_cleaning : 81] Schema validation successful: Columns and dtypes match.
[2024-11-11 10:46:48,755] ERROR: data_cleaning : 72] Dtype mismatch in 'age': Expected int, got int64
[2024-11-11 10:46:48,755] INFO: data_cleaning : 76] Converted column 'age' to int.
[2024-11-11 10:46:48,755] ERROR: data_cleaning : 72] Dtype mismatch in 'loan_tenure_months': Expected int, got int64
[2024-11-11 10:46:48,755] INFO: data_cleaning : 76] Converted column 'loan_tenure_months' to int.
[2024-11-11 10:46:48,755] ERROR: data_cleaning : 72] Dtype mismatch in 'number_of_open_accounts': Expected int, got int64
[2024-11-11 10:46:48,758] INFO: data_cleaning : 76] Converted column 'number_of_open_accounts' to int.
[2024-11-11 10:46:48,759] ERROR: data_cleaning : 72] Dtype mismatch in 'credit_utilization_ratio': Expected int, got int64
[2024-11-11 10:46:48,760] INFO: data_cleaning : 76] Converted column 'credit_utilization_ratio' to int.
[2024-11-11 10:46:48,761] INFO: data_cleaning : 81] Schema validation successful: Columns and dtypes match.
[2024-11-11 10:46:48,764] INFO: data_cleaning : 165] Categorical Columns : Index(['residence_type', 'loan_purpose', 'loan_type'], dtype='object')
[2024-11-11 10:46:48,764] INFO: data_cleaning : 166] Numerical Columns : Index(['age', 'loan_tenure_months', 'number_of_open_accounts',
       'credit_utilization_ratio', 'loan_to_income', 'delinquency_ratio',
       'avg_dpd_per_delinquency'],
      dtype='object')
[2024-11-11 10:46:48,836] ERROR: main : 41] An unexpected error occurred: Shape of passed values is (40000, 16), indices imply (40000, 10)
[2024-11-11 10:47:41,429] INFO: __init__ : 26] Credit Risk Model Building Started
[2024-11-11 10:47:43,388] INFO: main : 12] >>>>>>>>>>>Starting Data Ingestion Stage<<<<<<<<<<<<<
[2024-11-11 10:47:43,388] INFO: common : 32] Successfully loaded yaml file: config\config.yaml
[2024-11-11 10:47:43,388] INFO: common : 32] Successfully loaded yaml file: params.yaml
[2024-11-11 10:47:43,405] INFO: common : 32] Successfully loaded yaml file: schema.yaml
[2024-11-11 10:47:43,405] INFO: common : 55] Created directory: artifacts
[2024-11-11 10:47:43,405] INFO: common : 55] Created directory: artifacts/data_ingestion
[2024-11-11 10:47:43,405] INFO: data_ingestion : 17] Loading customers data...
[2024-11-11 10:47:43,496] INFO: common : 79] Successfully loaded DataFrame from: data\customers.csv
[2024-11-11 10:47:43,502] INFO: data_ingestion : 20] Loading loans data...
[2024-11-11 10:47:43,635] INFO: common : 79] Successfully loaded DataFrame from: data\loans.csv
[2024-11-11 10:47:43,635] INFO: data_ingestion : 23] Loading bureau data...
[2024-11-11 10:47:43,685] INFO: common : 79] Successfully loaded DataFrame from: data\bureau_data.csv
[2024-11-11 10:47:43,686] INFO: data_ingestion : 26] The Shape of customers data: (50000, 12)
[2024-11-11 10:47:43,686] INFO: data_ingestion : 27] The Shape of loans data: (50000, 15)
[2024-11-11 10:47:43,686] INFO: data_ingestion : 28] The Shape of bureau data: (50000, 8)
[2024-11-11 10:47:43,745] ERROR: common : 100] Error saving DataFrame to: artifacts\data_ingestion\data.csv - [Errno 22] Invalid argument: 'artifacts\\data_ingestion\\data.csv'
[2024-11-11 10:47:43,745] ERROR: data_ingestion_pipeline : 22] Error occurred during data ingestion: Error occurred in python script name [C:\Users\ambig\jupiter_notebook\Projects\Credit-Risk-Model\src\Credit_Risk_Model\utils\common.py] line number [95] error message[[Errno 22] Invalid argument: 'artifacts\\data_ingestion\\data.csv']
[2024-11-11 10:47:43,752] INFO: main : 14] >>>>>>>>>>>Completed Data Ingestion Stage<<<<<<<<<<<<<
[2024-11-11 10:47:43,752] INFO: main : 24] >>>>>>>>>>>Starting Data Pre-Processing Stage<<<<<<<<<<<<<
[2024-11-11 10:47:43,760] INFO: common : 32] Successfully loaded yaml file: config\config.yaml
[2024-11-11 10:47:43,760] INFO: common : 32] Successfully loaded yaml file: params.yaml
[2024-11-11 10:47:43,766] INFO: common : 32] Successfully loaded yaml file: schema.yaml
[2024-11-11 10:47:43,766] INFO: common : 55] Created directory: artifacts
[2024-11-11 10:47:43,768] INFO: common : 55] Created directory: artifacts/data_preprocessing
[2024-11-11 10:47:44,013] INFO: common : 79] Successfully loaded DataFrame from: artifacts\data_ingestion\data.csv
[2024-11-11 10:47:44,013] INFO: data_preprocessing : 26] The Valure counts for 'default' column: default
0    45703
1     4297
Name: count, dtype: int64
[2024-11-11 10:47:44,020] INFO: data_preprocessing : 42] No missing values found in column 'cust_id'
[2024-11-11 10:47:44,021] INFO: data_preprocessing : 42] No missing values found in column 'age'
[2024-11-11 10:47:44,024] INFO: data_preprocessing : 42] No missing values found in column 'gender'
[2024-11-11 10:47:44,027] INFO: data_preprocessing : 42] No missing values found in column 'marital_status'
[2024-11-11 10:47:44,031] INFO: data_preprocessing : 42] No missing values found in column 'employment_status'
[2024-11-11 10:47:44,031] INFO: data_preprocessing : 42] No missing values found in column 'income'
[2024-11-11 10:47:44,031] INFO: data_preprocessing : 42] No missing values found in column 'number_of_dependants'
[2024-11-11 10:47:44,036] WARNING: data_preprocessing : 33] Missing values found in column 'residence_type', replacing with 'Unknown'
[2024-11-11 10:47:44,048] INFO: data_preprocessing : 35] Missing values replaced in column 'residence_type' with mode 'Owned'
[2024-11-11 10:47:44,048] INFO: data_preprocessing : 42] No missing values found in column 'years_at_current_address'
[2024-11-11 10:47:44,051] INFO: data_preprocessing : 42] No missing values found in column 'city'
[2024-11-11 10:47:44,051] INFO: data_preprocessing : 42] No missing values found in column 'state'
[2024-11-11 10:47:44,051] INFO: data_preprocessing : 42] No missing values found in column 'zipcode'
[2024-11-11 10:47:44,059] INFO: data_preprocessing : 42] No missing values found in column 'loan_id'
[2024-11-11 10:47:44,059] INFO: data_preprocessing : 42] No missing values found in column 'loan_purpose'
[2024-11-11 10:47:44,065] INFO: data_preprocessing : 42] No missing values found in column 'loan_type'
[2024-11-11 10:47:44,065] INFO: data_preprocessing : 42] No missing values found in column 'sanction_amount'
[2024-11-11 10:47:44,067] INFO: data_preprocessing : 42] No missing values found in column 'loan_amount'
[2024-11-11 10:47:44,067] INFO: data_preprocessing : 42] No missing values found in column 'processing_fee'
[2024-11-11 10:47:44,067] INFO: data_preprocessing : 42] No missing values found in column 'gst'
[2024-11-11 10:47:44,067] INFO: data_preprocessing : 42] No missing values found in column 'net_disbursement'
[2024-11-11 10:47:44,067] INFO: data_preprocessing : 42] No missing values found in column 'loan_tenure_months'
[2024-11-11 10:47:44,067] INFO: data_preprocessing : 42] No missing values found in column 'principal_outstanding'
[2024-11-11 10:47:44,067] INFO: data_preprocessing : 42] No missing values found in column 'bank_balance_at_application'
[2024-11-11 10:47:44,073] INFO: data_preprocessing : 42] No missing values found in column 'disbursal_date'
[2024-11-11 10:47:44,075] INFO: data_preprocessing : 42] No missing values found in column 'installment_start_dt'
[2024-11-11 10:47:44,075] INFO: data_preprocessing : 42] No missing values found in column 'default'
[2024-11-11 10:47:44,079] INFO: data_preprocessing : 42] No missing values found in column 'number_of_open_accounts'
[2024-11-11 10:47:44,079] INFO: data_preprocessing : 42] No missing values found in column 'number_of_closed_accounts'
[2024-11-11 10:47:44,081] INFO: data_preprocessing : 42] No missing values found in column 'total_loan_months'
[2024-11-11 10:47:44,082] INFO: data_preprocessing : 42] No missing values found in column 'delinquent_months'
[2024-11-11 10:47:44,082] INFO: data_preprocessing : 42] No missing values found in column 'total_dpd'
[2024-11-11 10:47:44,083] INFO: data_preprocessing : 42] No missing values found in column 'enquiry_count'
[2024-11-11 10:47:44,084] INFO: data_preprocessing : 42] No missing values found in column 'credit_utilization_ratio'
[2024-11-11 10:47:44,147] INFO: data_preprocessing : 51] No duplicate rows found
[2024-11-11 10:47:44,147] INFO: data_preprocessing : 53] Index(['cust_id', 'age', 'gender', 'marital_status', 'employment_status',
       'income', 'number_of_dependants', 'residence_type',
       'years_at_current_address', 'city', 'state', 'zipcode', 'loan_id',
       'loan_purpose', 'loan_type', 'sanction_amount', 'loan_amount',
       'processing_fee', 'gst', 'net_disbursement', 'loan_tenure_months',
       'principal_outstanding', 'bank_balance_at_application',
       'disbursal_date', 'installment_start_dt', 'default',
       'number_of_open_accounts', 'number_of_closed_accounts',
       'total_loan_months', 'delinquent_months', 'total_dpd', 'enquiry_count',
       'credit_utilization_ratio'],
      dtype='object')
[2024-11-11 10:47:44,750] INFO: common : 97] Successfully saved DataFrame to: artifacts\data_preprocessing\preprocessed_data.csv
[2024-11-11 10:47:44,750] INFO: main : 26] >>>>>>>>>>>Completed Data Pre-Processing Stage<<<<<<<<<<<<<
[2024-11-11 10:47:44,750] INFO: main : 36] >>>>>>>>>>>Starting Data Cleaning Stage<<<<<<<<<<<<<
[2024-11-11 10:47:44,767] INFO: common : 32] Successfully loaded yaml file: config\config.yaml
[2024-11-11 10:47:44,768] INFO: common : 32] Successfully loaded yaml file: params.yaml
[2024-11-11 10:47:44,768] INFO: common : 32] Successfully loaded yaml file: schema.yaml
[2024-11-11 10:47:44,773] INFO: common : 55] Created directory: artifacts
[2024-11-11 10:47:44,774] INFO: common : 55] Created directory: artifacts/data_cleaning
[2024-11-11 10:47:44,980] INFO: common : 79] Successfully loaded DataFrame from: artifacts\data_preprocessing\preprocessed_data.csv
[2024-11-11 10:47:44,980] INFO: data_cleaning : 34] Initiating train test split...
[2024-11-11 10:47:45,015] INFO: data_cleaning : 36] Train test split completed successfully.
[2024-11-11 10:47:45,015] INFO: data_cleaning : 91] Train_df :Index(['cust_id', 'age', 'gender', 'marital_status', 'employment_status',
       'income', 'number_of_dependants', 'residence_type',
       'years_at_current_address', 'city', 'state', 'zipcode', 'loan_id',
       'loan_purpose', 'loan_type', 'sanction_amount', 'loan_amount',
       'processing_fee', 'gst', 'net_disbursement', 'loan_tenure_months',
       'principal_outstanding', 'bank_balance_at_application',
       'disbursal_date', 'installment_start_dt', 'default',
       'number_of_open_accounts', 'number_of_closed_accounts',
       'total_loan_months', 'delinquent_months', 'total_dpd', 'enquiry_count',
       'credit_utilization_ratio'],
      dtype='object')
[2024-11-11 10:47:45,031] INFO: data_cleaning : 96]  After outlier removal train_df :(40000, 33)
[2024-11-11 10:47:45,033] INFO: data_cleaning : 97]  After outlier removal test_df :(10000, 33)
[2024-11-11 10:47:45,033] INFO: data_cleaning : 102] Rule 1: GST should not be more than 20% :(0, 33)
[2024-11-11 10:47:45,036] INFO: data_cleaning : 106] Rule 2: Net disbursement should not be higher than loan_amount :(0, 33)
[2024-11-11 10:47:45,045] INFO: data_cleaning : 111] Rule 3 : Fixed loan_purpose column :loan_purpose
Personal     14037
Home         12006
Auto          7950
Education     6007
Name: count, dtype: int64
[2024-11-11 10:47:45,048] INFO: data_cleaning : 116] Rule 4 : Generated loan_to_income column(LTI)
[2024-11-11 10:47:45,054] INFO: data_cleaning : 121] Generated delinquency_ratio column :count    40000.000000
mean        10.424123
std         17.283345
min          0.000000
25%          0.000000
50%          3.800000
75%         13.200000
max        100.000000
Name: delinquency_ratio, dtype: float64
[2024-11-11 10:47:45,061] INFO: data_cleaning : 135] Generated avg_dpd_per_delinquency column :count    40000.000000
mean         3.303845
std          2.902944
min          0.000000
25%          0.000000
50%          4.300000
75%          5.800000
max         10.000000
Name: avg_dpd_per_delinquency, dtype: float64
[2024-11-11 10:47:45,063] INFO: data_cleaning : 44] Removing columns...
[2024-11-11 10:47:45,065] INFO: data_cleaning : 46] Columns removed successfully.
[2024-11-11 10:47:45,068] INFO: data_cleaning : 44] Removing columns...
[2024-11-11 10:47:45,070] INFO: data_cleaning : 46] Columns removed successfully.
[2024-11-11 10:47:45,071] ERROR: data_cleaning : 72] Dtype mismatch in 'age': Expected int, got int64
[2024-11-11 10:47:45,072] INFO: data_cleaning : 76] Converted column 'age' to int.
[2024-11-11 10:47:45,072] ERROR: data_cleaning : 72] Dtype mismatch in 'loan_tenure_months': Expected int, got int64
[2024-11-11 10:47:45,073] INFO: data_cleaning : 76] Converted column 'loan_tenure_months' to int.
[2024-11-11 10:47:45,073] ERROR: data_cleaning : 72] Dtype mismatch in 'number_of_open_accounts': Expected int, got int64
[2024-11-11 10:47:45,074] INFO: data_cleaning : 76] Converted column 'number_of_open_accounts' to int.
[2024-11-11 10:47:45,074] ERROR: data_cleaning : 72] Dtype mismatch in 'credit_utilization_ratio': Expected int, got int64
[2024-11-11 10:47:45,076] INFO: data_cleaning : 76] Converted column 'credit_utilization_ratio' to int.
[2024-11-11 10:47:45,076] INFO: data_cleaning : 81] Schema validation successful: Columns and dtypes match.
[2024-11-11 10:47:45,077] ERROR: data_cleaning : 72] Dtype mismatch in 'age': Expected int, got int64
[2024-11-11 10:47:45,077] INFO: data_cleaning : 76] Converted column 'age' to int.
[2024-11-11 10:47:45,077] ERROR: data_cleaning : 72] Dtype mismatch in 'loan_tenure_months': Expected int, got int64
[2024-11-11 10:47:45,079] INFO: data_cleaning : 76] Converted column 'loan_tenure_months' to int.
[2024-11-11 10:47:45,079] ERROR: data_cleaning : 72] Dtype mismatch in 'number_of_open_accounts': Expected int, got int64
[2024-11-11 10:47:45,080] INFO: data_cleaning : 76] Converted column 'number_of_open_accounts' to int.
[2024-11-11 10:47:45,081] ERROR: data_cleaning : 72] Dtype mismatch in 'credit_utilization_ratio': Expected int, got int64
[2024-11-11 10:47:45,081] INFO: data_cleaning : 76] Converted column 'credit_utilization_ratio' to int.
[2024-11-11 10:47:45,081] INFO: data_cleaning : 81] Schema validation successful: Columns and dtypes match.
[2024-11-11 10:47:45,081] INFO: data_cleaning : 165] Categorical Columns : Index(['residence_type', 'loan_purpose', 'loan_type'], dtype='object')
[2024-11-11 10:47:45,087] INFO: data_cleaning : 166] Numerical Columns : Index(['age', 'loan_tenure_months', 'number_of_open_accounts',
       'credit_utilization_ratio', 'loan_to_income', 'delinquency_ratio',
       'avg_dpd_per_delinquency'],
      dtype='object')
[2024-11-11 10:47:45,165] ERROR: main : 41] An unexpected error occurred: 'numpy.ndarray' object has no attribute 'columns'
[2024-11-11 10:48:32,513] INFO: __init__ : 26] Credit Risk Model Building Started
[2024-11-11 10:48:34,423] INFO: main : 12] >>>>>>>>>>>Starting Data Ingestion Stage<<<<<<<<<<<<<
[2024-11-11 10:48:34,423] INFO: common : 32] Successfully loaded yaml file: config\config.yaml
[2024-11-11 10:48:34,441] INFO: common : 32] Successfully loaded yaml file: params.yaml
[2024-11-11 10:48:34,442] INFO: common : 32] Successfully loaded yaml file: schema.yaml
[2024-11-11 10:48:34,442] INFO: common : 55] Created directory: artifacts
[2024-11-11 10:48:34,442] INFO: common : 55] Created directory: artifacts/data_ingestion
[2024-11-11 10:48:34,447] INFO: data_ingestion : 17] Loading customers data...
[2024-11-11 10:48:34,537] INFO: common : 79] Successfully loaded DataFrame from: data\customers.csv
[2024-11-11 10:48:34,537] INFO: data_ingestion : 20] Loading loans data...
[2024-11-11 10:48:34,666] INFO: common : 79] Successfully loaded DataFrame from: data\loans.csv
[2024-11-11 10:48:34,666] INFO: data_ingestion : 23] Loading bureau data...
[2024-11-11 10:48:34,719] INFO: common : 79] Successfully loaded DataFrame from: data\bureau_data.csv
[2024-11-11 10:48:34,719] INFO: data_ingestion : 26] The Shape of customers data: (50000, 12)
[2024-11-11 10:48:34,719] INFO: data_ingestion : 27] The Shape of loans data: (50000, 15)
[2024-11-11 10:48:34,719] INFO: data_ingestion : 28] The Shape of bureau data: (50000, 8)
[2024-11-11 10:48:35,259] INFO: common : 97] Successfully saved DataFrame to: artifacts\data_ingestion\data.csv
[2024-11-11 10:48:35,259] INFO: main : 14] >>>>>>>>>>>Completed Data Ingestion Stage<<<<<<<<<<<<<
[2024-11-11 10:48:35,259] INFO: main : 24] >>>>>>>>>>>Starting Data Pre-Processing Stage<<<<<<<<<<<<<
[2024-11-11 10:48:35,273] INFO: common : 32] Successfully loaded yaml file: config\config.yaml
[2024-11-11 10:48:35,276] INFO: common : 32] Successfully loaded yaml file: params.yaml
[2024-11-11 10:48:35,278] INFO: common : 32] Successfully loaded yaml file: schema.yaml
[2024-11-11 10:48:35,280] INFO: common : 55] Created directory: artifacts
[2024-11-11 10:48:35,282] INFO: common : 55] Created directory: artifacts/data_preprocessing
[2024-11-11 10:48:35,474] INFO: common : 79] Successfully loaded DataFrame from: artifacts\data_ingestion\data.csv
[2024-11-11 10:48:35,490] INFO: data_preprocessing : 26] The Valure counts for 'default' column: default
0    45703
1     4297
Name: count, dtype: int64
[2024-11-11 10:48:35,490] INFO: data_preprocessing : 42] No missing values found in column 'cust_id'
[2024-11-11 10:48:35,490] INFO: data_preprocessing : 42] No missing values found in column 'age'
[2024-11-11 10:48:35,498] INFO: data_preprocessing : 42] No missing values found in column 'gender'
[2024-11-11 10:48:35,499] INFO: data_preprocessing : 42] No missing values found in column 'marital_status'
[2024-11-11 10:48:35,504] INFO: data_preprocessing : 42] No missing values found in column 'employment_status'
[2024-11-11 10:48:35,504] INFO: data_preprocessing : 42] No missing values found in column 'income'
[2024-11-11 10:48:35,506] INFO: data_preprocessing : 42] No missing values found in column 'number_of_dependants'
[2024-11-11 10:48:35,506] WARNING: data_preprocessing : 33] Missing values found in column 'residence_type', replacing with 'Unknown'
[2024-11-11 10:48:35,515] INFO: data_preprocessing : 35] Missing values replaced in column 'residence_type' with mode 'Owned'
[2024-11-11 10:48:35,515] INFO: data_preprocessing : 42] No missing values found in column 'years_at_current_address'
[2024-11-11 10:48:35,523] INFO: data_preprocessing : 42] No missing values found in column 'city'
[2024-11-11 10:48:35,523] INFO: data_preprocessing : 42] No missing values found in column 'state'
[2024-11-11 10:48:35,523] INFO: data_preprocessing : 42] No missing values found in column 'zipcode'
[2024-11-11 10:48:35,529] INFO: data_preprocessing : 42] No missing values found in column 'loan_id'
[2024-11-11 10:48:35,531] INFO: data_preprocessing : 42] No missing values found in column 'loan_purpose'
[2024-11-11 10:48:35,536] INFO: data_preprocessing : 42] No missing values found in column 'loan_type'
[2024-11-11 10:48:35,536] INFO: data_preprocessing : 42] No missing values found in column 'sanction_amount'
[2024-11-11 10:48:35,536] INFO: data_preprocessing : 42] No missing values found in column 'loan_amount'
[2024-11-11 10:48:35,539] INFO: data_preprocessing : 42] No missing values found in column 'processing_fee'
[2024-11-11 10:48:35,539] INFO: data_preprocessing : 42] No missing values found in column 'gst'
[2024-11-11 10:48:35,539] INFO: data_preprocessing : 42] No missing values found in column 'net_disbursement'
[2024-11-11 10:48:35,539] INFO: data_preprocessing : 42] No missing values found in column 'loan_tenure_months'
[2024-11-11 10:48:35,539] INFO: data_preprocessing : 42] No missing values found in column 'principal_outstanding'
[2024-11-11 10:48:35,543] INFO: data_preprocessing : 42] No missing values found in column 'bank_balance_at_application'
[2024-11-11 10:48:35,544] INFO: data_preprocessing : 42] No missing values found in column 'disbursal_date'
[2024-11-11 10:48:35,548] INFO: data_preprocessing : 42] No missing values found in column 'installment_start_dt'
[2024-11-11 10:48:35,548] INFO: data_preprocessing : 42] No missing values found in column 'default'
[2024-11-11 10:48:35,549] INFO: data_preprocessing : 42] No missing values found in column 'number_of_open_accounts'
[2024-11-11 10:48:35,551] INFO: data_preprocessing : 42] No missing values found in column 'number_of_closed_accounts'
[2024-11-11 10:48:35,551] INFO: data_preprocessing : 42] No missing values found in column 'total_loan_months'
[2024-11-11 10:48:35,551] INFO: data_preprocessing : 42] No missing values found in column 'delinquent_months'
[2024-11-11 10:48:35,551] INFO: data_preprocessing : 42] No missing values found in column 'total_dpd'
[2024-11-11 10:48:35,551] INFO: data_preprocessing : 42] No missing values found in column 'enquiry_count'
[2024-11-11 10:48:35,551] INFO: data_preprocessing : 42] No missing values found in column 'credit_utilization_ratio'
[2024-11-11 10:48:35,628] INFO: data_preprocessing : 51] No duplicate rows found
[2024-11-11 10:48:35,629] INFO: data_preprocessing : 53] Index(['cust_id', 'age', 'gender', 'marital_status', 'employment_status',
       'income', 'number_of_dependants', 'residence_type',
       'years_at_current_address', 'city', 'state', 'zipcode', 'loan_id',
       'loan_purpose', 'loan_type', 'sanction_amount', 'loan_amount',
       'processing_fee', 'gst', 'net_disbursement', 'loan_tenure_months',
       'principal_outstanding', 'bank_balance_at_application',
       'disbursal_date', 'installment_start_dt', 'default',
       'number_of_open_accounts', 'number_of_closed_accounts',
       'total_loan_months', 'delinquent_months', 'total_dpd', 'enquiry_count',
       'credit_utilization_ratio'],
      dtype='object')
[2024-11-11 10:48:36,090] INFO: common : 97] Successfully saved DataFrame to: artifacts\data_preprocessing\preprocessed_data.csv
[2024-11-11 10:48:36,098] INFO: main : 26] >>>>>>>>>>>Completed Data Pre-Processing Stage<<<<<<<<<<<<<
[2024-11-11 10:48:36,099] INFO: main : 36] >>>>>>>>>>>Starting Data Cleaning Stage<<<<<<<<<<<<<
[2024-11-11 10:48:36,099] INFO: common : 32] Successfully loaded yaml file: config\config.yaml
[2024-11-11 10:48:36,099] INFO: common : 32] Successfully loaded yaml file: params.yaml
[2024-11-11 10:48:36,106] INFO: common : 32] Successfully loaded yaml file: schema.yaml
[2024-11-11 10:48:36,106] INFO: common : 55] Created directory: artifacts
[2024-11-11 10:48:36,106] INFO: common : 55] Created directory: artifacts/data_cleaning
[2024-11-11 10:48:36,309] INFO: common : 79] Successfully loaded DataFrame from: artifacts\data_preprocessing\preprocessed_data.csv
[2024-11-11 10:48:36,309] INFO: data_cleaning : 34] Initiating train test split...
[2024-11-11 10:48:36,329] INFO: data_cleaning : 36] Train test split completed successfully.
[2024-11-11 10:48:36,330] INFO: data_cleaning : 91] Train_df :Index(['cust_id', 'age', 'gender', 'marital_status', 'employment_status',
       'income', 'number_of_dependants', 'residence_type',
       'years_at_current_address', 'city', 'state', 'zipcode', 'loan_id',
       'loan_purpose', 'loan_type', 'sanction_amount', 'loan_amount',
       'processing_fee', 'gst', 'net_disbursement', 'loan_tenure_months',
       'principal_outstanding', 'bank_balance_at_application',
       'disbursal_date', 'installment_start_dt', 'default',
       'number_of_open_accounts', 'number_of_closed_accounts',
       'total_loan_months', 'delinquent_months', 'total_dpd', 'enquiry_count',
       'credit_utilization_ratio'],
      dtype='object')
[2024-11-11 10:48:36,342] INFO: data_cleaning : 96]  After outlier removal train_df :(40000, 33)
[2024-11-11 10:48:36,346] INFO: data_cleaning : 97]  After outlier removal test_df :(10000, 33)
[2024-11-11 10:48:36,347] INFO: data_cleaning : 102] Rule 1: GST should not be more than 20% :(0, 33)
[2024-11-11 10:48:36,347] INFO: data_cleaning : 106] Rule 2: Net disbursement should not be higher than loan_amount :(0, 33)
[2024-11-11 10:48:36,352] INFO: data_cleaning : 111] Rule 3 : Fixed loan_purpose column :loan_purpose
Personal     14037
Home         12006
Auto          7950
Education     6007
Name: count, dtype: int64
[2024-11-11 10:48:36,360] INFO: data_cleaning : 116] Rule 4 : Generated loan_to_income column(LTI)
[2024-11-11 10:48:36,363] INFO: data_cleaning : 121] Generated delinquency_ratio column :count    40000.000000
mean        10.424123
std         17.283345
min          0.000000
25%          0.000000
50%          3.800000
75%         13.200000
max        100.000000
Name: delinquency_ratio, dtype: float64
[2024-11-11 10:48:36,367] INFO: data_cleaning : 135] Generated avg_dpd_per_delinquency column :count    40000.000000
mean         3.303845
std          2.902944
min          0.000000
25%          0.000000
50%          4.300000
75%          5.800000
max         10.000000
Name: avg_dpd_per_delinquency, dtype: float64
[2024-11-11 10:48:36,374] INFO: data_cleaning : 44] Removing columns...
[2024-11-11 10:48:36,375] INFO: data_cleaning : 46] Columns removed successfully.
[2024-11-11 10:48:36,375] INFO: data_cleaning : 44] Removing columns...
[2024-11-11 10:48:36,375] INFO: data_cleaning : 46] Columns removed successfully.
[2024-11-11 10:48:36,375] ERROR: data_cleaning : 72] Dtype mismatch in 'age': Expected int, got int64
[2024-11-11 10:48:36,375] INFO: data_cleaning : 76] Converted column 'age' to int.
[2024-11-11 10:48:36,383] ERROR: data_cleaning : 72] Dtype mismatch in 'loan_tenure_months': Expected int, got int64
[2024-11-11 10:48:36,383] INFO: data_cleaning : 76] Converted column 'loan_tenure_months' to int.
[2024-11-11 10:48:36,383] ERROR: data_cleaning : 72] Dtype mismatch in 'number_of_open_accounts': Expected int, got int64
[2024-11-11 10:48:36,383] INFO: data_cleaning : 76] Converted column 'number_of_open_accounts' to int.
[2024-11-11 10:48:36,383] ERROR: data_cleaning : 72] Dtype mismatch in 'credit_utilization_ratio': Expected int, got int64
[2024-11-11 10:48:36,386] INFO: data_cleaning : 76] Converted column 'credit_utilization_ratio' to int.
[2024-11-11 10:48:36,387] INFO: data_cleaning : 81] Schema validation successful: Columns and dtypes match.
[2024-11-11 10:48:36,387] ERROR: data_cleaning : 72] Dtype mismatch in 'age': Expected int, got int64
[2024-11-11 10:48:36,387] INFO: data_cleaning : 76] Converted column 'age' to int.
[2024-11-11 10:48:36,387] ERROR: data_cleaning : 72] Dtype mismatch in 'loan_tenure_months': Expected int, got int64
[2024-11-11 10:48:36,387] INFO: data_cleaning : 76] Converted column 'loan_tenure_months' to int.
[2024-11-11 10:48:36,387] ERROR: data_cleaning : 72] Dtype mismatch in 'number_of_open_accounts': Expected int, got int64
[2024-11-11 10:48:36,387] INFO: data_cleaning : 76] Converted column 'number_of_open_accounts' to int.
[2024-11-11 10:48:36,387] ERROR: data_cleaning : 72] Dtype mismatch in 'credit_utilization_ratio': Expected int, got int64
[2024-11-11 10:48:36,391] INFO: data_cleaning : 76] Converted column 'credit_utilization_ratio' to int.
[2024-11-11 10:48:36,391] INFO: data_cleaning : 81] Schema validation successful: Columns and dtypes match.
[2024-11-11 10:48:36,393] INFO: data_cleaning : 165] Categorical Columns : Index(['residence_type', 'loan_purpose', 'loan_type'], dtype='object')
[2024-11-11 10:48:36,393] INFO: data_cleaning : 166] Numerical Columns : Index(['age', 'loan_tenure_months', 'number_of_open_accounts',
       'credit_utilization_ratio', 'loan_to_income', 'delinquency_ratio',
       'avg_dpd_per_delinquency'],
      dtype='object')
[2024-11-11 10:48:36,401] INFO: data_cleaning : 168] Train_.columns : Index(['age', 'residence_type', 'loan_purpose', 'loan_type',
       'loan_tenure_months', 'number_of_open_accounts',
       'credit_utilization_ratio', 'loan_to_income', 'delinquency_ratio',
       'avg_dpd_per_delinquency'],
      dtype='object')
[2024-11-11 10:48:36,401] INFO: data_cleaning : 169] Test_.columns : Index(['age', 'residence_type', 'loan_purpose', 'loan_type',
       'loan_tenure_months', 'number_of_open_accounts',
       'credit_utilization_ratio', 'loan_to_income', 'delinquency_ratio',
       'avg_dpd_per_delinquency'],
      dtype='object')
[2024-11-11 10:48:36,471] ERROR: main : 41] An unexpected error occurred: Shape of passed values is (40000, 16), indices imply (40000, 10)
[2024-11-11 10:53:32,496] INFO: __init__ : 26] Credit Risk Model Building Started
[2024-11-11 10:53:38,238] INFO: main : 12] >>>>>>>>>>>Starting Data Ingestion Stage<<<<<<<<<<<<<
[2024-11-11 10:53:38,238] INFO: common : 32] Successfully loaded yaml file: config\config.yaml
[2024-11-11 10:53:38,253] INFO: common : 32] Successfully loaded yaml file: params.yaml
[2024-11-11 10:53:38,264] INFO: common : 32] Successfully loaded yaml file: schema.yaml
[2024-11-11 10:53:38,266] INFO: common : 55] Created directory: artifacts
[2024-11-11 10:53:38,267] INFO: common : 55] Created directory: artifacts/data_ingestion
[2024-11-11 10:53:38,268] INFO: data_ingestion : 17] Loading customers data...
[2024-11-11 10:53:38,556] INFO: common : 79] Successfully loaded DataFrame from: data\customers.csv
[2024-11-11 10:53:38,558] INFO: data_ingestion : 20] Loading loans data...
[2024-11-11 10:53:38,963] INFO: common : 79] Successfully loaded DataFrame from: data\loans.csv
[2024-11-11 10:53:38,970] INFO: data_ingestion : 23] Loading bureau data...
[2024-11-11 10:53:39,109] INFO: common : 79] Successfully loaded DataFrame from: data\bureau_data.csv
[2024-11-11 10:53:39,116] INFO: data_ingestion : 26] The Shape of customers data: (50000, 12)
[2024-11-11 10:53:39,116] INFO: data_ingestion : 27] The Shape of loans data: (50000, 15)
[2024-11-11 10:53:39,122] INFO: data_ingestion : 28] The Shape of bureau data: (50000, 8)
[2024-11-11 10:53:40,995] INFO: common : 97] Successfully saved DataFrame to: artifacts\data_ingestion\data.csv
[2024-11-11 10:53:41,018] INFO: main : 14] >>>>>>>>>>>Completed Data Ingestion Stage<<<<<<<<<<<<<
[2024-11-11 10:53:41,018] INFO: main : 24] >>>>>>>>>>>Starting Data Pre-Processing Stage<<<<<<<<<<<<<
[2024-11-11 10:53:41,030] INFO: common : 32] Successfully loaded yaml file: config\config.yaml
[2024-11-11 10:53:41,037] INFO: common : 32] Successfully loaded yaml file: params.yaml
[2024-11-11 10:53:41,041] INFO: common : 32] Successfully loaded yaml file: schema.yaml
[2024-11-11 10:53:41,041] INFO: common : 55] Created directory: artifacts
[2024-11-11 10:53:41,047] INFO: common : 55] Created directory: artifacts/data_preprocessing
[2024-11-11 10:53:41,600] INFO: common : 79] Successfully loaded DataFrame from: artifacts\data_ingestion\data.csv
[2024-11-11 10:53:41,600] INFO: data_preprocessing : 26] The Valure counts for 'default' column: default
0    45703
1     4297
Name: count, dtype: int64
[2024-11-11 10:53:41,621] INFO: data_preprocessing : 42] No missing values found in column 'cust_id'
[2024-11-11 10:53:41,623] INFO: data_preprocessing : 42] No missing values found in column 'age'
[2024-11-11 10:53:41,630] INFO: data_preprocessing : 42] No missing values found in column 'gender'
[2024-11-11 10:53:41,636] INFO: data_preprocessing : 42] No missing values found in column 'marital_status'
[2024-11-11 10:53:41,639] INFO: data_preprocessing : 42] No missing values found in column 'employment_status'
[2024-11-11 10:53:41,644] INFO: data_preprocessing : 42] No missing values found in column 'income'
[2024-11-11 10:53:41,646] INFO: data_preprocessing : 42] No missing values found in column 'number_of_dependants'
[2024-11-11 10:53:41,652] WARNING: data_preprocessing : 33] Missing values found in column 'residence_type', replacing with 'Unknown'
[2024-11-11 10:53:41,677] INFO: data_preprocessing : 35] Missing values replaced in column 'residence_type' with mode 'Owned'
[2024-11-11 10:53:41,680] INFO: data_preprocessing : 42] No missing values found in column 'years_at_current_address'
[2024-11-11 10:53:41,685] INFO: data_preprocessing : 42] No missing values found in column 'city'
[2024-11-11 10:53:41,690] INFO: data_preprocessing : 42] No missing values found in column 'state'
[2024-11-11 10:53:41,690] INFO: data_preprocessing : 42] No missing values found in column 'zipcode'
[2024-11-11 10:53:41,704] INFO: data_preprocessing : 42] No missing values found in column 'loan_id'
[2024-11-11 10:53:41,707] INFO: data_preprocessing : 42] No missing values found in column 'loan_purpose'
[2024-11-11 10:53:41,718] INFO: data_preprocessing : 42] No missing values found in column 'loan_type'
[2024-11-11 10:53:41,718] INFO: data_preprocessing : 42] No missing values found in column 'sanction_amount'
[2024-11-11 10:53:41,723] INFO: data_preprocessing : 42] No missing values found in column 'loan_amount'
[2024-11-11 10:53:41,725] INFO: data_preprocessing : 42] No missing values found in column 'processing_fee'
[2024-11-11 10:53:41,725] INFO: data_preprocessing : 42] No missing values found in column 'gst'
[2024-11-11 10:53:41,725] INFO: data_preprocessing : 42] No missing values found in column 'net_disbursement'
[2024-11-11 10:53:41,730] INFO: data_preprocessing : 42] No missing values found in column 'loan_tenure_months'
[2024-11-11 10:53:41,732] INFO: data_preprocessing : 42] No missing values found in column 'principal_outstanding'
[2024-11-11 10:53:41,734] INFO: data_preprocessing : 42] No missing values found in column 'bank_balance_at_application'
[2024-11-11 10:53:41,739] INFO: data_preprocessing : 42] No missing values found in column 'disbursal_date'
[2024-11-11 10:53:41,747] INFO: data_preprocessing : 42] No missing values found in column 'installment_start_dt'
[2024-11-11 10:53:41,750] INFO: data_preprocessing : 42] No missing values found in column 'default'
[2024-11-11 10:53:41,752] INFO: data_preprocessing : 42] No missing values found in column 'number_of_open_accounts'
[2024-11-11 10:53:41,752] INFO: data_preprocessing : 42] No missing values found in column 'number_of_closed_accounts'
[2024-11-11 10:53:41,756] INFO: data_preprocessing : 42] No missing values found in column 'total_loan_months'
[2024-11-11 10:53:41,757] INFO: data_preprocessing : 42] No missing values found in column 'delinquent_months'
[2024-11-11 10:53:41,757] INFO: data_preprocessing : 42] No missing values found in column 'total_dpd'
[2024-11-11 10:53:41,761] INFO: data_preprocessing : 42] No missing values found in column 'enquiry_count'
[2024-11-11 10:53:41,763] INFO: data_preprocessing : 42] No missing values found in column 'credit_utilization_ratio'
[2024-11-11 10:53:41,890] INFO: data_preprocessing : 51] No duplicate rows found
[2024-11-11 10:53:41,890] INFO: data_preprocessing : 53] Index(['cust_id', 'age', 'gender', 'marital_status', 'employment_status',
       'income', 'number_of_dependants', 'residence_type',
       'years_at_current_address', 'city', 'state', 'zipcode', 'loan_id',
       'loan_purpose', 'loan_type', 'sanction_amount', 'loan_amount',
       'processing_fee', 'gst', 'net_disbursement', 'loan_tenure_months',
       'principal_outstanding', 'bank_balance_at_application',
       'disbursal_date', 'installment_start_dt', 'default',
       'number_of_open_accounts', 'number_of_closed_accounts',
       'total_loan_months', 'delinquent_months', 'total_dpd', 'enquiry_count',
       'credit_utilization_ratio'],
      dtype='object')
[2024-11-11 10:53:42,800] INFO: common : 97] Successfully saved DataFrame to: artifacts\data_preprocessing\preprocessed_data.csv
[2024-11-11 10:53:42,800] INFO: main : 26] >>>>>>>>>>>Completed Data Pre-Processing Stage<<<<<<<<<<<<<
[2024-11-11 10:53:42,800] INFO: main : 36] >>>>>>>>>>>Starting Data Cleaning Stage<<<<<<<<<<<<<
[2024-11-11 10:53:42,816] INFO: common : 32] Successfully loaded yaml file: config\config.yaml
[2024-11-11 10:53:42,819] INFO: common : 32] Successfully loaded yaml file: params.yaml
[2024-11-11 10:53:42,821] INFO: common : 32] Successfully loaded yaml file: schema.yaml
[2024-11-11 10:53:42,821] INFO: common : 55] Created directory: artifacts
[2024-11-11 10:53:42,821] INFO: common : 55] Created directory: artifacts/data_cleaning
[2024-11-11 10:53:43,173] INFO: common : 79] Successfully loaded DataFrame from: artifacts\data_preprocessing\preprocessed_data.csv
[2024-11-11 10:53:43,173] INFO: data_cleaning : 31] Initiating train test split...
[2024-11-11 10:53:43,211] INFO: data_cleaning : 33] Train test split completed successfully.
[2024-11-11 10:53:43,211] INFO: data_cleaning : 87] Applying business rules...
[2024-11-11 10:53:43,230] INFO: data_cleaning : 91] After applying Processing Fee rule, train_df: (39987, 33), test_df: (9998, 33)
[2024-11-11 10:53:43,232] INFO: data_cleaning : 95] GST Violations in train data: 0 records
[2024-11-11 10:53:43,234] INFO: data_cleaning : 99] Net Disbursement Violations in train data: 0 records
[2024-11-11 10:53:43,250] INFO: data_cleaning : 104] Fixed loan_purpose column: loan_purpose
Personal     14031
Home         12003
Auto          7947
Education     6006
Name: count, dtype: int64
[2024-11-11 10:53:43,255] INFO: data_cleaning : 109] Generated loan_to_income column
[2024-11-11 10:53:43,267] INFO: data_cleaning : 114] Generated delinquency_ratio column: count    39987.000000
mean        10.426146
std         17.285322
min          0.000000
25%          0.000000
50%          3.800000
75%         13.200000
max        100.000000
Name: delinquency_ratio, dtype: float64
[2024-11-11 10:53:43,284] INFO: data_cleaning : 127] Generated avg_dpd_per_delinquency column: count    39987.000000
mean         3.304136
std          2.902968
min          0.000000
25%          0.000000
50%          4.300000
75%          5.800000
max         10.000000
Name: avg_dpd_per_delinquency, dtype: float64
[2024-11-11 10:53:43,285] ERROR: data_cleaning : 58] Extra columns: disbursal_date, city, gst, total_loan_months, state, zipcode, delinquent_months, income, number_of_closed_accounts, cust_id, number_of_dependants, default, sanction_amount, bank_balance_at_application, loan_id, loan_amount, enquiry_count, processing_fee, gender, principal_outstanding, employment_status, total_dpd, installment_start_dt, net_disbursement, years_at_current_address, marital_status
[2024-11-11 10:53:43,291] ERROR: data_cleaning : 191] Error occurred during data cleaning: CustomException.__init__() missing 1 required positional argument: 'error_detail'
[2024-11-11 10:53:43,293] ERROR: data_cleaning_pipeline : 22] Error occurred during data ingestion: Error occurred in python script name [C:\Users\ambig\jupiter_notebook\Projects\Credit-Risk-Model\src\Credit_Risk_Model\components\data_cleaning.py] line number [144] error message[CustomException.__init__() missing 1 required positional argument: 'error_detail']
[2024-11-11 10:53:43,307] INFO: main : 38] >>>>>>>>>>>Completed Data Cleaning Stage<<<<<<<<<<<<<
[2024-11-11 10:55:50,637] INFO: __init__ : 26] Credit Risk Model Building Started
[2024-11-11 10:55:53,048] INFO: main : 12] >>>>>>>>>>>Starting Data Ingestion Stage<<<<<<<<<<<<<
[2024-11-11 10:55:53,058] INFO: common : 32] Successfully loaded yaml file: config\config.yaml
[2024-11-11 10:55:53,064] INFO: common : 32] Successfully loaded yaml file: params.yaml
[2024-11-11 10:55:53,067] INFO: common : 32] Successfully loaded yaml file: schema.yaml
[2024-11-11 10:55:53,067] INFO: common : 55] Created directory: artifacts
[2024-11-11 10:55:53,067] INFO: common : 55] Created directory: artifacts/data_ingestion
[2024-11-11 10:55:53,067] INFO: data_ingestion : 17] Loading customers data...
[2024-11-11 10:55:53,184] INFO: common : 79] Successfully loaded DataFrame from: data\customers.csv
[2024-11-11 10:55:53,184] INFO: data_ingestion : 20] Loading loans data...
[2024-11-11 10:55:53,327] INFO: common : 79] Successfully loaded DataFrame from: data\loans.csv
[2024-11-11 10:55:53,327] INFO: data_ingestion : 23] Loading bureau data...
[2024-11-11 10:55:53,383] INFO: common : 79] Successfully loaded DataFrame from: data\bureau_data.csv
[2024-11-11 10:55:53,384] INFO: data_ingestion : 26] The Shape of customers data: (50000, 12)
[2024-11-11 10:55:53,384] INFO: data_ingestion : 27] The Shape of loans data: (50000, 15)
[2024-11-11 10:55:53,384] INFO: data_ingestion : 28] The Shape of bureau data: (50000, 8)
[2024-11-11 10:55:54,025] INFO: common : 97] Successfully saved DataFrame to: artifacts\data_ingestion\data.csv
[2024-11-11 10:55:54,031] INFO: main : 14] >>>>>>>>>>>Completed Data Ingestion Stage<<<<<<<<<<<<<
[2024-11-11 10:55:54,031] INFO: main : 24] >>>>>>>>>>>Starting Data Pre-Processing Stage<<<<<<<<<<<<<
[2024-11-11 10:55:54,037] INFO: common : 32] Successfully loaded yaml file: config\config.yaml
[2024-11-11 10:55:54,037] INFO: common : 32] Successfully loaded yaml file: params.yaml
[2024-11-11 10:55:54,043] INFO: common : 32] Successfully loaded yaml file: schema.yaml
[2024-11-11 10:55:54,045] INFO: common : 55] Created directory: artifacts
[2024-11-11 10:55:54,045] INFO: common : 55] Created directory: artifacts/data_preprocessing
[2024-11-11 10:55:54,281] INFO: common : 79] Successfully loaded DataFrame from: artifacts\data_ingestion\data.csv
[2024-11-11 10:55:54,281] INFO: data_preprocessing : 26] The Valure counts for 'default' column: default
0    45703
1     4297
Name: count, dtype: int64
[2024-11-11 10:55:54,281] INFO: data_preprocessing : 42] No missing values found in column 'cust_id'
[2024-11-11 10:55:54,281] INFO: data_preprocessing : 42] No missing values found in column 'age'
[2024-11-11 10:55:54,293] INFO: data_preprocessing : 42] No missing values found in column 'gender'
[2024-11-11 10:55:54,293] INFO: data_preprocessing : 42] No missing values found in column 'marital_status'
[2024-11-11 10:55:54,300] INFO: data_preprocessing : 42] No missing values found in column 'employment_status'
[2024-11-11 10:55:54,302] INFO: data_preprocessing : 42] No missing values found in column 'income'
[2024-11-11 10:55:54,302] INFO: data_preprocessing : 42] No missing values found in column 'number_of_dependants'
[2024-11-11 10:55:54,302] WARNING: data_preprocessing : 33] Missing values found in column 'residence_type', replacing with 'Unknown'
[2024-11-11 10:55:54,316] INFO: data_preprocessing : 35] Missing values replaced in column 'residence_type' with mode 'Owned'
[2024-11-11 10:55:54,316] INFO: data_preprocessing : 42] No missing values found in column 'years_at_current_address'
[2024-11-11 10:55:54,316] INFO: data_preprocessing : 42] No missing values found in column 'city'
[2024-11-11 10:55:54,316] INFO: data_preprocessing : 42] No missing values found in column 'state'
[2024-11-11 10:55:54,325] INFO: data_preprocessing : 42] No missing values found in column 'zipcode'
[2024-11-11 10:55:54,326] INFO: data_preprocessing : 42] No missing values found in column 'loan_id'
[2024-11-11 10:55:54,326] INFO: data_preprocessing : 42] No missing values found in column 'loan_purpose'
[2024-11-11 10:55:54,333] INFO: data_preprocessing : 42] No missing values found in column 'loan_type'
[2024-11-11 10:55:54,335] INFO: data_preprocessing : 42] No missing values found in column 'sanction_amount'
[2024-11-11 10:55:54,336] INFO: data_preprocessing : 42] No missing values found in column 'loan_amount'
[2024-11-11 10:55:54,337] INFO: data_preprocessing : 42] No missing values found in column 'processing_fee'
[2024-11-11 10:55:54,337] INFO: data_preprocessing : 42] No missing values found in column 'gst'
[2024-11-11 10:55:54,337] INFO: data_preprocessing : 42] No missing values found in column 'net_disbursement'
[2024-11-11 10:55:54,337] INFO: data_preprocessing : 42] No missing values found in column 'loan_tenure_months'
[2024-11-11 10:55:54,339] INFO: data_preprocessing : 42] No missing values found in column 'principal_outstanding'
[2024-11-11 10:55:54,340] INFO: data_preprocessing : 42] No missing values found in column 'bank_balance_at_application'
[2024-11-11 10:55:54,340] INFO: data_preprocessing : 42] No missing values found in column 'disbursal_date'
[2024-11-11 10:55:54,345] INFO: data_preprocessing : 42] No missing values found in column 'installment_start_dt'
[2024-11-11 10:55:54,345] INFO: data_preprocessing : 42] No missing values found in column 'default'
[2024-11-11 10:55:54,349] INFO: data_preprocessing : 42] No missing values found in column 'number_of_open_accounts'
[2024-11-11 10:55:54,349] INFO: data_preprocessing : 42] No missing values found in column 'number_of_closed_accounts'
[2024-11-11 10:55:54,350] INFO: data_preprocessing : 42] No missing values found in column 'total_loan_months'
[2024-11-11 10:55:54,350] INFO: data_preprocessing : 42] No missing values found in column 'delinquent_months'
[2024-11-11 10:55:54,350] INFO: data_preprocessing : 42] No missing values found in column 'total_dpd'
[2024-11-11 10:55:54,350] INFO: data_preprocessing : 42] No missing values found in column 'enquiry_count'
[2024-11-11 10:55:54,350] INFO: data_preprocessing : 42] No missing values found in column 'credit_utilization_ratio'
[2024-11-11 10:55:54,420] INFO: data_preprocessing : 51] No duplicate rows found
[2024-11-11 10:55:54,420] INFO: data_preprocessing : 53] Index(['cust_id', 'age', 'gender', 'marital_status', 'employment_status',
       'income', 'number_of_dependants', 'residence_type',
       'years_at_current_address', 'city', 'state', 'zipcode', 'loan_id',
       'loan_purpose', 'loan_type', 'sanction_amount', 'loan_amount',
       'processing_fee', 'gst', 'net_disbursement', 'loan_tenure_months',
       'principal_outstanding', 'bank_balance_at_application',
       'disbursal_date', 'installment_start_dt', 'default',
       'number_of_open_accounts', 'number_of_closed_accounts',
       'total_loan_months', 'delinquent_months', 'total_dpd', 'enquiry_count',
       'credit_utilization_ratio'],
      dtype='object')
[2024-11-11 10:55:54,934] INFO: common : 97] Successfully saved DataFrame to: artifacts\data_preprocessing\preprocessed_data.csv
[2024-11-11 10:55:54,934] INFO: main : 26] >>>>>>>>>>>Completed Data Pre-Processing Stage<<<<<<<<<<<<<
[2024-11-11 10:55:54,934] INFO: main : 36] >>>>>>>>>>>Starting Data Cleaning Stage<<<<<<<<<<<<<
[2024-11-11 10:55:54,944] INFO: common : 32] Successfully loaded yaml file: config\config.yaml
[2024-11-11 10:55:54,946] INFO: common : 32] Successfully loaded yaml file: params.yaml
[2024-11-11 10:55:54,946] INFO: common : 32] Successfully loaded yaml file: schema.yaml
[2024-11-11 10:55:54,950] INFO: common : 55] Created directory: artifacts
[2024-11-11 10:55:54,950] INFO: common : 55] Created directory: artifacts/data_cleaning
[2024-11-11 10:55:55,176] INFO: common : 79] Successfully loaded DataFrame from: artifacts\data_preprocessing\preprocessed_data.csv
[2024-11-11 10:55:55,176] INFO: data_cleaning : 31] Initiating train test split...
[2024-11-11 10:55:55,198] INFO: data_cleaning : 33] Train test split completed successfully.
[2024-11-11 10:55:55,198] INFO: data_cleaning : 87] Applying business rules...
[2024-11-11 10:55:55,210] INFO: data_cleaning : 91] After applying Processing Fee rule, train_df: (39987, 33), test_df: (9998, 33)
[2024-11-11 10:55:55,210] INFO: data_cleaning : 95] GST Violations in train data: 0 records
[2024-11-11 10:55:55,210] INFO: data_cleaning : 99] Net Disbursement Violations in train data: 0 records
[2024-11-11 10:55:55,215] INFO: data_cleaning : 104] Fixed loan_purpose column: loan_purpose
Personal     14031
Home         12003
Auto          7947
Education     6006
Name: count, dtype: int64
[2024-11-11 10:55:55,224] INFO: data_cleaning : 109] Generated loan_to_income column
[2024-11-11 10:55:55,232] INFO: data_cleaning : 114] Generated delinquency_ratio column: count    39987.000000
mean        10.426146
std         17.285322
min          0.000000
25%          0.000000
50%          3.800000
75%         13.200000
max        100.000000
Name: delinquency_ratio, dtype: float64
[2024-11-11 10:55:55,234] INFO: data_cleaning : 127] Generated avg_dpd_per_delinquency column: count    39987.000000
mean         3.304136
std          2.902968
min          0.000000
25%          0.000000
50%          4.300000
75%          5.800000
max         10.000000
Name: avg_dpd_per_delinquency, dtype: float64
[2024-11-11 10:55:55,242] ERROR: data_cleaning : 58] Extra columns: installment_start_dt, disbursal_date, gst, number_of_dependants, income, marital_status, total_dpd, default, city, processing_fee, bank_balance_at_application, state, principal_outstanding, employment_status, loan_amount, cust_id, sanction_amount, enquiry_count, gender, number_of_closed_accounts, total_loan_months, zipcode, loan_id, net_disbursement, years_at_current_address, delinquent_months
[2024-11-11 10:55:55,242] ERROR: data_cleaning : 191] Error occurred during data cleaning: CustomException.__init__() missing 1 required positional argument: 'error_detail'
[2024-11-11 10:55:55,242] ERROR: data_cleaning_pipeline : 22] Error occurred during data ingestion: Error occurred in python script name [C:\Users\ambig\jupiter_notebook\Projects\Credit-Risk-Model\src\Credit_Risk_Model\components\data_cleaning.py] line number [144] error message[CustomException.__init__() missing 1 required positional argument: 'error_detail']
[2024-11-11 10:55:55,249] INFO: main : 38] >>>>>>>>>>>Completed Data Cleaning Stage<<<<<<<<<<<<<
[2024-11-11 11:09:21,374] INFO: __init__ : 26] Credit Risk Model Building Started
[2024-11-11 11:09:25,006] INFO: main : 12] >>>>>>>>>>>Starting Data Ingestion Stage<<<<<<<<<<<<<
[2024-11-11 11:09:25,006] INFO: common : 33] Successfully loaded yaml file: config\config.yaml
[2024-11-11 11:09:25,006] INFO: common : 33] Successfully loaded yaml file: params.yaml
[2024-11-11 11:09:25,022] INFO: common : 33] Successfully loaded yaml file: schema.yaml
[2024-11-11 11:09:25,024] INFO: common : 56] Created directory: artifacts
[2024-11-11 11:09:25,025] INFO: common : 56] Created directory: artifacts/data_ingestion
[2024-11-11 11:09:25,025] INFO: data_ingestion : 17] Loading customers data...
[2024-11-11 11:09:25,132] INFO: common : 80] Successfully loaded DataFrame from: data\customers.csv
[2024-11-11 11:09:25,132] INFO: data_ingestion : 20] Loading loans data...
[2024-11-11 11:09:25,271] INFO: common : 80] Successfully loaded DataFrame from: data\loans.csv
[2024-11-11 11:09:25,271] INFO: data_ingestion : 23] Loading bureau data...
[2024-11-11 11:09:25,322] INFO: common : 80] Successfully loaded DataFrame from: data\bureau_data.csv
[2024-11-11 11:09:25,323] INFO: data_ingestion : 26] The Shape of customers data: (50000, 12)
[2024-11-11 11:09:25,323] INFO: data_ingestion : 27] The Shape of loans data: (50000, 15)
[2024-11-11 11:09:25,324] INFO: data_ingestion : 28] The Shape of bureau data: (50000, 8)
[2024-11-11 11:09:25,869] INFO: common : 98] Successfully saved DataFrame to: artifacts\data_ingestion\data.csv
[2024-11-11 11:09:25,884] INFO: main : 14] >>>>>>>>>>>Completed Data Ingestion Stage<<<<<<<<<<<<<
[2024-11-11 11:09:25,885] INFO: main : 24] >>>>>>>>>>>Starting Data Pre-Processing Stage<<<<<<<<<<<<<
[2024-11-11 11:09:25,887] INFO: common : 33] Successfully loaded yaml file: config\config.yaml
[2024-11-11 11:09:25,891] INFO: common : 33] Successfully loaded yaml file: params.yaml
[2024-11-11 11:09:25,892] INFO: common : 33] Successfully loaded yaml file: schema.yaml
[2024-11-11 11:09:25,892] INFO: common : 56] Created directory: artifacts
[2024-11-11 11:09:25,892] INFO: common : 56] Created directory: artifacts/data_preprocessing
[2024-11-11 11:09:26,149] INFO: common : 80] Successfully loaded DataFrame from: artifacts\data_ingestion\data.csv
[2024-11-11 11:09:26,149] INFO: data_preprocessing : 26] The Valure counts for 'default' column: default
0    45703
1     4297
Name: count, dtype: int64
[2024-11-11 11:09:26,158] INFO: data_preprocessing : 42] No missing values found in column 'cust_id'
[2024-11-11 11:09:26,158] INFO: data_preprocessing : 42] No missing values found in column 'age'
[2024-11-11 11:09:26,162] INFO: data_preprocessing : 42] No missing values found in column 'gender'
[2024-11-11 11:09:26,167] INFO: data_preprocessing : 42] No missing values found in column 'marital_status'
[2024-11-11 11:09:26,167] INFO: data_preprocessing : 42] No missing values found in column 'employment_status'
[2024-11-11 11:09:26,167] INFO: data_preprocessing : 42] No missing values found in column 'income'
[2024-11-11 11:09:26,173] INFO: data_preprocessing : 42] No missing values found in column 'number_of_dependants'
[2024-11-11 11:09:26,173] WARNING: data_preprocessing : 33] Missing values found in column 'residence_type', replacing with 'Unknown'
[2024-11-11 11:09:26,185] INFO: data_preprocessing : 35] Missing values replaced in column 'residence_type' with mode 'Owned'
[2024-11-11 11:09:26,185] INFO: data_preprocessing : 42] No missing values found in column 'years_at_current_address'
[2024-11-11 11:09:26,194] INFO: data_preprocessing : 42] No missing values found in column 'city'
[2024-11-11 11:09:26,199] INFO: data_preprocessing : 42] No missing values found in column 'state'
[2024-11-11 11:09:26,199] INFO: data_preprocessing : 42] No missing values found in column 'zipcode'
[2024-11-11 11:09:26,204] INFO: data_preprocessing : 42] No missing values found in column 'loan_id'
[2024-11-11 11:09:26,204] INFO: data_preprocessing : 42] No missing values found in column 'loan_purpose'
[2024-11-11 11:09:26,210] INFO: data_preprocessing : 42] No missing values found in column 'loan_type'
[2024-11-11 11:09:26,210] INFO: data_preprocessing : 42] No missing values found in column 'sanction_amount'
[2024-11-11 11:09:26,210] INFO: data_preprocessing : 42] No missing values found in column 'loan_amount'
[2024-11-11 11:09:26,210] INFO: data_preprocessing : 42] No missing values found in column 'processing_fee'
[2024-11-11 11:09:26,210] INFO: data_preprocessing : 42] No missing values found in column 'gst'
[2024-11-11 11:09:26,210] INFO: data_preprocessing : 42] No missing values found in column 'net_disbursement'
[2024-11-11 11:09:26,214] INFO: data_preprocessing : 42] No missing values found in column 'loan_tenure_months'
[2024-11-11 11:09:26,214] INFO: data_preprocessing : 42] No missing values found in column 'principal_outstanding'
[2024-11-11 11:09:26,214] INFO: data_preprocessing : 42] No missing values found in column 'bank_balance_at_application'
[2024-11-11 11:09:26,218] INFO: data_preprocessing : 42] No missing values found in column 'disbursal_date'
[2024-11-11 11:09:26,218] INFO: data_preprocessing : 42] No missing values found in column 'installment_start_dt'
[2024-11-11 11:09:26,218] INFO: data_preprocessing : 42] No missing values found in column 'default'
[2024-11-11 11:09:26,218] INFO: data_preprocessing : 42] No missing values found in column 'number_of_open_accounts'
[2024-11-11 11:09:26,218] INFO: data_preprocessing : 42] No missing values found in column 'number_of_closed_accounts'
[2024-11-11 11:09:26,218] INFO: data_preprocessing : 42] No missing values found in column 'total_loan_months'
[2024-11-11 11:09:26,226] INFO: data_preprocessing : 42] No missing values found in column 'delinquent_months'
[2024-11-11 11:09:26,227] INFO: data_preprocessing : 42] No missing values found in column 'total_dpd'
[2024-11-11 11:09:26,227] INFO: data_preprocessing : 42] No missing values found in column 'enquiry_count'
[2024-11-11 11:09:26,227] INFO: data_preprocessing : 42] No missing values found in column 'credit_utilization_ratio'
[2024-11-11 11:09:26,301] INFO: data_preprocessing : 51] No duplicate rows found
[2024-11-11 11:09:26,301] INFO: data_preprocessing : 53] Index(['cust_id', 'age', 'gender', 'marital_status', 'employment_status',
       'income', 'number_of_dependants', 'residence_type',
       'years_at_current_address', 'city', 'state', 'zipcode', 'loan_id',
       'loan_purpose', 'loan_type', 'sanction_amount', 'loan_amount',
       'processing_fee', 'gst', 'net_disbursement', 'loan_tenure_months',
       'principal_outstanding', 'bank_balance_at_application',
       'disbursal_date', 'installment_start_dt', 'default',
       'number_of_open_accounts', 'number_of_closed_accounts',
       'total_loan_months', 'delinquent_months', 'total_dpd', 'enquiry_count',
       'credit_utilization_ratio'],
      dtype='object')
[2024-11-11 11:09:26,785] INFO: common : 98] Successfully saved DataFrame to: artifacts\data_preprocessing\preprocessed_data.csv
[2024-11-11 11:09:26,785] INFO: main : 26] >>>>>>>>>>>Completed Data Pre-Processing Stage<<<<<<<<<<<<<
[2024-11-11 11:09:26,785] INFO: main : 36] >>>>>>>>>>>Starting Data Cleaning Stage<<<<<<<<<<<<<
[2024-11-11 11:09:26,797] INFO: common : 33] Successfully loaded yaml file: config\config.yaml
[2024-11-11 11:09:26,798] INFO: common : 33] Successfully loaded yaml file: params.yaml
[2024-11-11 11:09:26,801] INFO: common : 33] Successfully loaded yaml file: schema.yaml
[2024-11-11 11:09:26,801] INFO: common : 56] Created directory: artifacts
[2024-11-11 11:09:26,804] INFO: common : 56] Created directory: artifacts/data_cleaning
[2024-11-11 11:09:27,012] INFO: common : 80] Successfully loaded DataFrame from: artifacts\data_preprocessing\preprocessed_data.csv
[2024-11-11 11:09:27,012] INFO: data_cleaning : 31] Initiating train test split...
[2024-11-11 11:09:27,067] INFO: data_cleaning : 33] Train test split completed successfully.
[2024-11-11 11:09:27,067] INFO: data_cleaning : 87] Applying business rules...
[2024-11-11 11:09:27,081] INFO: data_cleaning : 91] After applying Processing Fee rule, train_df: (39987, 33), test_df: (9998, 33)
[2024-11-11 11:09:27,081] INFO: data_cleaning : 95] GST Violations in train data: 0 records
[2024-11-11 11:09:27,081] INFO: data_cleaning : 99] Net Disbursement Violations in train data: 0 records
[2024-11-11 11:09:27,084] INFO: data_cleaning : 104] Fixed loan_purpose column: loan_purpose
Personal     14031
Home         12003
Auto          7947
Education     6006
Name: count, dtype: int64
[2024-11-11 11:09:27,097] INFO: data_cleaning : 109] Generated loan_to_income column
[2024-11-11 11:09:27,102] INFO: data_cleaning : 114] Generated delinquency_ratio column: count    39987.000000
mean        10.426146
std         17.285322
min          0.000000
25%          0.000000
50%          3.800000
75%         13.200000
max        100.000000
Name: delinquency_ratio, dtype: float64
[2024-11-11 11:09:27,107] INFO: data_cleaning : 127] Generated avg_dpd_per_delinquency column: count    39987.000000
mean         3.304136
std          2.902968
min          0.000000
25%          0.000000
50%          4.300000
75%          5.800000
max         10.000000
Name: avg_dpd_per_delinquency, dtype: float64
[2024-11-11 11:09:27,118] ERROR: data_cleaning : 58] Extra columns: net_disbursement, cust_id, delinquent_months, disbursal_date, zipcode, employment_status, loan_id, gst, installment_start_dt, enquiry_count, number_of_dependants, bank_balance_at_application, number_of_closed_accounts, city, state, loan_amount, sanction_amount, marital_status, default, total_loan_months, principal_outstanding, total_dpd, gender, processing_fee, income, years_at_current_address
[2024-11-11 11:09:27,118] ERROR: data_cleaning : 184] Error occurred during data cleaning: CustomException.__init__() missing 1 required positional argument: 'error_detail'
[2024-11-11 11:09:27,118] ERROR: data_cleaning_pipeline : 22] Error occurred during data ingestion: Error occurred in python script name [C:\Users\ambig\jupiter_notebook\Projects\Credit-Risk-Model\src\Credit_Risk_Model\components\data_cleaning.py] line number [144] error message[CustomException.__init__() missing 1 required positional argument: 'error_detail']
[2024-11-11 11:09:27,120] INFO: main : 38] >>>>>>>>>>>Completed Data Cleaning Stage<<<<<<<<<<<<<
[2024-11-11 11:11:35,472] INFO: __init__ : 26] Credit Risk Model Building Started
[2024-11-11 11:11:37,837] INFO: main : 12] >>>>>>>>>>>Starting Data Ingestion Stage<<<<<<<<<<<<<
[2024-11-11 11:11:37,837] INFO: common : 33] Successfully loaded yaml file: config\config.yaml
[2024-11-11 11:11:37,845] INFO: common : 33] Successfully loaded yaml file: params.yaml
[2024-11-11 11:11:37,852] INFO: common : 33] Successfully loaded yaml file: schema.yaml
[2024-11-11 11:11:37,854] INFO: common : 56] Created directory: artifacts
[2024-11-11 11:11:37,854] INFO: common : 56] Created directory: artifacts/data_ingestion
[2024-11-11 11:11:37,854] INFO: data_ingestion : 17] Loading customers data...
[2024-11-11 11:11:37,990] INFO: common : 80] Successfully loaded DataFrame from: data\customers.csv
[2024-11-11 11:11:37,991] INFO: data_ingestion : 20] Loading loans data...
[2024-11-11 11:11:38,160] INFO: common : 80] Successfully loaded DataFrame from: data\loans.csv
[2024-11-11 11:11:38,160] INFO: data_ingestion : 23] Loading bureau data...
[2024-11-11 11:11:38,224] INFO: common : 80] Successfully loaded DataFrame from: data\bureau_data.csv
[2024-11-11 11:11:38,224] INFO: data_ingestion : 26] The Shape of customers data: (50000, 12)
[2024-11-11 11:11:38,224] INFO: data_ingestion : 27] The Shape of loans data: (50000, 15)
[2024-11-11 11:11:38,224] INFO: data_ingestion : 28] The Shape of bureau data: (50000, 8)
[2024-11-11 11:11:38,946] INFO: common : 98] Successfully saved DataFrame to: artifacts\data_ingestion\data.csv
[2024-11-11 11:11:38,962] INFO: main : 14] >>>>>>>>>>>Completed Data Ingestion Stage<<<<<<<<<<<<<
[2024-11-11 11:11:38,963] INFO: main : 24] >>>>>>>>>>>Starting Data Pre-Processing Stage<<<<<<<<<<<<<
[2024-11-11 11:11:38,966] INFO: common : 33] Successfully loaded yaml file: config\config.yaml
[2024-11-11 11:11:38,970] INFO: common : 33] Successfully loaded yaml file: params.yaml
[2024-11-11 11:11:38,974] INFO: common : 33] Successfully loaded yaml file: schema.yaml
[2024-11-11 11:11:38,976] INFO: common : 56] Created directory: artifacts
[2024-11-11 11:11:38,977] INFO: common : 56] Created directory: artifacts/data_preprocessing
[2024-11-11 11:11:39,212] INFO: common : 80] Successfully loaded DataFrame from: artifacts\data_ingestion\data.csv
[2024-11-11 11:11:39,214] INFO: data_preprocessing : 26] The Valure counts for 'default' column: default
0    45703
1     4297
Name: count, dtype: int64
[2024-11-11 11:11:39,218] INFO: data_preprocessing : 42] No missing values found in column 'cust_id'
[2024-11-11 11:11:39,219] INFO: data_preprocessing : 42] No missing values found in column 'age'
[2024-11-11 11:11:39,222] INFO: data_preprocessing : 42] No missing values found in column 'gender'
[2024-11-11 11:11:39,226] INFO: data_preprocessing : 42] No missing values found in column 'marital_status'
[2024-11-11 11:11:39,229] INFO: data_preprocessing : 42] No missing values found in column 'employment_status'
[2024-11-11 11:11:39,230] INFO: data_preprocessing : 42] No missing values found in column 'income'
[2024-11-11 11:11:39,231] INFO: data_preprocessing : 42] No missing values found in column 'number_of_dependants'
[2024-11-11 11:11:39,233] WARNING: data_preprocessing : 33] Missing values found in column 'residence_type', replacing with 'Unknown'
[2024-11-11 11:11:39,247] INFO: data_preprocessing : 35] Missing values replaced in column 'residence_type' with mode 'Owned'
[2024-11-11 11:11:39,247] INFO: data_preprocessing : 42] No missing values found in column 'years_at_current_address'
[2024-11-11 11:11:39,249] INFO: data_preprocessing : 42] No missing values found in column 'city'
[2024-11-11 11:11:39,252] INFO: data_preprocessing : 42] No missing values found in column 'state'
[2024-11-11 11:11:39,252] INFO: data_preprocessing : 42] No missing values found in column 'zipcode'
[2024-11-11 11:11:39,255] INFO: data_preprocessing : 42] No missing values found in column 'loan_id'
[2024-11-11 11:11:39,255] INFO: data_preprocessing : 42] No missing values found in column 'loan_purpose'
[2024-11-11 11:11:39,263] INFO: data_preprocessing : 42] No missing values found in column 'loan_type'
[2024-11-11 11:11:39,263] INFO: data_preprocessing : 42] No missing values found in column 'sanction_amount'
[2024-11-11 11:11:39,263] INFO: data_preprocessing : 42] No missing values found in column 'loan_amount'
[2024-11-11 11:11:39,263] INFO: data_preprocessing : 42] No missing values found in column 'processing_fee'
[2024-11-11 11:11:39,263] INFO: data_preprocessing : 42] No missing values found in column 'gst'
[2024-11-11 11:11:39,263] INFO: data_preprocessing : 42] No missing values found in column 'net_disbursement'
[2024-11-11 11:11:39,268] INFO: data_preprocessing : 42] No missing values found in column 'loan_tenure_months'
[2024-11-11 11:11:39,269] INFO: data_preprocessing : 42] No missing values found in column 'principal_outstanding'
[2024-11-11 11:11:39,269] INFO: data_preprocessing : 42] No missing values found in column 'bank_balance_at_application'
[2024-11-11 11:11:39,273] INFO: data_preprocessing : 42] No missing values found in column 'disbursal_date'
[2024-11-11 11:11:39,276] INFO: data_preprocessing : 42] No missing values found in column 'installment_start_dt'
[2024-11-11 11:11:39,276] INFO: data_preprocessing : 42] No missing values found in column 'default'
[2024-11-11 11:11:39,276] INFO: data_preprocessing : 42] No missing values found in column 'number_of_open_accounts'
[2024-11-11 11:11:39,279] INFO: data_preprocessing : 42] No missing values found in column 'number_of_closed_accounts'
[2024-11-11 11:11:39,279] INFO: data_preprocessing : 42] No missing values found in column 'total_loan_months'
[2024-11-11 11:11:39,279] INFO: data_preprocessing : 42] No missing values found in column 'delinquent_months'
[2024-11-11 11:11:39,279] INFO: data_preprocessing : 42] No missing values found in column 'total_dpd'
[2024-11-11 11:11:39,279] INFO: data_preprocessing : 42] No missing values found in column 'enquiry_count'
[2024-11-11 11:11:39,279] INFO: data_preprocessing : 42] No missing values found in column 'credit_utilization_ratio'
[2024-11-11 11:11:39,352] INFO: data_preprocessing : 51] No duplicate rows found
[2024-11-11 11:11:39,352] INFO: data_preprocessing : 53] Index(['cust_id', 'age', 'gender', 'marital_status', 'employment_status',
       'income', 'number_of_dependants', 'residence_type',
       'years_at_current_address', 'city', 'state', 'zipcode', 'loan_id',
       'loan_purpose', 'loan_type', 'sanction_amount', 'loan_amount',
       'processing_fee', 'gst', 'net_disbursement', 'loan_tenure_months',
       'principal_outstanding', 'bank_balance_at_application',
       'disbursal_date', 'installment_start_dt', 'default',
       'number_of_open_accounts', 'number_of_closed_accounts',
       'total_loan_months', 'delinquent_months', 'total_dpd', 'enquiry_count',
       'credit_utilization_ratio'],
      dtype='object')
[2024-11-11 11:11:39,875] INFO: common : 98] Successfully saved DataFrame to: artifacts\data_preprocessing\preprocessed_data.csv
[2024-11-11 11:11:39,878] INFO: main : 26] >>>>>>>>>>>Completed Data Pre-Processing Stage<<<<<<<<<<<<<
[2024-11-11 11:11:39,878] INFO: main : 36] >>>>>>>>>>>Starting Data Cleaning Stage<<<<<<<<<<<<<
[2024-11-11 11:11:39,878] INFO: common : 33] Successfully loaded yaml file: config\config.yaml
[2024-11-11 11:11:39,878] INFO: common : 33] Successfully loaded yaml file: params.yaml
[2024-11-11 11:11:39,888] INFO: common : 33] Successfully loaded yaml file: schema.yaml
[2024-11-11 11:11:39,888] INFO: common : 56] Created directory: artifacts
[2024-11-11 11:11:39,890] INFO: common : 56] Created directory: artifacts/data_cleaning
[2024-11-11 11:11:40,129] INFO: common : 80] Successfully loaded DataFrame from: artifacts\data_preprocessing\preprocessed_data.csv
[2024-11-11 11:11:40,130] INFO: data_cleaning : 31] Initiating train test split...
[2024-11-11 11:11:40,152] INFO: data_cleaning : 33] Train test split completed successfully.
[2024-11-11 11:11:40,152] INFO: data_cleaning : 87] Applying business rules...
[2024-11-11 11:11:40,166] INFO: data_cleaning : 91] After applying Processing Fee rule, train_df: (39987, 33), test_df: (9998, 33)
[2024-11-11 11:11:40,168] INFO: data_cleaning : 95] GST Violations in train data: 0 records
[2024-11-11 11:11:40,169] INFO: data_cleaning : 99] Net Disbursement Violations in train data: 0 records
[2024-11-11 11:11:40,173] INFO: data_cleaning : 104] Fixed loan_purpose column: loan_purpose
Personal     14031
Home         12003
Auto          7947
Education     6006
Name: count, dtype: int64
[2024-11-11 11:11:40,182] INFO: data_cleaning : 109] Generated loan_to_income column
[2024-11-11 11:11:40,191] INFO: data_cleaning : 114] Generated delinquency_ratio column: count    39987.000000
mean        10.426146
std         17.285322
min          0.000000
25%          0.000000
50%          3.800000
75%         13.200000
max        100.000000
Name: delinquency_ratio, dtype: float64
[2024-11-11 11:11:40,199] INFO: data_cleaning : 127] Generated avg_dpd_per_delinquency column: count    39987.000000
mean         3.304136
std          2.902968
min          0.000000
25%          0.000000
50%          4.300000
75%          5.800000
max         10.000000
Name: avg_dpd_per_delinquency, dtype: float64
[2024-11-11 11:11:40,206] ERROR: data_cleaning : 58] Extra columns: number_of_dependants, income, number_of_closed_accounts, total_dpd, loan_amount, default, enquiry_count, total_loan_months, sanction_amount, processing_fee, bank_balance_at_application, state, disbursal_date, gst, net_disbursement, marital_status, principal_outstanding, loan_id, employment_status, gender, installment_start_dt, cust_id, years_at_current_address, delinquent_months, zipcode, city
[2024-11-11 11:11:40,206] ERROR: data_cleaning : 187] Error occurred during data cleaning: CustomException.__init__() missing 1 required positional argument: 'error_detail'
[2024-11-11 11:11:40,208] ERROR: data_cleaning_pipeline : 22] Error occurred during data ingestion: Error occurred in python script name [C:\Users\ambig\jupiter_notebook\Projects\Credit-Risk-Model\src\Credit_Risk_Model\components\data_cleaning.py] line number [147] error message[CustomException.__init__() missing 1 required positional argument: 'error_detail']
[2024-11-11 11:11:40,216] INFO: main : 38] >>>>>>>>>>>Completed Data Cleaning Stage<<<<<<<<<<<<<
[2024-11-11 11:12:54,657] INFO: __init__ : 26] Credit Risk Model Building Started
[2024-11-11 11:12:56,731] INFO: main : 12] >>>>>>>>>>>Starting Data Ingestion Stage<<<<<<<<<<<<<
[2024-11-11 11:12:56,734] INFO: common : 33] Successfully loaded yaml file: config\config.yaml
[2024-11-11 11:12:56,734] INFO: common : 33] Successfully loaded yaml file: params.yaml
[2024-11-11 11:12:56,738] INFO: common : 33] Successfully loaded yaml file: schema.yaml
[2024-11-11 11:12:56,738] INFO: common : 56] Created directory: artifacts
[2024-11-11 11:12:56,738] INFO: common : 56] Created directory: artifacts/data_ingestion
[2024-11-11 11:12:56,738] INFO: data_ingestion : 17] Loading customers data...
[2024-11-11 11:12:56,845] INFO: common : 80] Successfully loaded DataFrame from: data\customers.csv
[2024-11-11 11:12:56,845] INFO: data_ingestion : 20] Loading loans data...
[2024-11-11 11:12:57,002] INFO: common : 80] Successfully loaded DataFrame from: data\loans.csv
[2024-11-11 11:12:57,005] INFO: data_ingestion : 23] Loading bureau data...
[2024-11-11 11:12:57,050] INFO: common : 80] Successfully loaded DataFrame from: data\bureau_data.csv
[2024-11-11 11:12:57,050] INFO: data_ingestion : 26] The Shape of customers data: (50000, 12)
[2024-11-11 11:12:57,050] INFO: data_ingestion : 27] The Shape of loans data: (50000, 15)
[2024-11-11 11:12:57,050] INFO: data_ingestion : 28] The Shape of bureau data: (50000, 8)
[2024-11-11 11:12:57,631] INFO: common : 98] Successfully saved DataFrame to: artifacts\data_ingestion\data.csv
[2024-11-11 11:12:57,652] INFO: main : 14] >>>>>>>>>>>Completed Data Ingestion Stage<<<<<<<<<<<<<
[2024-11-11 11:12:57,653] INFO: main : 24] >>>>>>>>>>>Starting Data Pre-Processing Stage<<<<<<<<<<<<<
[2024-11-11 11:12:57,655] INFO: common : 33] Successfully loaded yaml file: config\config.yaml
[2024-11-11 11:12:57,657] INFO: common : 33] Successfully loaded yaml file: params.yaml
[2024-11-11 11:12:57,659] INFO: common : 33] Successfully loaded yaml file: schema.yaml
[2024-11-11 11:12:57,660] INFO: common : 56] Created directory: artifacts
[2024-11-11 11:12:57,661] INFO: common : 56] Created directory: artifacts/data_preprocessing
[2024-11-11 11:12:57,904] INFO: common : 80] Successfully loaded DataFrame from: artifacts\data_ingestion\data.csv
[2024-11-11 11:12:57,904] INFO: data_preprocessing : 26] The Valure counts for 'default' column: default
0    45703
1     4297
Name: count, dtype: int64
[2024-11-11 11:12:57,904] INFO: data_preprocessing : 42] No missing values found in column 'cust_id'
[2024-11-11 11:12:57,904] INFO: data_preprocessing : 42] No missing values found in column 'age'
[2024-11-11 11:12:57,916] INFO: data_preprocessing : 42] No missing values found in column 'gender'
[2024-11-11 11:12:57,918] INFO: data_preprocessing : 42] No missing values found in column 'marital_status'
[2024-11-11 11:12:57,923] INFO: data_preprocessing : 42] No missing values found in column 'employment_status'
[2024-11-11 11:12:57,923] INFO: data_preprocessing : 42] No missing values found in column 'income'
[2024-11-11 11:12:57,923] INFO: data_preprocessing : 42] No missing values found in column 'number_of_dependants'
[2024-11-11 11:12:57,923] WARNING: data_preprocessing : 33] Missing values found in column 'residence_type', replacing with 'Unknown'
[2024-11-11 11:12:57,937] INFO: data_preprocessing : 35] Missing values replaced in column 'residence_type' with mode 'Owned'
[2024-11-11 11:12:57,937] INFO: data_preprocessing : 42] No missing values found in column 'years_at_current_address'
[2024-11-11 11:12:57,942] INFO: data_preprocessing : 42] No missing values found in column 'city'
[2024-11-11 11:12:57,942] INFO: data_preprocessing : 42] No missing values found in column 'state'
[2024-11-11 11:12:57,942] INFO: data_preprocessing : 42] No missing values found in column 'zipcode'
[2024-11-11 11:12:57,951] INFO: data_preprocessing : 42] No missing values found in column 'loan_id'
[2024-11-11 11:12:57,952] INFO: data_preprocessing : 42] No missing values found in column 'loan_purpose'
[2024-11-11 11:12:57,957] INFO: data_preprocessing : 42] No missing values found in column 'loan_type'
[2024-11-11 11:12:57,958] INFO: data_preprocessing : 42] No missing values found in column 'sanction_amount'
[2024-11-11 11:12:57,959] INFO: data_preprocessing : 42] No missing values found in column 'loan_amount'
[2024-11-11 11:12:57,960] INFO: data_preprocessing : 42] No missing values found in column 'processing_fee'
[2024-11-11 11:12:57,960] INFO: data_preprocessing : 42] No missing values found in column 'gst'
[2024-11-11 11:12:57,960] INFO: data_preprocessing : 42] No missing values found in column 'net_disbursement'
[2024-11-11 11:12:57,960] INFO: data_preprocessing : 42] No missing values found in column 'loan_tenure_months'
[2024-11-11 11:12:57,960] INFO: data_preprocessing : 42] No missing values found in column 'principal_outstanding'
[2024-11-11 11:12:57,960] INFO: data_preprocessing : 42] No missing values found in column 'bank_balance_at_application'
[2024-11-11 11:12:57,966] INFO: data_preprocessing : 42] No missing values found in column 'disbursal_date'
[2024-11-11 11:12:57,969] INFO: data_preprocessing : 42] No missing values found in column 'installment_start_dt'
[2024-11-11 11:12:57,970] INFO: data_preprocessing : 42] No missing values found in column 'default'
[2024-11-11 11:12:57,971] INFO: data_preprocessing : 42] No missing values found in column 'number_of_open_accounts'
[2024-11-11 11:12:57,971] INFO: data_preprocessing : 42] No missing values found in column 'number_of_closed_accounts'
[2024-11-11 11:12:57,972] INFO: data_preprocessing : 42] No missing values found in column 'total_loan_months'
[2024-11-11 11:12:57,972] INFO: data_preprocessing : 42] No missing values found in column 'delinquent_months'
[2024-11-11 11:12:57,972] INFO: data_preprocessing : 42] No missing values found in column 'total_dpd'
[2024-11-11 11:12:57,974] INFO: data_preprocessing : 42] No missing values found in column 'enquiry_count'
[2024-11-11 11:12:57,974] INFO: data_preprocessing : 42] No missing values found in column 'credit_utilization_ratio'
[2024-11-11 11:12:58,041] INFO: data_preprocessing : 51] No duplicate rows found
[2024-11-11 11:12:58,041] INFO: data_preprocessing : 53] Index(['cust_id', 'age', 'gender', 'marital_status', 'employment_status',
       'income', 'number_of_dependants', 'residence_type',
       'years_at_current_address', 'city', 'state', 'zipcode', 'loan_id',
       'loan_purpose', 'loan_type', 'sanction_amount', 'loan_amount',
       'processing_fee', 'gst', 'net_disbursement', 'loan_tenure_months',
       'principal_outstanding', 'bank_balance_at_application',
       'disbursal_date', 'installment_start_dt', 'default',
       'number_of_open_accounts', 'number_of_closed_accounts',
       'total_loan_months', 'delinquent_months', 'total_dpd', 'enquiry_count',
       'credit_utilization_ratio'],
      dtype='object')
[2024-11-11 11:12:58,521] INFO: common : 98] Successfully saved DataFrame to: artifacts\data_preprocessing\preprocessed_data.csv
[2024-11-11 11:12:58,536] INFO: main : 26] >>>>>>>>>>>Completed Data Pre-Processing Stage<<<<<<<<<<<<<
[2024-11-11 11:12:58,536] INFO: main : 36] >>>>>>>>>>>Starting Data Cleaning Stage<<<<<<<<<<<<<
[2024-11-11 11:12:58,542] INFO: common : 33] Successfully loaded yaml file: config\config.yaml
[2024-11-11 11:12:58,545] INFO: common : 33] Successfully loaded yaml file: params.yaml
[2024-11-11 11:12:58,546] INFO: common : 33] Successfully loaded yaml file: schema.yaml
[2024-11-11 11:12:58,546] INFO: common : 56] Created directory: artifacts
[2024-11-11 11:12:58,550] INFO: common : 56] Created directory: artifacts/data_cleaning
[2024-11-11 11:12:58,785] INFO: common : 80] Successfully loaded DataFrame from: artifacts\data_preprocessing\preprocessed_data.csv
[2024-11-11 11:12:58,785] INFO: data_cleaning : 31] Initiating train test split...
[2024-11-11 11:12:58,800] INFO: data_cleaning : 33] Train test split completed successfully.
[2024-11-11 11:12:58,809] INFO: data_cleaning : 87] Applying business rules...
[2024-11-11 11:12:58,820] INFO: data_cleaning : 91] After applying Processing Fee rule, train_df: (39987, 33), test_df: (9998, 33)
[2024-11-11 11:12:58,824] INFO: data_cleaning : 95] GST Violations in train data: 0 records
[2024-11-11 11:12:58,824] INFO: data_cleaning : 99] Net Disbursement Violations in train data: 0 records
[2024-11-11 11:12:58,834] INFO: data_cleaning : 104] Fixed loan_purpose column: loan_purpose
Personal     14031
Home         12003
Auto          7947
Education     6006
Name: count, dtype: int64
[2024-11-11 11:12:58,836] INFO: data_cleaning : 109] Generated loan_to_income column
[2024-11-11 11:12:58,843] INFO: data_cleaning : 114] Generated delinquency_ratio column: count    39987.000000
mean        10.426146
std         17.285322
min          0.000000
25%          0.000000
50%          3.800000
75%         13.200000
max        100.000000
Name: delinquency_ratio, dtype: float64
[2024-11-11 11:12:58,852] INFO: data_cleaning : 127] Generated avg_dpd_per_delinquency column: count    39987.000000
mean         3.304136
std          2.902968
min          0.000000
25%          0.000000
50%          4.300000
75%          5.800000
max         10.000000
Name: avg_dpd_per_delinquency, dtype: float64
[2024-11-11 11:12:58,856] INFO: data_cleaning : 41] Removing unnecessary columns...
[2024-11-11 11:12:58,884] INFO: data_cleaning : 43] Columns removed successfully.
[2024-11-11 11:12:58,884] INFO: data_cleaning : 41] Removing unnecessary columns...
[2024-11-11 11:12:58,884] INFO: data_cleaning : 43] Columns removed successfully.
[2024-11-11 11:12:58,893] ERROR: data_cleaning : 70] Dtype mismatch in 'age': Expected int, got int64
[2024-11-11 11:12:58,894] INFO: data_cleaning : 74] Converted column 'age' to int.
[2024-11-11 11:12:58,895] ERROR: data_cleaning : 70] Dtype mismatch in 'loan_tenure_months': Expected int, got int64
[2024-11-11 11:12:58,896] INFO: data_cleaning : 74] Converted column 'loan_tenure_months' to int.
[2024-11-11 11:12:58,896] ERROR: data_cleaning : 70] Dtype mismatch in 'number_of_open_accounts': Expected int, got int64
[2024-11-11 11:12:58,896] INFO: data_cleaning : 74] Converted column 'number_of_open_accounts' to int.
[2024-11-11 11:12:58,896] ERROR: data_cleaning : 70] Dtype mismatch in 'credit_utilization_ratio': Expected int, got int64
[2024-11-11 11:12:58,898] INFO: data_cleaning : 74] Converted column 'credit_utilization_ratio' to int.
[2024-11-11 11:12:58,898] INFO: data_cleaning : 79] Schema validation successful: Columns and dtypes match.
[2024-11-11 11:12:58,900] ERROR: data_cleaning : 70] Dtype mismatch in 'age': Expected int, got int64
[2024-11-11 11:12:58,901] INFO: data_cleaning : 74] Converted column 'age' to int.
[2024-11-11 11:12:58,902] ERROR: data_cleaning : 70] Dtype mismatch in 'loan_tenure_months': Expected int, got int64
[2024-11-11 11:12:58,902] INFO: data_cleaning : 74] Converted column 'loan_tenure_months' to int.
[2024-11-11 11:12:58,902] ERROR: data_cleaning : 70] Dtype mismatch in 'number_of_open_accounts': Expected int, got int64
[2024-11-11 11:12:58,905] INFO: data_cleaning : 74] Converted column 'number_of_open_accounts' to int.
[2024-11-11 11:12:58,905] ERROR: data_cleaning : 70] Dtype mismatch in 'credit_utilization_ratio': Expected int, got int64
[2024-11-11 11:12:58,905] INFO: data_cleaning : 74] Converted column 'credit_utilization_ratio' to int.
[2024-11-11 11:12:58,905] INFO: data_cleaning : 79] Schema validation successful: Columns and dtypes match.
[2024-11-11 11:12:59,007] ERROR: data_cleaning : 189] Error occurred during data cleaning: save_numpy_array_data() got an unexpected keyword argument 'data'
[2024-11-11 11:12:59,009] ERROR: data_cleaning_pipeline : 22] Error occurred during data ingestion: Error occurred in python script name [C:\Users\ambig\jupiter_notebook\Projects\Credit-Risk-Model\src\Credit_Risk_Model\components\data_cleaning.py] line number [183] error message[save_numpy_array_data() got an unexpected keyword argument 'data']
[2024-11-11 11:12:59,009] INFO: main : 38] >>>>>>>>>>>Completed Data Cleaning Stage<<<<<<<<<<<<<
[2024-11-11 11:13:51,859] INFO: __init__ : 26] Credit Risk Model Building Started
[2024-11-11 11:13:54,120] INFO: main : 12] >>>>>>>>>>>Starting Data Ingestion Stage<<<<<<<<<<<<<
[2024-11-11 11:13:54,123] INFO: common : 33] Successfully loaded yaml file: config\config.yaml
[2024-11-11 11:13:54,127] INFO: common : 33] Successfully loaded yaml file: params.yaml
[2024-11-11 11:13:54,131] INFO: common : 33] Successfully loaded yaml file: schema.yaml
[2024-11-11 11:13:54,131] INFO: common : 56] Created directory: artifacts
[2024-11-11 11:13:54,131] INFO: common : 56] Created directory: artifacts/data_ingestion
[2024-11-11 11:13:54,134] INFO: data_ingestion : 17] Loading customers data...
[2024-11-11 11:13:54,233] INFO: common : 80] Successfully loaded DataFrame from: data\customers.csv
[2024-11-11 11:13:54,233] INFO: data_ingestion : 20] Loading loans data...
[2024-11-11 11:13:54,384] INFO: common : 80] Successfully loaded DataFrame from: data\loans.csv
[2024-11-11 11:13:54,384] INFO: data_ingestion : 23] Loading bureau data...
[2024-11-11 11:13:54,437] INFO: common : 80] Successfully loaded DataFrame from: data\bureau_data.csv
[2024-11-11 11:13:54,437] INFO: data_ingestion : 26] The Shape of customers data: (50000, 12)
[2024-11-11 11:13:54,437] INFO: data_ingestion : 27] The Shape of loans data: (50000, 15)
[2024-11-11 11:13:54,437] INFO: data_ingestion : 28] The Shape of bureau data: (50000, 8)
[2024-11-11 11:13:55,088] INFO: common : 98] Successfully saved DataFrame to: artifacts\data_ingestion\data.csv
[2024-11-11 11:13:55,088] INFO: main : 14] >>>>>>>>>>>Completed Data Ingestion Stage<<<<<<<<<<<<<
[2024-11-11 11:13:55,088] INFO: main : 24] >>>>>>>>>>>Starting Data Pre-Processing Stage<<<<<<<<<<<<<
[2024-11-11 11:13:55,100] INFO: common : 33] Successfully loaded yaml file: config\config.yaml
[2024-11-11 11:13:55,101] INFO: common : 33] Successfully loaded yaml file: params.yaml
[2024-11-11 11:13:55,105] INFO: common : 33] Successfully loaded yaml file: schema.yaml
[2024-11-11 11:13:55,107] INFO: common : 56] Created directory: artifacts
[2024-11-11 11:13:55,107] INFO: common : 56] Created directory: artifacts/data_preprocessing
[2024-11-11 11:13:55,314] INFO: common : 80] Successfully loaded DataFrame from: artifacts\data_ingestion\data.csv
[2024-11-11 11:13:55,314] INFO: data_preprocessing : 26] The Valure counts for 'default' column: default
0    45703
1     4297
Name: count, dtype: int64
[2024-11-11 11:13:55,314] INFO: data_preprocessing : 42] No missing values found in column 'cust_id'
[2024-11-11 11:13:55,314] INFO: data_preprocessing : 42] No missing values found in column 'age'
[2024-11-11 11:13:55,329] INFO: data_preprocessing : 42] No missing values found in column 'gender'
[2024-11-11 11:13:55,329] INFO: data_preprocessing : 42] No missing values found in column 'marital_status'
[2024-11-11 11:13:55,335] INFO: data_preprocessing : 42] No missing values found in column 'employment_status'
[2024-11-11 11:13:55,335] INFO: data_preprocessing : 42] No missing values found in column 'income'
[2024-11-11 11:13:55,335] INFO: data_preprocessing : 42] No missing values found in column 'number_of_dependants'
[2024-11-11 11:13:55,335] WARNING: data_preprocessing : 33] Missing values found in column 'residence_type', replacing with 'Unknown'
[2024-11-11 11:13:55,350] INFO: data_preprocessing : 35] Missing values replaced in column 'residence_type' with mode 'Owned'
[2024-11-11 11:13:55,352] INFO: data_preprocessing : 42] No missing values found in column 'years_at_current_address'
[2024-11-11 11:13:55,352] INFO: data_preprocessing : 42] No missing values found in column 'city'
[2024-11-11 11:13:55,352] INFO: data_preprocessing : 42] No missing values found in column 'state'
[2024-11-11 11:13:55,352] INFO: data_preprocessing : 42] No missing values found in column 'zipcode'
[2024-11-11 11:13:55,368] INFO: data_preprocessing : 42] No missing values found in column 'loan_id'
[2024-11-11 11:13:55,368] INFO: data_preprocessing : 42] No missing values found in column 'loan_purpose'
[2024-11-11 11:13:55,368] INFO: data_preprocessing : 42] No missing values found in column 'loan_type'
[2024-11-11 11:13:55,368] INFO: data_preprocessing : 42] No missing values found in column 'sanction_amount'
[2024-11-11 11:13:55,368] INFO: data_preprocessing : 42] No missing values found in column 'loan_amount'
[2024-11-11 11:13:55,383] INFO: data_preprocessing : 42] No missing values found in column 'processing_fee'
[2024-11-11 11:13:55,386] INFO: data_preprocessing : 42] No missing values found in column 'gst'
[2024-11-11 11:13:55,386] INFO: data_preprocessing : 42] No missing values found in column 'net_disbursement'
[2024-11-11 11:13:55,386] INFO: data_preprocessing : 42] No missing values found in column 'loan_tenure_months'
[2024-11-11 11:13:55,386] INFO: data_preprocessing : 42] No missing values found in column 'principal_outstanding'
[2024-11-11 11:13:55,386] INFO: data_preprocessing : 42] No missing values found in column 'bank_balance_at_application'
[2024-11-11 11:13:55,386] INFO: data_preprocessing : 42] No missing values found in column 'disbursal_date'
[2024-11-11 11:13:55,386] INFO: data_preprocessing : 42] No missing values found in column 'installment_start_dt'
[2024-11-11 11:13:55,386] INFO: data_preprocessing : 42] No missing values found in column 'default'
[2024-11-11 11:13:55,398] INFO: data_preprocessing : 42] No missing values found in column 'number_of_open_accounts'
[2024-11-11 11:13:55,400] INFO: data_preprocessing : 42] No missing values found in column 'number_of_closed_accounts'
[2024-11-11 11:13:55,401] INFO: data_preprocessing : 42] No missing values found in column 'total_loan_months'
[2024-11-11 11:13:55,401] INFO: data_preprocessing : 42] No missing values found in column 'delinquent_months'
[2024-11-11 11:13:55,404] INFO: data_preprocessing : 42] No missing values found in column 'total_dpd'
[2024-11-11 11:13:55,404] INFO: data_preprocessing : 42] No missing values found in column 'enquiry_count'
[2024-11-11 11:13:55,404] INFO: data_preprocessing : 42] No missing values found in column 'credit_utilization_ratio'
[2024-11-11 11:13:55,472] INFO: data_preprocessing : 51] No duplicate rows found
[2024-11-11 11:13:55,472] INFO: data_preprocessing : 53] Index(['cust_id', 'age', 'gender', 'marital_status', 'employment_status',
       'income', 'number_of_dependants', 'residence_type',
       'years_at_current_address', 'city', 'state', 'zipcode', 'loan_id',
       'loan_purpose', 'loan_type', 'sanction_amount', 'loan_amount',
       'processing_fee', 'gst', 'net_disbursement', 'loan_tenure_months',
       'principal_outstanding', 'bank_balance_at_application',
       'disbursal_date', 'installment_start_dt', 'default',
       'number_of_open_accounts', 'number_of_closed_accounts',
       'total_loan_months', 'delinquent_months', 'total_dpd', 'enquiry_count',
       'credit_utilization_ratio'],
      dtype='object')
[2024-11-11 11:13:55,957] INFO: common : 98] Successfully saved DataFrame to: artifacts\data_preprocessing\preprocessed_data.csv
[2024-11-11 11:13:55,957] INFO: main : 26] >>>>>>>>>>>Completed Data Pre-Processing Stage<<<<<<<<<<<<<
[2024-11-11 11:13:55,957] INFO: main : 36] >>>>>>>>>>>Starting Data Cleaning Stage<<<<<<<<<<<<<
[2024-11-11 11:13:55,957] INFO: common : 33] Successfully loaded yaml file: config\config.yaml
[2024-11-11 11:13:55,966] INFO: common : 33] Successfully loaded yaml file: params.yaml
[2024-11-11 11:13:55,969] INFO: common : 33] Successfully loaded yaml file: schema.yaml
[2024-11-11 11:13:55,969] INFO: common : 56] Created directory: artifacts
[2024-11-11 11:13:55,973] INFO: common : 56] Created directory: artifacts/data_cleaning
[2024-11-11 11:13:56,214] INFO: common : 80] Successfully loaded DataFrame from: artifacts\data_preprocessing\preprocessed_data.csv
[2024-11-11 11:13:56,214] INFO: data_cleaning : 31] Initiating train test split...
[2024-11-11 11:13:56,238] INFO: data_cleaning : 33] Train test split completed successfully.
[2024-11-11 11:13:56,238] INFO: data_cleaning : 87] Applying business rules...
[2024-11-11 11:13:56,253] INFO: data_cleaning : 91] After applying Processing Fee rule, train_df: (39987, 33), test_df: (9998, 33)
[2024-11-11 11:13:56,255] INFO: data_cleaning : 95] GST Violations in train data: 0 records
[2024-11-11 11:13:56,257] INFO: data_cleaning : 99] Net Disbursement Violations in train data: 0 records
[2024-11-11 11:13:56,267] INFO: data_cleaning : 104] Fixed loan_purpose column: loan_purpose
Personal     14031
Home         12003
Auto          7947
Education     6006
Name: count, dtype: int64
[2024-11-11 11:13:56,270] INFO: data_cleaning : 109] Generated loan_to_income column
[2024-11-11 11:13:56,279] INFO: data_cleaning : 114] Generated delinquency_ratio column: count    39987.000000
mean        10.426146
std         17.285322
min          0.000000
25%          0.000000
50%          3.800000
75%         13.200000
max        100.000000
Name: delinquency_ratio, dtype: float64
[2024-11-11 11:13:56,287] INFO: data_cleaning : 127] Generated avg_dpd_per_delinquency column: count    39987.000000
mean         3.304136
std          2.902968
min          0.000000
25%          0.000000
50%          4.300000
75%          5.800000
max         10.000000
Name: avg_dpd_per_delinquency, dtype: float64
[2024-11-11 11:13:56,292] INFO: data_cleaning : 41] Removing unnecessary columns...
[2024-11-11 11:13:56,292] INFO: data_cleaning : 43] Columns removed successfully.
[2024-11-11 11:13:56,298] INFO: data_cleaning : 41] Removing unnecessary columns...
[2024-11-11 11:13:56,301] INFO: data_cleaning : 43] Columns removed successfully.
[2024-11-11 11:13:56,302] ERROR: data_cleaning : 70] Dtype mismatch in 'age': Expected int, got int64
[2024-11-11 11:13:56,305] INFO: data_cleaning : 74] Converted column 'age' to int.
[2024-11-11 11:13:56,306] ERROR: data_cleaning : 70] Dtype mismatch in 'loan_tenure_months': Expected int, got int64
[2024-11-11 11:13:56,306] INFO: data_cleaning : 74] Converted column 'loan_tenure_months' to int.
[2024-11-11 11:13:56,306] ERROR: data_cleaning : 70] Dtype mismatch in 'number_of_open_accounts': Expected int, got int64
[2024-11-11 11:13:56,306] INFO: data_cleaning : 74] Converted column 'number_of_open_accounts' to int.
[2024-11-11 11:13:56,306] ERROR: data_cleaning : 70] Dtype mismatch in 'credit_utilization_ratio': Expected int, got int64
[2024-11-11 11:13:56,306] INFO: data_cleaning : 74] Converted column 'credit_utilization_ratio' to int.
[2024-11-11 11:13:56,306] INFO: data_cleaning : 79] Schema validation successful: Columns and dtypes match.
[2024-11-11 11:13:56,311] ERROR: data_cleaning : 70] Dtype mismatch in 'age': Expected int, got int64
[2024-11-11 11:13:56,312] INFO: data_cleaning : 74] Converted column 'age' to int.
[2024-11-11 11:13:56,312] ERROR: data_cleaning : 70] Dtype mismatch in 'loan_tenure_months': Expected int, got int64
[2024-11-11 11:13:56,313] INFO: data_cleaning : 74] Converted column 'loan_tenure_months' to int.
[2024-11-11 11:13:56,313] ERROR: data_cleaning : 70] Dtype mismatch in 'number_of_open_accounts': Expected int, got int64
[2024-11-11 11:13:56,313] INFO: data_cleaning : 74] Converted column 'number_of_open_accounts' to int.
[2024-11-11 11:13:56,313] ERROR: data_cleaning : 70] Dtype mismatch in 'credit_utilization_ratio': Expected int, got int64
[2024-11-11 11:13:56,313] INFO: data_cleaning : 74] Converted column 'credit_utilization_ratio' to int.
[2024-11-11 11:13:56,313] INFO: data_cleaning : 79] Schema validation successful: Columns and dtypes match.
[2024-11-11 11:13:56,435] INFO: data_cleaning : 186] Data cleaning process completed successfully.
[2024-11-11 11:13:56,438] INFO: main : 38] >>>>>>>>>>>Completed Data Cleaning Stage<<<<<<<<<<<<<
[2024-11-11 11:14:27,502] INFO: __init__ : 26] Credit Risk Model Building Started
[2024-11-11 11:14:29,355] INFO: main : 12] >>>>>>>>>>>Starting Data Ingestion Stage<<<<<<<<<<<<<
[2024-11-11 11:14:29,371] INFO: common : 33] Successfully loaded yaml file: config\config.yaml
[2024-11-11 11:14:29,382] INFO: common : 33] Successfully loaded yaml file: params.yaml
[2024-11-11 11:14:29,385] INFO: common : 33] Successfully loaded yaml file: schema.yaml
[2024-11-11 11:14:29,385] INFO: common : 56] Created directory: artifacts
[2024-11-11 11:14:29,387] INFO: common : 56] Created directory: artifacts/data_ingestion
[2024-11-11 11:14:29,388] INFO: data_ingestion : 17] Loading customers data...
[2024-11-11 11:14:29,474] INFO: common : 80] Successfully loaded DataFrame from: data\customers.csv
[2024-11-11 11:14:29,474] INFO: data_ingestion : 20] Loading loans data...
[2024-11-11 11:14:29,601] INFO: common : 80] Successfully loaded DataFrame from: data\loans.csv
[2024-11-11 11:14:29,601] INFO: data_ingestion : 23] Loading bureau data...
[2024-11-11 11:14:29,657] INFO: common : 80] Successfully loaded DataFrame from: data\bureau_data.csv
[2024-11-11 11:14:29,657] INFO: data_ingestion : 26] The Shape of customers data: (50000, 12)
[2024-11-11 11:14:29,657] INFO: data_ingestion : 27] The Shape of loans data: (50000, 15)
[2024-11-11 11:14:29,657] INFO: data_ingestion : 28] The Shape of bureau data: (50000, 8)
[2024-11-11 11:14:30,202] INFO: common : 98] Successfully saved DataFrame to: artifacts\data_ingestion\data.csv
[2024-11-11 11:14:30,207] INFO: main : 14] >>>>>>>>>>>Completed Data Ingestion Stage<<<<<<<<<<<<<
[2024-11-11 11:14:30,207] INFO: main : 24] >>>>>>>>>>>Starting Data Pre-Processing Stage<<<<<<<<<<<<<
[2024-11-11 11:14:30,218] INFO: common : 33] Successfully loaded yaml file: config\config.yaml
[2024-11-11 11:14:30,218] INFO: common : 33] Successfully loaded yaml file: params.yaml
[2024-11-11 11:14:30,223] INFO: common : 33] Successfully loaded yaml file: schema.yaml
[2024-11-11 11:14:30,223] INFO: common : 56] Created directory: artifacts
[2024-11-11 11:14:30,223] INFO: common : 56] Created directory: artifacts/data_preprocessing
[2024-11-11 11:14:30,460] INFO: common : 80] Successfully loaded DataFrame from: artifacts\data_ingestion\data.csv
[2024-11-11 11:14:30,460] INFO: data_preprocessing : 26] The Valure counts for 'default' column: default
0    45703
1     4297
Name: count, dtype: int64
[2024-11-11 11:14:30,474] INFO: data_preprocessing : 42] No missing values found in column 'cust_id'
[2024-11-11 11:14:30,476] INFO: data_preprocessing : 42] No missing values found in column 'age'
[2024-11-11 11:14:30,479] INFO: data_preprocessing : 42] No missing values found in column 'gender'
[2024-11-11 11:14:30,483] INFO: data_preprocessing : 42] No missing values found in column 'marital_status'
[2024-11-11 11:14:30,486] INFO: data_preprocessing : 42] No missing values found in column 'employment_status'
[2024-11-11 11:14:30,486] INFO: data_preprocessing : 42] No missing values found in column 'income'
[2024-11-11 11:14:30,489] INFO: data_preprocessing : 42] No missing values found in column 'number_of_dependants'
[2024-11-11 11:14:30,492] WARNING: data_preprocessing : 33] Missing values found in column 'residence_type', replacing with 'Unknown'
[2024-11-11 11:14:30,503] INFO: data_preprocessing : 35] Missing values replaced in column 'residence_type' with mode 'Owned'
[2024-11-11 11:14:30,503] INFO: data_preprocessing : 42] No missing values found in column 'years_at_current_address'
[2024-11-11 11:14:30,508] INFO: data_preprocessing : 42] No missing values found in column 'city'
[2024-11-11 11:14:30,508] INFO: data_preprocessing : 42] No missing values found in column 'state'
[2024-11-11 11:14:30,508] INFO: data_preprocessing : 42] No missing values found in column 'zipcode'
[2024-11-11 11:14:30,515] INFO: data_preprocessing : 42] No missing values found in column 'loan_id'
[2024-11-11 11:14:30,520] INFO: data_preprocessing : 42] No missing values found in column 'loan_purpose'
[2024-11-11 11:14:30,520] INFO: data_preprocessing : 42] No missing values found in column 'loan_type'
[2024-11-11 11:14:30,520] INFO: data_preprocessing : 42] No missing values found in column 'sanction_amount'
[2024-11-11 11:14:30,520] INFO: data_preprocessing : 42] No missing values found in column 'loan_amount'
[2024-11-11 11:14:30,527] INFO: data_preprocessing : 42] No missing values found in column 'processing_fee'
[2024-11-11 11:14:30,527] INFO: data_preprocessing : 42] No missing values found in column 'gst'
[2024-11-11 11:14:30,527] INFO: data_preprocessing : 42] No missing values found in column 'net_disbursement'
[2024-11-11 11:14:30,527] INFO: data_preprocessing : 42] No missing values found in column 'loan_tenure_months'
[2024-11-11 11:14:30,527] INFO: data_preprocessing : 42] No missing values found in column 'principal_outstanding'
[2024-11-11 11:14:30,527] INFO: data_preprocessing : 42] No missing values found in column 'bank_balance_at_application'
[2024-11-11 11:14:30,527] INFO: data_preprocessing : 42] No missing values found in column 'disbursal_date'
[2024-11-11 11:14:30,537] INFO: data_preprocessing : 42] No missing values found in column 'installment_start_dt'
[2024-11-11 11:14:30,537] INFO: data_preprocessing : 42] No missing values found in column 'default'
[2024-11-11 11:14:30,537] INFO: data_preprocessing : 42] No missing values found in column 'number_of_open_accounts'
[2024-11-11 11:14:30,537] INFO: data_preprocessing : 42] No missing values found in column 'number_of_closed_accounts'
[2024-11-11 11:14:30,541] INFO: data_preprocessing : 42] No missing values found in column 'total_loan_months'
[2024-11-11 11:14:30,541] INFO: data_preprocessing : 42] No missing values found in column 'delinquent_months'
[2024-11-11 11:14:30,541] INFO: data_preprocessing : 42] No missing values found in column 'total_dpd'
[2024-11-11 11:14:30,543] INFO: data_preprocessing : 42] No missing values found in column 'enquiry_count'
[2024-11-11 11:14:30,543] INFO: data_preprocessing : 42] No missing values found in column 'credit_utilization_ratio'
[2024-11-11 11:14:30,617] INFO: data_preprocessing : 51] No duplicate rows found
[2024-11-11 11:14:30,617] INFO: data_preprocessing : 53] Index(['cust_id', 'age', 'gender', 'marital_status', 'employment_status',
       'income', 'number_of_dependants', 'residence_type',
       'years_at_current_address', 'city', 'state', 'zipcode', 'loan_id',
       'loan_purpose', 'loan_type', 'sanction_amount', 'loan_amount',
       'processing_fee', 'gst', 'net_disbursement', 'loan_tenure_months',
       'principal_outstanding', 'bank_balance_at_application',
       'disbursal_date', 'installment_start_dt', 'default',
       'number_of_open_accounts', 'number_of_closed_accounts',
       'total_loan_months', 'delinquent_months', 'total_dpd', 'enquiry_count',
       'credit_utilization_ratio'],
      dtype='object')
[2024-11-11 11:14:31,136] INFO: common : 98] Successfully saved DataFrame to: artifacts\data_preprocessing\preprocessed_data.csv
[2024-11-11 11:14:31,154] INFO: main : 26] >>>>>>>>>>>Completed Data Pre-Processing Stage<<<<<<<<<<<<<
[2024-11-11 11:14:31,155] INFO: main : 36] >>>>>>>>>>>Starting Data Cleaning Stage<<<<<<<<<<<<<
[2024-11-11 11:14:31,158] INFO: common : 33] Successfully loaded yaml file: config\config.yaml
[2024-11-11 11:14:31,160] INFO: common : 33] Successfully loaded yaml file: params.yaml
[2024-11-11 11:14:31,163] INFO: common : 33] Successfully loaded yaml file: schema.yaml
[2024-11-11 11:14:31,163] INFO: common : 56] Created directory: artifacts
[2024-11-11 11:14:31,163] INFO: common : 56] Created directory: artifacts/data_cleaning
[2024-11-11 11:14:31,369] INFO: common : 80] Successfully loaded DataFrame from: artifacts\data_preprocessing\preprocessed_data.csv
[2024-11-11 11:14:31,369] INFO: data_cleaning : 31] Initiating train test split...
[2024-11-11 11:14:31,391] INFO: data_cleaning : 33] Train test split completed successfully.
[2024-11-11 11:14:31,391] INFO: data_cleaning : 87] Applying business rules...
[2024-11-11 11:14:31,404] INFO: data_cleaning : 91] After applying Processing Fee rule, train_df: (39987, 33), test_df: (9998, 33)
[2024-11-11 11:14:31,404] INFO: data_cleaning : 95] GST Violations in train data: 0 records
[2024-11-11 11:14:31,404] INFO: data_cleaning : 99] Net Disbursement Violations in train data: 0 records
[2024-11-11 11:14:31,416] INFO: data_cleaning : 104] Fixed loan_purpose column: loan_purpose
Personal     14031
Home         12003
Auto          7947
Education     6006
Name: count, dtype: int64
[2024-11-11 11:14:31,419] INFO: data_cleaning : 109] Generated loan_to_income column
[2024-11-11 11:14:31,424] INFO: data_cleaning : 114] Generated delinquency_ratio column: count    39987.000000
mean        10.426146
std         17.285322
min          0.000000
25%          0.000000
50%          3.800000
75%         13.200000
max        100.000000
Name: delinquency_ratio, dtype: float64
[2024-11-11 11:14:31,433] INFO: data_cleaning : 127] Generated avg_dpd_per_delinquency column: count    39987.000000
mean         3.304136
std          2.902968
min          0.000000
25%          0.000000
50%          4.300000
75%          5.800000
max         10.000000
Name: avg_dpd_per_delinquency, dtype: float64
[2024-11-11 11:14:31,437] INFO: data_cleaning : 41] Removing unnecessary columns...
[2024-11-11 11:14:31,437] INFO: data_cleaning : 43] Columns removed successfully.
[2024-11-11 11:14:31,442] INFO: data_cleaning : 41] Removing unnecessary columns...
[2024-11-11 11:14:31,442] INFO: data_cleaning : 43] Columns removed successfully.
[2024-11-11 11:14:31,445] ERROR: data_cleaning : 70] Dtype mismatch in 'age': Expected int, got int64
[2024-11-11 11:14:31,448] INFO: data_cleaning : 74] Converted column 'age' to int.
[2024-11-11 11:14:31,448] ERROR: data_cleaning : 70] Dtype mismatch in 'loan_tenure_months': Expected int, got int64
[2024-11-11 11:14:31,449] INFO: data_cleaning : 74] Converted column 'loan_tenure_months' to int.
[2024-11-11 11:14:31,449] ERROR: data_cleaning : 70] Dtype mismatch in 'number_of_open_accounts': Expected int, got int64
[2024-11-11 11:14:31,449] INFO: data_cleaning : 74] Converted column 'number_of_open_accounts' to int.
[2024-11-11 11:14:31,449] ERROR: data_cleaning : 70] Dtype mismatch in 'credit_utilization_ratio': Expected int, got int64
[2024-11-11 11:14:31,449] INFO: data_cleaning : 74] Converted column 'credit_utilization_ratio' to int.
[2024-11-11 11:14:31,449] INFO: data_cleaning : 79] Schema validation successful: Columns and dtypes match.
[2024-11-11 11:14:31,452] ERROR: data_cleaning : 70] Dtype mismatch in 'age': Expected int, got int64
[2024-11-11 11:14:31,452] INFO: data_cleaning : 74] Converted column 'age' to int.
[2024-11-11 11:14:31,452] ERROR: data_cleaning : 70] Dtype mismatch in 'loan_tenure_months': Expected int, got int64
[2024-11-11 11:14:31,454] INFO: data_cleaning : 74] Converted column 'loan_tenure_months' to int.
[2024-11-11 11:14:31,455] ERROR: data_cleaning : 70] Dtype mismatch in 'number_of_open_accounts': Expected int, got int64
[2024-11-11 11:14:31,455] INFO: data_cleaning : 74] Converted column 'number_of_open_accounts' to int.
[2024-11-11 11:14:31,455] ERROR: data_cleaning : 70] Dtype mismatch in 'credit_utilization_ratio': Expected int, got int64
[2024-11-11 11:14:31,457] INFO: data_cleaning : 74] Converted column 'credit_utilization_ratio' to int.
[2024-11-11 11:14:31,457] INFO: data_cleaning : 79] Schema validation successful: Columns and dtypes match.
[2024-11-11 11:14:31,563] INFO: data_cleaning : 186] Data cleaning process completed successfully.
[2024-11-11 11:14:31,563] INFO: main : 38] >>>>>>>>>>>Completed Data Cleaning Stage<<<<<<<<<<<<<
[2024-11-11 12:25:50,644] INFO: __init__ : 26] Credit Risk Model Building Started
[2024-11-11 12:25:54,772] INFO: main : 12] >>>>>>>>>>>Starting Data Ingestion Stage<<<<<<<<<<<<<
[2024-11-11 12:25:54,795] INFO: common : 35] Successfully loaded yaml file: config\config.yaml
[2024-11-11 12:25:54,804] INFO: common : 35] Successfully loaded yaml file: params.yaml
[2024-11-11 12:25:54,817] INFO: common : 35] Successfully loaded yaml file: schema.yaml
[2024-11-11 12:25:54,817] INFO: common : 58] Created directory: artifacts
[2024-11-11 12:25:54,820] INFO: common : 58] Created directory: artifacts/data_ingestion
[2024-11-11 12:25:54,820] INFO: data_ingestion : 17] Loading customers data...
[2024-11-11 12:25:54,930] INFO: common : 103] Successfully loaded DataFrame from: data\customers.csv
[2024-11-11 12:25:54,930] INFO: data_ingestion : 20] Loading loans data...
[2024-11-11 12:25:55,086] INFO: common : 103] Successfully loaded DataFrame from: data\loans.csv
[2024-11-11 12:25:55,086] INFO: data_ingestion : 23] Loading bureau data...
[2024-11-11 12:25:55,139] INFO: common : 103] Successfully loaded DataFrame from: data\bureau_data.csv
[2024-11-11 12:25:55,145] INFO: data_ingestion : 26] The Shape of customers data: (50000, 12)
[2024-11-11 12:25:55,145] INFO: data_ingestion : 27] The Shape of loans data: (50000, 15)
[2024-11-11 12:25:55,146] INFO: data_ingestion : 28] The Shape of bureau data: (50000, 8)
[2024-11-11 12:25:55,740] INFO: common : 121] Successfully saved DataFrame to: artifacts\data_ingestion\data.csv
[2024-11-11 12:25:55,756] INFO: main : 14] >>>>>>>>>>>Completed Data Ingestion Stage<<<<<<<<<<<<<
[2024-11-11 12:25:55,756] INFO: main : 24] >>>>>>>>>>>Starting Data Pre-Processing Stage<<<<<<<<<<<<<
[2024-11-11 12:25:55,765] INFO: common : 35] Successfully loaded yaml file: config\config.yaml
[2024-11-11 12:25:55,769] INFO: common : 35] Successfully loaded yaml file: params.yaml
[2024-11-11 12:25:55,772] INFO: common : 35] Successfully loaded yaml file: schema.yaml
[2024-11-11 12:25:55,772] INFO: common : 58] Created directory: artifacts
[2024-11-11 12:25:55,773] INFO: common : 58] Created directory: artifacts/data_preprocessing
[2024-11-11 12:25:56,007] INFO: common : 103] Successfully loaded DataFrame from: artifacts\data_ingestion\data.csv
[2024-11-11 12:25:56,024] INFO: data_preprocessing : 26] The Valure counts for 'default' column: default
0    45703
1     4297
Name: count, dtype: int64
[2024-11-11 12:25:56,030] INFO: data_preprocessing : 42] No missing values found in column 'cust_id'
[2024-11-11 12:25:56,031] INFO: data_preprocessing : 42] No missing values found in column 'age'
[2024-11-11 12:25:56,035] INFO: data_preprocessing : 42] No missing values found in column 'gender'
[2024-11-11 12:25:56,037] INFO: data_preprocessing : 42] No missing values found in column 'marital_status'
[2024-11-11 12:25:56,040] INFO: data_preprocessing : 42] No missing values found in column 'employment_status'
[2024-11-11 12:25:56,041] INFO: data_preprocessing : 42] No missing values found in column 'income'
[2024-11-11 12:25:56,043] INFO: data_preprocessing : 42] No missing values found in column 'number_of_dependants'
[2024-11-11 12:25:56,046] WARNING: data_preprocessing : 33] Missing values found in column 'residence_type', replacing with 'Unknown'
[2024-11-11 12:25:56,065] INFO: data_preprocessing : 35] Missing values replaced in column 'residence_type' with mode 'Owned'
[2024-11-11 12:25:56,066] INFO: data_preprocessing : 42] No missing values found in column 'years_at_current_address'
[2024-11-11 12:25:56,070] INFO: data_preprocessing : 42] No missing values found in column 'city'
[2024-11-11 12:25:56,073] INFO: data_preprocessing : 42] No missing values found in column 'state'
[2024-11-11 12:25:56,075] INFO: data_preprocessing : 42] No missing values found in column 'zipcode'
[2024-11-11 12:25:56,080] INFO: data_preprocessing : 42] No missing values found in column 'loan_id'
[2024-11-11 12:25:56,084] INFO: data_preprocessing : 42] No missing values found in column 'loan_purpose'
[2024-11-11 12:25:56,088] INFO: data_preprocessing : 42] No missing values found in column 'loan_type'
[2024-11-11 12:25:56,088] INFO: data_preprocessing : 42] No missing values found in column 'sanction_amount'
[2024-11-11 12:25:56,088] INFO: data_preprocessing : 42] No missing values found in column 'loan_amount'
[2024-11-11 12:25:56,092] INFO: data_preprocessing : 42] No missing values found in column 'processing_fee'
[2024-11-11 12:25:56,093] INFO: data_preprocessing : 42] No missing values found in column 'gst'
[2024-11-11 12:25:56,094] INFO: data_preprocessing : 42] No missing values found in column 'net_disbursement'
[2024-11-11 12:25:56,095] INFO: data_preprocessing : 42] No missing values found in column 'loan_tenure_months'
[2024-11-11 12:25:56,096] INFO: data_preprocessing : 42] No missing values found in column 'principal_outstanding'
[2024-11-11 12:25:56,096] INFO: data_preprocessing : 42] No missing values found in column 'bank_balance_at_application'
[2024-11-11 12:25:56,100] INFO: data_preprocessing : 42] No missing values found in column 'disbursal_date'
[2024-11-11 12:25:56,105] INFO: data_preprocessing : 42] No missing values found in column 'installment_start_dt'
[2024-11-11 12:25:56,106] INFO: data_preprocessing : 42] No missing values found in column 'default'
[2024-11-11 12:25:56,106] INFO: data_preprocessing : 42] No missing values found in column 'number_of_open_accounts'
[2024-11-11 12:25:56,107] INFO: data_preprocessing : 42] No missing values found in column 'number_of_closed_accounts'
[2024-11-11 12:25:56,108] INFO: data_preprocessing : 42] No missing values found in column 'total_loan_months'
[2024-11-11 12:25:56,108] INFO: data_preprocessing : 42] No missing values found in column 'delinquent_months'
[2024-11-11 12:25:56,108] INFO: data_preprocessing : 42] No missing values found in column 'total_dpd'
[2024-11-11 12:25:56,108] INFO: data_preprocessing : 42] No missing values found in column 'enquiry_count'
[2024-11-11 12:25:56,112] INFO: data_preprocessing : 42] No missing values found in column 'credit_utilization_ratio'
[2024-11-11 12:25:56,197] INFO: data_preprocessing : 51] No duplicate rows found
[2024-11-11 12:25:56,197] INFO: data_preprocessing : 53] Index(['cust_id', 'age', 'gender', 'marital_status', 'employment_status',
       'income', 'number_of_dependants', 'residence_type',
       'years_at_current_address', 'city', 'state', 'zipcode', 'loan_id',
       'loan_purpose', 'loan_type', 'sanction_amount', 'loan_amount',
       'processing_fee', 'gst', 'net_disbursement', 'loan_tenure_months',
       'principal_outstanding', 'bank_balance_at_application',
       'disbursal_date', 'installment_start_dt', 'default',
       'number_of_open_accounts', 'number_of_closed_accounts',
       'total_loan_months', 'delinquent_months', 'total_dpd', 'enquiry_count',
       'credit_utilization_ratio'],
      dtype='object')
[2024-11-11 12:25:56,759] INFO: common : 121] Successfully saved DataFrame to: artifacts\data_preprocessing\preprocessed_data.csv
[2024-11-11 12:25:56,765] INFO: main : 26] >>>>>>>>>>>Completed Data Pre-Processing Stage<<<<<<<<<<<<<
[2024-11-11 12:25:56,765] INFO: main : 36] >>>>>>>>>>>Starting Data Cleaning Stage<<<<<<<<<<<<<
[2024-11-11 12:25:56,775] INFO: common : 35] Successfully loaded yaml file: config\config.yaml
[2024-11-11 12:25:56,776] INFO: common : 35] Successfully loaded yaml file: params.yaml
[2024-11-11 12:25:56,781] INFO: common : 35] Successfully loaded yaml file: schema.yaml
[2024-11-11 12:25:56,782] INFO: common : 58] Created directory: artifacts
[2024-11-11 12:25:56,783] INFO: common : 58] Created directory: artifacts/data_cleaning
[2024-11-11 12:25:57,030] INFO: common : 103] Successfully loaded DataFrame from: artifacts\data_preprocessing\preprocessed_data.csv
[2024-11-11 12:25:57,030] INFO: data_cleaning : 32] Initiating train test split...
[2024-11-11 12:25:57,054] INFO: data_cleaning : 34] Train test split completed successfully.
[2024-11-11 12:25:57,054] INFO: data_cleaning : 88] Applying business rules...
[2024-11-11 12:25:57,070] INFO: data_cleaning : 92] After applying Processing Fee rule, train_df: (39987, 33), test_df: (9998, 33)
[2024-11-11 12:25:57,072] INFO: data_cleaning : 96] GST Violations in train data: 0 records
[2024-11-11 12:25:57,073] INFO: data_cleaning : 100] Net Disbursement Violations in train data: 0 records
[2024-11-11 12:25:57,085] INFO: data_cleaning : 105] Fixed loan_purpose column: loan_purpose
Personal     14031
Home         12003
Auto          7947
Education     6006
Name: count, dtype: int64
[2024-11-11 12:25:57,089] INFO: data_cleaning : 110] Generated loan_to_income column
[2024-11-11 12:25:57,099] INFO: data_cleaning : 115] Generated delinquency_ratio column: count    39987.000000
mean        10.426146
std         17.285322
min          0.000000
25%          0.000000
50%          3.800000
75%         13.200000
max        100.000000
Name: delinquency_ratio, dtype: float64
[2024-11-11 12:25:57,103] INFO: data_cleaning : 128] Generated avg_dpd_per_delinquency column: count    39987.000000
mean         3.304136
std          2.902968
min          0.000000
25%          0.000000
50%          4.300000
75%          5.800000
max         10.000000
Name: avg_dpd_per_delinquency, dtype: float64
[2024-11-11 12:25:57,111] INFO: data_cleaning : 42] Removing unnecessary columns...
[2024-11-11 12:25:57,115] INFO: data_cleaning : 44] Columns removed successfully.
[2024-11-11 12:25:57,118] INFO: data_cleaning : 42] Removing unnecessary columns...
[2024-11-11 12:25:57,120] INFO: data_cleaning : 44] Columns removed successfully.
[2024-11-11 12:25:57,120] ERROR: data_cleaning : 71] Dtype mismatch in 'age': Expected int, got int64
[2024-11-11 12:25:57,120] INFO: data_cleaning : 75] Converted column 'age' to int.
[2024-11-11 12:25:57,120] ERROR: data_cleaning : 71] Dtype mismatch in 'loan_tenure_months': Expected int, got int64
[2024-11-11 12:25:57,120] INFO: data_cleaning : 75] Converted column 'loan_tenure_months' to int.
[2024-11-11 12:25:57,120] ERROR: data_cleaning : 71] Dtype mismatch in 'number_of_open_accounts': Expected int, got int64
[2024-11-11 12:25:57,120] INFO: data_cleaning : 75] Converted column 'number_of_open_accounts' to int.
[2024-11-11 12:25:57,127] ERROR: data_cleaning : 71] Dtype mismatch in 'credit_utilization_ratio': Expected int, got int64
[2024-11-11 12:25:57,129] INFO: data_cleaning : 75] Converted column 'credit_utilization_ratio' to int.
[2024-11-11 12:25:57,129] INFO: data_cleaning : 80] Schema validation successful: Columns and dtypes match.
[2024-11-11 12:25:57,129] ERROR: data_cleaning : 71] Dtype mismatch in 'age': Expected int, got int64
[2024-11-11 12:25:57,131] INFO: data_cleaning : 75] Converted column 'age' to int.
[2024-11-11 12:25:57,132] ERROR: data_cleaning : 71] Dtype mismatch in 'loan_tenure_months': Expected int, got int64
[2024-11-11 12:25:57,133] INFO: data_cleaning : 75] Converted column 'loan_tenure_months' to int.
[2024-11-11 12:25:57,134] ERROR: data_cleaning : 71] Dtype mismatch in 'number_of_open_accounts': Expected int, got int64
[2024-11-11 12:25:57,135] INFO: data_cleaning : 75] Converted column 'number_of_open_accounts' to int.
[2024-11-11 12:25:57,135] ERROR: data_cleaning : 71] Dtype mismatch in 'credit_utilization_ratio': Expected int, got int64
[2024-11-11 12:25:57,136] INFO: data_cleaning : 75] Converted column 'credit_utilization_ratio' to int.
[2024-11-11 12:25:57,136] INFO: data_cleaning : 80] Schema validation successful: Columns and dtypes match.
[2024-11-11 12:25:57,224] ERROR: data_cleaning : 191] Error occurred during data cleaning: 'DataCleaning' object has no attribute 'PREPROCESSOR'
[2024-11-11 12:25:57,225] ERROR: data_cleaning_pipeline : 22] Error occurred during data ingestion: Error occurred in python script name [C:\Users\ambig\jupiter_notebook\Projects\Credit-Risk-Model\src\Credit_Risk_Model\components\data_cleaning.py] line number [179] error message['DataCleaning' object has no attribute 'PREPROCESSOR']
[2024-11-11 12:25:57,230] INFO: main : 38] >>>>>>>>>>>Completed Data Cleaning Stage<<<<<<<<<<<<<
[2024-11-11 12:26:50,789] INFO: __init__ : 26] Credit Risk Model Building Started
[2024-11-11 12:26:56,268] INFO: main : 12] >>>>>>>>>>>Starting Data Ingestion Stage<<<<<<<<<<<<<
[2024-11-11 12:26:56,280] INFO: common : 35] Successfully loaded yaml file: config\config.yaml
[2024-11-11 12:26:56,285] INFO: common : 35] Successfully loaded yaml file: params.yaml
[2024-11-11 12:26:56,288] INFO: common : 35] Successfully loaded yaml file: schema.yaml
[2024-11-11 12:26:56,288] INFO: common : 58] Created directory: artifacts
[2024-11-11 12:26:56,288] INFO: common : 58] Created directory: artifacts/data_ingestion
[2024-11-11 12:26:56,288] INFO: data_ingestion : 17] Loading customers data...
[2024-11-11 12:26:56,386] INFO: common : 103] Successfully loaded DataFrame from: data\customers.csv
[2024-11-11 12:26:56,387] INFO: data_ingestion : 20] Loading loans data...
[2024-11-11 12:26:56,530] INFO: common : 103] Successfully loaded DataFrame from: data\loans.csv
[2024-11-11 12:26:56,531] INFO: data_ingestion : 23] Loading bureau data...
[2024-11-11 12:26:56,582] INFO: common : 103] Successfully loaded DataFrame from: data\bureau_data.csv
[2024-11-11 12:26:56,583] INFO: data_ingestion : 26] The Shape of customers data: (50000, 12)
[2024-11-11 12:26:56,583] INFO: data_ingestion : 27] The Shape of loans data: (50000, 15)
[2024-11-11 12:26:56,584] INFO: data_ingestion : 28] The Shape of bureau data: (50000, 8)
[2024-11-11 12:26:57,292] INFO: common : 121] Successfully saved DataFrame to: artifacts\data_ingestion\data.csv
[2024-11-11 12:26:57,301] INFO: main : 14] >>>>>>>>>>>Completed Data Ingestion Stage<<<<<<<<<<<<<
[2024-11-11 12:26:57,302] INFO: main : 24] >>>>>>>>>>>Starting Data Pre-Processing Stage<<<<<<<<<<<<<
[2024-11-11 12:26:57,307] INFO: common : 35] Successfully loaded yaml file: config\config.yaml
[2024-11-11 12:26:57,310] INFO: common : 35] Successfully loaded yaml file: params.yaml
[2024-11-11 12:26:57,314] INFO: common : 35] Successfully loaded yaml file: schema.yaml
[2024-11-11 12:26:57,314] INFO: common : 58] Created directory: artifacts
[2024-11-11 12:26:57,315] INFO: common : 58] Created directory: artifacts/data_preprocessing
[2024-11-11 12:26:57,581] INFO: common : 103] Successfully loaded DataFrame from: artifacts\data_ingestion\data.csv
[2024-11-11 12:26:57,585] INFO: data_preprocessing : 26] The Valure counts for 'default' column: default
0    45703
1     4297
Name: count, dtype: int64
[2024-11-11 12:26:57,585] INFO: data_preprocessing : 42] No missing values found in column 'cust_id'
[2024-11-11 12:26:57,585] INFO: data_preprocessing : 42] No missing values found in column 'age'
[2024-11-11 12:26:57,593] INFO: data_preprocessing : 42] No missing values found in column 'gender'
[2024-11-11 12:26:57,596] INFO: data_preprocessing : 42] No missing values found in column 'marital_status'
[2024-11-11 12:26:57,600] INFO: data_preprocessing : 42] No missing values found in column 'employment_status'
[2024-11-11 12:26:57,601] INFO: data_preprocessing : 42] No missing values found in column 'income'
[2024-11-11 12:26:57,602] INFO: data_preprocessing : 42] No missing values found in column 'number_of_dependants'
[2024-11-11 12:26:57,603] WARNING: data_preprocessing : 33] Missing values found in column 'residence_type', replacing with 'Unknown'
[2024-11-11 12:26:57,615] INFO: data_preprocessing : 35] Missing values replaced in column 'residence_type' with mode 'Owned'
[2024-11-11 12:26:57,615] INFO: data_preprocessing : 42] No missing values found in column 'years_at_current_address'
[2024-11-11 12:26:57,624] INFO: data_preprocessing : 42] No missing values found in column 'city'
[2024-11-11 12:26:57,627] INFO: data_preprocessing : 42] No missing values found in column 'state'
[2024-11-11 12:26:57,629] INFO: data_preprocessing : 42] No missing values found in column 'zipcode'
[2024-11-11 12:26:57,632] INFO: data_preprocessing : 42] No missing values found in column 'loan_id'
[2024-11-11 12:26:57,636] INFO: data_preprocessing : 42] No missing values found in column 'loan_purpose'
[2024-11-11 12:26:57,636] INFO: data_preprocessing : 42] No missing values found in column 'loan_type'
[2024-11-11 12:26:57,636] INFO: data_preprocessing : 42] No missing values found in column 'sanction_amount'
[2024-11-11 12:26:57,643] INFO: data_preprocessing : 42] No missing values found in column 'loan_amount'
[2024-11-11 12:26:57,644] INFO: data_preprocessing : 42] No missing values found in column 'processing_fee'
[2024-11-11 12:26:57,645] INFO: data_preprocessing : 42] No missing values found in column 'gst'
[2024-11-11 12:26:57,646] INFO: data_preprocessing : 42] No missing values found in column 'net_disbursement'
[2024-11-11 12:26:57,647] INFO: data_preprocessing : 42] No missing values found in column 'loan_tenure_months'
[2024-11-11 12:26:57,648] INFO: data_preprocessing : 42] No missing values found in column 'principal_outstanding'
[2024-11-11 12:26:57,649] INFO: data_preprocessing : 42] No missing values found in column 'bank_balance_at_application'
[2024-11-11 12:26:57,653] INFO: data_preprocessing : 42] No missing values found in column 'disbursal_date'
[2024-11-11 12:26:57,657] INFO: data_preprocessing : 42] No missing values found in column 'installment_start_dt'
[2024-11-11 12:26:57,657] INFO: data_preprocessing : 42] No missing values found in column 'default'
[2024-11-11 12:26:57,659] INFO: data_preprocessing : 42] No missing values found in column 'number_of_open_accounts'
[2024-11-11 12:26:57,660] INFO: data_preprocessing : 42] No missing values found in column 'number_of_closed_accounts'
[2024-11-11 12:26:57,660] INFO: data_preprocessing : 42] No missing values found in column 'total_loan_months'
[2024-11-11 12:26:57,661] INFO: data_preprocessing : 42] No missing values found in column 'delinquent_months'
[2024-11-11 12:26:57,662] INFO: data_preprocessing : 42] No missing values found in column 'total_dpd'
[2024-11-11 12:26:57,663] INFO: data_preprocessing : 42] No missing values found in column 'enquiry_count'
[2024-11-11 12:26:57,665] INFO: data_preprocessing : 42] No missing values found in column 'credit_utilization_ratio'
[2024-11-11 12:26:57,747] INFO: data_preprocessing : 51] No duplicate rows found
[2024-11-11 12:26:57,748] INFO: data_preprocessing : 53] Index(['cust_id', 'age', 'gender', 'marital_status', 'employment_status',
       'income', 'number_of_dependants', 'residence_type',
       'years_at_current_address', 'city', 'state', 'zipcode', 'loan_id',
       'loan_purpose', 'loan_type', 'sanction_amount', 'loan_amount',
       'processing_fee', 'gst', 'net_disbursement', 'loan_tenure_months',
       'principal_outstanding', 'bank_balance_at_application',
       'disbursal_date', 'installment_start_dt', 'default',
       'number_of_open_accounts', 'number_of_closed_accounts',
       'total_loan_months', 'delinquent_months', 'total_dpd', 'enquiry_count',
       'credit_utilization_ratio'],
      dtype='object')
[2024-11-11 12:26:58,354] INFO: common : 121] Successfully saved DataFrame to: artifacts\data_preprocessing\preprocessed_data.csv
[2024-11-11 12:26:58,358] INFO: main : 26] >>>>>>>>>>>Completed Data Pre-Processing Stage<<<<<<<<<<<<<
[2024-11-11 12:26:58,358] INFO: main : 36] >>>>>>>>>>>Starting Data Cleaning Stage<<<<<<<<<<<<<
[2024-11-11 12:26:58,363] INFO: common : 35] Successfully loaded yaml file: config\config.yaml
[2024-11-11 12:26:58,367] INFO: common : 35] Successfully loaded yaml file: params.yaml
[2024-11-11 12:26:58,370] INFO: common : 35] Successfully loaded yaml file: schema.yaml
[2024-11-11 12:26:58,371] INFO: common : 58] Created directory: artifacts
[2024-11-11 12:26:58,372] INFO: common : 58] Created directory: artifacts/data_cleaning
[2024-11-11 12:26:58,678] INFO: common : 103] Successfully loaded DataFrame from: artifacts\data_preprocessing\preprocessed_data.csv
[2024-11-11 12:26:58,678] INFO: data_cleaning : 32] Initiating train test split...
[2024-11-11 12:26:58,703] INFO: data_cleaning : 34] Train test split completed successfully.
[2024-11-11 12:26:58,703] INFO: data_cleaning : 88] Applying business rules...
[2024-11-11 12:26:58,719] INFO: data_cleaning : 92] After applying Processing Fee rule, train_df: (39987, 33), test_df: (9998, 33)
[2024-11-11 12:26:58,720] INFO: data_cleaning : 96] GST Violations in train data: 0 records
[2024-11-11 12:26:58,722] INFO: data_cleaning : 100] Net Disbursement Violations in train data: 0 records
[2024-11-11 12:26:58,735] INFO: data_cleaning : 105] Fixed loan_purpose column: loan_purpose
Personal     14031
Home         12003
Auto          7947
Education     6006
Name: count, dtype: int64
[2024-11-11 12:26:58,740] INFO: data_cleaning : 110] Generated loan_to_income column
[2024-11-11 12:26:58,749] INFO: data_cleaning : 115] Generated delinquency_ratio column: count    39987.000000
mean        10.426146
std         17.285322
min          0.000000
25%          0.000000
50%          3.800000
75%         13.200000
max        100.000000
Name: delinquency_ratio, dtype: float64
[2024-11-11 12:26:58,760] INFO: data_cleaning : 128] Generated avg_dpd_per_delinquency column: count    39987.000000
mean         3.304136
std          2.902968
min          0.000000
25%          0.000000
50%          4.300000
75%          5.800000
max         10.000000
Name: avg_dpd_per_delinquency, dtype: float64
[2024-11-11 12:26:58,764] INFO: data_cleaning : 42] Removing unnecessary columns...
[2024-11-11 12:26:58,768] INFO: data_cleaning : 44] Columns removed successfully.
[2024-11-11 12:26:58,772] INFO: data_cleaning : 42] Removing unnecessary columns...
[2024-11-11 12:26:58,774] INFO: data_cleaning : 44] Columns removed successfully.
[2024-11-11 12:26:58,775] ERROR: data_cleaning : 71] Dtype mismatch in 'age': Expected int, got int64
[2024-11-11 12:26:58,776] INFO: data_cleaning : 75] Converted column 'age' to int.
[2024-11-11 12:26:58,777] ERROR: data_cleaning : 71] Dtype mismatch in 'loan_tenure_months': Expected int, got int64
[2024-11-11 12:26:58,779] INFO: data_cleaning : 75] Converted column 'loan_tenure_months' to int.
[2024-11-11 12:26:58,780] ERROR: data_cleaning : 71] Dtype mismatch in 'number_of_open_accounts': Expected int, got int64
[2024-11-11 12:26:58,781] INFO: data_cleaning : 75] Converted column 'number_of_open_accounts' to int.
[2024-11-11 12:26:58,782] ERROR: data_cleaning : 71] Dtype mismatch in 'credit_utilization_ratio': Expected int, got int64
[2024-11-11 12:26:58,784] INFO: data_cleaning : 75] Converted column 'credit_utilization_ratio' to int.
[2024-11-11 12:26:58,785] INFO: data_cleaning : 80] Schema validation successful: Columns and dtypes match.
[2024-11-11 12:26:58,787] ERROR: data_cleaning : 71] Dtype mismatch in 'age': Expected int, got int64
[2024-11-11 12:26:58,788] INFO: data_cleaning : 75] Converted column 'age' to int.
[2024-11-11 12:26:58,788] ERROR: data_cleaning : 71] Dtype mismatch in 'loan_tenure_months': Expected int, got int64
[2024-11-11 12:26:58,790] INFO: data_cleaning : 75] Converted column 'loan_tenure_months' to int.
[2024-11-11 12:26:58,790] ERROR: data_cleaning : 71] Dtype mismatch in 'number_of_open_accounts': Expected int, got int64
[2024-11-11 12:26:58,792] INFO: data_cleaning : 75] Converted column 'number_of_open_accounts' to int.
[2024-11-11 12:26:58,792] ERROR: data_cleaning : 71] Dtype mismatch in 'credit_utilization_ratio': Expected int, got int64
[2024-11-11 12:26:58,793] INFO: data_cleaning : 75] Converted column 'credit_utilization_ratio' to int.
[2024-11-11 12:26:58,794] INFO: data_cleaning : 80] Schema validation successful: Columns and dtypes match.
[2024-11-11 12:26:58,913] INFO: data_cleaning : 188] Data cleaning process completed successfully.
[2024-11-11 12:26:58,920] INFO: main : 38] >>>>>>>>>>>Completed Data Cleaning Stage<<<<<<<<<<<<<
[2024-11-11 12:46:29,706] INFO: __init__ : 26] Credit Risk Model Building Started
[2024-11-11 12:46:48,152] INFO: _client : 1038] HTTP Request: GET https://dagshub.com/api/v1/user "HTTP/1.1 200 OK"
[2024-11-11 12:46:48,186] INFO: helpers : 107] Accessing as Ambigapathi-V
[2024-11-11 12:46:49,528] INFO: _client : 1038] HTTP Request: GET https://dagshub.com/api/v1/repos/Ambigapathi-V/credict-Risk-Model "HTTP/1.1 200 OK"
[2024-11-11 12:46:49,547] INFO: helpers : 107] Initialized MLflow to track repo "Ambigapathi-V/credict-Risk-Model"
[2024-11-11 12:46:49,549] INFO: helpers : 107] Repository Ambigapathi-V/credict-Risk-Model initialized!
[2024-11-11 12:46:49,550] INFO: main : 13] >>>>>>>>>>>Starting Data Ingestion Stage<<<<<<<<<<<<<
[2024-11-11 12:46:49,550] INFO: common : 35] Successfully loaded yaml file: config\config.yaml
[2024-11-11 12:46:49,550] INFO: common : 35] Successfully loaded yaml file: params.yaml
[2024-11-11 12:46:49,562] INFO: common : 35] Successfully loaded yaml file: schema.yaml
[2024-11-11 12:46:49,563] INFO: common : 58] Created directory: artifacts
[2024-11-11 12:46:49,564] INFO: common : 58] Created directory: artifacts/data_ingestion
[2024-11-11 12:46:49,565] INFO: data_ingestion : 17] Loading customers data...
[2024-11-11 12:46:49,665] INFO: common : 103] Successfully loaded DataFrame from: data\customers.csv
[2024-11-11 12:46:49,665] INFO: data_ingestion : 20] Loading loans data...
[2024-11-11 12:46:49,803] INFO: common : 103] Successfully loaded DataFrame from: data\loans.csv
[2024-11-11 12:46:49,803] INFO: data_ingestion : 23] Loading bureau data...
[2024-11-11 12:46:49,859] INFO: common : 103] Successfully loaded DataFrame from: data\bureau_data.csv
[2024-11-11 12:46:49,859] INFO: data_ingestion : 26] The Shape of customers data: (50000, 12)
[2024-11-11 12:46:49,859] INFO: data_ingestion : 27] The Shape of loans data: (50000, 15)
[2024-11-11 12:46:49,859] INFO: data_ingestion : 28] The Shape of bureau data: (50000, 8)
[2024-11-11 12:46:50,443] INFO: common : 121] Successfully saved DataFrame to: artifacts\data_ingestion\data.csv
[2024-11-11 12:46:50,451] INFO: main : 15] >>>>>>>>>>>Completed Data Ingestion Stage<<<<<<<<<<<<<
[2024-11-11 12:46:50,451] INFO: main : 25] >>>>>>>>>>>Starting Data Pre-Processing Stage<<<<<<<<<<<<<
[2024-11-11 12:46:50,462] INFO: common : 35] Successfully loaded yaml file: config\config.yaml
[2024-11-11 12:46:50,464] INFO: common : 35] Successfully loaded yaml file: params.yaml
[2024-11-11 12:46:50,467] INFO: common : 35] Successfully loaded yaml file: schema.yaml
[2024-11-11 12:46:50,468] INFO: common : 58] Created directory: artifacts
[2024-11-11 12:46:50,469] INFO: common : 58] Created directory: artifacts/data_preprocessing
[2024-11-11 12:46:50,738] INFO: common : 103] Successfully loaded DataFrame from: artifacts\data_ingestion\data.csv
[2024-11-11 12:46:50,738] INFO: data_preprocessing : 26] The Valure counts for 'default' column: default
0    45703
1     4297
Name: count, dtype: int64
[2024-11-11 12:46:50,738] INFO: data_preprocessing : 42] No missing values found in column 'cust_id'
[2024-11-11 12:46:50,738] INFO: data_preprocessing : 42] No missing values found in column 'age'
[2024-11-11 12:46:50,750] INFO: data_preprocessing : 42] No missing values found in column 'gender'
[2024-11-11 12:46:50,755] INFO: data_preprocessing : 42] No missing values found in column 'marital_status'
[2024-11-11 12:46:50,758] INFO: data_preprocessing : 42] No missing values found in column 'employment_status'
[2024-11-11 12:46:50,760] INFO: data_preprocessing : 42] No missing values found in column 'income'
[2024-11-11 12:46:50,760] INFO: data_preprocessing : 42] No missing values found in column 'number_of_dependants'
[2024-11-11 12:46:50,763] WARNING: data_preprocessing : 33] Missing values found in column 'residence_type', replacing with 'Unknown'
[2024-11-11 12:46:50,776] INFO: data_preprocessing : 35] Missing values replaced in column 'residence_type' with mode 'Owned'
[2024-11-11 12:46:50,777] INFO: data_preprocessing : 42] No missing values found in column 'years_at_current_address'
[2024-11-11 12:46:50,780] INFO: data_preprocessing : 42] No missing values found in column 'city'
[2024-11-11 12:46:50,784] INFO: data_preprocessing : 42] No missing values found in column 'state'
[2024-11-11 12:46:50,785] INFO: data_preprocessing : 42] No missing values found in column 'zipcode'
[2024-11-11 12:46:50,789] INFO: data_preprocessing : 42] No missing values found in column 'loan_id'
[2024-11-11 12:46:50,792] INFO: data_preprocessing : 42] No missing values found in column 'loan_purpose'
[2024-11-11 12:46:50,796] INFO: data_preprocessing : 42] No missing values found in column 'loan_type'
[2024-11-11 12:46:50,796] INFO: data_preprocessing : 42] No missing values found in column 'sanction_amount'
[2024-11-11 12:46:50,797] INFO: data_preprocessing : 42] No missing values found in column 'loan_amount'
[2024-11-11 12:46:50,798] INFO: data_preprocessing : 42] No missing values found in column 'processing_fee'
[2024-11-11 12:46:50,800] INFO: data_preprocessing : 42] No missing values found in column 'gst'
[2024-11-11 12:46:50,800] INFO: data_preprocessing : 42] No missing values found in column 'net_disbursement'
[2024-11-11 12:46:50,800] INFO: data_preprocessing : 42] No missing values found in column 'loan_tenure_months'
[2024-11-11 12:46:50,800] INFO: data_preprocessing : 42] No missing values found in column 'principal_outstanding'
[2024-11-11 12:46:50,804] INFO: data_preprocessing : 42] No missing values found in column 'bank_balance_at_application'
[2024-11-11 12:46:50,807] INFO: data_preprocessing : 42] No missing values found in column 'disbursal_date'
[2024-11-11 12:46:50,810] INFO: data_preprocessing : 42] No missing values found in column 'installment_start_dt'
[2024-11-11 12:46:50,811] INFO: data_preprocessing : 42] No missing values found in column 'default'
[2024-11-11 12:46:50,812] INFO: data_preprocessing : 42] No missing values found in column 'number_of_open_accounts'
[2024-11-11 12:46:50,812] INFO: data_preprocessing : 42] No missing values found in column 'number_of_closed_accounts'
[2024-11-11 12:46:50,813] INFO: data_preprocessing : 42] No missing values found in column 'total_loan_months'
[2024-11-11 12:46:50,814] INFO: data_preprocessing : 42] No missing values found in column 'delinquent_months'
[2024-11-11 12:46:50,815] INFO: data_preprocessing : 42] No missing values found in column 'total_dpd'
[2024-11-11 12:46:50,816] INFO: data_preprocessing : 42] No missing values found in column 'enquiry_count'
[2024-11-11 12:46:50,817] INFO: data_preprocessing : 42] No missing values found in column 'credit_utilization_ratio'
[2024-11-11 12:46:50,884] INFO: data_preprocessing : 51] No duplicate rows found
[2024-11-11 12:46:50,884] INFO: data_preprocessing : 53] Index(['cust_id', 'age', 'gender', 'marital_status', 'employment_status',
       'income', 'number_of_dependants', 'residence_type',
       'years_at_current_address', 'city', 'state', 'zipcode', 'loan_id',
       'loan_purpose', 'loan_type', 'sanction_amount', 'loan_amount',
       'processing_fee', 'gst', 'net_disbursement', 'loan_tenure_months',
       'principal_outstanding', 'bank_balance_at_application',
       'disbursal_date', 'installment_start_dt', 'default',
       'number_of_open_accounts', 'number_of_closed_accounts',
       'total_loan_months', 'delinquent_months', 'total_dpd', 'enquiry_count',
       'credit_utilization_ratio'],
      dtype='object')
[2024-11-11 12:46:51,406] INFO: common : 121] Successfully saved DataFrame to: artifacts\data_preprocessing\preprocessed_data.csv
[2024-11-11 12:46:51,417] INFO: main : 27] >>>>>>>>>>>Completed Data Pre-Processing Stage<<<<<<<<<<<<<
[2024-11-11 12:46:51,417] INFO: main : 37] >>>>>>>>>>>Starting Data Cleaning Stage<<<<<<<<<<<<<
[2024-11-11 12:46:51,423] INFO: common : 35] Successfully loaded yaml file: config\config.yaml
[2024-11-11 12:46:51,425] INFO: common : 35] Successfully loaded yaml file: params.yaml
[2024-11-11 12:46:51,428] INFO: common : 35] Successfully loaded yaml file: schema.yaml
[2024-11-11 12:46:51,428] INFO: common : 58] Created directory: artifacts
[2024-11-11 12:46:51,428] INFO: common : 58] Created directory: artifacts/data_cleaning
[2024-11-11 12:46:51,668] INFO: common : 103] Successfully loaded DataFrame from: artifacts\data_preprocessing\preprocessed_data.csv
[2024-11-11 12:46:51,668] INFO: data_cleaning : 32] Initiating train test split...
[2024-11-11 12:46:51,699] INFO: data_cleaning : 34] Train test split completed successfully.
[2024-11-11 12:46:51,700] INFO: data_cleaning : 88] Applying business rules...
[2024-11-11 12:46:51,712] INFO: data_cleaning : 92] After applying Processing Fee rule, train_df: (39987, 33), test_df: (9998, 33)
[2024-11-11 12:46:51,713] INFO: data_cleaning : 96] GST Violations in train data: 0 records
[2024-11-11 12:46:51,714] INFO: data_cleaning : 100] Net Disbursement Violations in train data: 0 records
[2024-11-11 12:46:51,719] INFO: data_cleaning : 105] Fixed loan_purpose column: loan_purpose
Personal     14031
Home         12003
Auto          7947
Education     6006
Name: count, dtype: int64
[2024-11-11 12:46:51,730] INFO: data_cleaning : 110] Generated loan_to_income column
[2024-11-11 12:46:51,738] INFO: data_cleaning : 115] Generated delinquency_ratio column: count    39987.000000
mean        10.426146
std         17.285322
min          0.000000
25%          0.000000
50%          3.800000
75%         13.200000
max        100.000000
Name: delinquency_ratio, dtype: float64
[2024-11-11 12:46:51,744] INFO: data_cleaning : 128] Generated avg_dpd_per_delinquency column: count    39987.000000
mean         3.304136
std          2.902968
min          0.000000
25%          0.000000
50%          4.300000
75%          5.800000
max         10.000000
Name: avg_dpd_per_delinquency, dtype: float64
[2024-11-11 12:46:51,752] INFO: data_cleaning : 42] Removing unnecessary columns...
[2024-11-11 12:46:51,756] INFO: data_cleaning : 44] Columns removed successfully.
[2024-11-11 12:46:51,758] INFO: data_cleaning : 42] Removing unnecessary columns...
[2024-11-11 12:46:51,759] INFO: data_cleaning : 44] Columns removed successfully.
[2024-11-11 12:46:51,762] ERROR: data_cleaning : 71] Dtype mismatch in 'age': Expected int, got int64
[2024-11-11 12:46:51,763] INFO: data_cleaning : 75] Converted column 'age' to int.
[2024-11-11 12:46:51,764] ERROR: data_cleaning : 71] Dtype mismatch in 'loan_tenure_months': Expected int, got int64
[2024-11-11 12:46:51,764] INFO: data_cleaning : 75] Converted column 'loan_tenure_months' to int.
[2024-11-11 12:46:51,765] ERROR: data_cleaning : 71] Dtype mismatch in 'number_of_open_accounts': Expected int, got int64
[2024-11-11 12:46:51,767] INFO: data_cleaning : 75] Converted column 'number_of_open_accounts' to int.
[2024-11-11 12:46:51,768] ERROR: data_cleaning : 71] Dtype mismatch in 'credit_utilization_ratio': Expected int, got int64
[2024-11-11 12:46:51,769] INFO: data_cleaning : 75] Converted column 'credit_utilization_ratio' to int.
[2024-11-11 12:46:51,770] INFO: data_cleaning : 80] Schema validation successful: Columns and dtypes match.
[2024-11-11 12:46:51,771] ERROR: data_cleaning : 71] Dtype mismatch in 'age': Expected int, got int64
[2024-11-11 12:46:51,772] INFO: data_cleaning : 75] Converted column 'age' to int.
[2024-11-11 12:46:51,772] ERROR: data_cleaning : 71] Dtype mismatch in 'loan_tenure_months': Expected int, got int64
[2024-11-11 12:46:51,773] INFO: data_cleaning : 75] Converted column 'loan_tenure_months' to int.
[2024-11-11 12:46:51,774] ERROR: data_cleaning : 71] Dtype mismatch in 'number_of_open_accounts': Expected int, got int64
[2024-11-11 12:46:51,775] INFO: data_cleaning : 75] Converted column 'number_of_open_accounts' to int.
[2024-11-11 12:46:51,775] ERROR: data_cleaning : 71] Dtype mismatch in 'credit_utilization_ratio': Expected int, got int64
[2024-11-11 12:46:51,776] INFO: data_cleaning : 75] Converted column 'credit_utilization_ratio' to int.
[2024-11-11 12:46:51,777] INFO: data_cleaning : 80] Schema validation successful: Columns and dtypes match.
[2024-11-11 12:46:51,872] INFO: data_cleaning : 188] Data cleaning process completed successfully.
[2024-11-11 12:46:51,877] INFO: main : 39] >>>>>>>>>>>Completed Data Cleaning Stage<<<<<<<<<<<<<
[2024-11-11 12:46:51,877] INFO: main : 49] >>>>>>>>>>>Starting Model Trainer Stage<<<<<<<<<<<<<
[2024-11-11 12:46:51,881] INFO: common : 35] Successfully loaded yaml file: config\config.yaml
[2024-11-11 12:46:51,884] INFO: common : 35] Successfully loaded yaml file: params.yaml
[2024-11-11 12:46:51,888] INFO: common : 35] Successfully loaded yaml file: schema.yaml
[2024-11-11 12:46:51,888] INFO: common : 58] Created directory: artifacts
[2024-11-11 12:46:51,890] ERROR: main : 54] An unexpected error occurred: "'ConfigBox' object has no attribute 'model_training'"
[2024-11-11 12:48:30,642] INFO: __init__ : 26] Credit Risk Model Building Started
[2024-11-11 12:48:38,514] INFO: _client : 1038] HTTP Request: GET https://dagshub.com/api/v1/user "HTTP/1.1 200 OK"
[2024-11-11 12:48:38,518] INFO: helpers : 107] Accessing as Ambigapathi-V
[2024-11-11 12:48:39,688] INFO: _client : 1038] HTTP Request: GET https://dagshub.com/api/v1/repos/Ambigapathi-V/credict-Risk-Model "HTTP/1.1 200 OK"
[2024-11-11 12:48:39,704] INFO: helpers : 107] Initialized MLflow to track repo "Ambigapathi-V/credict-Risk-Model"
[2024-11-11 12:48:39,706] INFO: helpers : 107] Repository Ambigapathi-V/credict-Risk-Model initialized!
[2024-11-11 12:48:39,707] INFO: main : 13] >>>>>>>>>>>Starting Data Ingestion Stage<<<<<<<<<<<<<
[2024-11-11 12:48:39,714] INFO: common : 35] Successfully loaded yaml file: config\config.yaml
[2024-11-11 12:48:39,719] INFO: common : 35] Successfully loaded yaml file: params.yaml
[2024-11-11 12:48:39,723] INFO: common : 35] Successfully loaded yaml file: schema.yaml
[2024-11-11 12:48:39,723] INFO: common : 58] Created directory: artifacts
[2024-11-11 12:48:39,723] INFO: common : 58] Created directory: artifacts/data_ingestion
[2024-11-11 12:48:39,723] INFO: data_ingestion : 17] Loading customers data...
[2024-11-11 12:48:39,937] INFO: common : 103] Successfully loaded DataFrame from: data\customers.csv
[2024-11-11 12:48:39,938] INFO: data_ingestion : 20] Loading loans data...
[2024-11-11 12:48:40,225] INFO: common : 103] Successfully loaded DataFrame from: data\loans.csv
[2024-11-11 12:48:40,225] INFO: data_ingestion : 23] Loading bureau data...
[2024-11-11 12:48:40,309] INFO: common : 103] Successfully loaded DataFrame from: data\bureau_data.csv
[2024-11-11 12:48:40,309] INFO: data_ingestion : 26] The Shape of customers data: (50000, 12)
[2024-11-11 12:48:40,309] INFO: data_ingestion : 27] The Shape of loans data: (50000, 15)
[2024-11-11 12:48:40,309] INFO: data_ingestion : 28] The Shape of bureau data: (50000, 8)
[2024-11-11 12:48:41,724] INFO: common : 121] Successfully saved DataFrame to: artifacts\data_ingestion\data.csv
[2024-11-11 12:48:41,736] INFO: main : 15] >>>>>>>>>>>Completed Data Ingestion Stage<<<<<<<<<<<<<
[2024-11-11 12:48:41,737] INFO: main : 25] >>>>>>>>>>>Starting Data Pre-Processing Stage<<<<<<<<<<<<<
[2024-11-11 12:48:41,745] INFO: common : 35] Successfully loaded yaml file: config\config.yaml
[2024-11-11 12:48:41,750] INFO: common : 35] Successfully loaded yaml file: params.yaml
[2024-11-11 12:48:41,757] INFO: common : 35] Successfully loaded yaml file: schema.yaml
[2024-11-11 12:48:41,758] INFO: common : 58] Created directory: artifacts
[2024-11-11 12:48:41,759] INFO: common : 58] Created directory: artifacts/data_preprocessing
[2024-11-11 12:48:42,141] INFO: common : 103] Successfully loaded DataFrame from: artifacts\data_ingestion\data.csv
[2024-11-11 12:48:42,145] INFO: data_preprocessing : 26] The Valure counts for 'default' column: default
0    45703
1     4297
Name: count, dtype: int64
[2024-11-11 12:48:42,151] INFO: data_preprocessing : 42] No missing values found in column 'cust_id'
[2024-11-11 12:48:42,154] INFO: data_preprocessing : 42] No missing values found in column 'age'
[2024-11-11 12:48:42,159] INFO: data_preprocessing : 42] No missing values found in column 'gender'
[2024-11-11 12:48:42,167] INFO: data_preprocessing : 42] No missing values found in column 'marital_status'
[2024-11-11 12:48:42,172] INFO: data_preprocessing : 42] No missing values found in column 'employment_status'
[2024-11-11 12:48:42,174] INFO: data_preprocessing : 42] No missing values found in column 'income'
[2024-11-11 12:48:42,176] INFO: data_preprocessing : 42] No missing values found in column 'number_of_dependants'
[2024-11-11 12:48:42,183] WARNING: data_preprocessing : 33] Missing values found in column 'residence_type', replacing with 'Unknown'
[2024-11-11 12:48:42,203] INFO: data_preprocessing : 35] Missing values replaced in column 'residence_type' with mode 'Owned'
[2024-11-11 12:48:42,205] INFO: data_preprocessing : 42] No missing values found in column 'years_at_current_address'
[2024-11-11 12:48:42,211] INFO: data_preprocessing : 42] No missing values found in column 'city'
[2024-11-11 12:48:42,218] INFO: data_preprocessing : 42] No missing values found in column 'state'
[2024-11-11 12:48:42,221] INFO: data_preprocessing : 42] No missing values found in column 'zipcode'
[2024-11-11 12:48:42,226] INFO: data_preprocessing : 42] No missing values found in column 'loan_id'
[2024-11-11 12:48:42,233] INFO: data_preprocessing : 42] No missing values found in column 'loan_purpose'
[2024-11-11 12:48:42,239] INFO: data_preprocessing : 42] No missing values found in column 'loan_type'
[2024-11-11 12:48:42,241] INFO: data_preprocessing : 42] No missing values found in column 'sanction_amount'
[2024-11-11 12:48:42,242] INFO: data_preprocessing : 42] No missing values found in column 'loan_amount'
[2024-11-11 12:48:42,243] INFO: data_preprocessing : 42] No missing values found in column 'processing_fee'
[2024-11-11 12:48:42,244] INFO: data_preprocessing : 42] No missing values found in column 'gst'
[2024-11-11 12:48:42,247] INFO: data_preprocessing : 42] No missing values found in column 'net_disbursement'
[2024-11-11 12:48:42,251] INFO: data_preprocessing : 42] No missing values found in column 'loan_tenure_months'
[2024-11-11 12:48:42,253] INFO: data_preprocessing : 42] No missing values found in column 'principal_outstanding'
[2024-11-11 12:48:42,254] INFO: data_preprocessing : 42] No missing values found in column 'bank_balance_at_application'
[2024-11-11 12:48:42,261] INFO: data_preprocessing : 42] No missing values found in column 'disbursal_date'
[2024-11-11 12:48:42,268] INFO: data_preprocessing : 42] No missing values found in column 'installment_start_dt'
[2024-11-11 12:48:42,269] INFO: data_preprocessing : 42] No missing values found in column 'default'
[2024-11-11 12:48:42,273] INFO: data_preprocessing : 42] No missing values found in column 'number_of_open_accounts'
[2024-11-11 12:48:42,274] INFO: data_preprocessing : 42] No missing values found in column 'number_of_closed_accounts'
[2024-11-11 12:48:42,276] INFO: data_preprocessing : 42] No missing values found in column 'total_loan_months'
[2024-11-11 12:48:42,277] INFO: data_preprocessing : 42] No missing values found in column 'delinquent_months'
[2024-11-11 12:48:42,278] INFO: data_preprocessing : 42] No missing values found in column 'total_dpd'
[2024-11-11 12:48:42,280] INFO: data_preprocessing : 42] No missing values found in column 'enquiry_count'
[2024-11-11 12:48:42,281] INFO: data_preprocessing : 42] No missing values found in column 'credit_utilization_ratio'
[2024-11-11 12:48:42,401] INFO: data_preprocessing : 51] No duplicate rows found
[2024-11-11 12:48:42,401] INFO: data_preprocessing : 53] Index(['cust_id', 'age', 'gender', 'marital_status', 'employment_status',
       'income', 'number_of_dependants', 'residence_type',
       'years_at_current_address', 'city', 'state', 'zipcode', 'loan_id',
       'loan_purpose', 'loan_type', 'sanction_amount', 'loan_amount',
       'processing_fee', 'gst', 'net_disbursement', 'loan_tenure_months',
       'principal_outstanding', 'bank_balance_at_application',
       'disbursal_date', 'installment_start_dt', 'default',
       'number_of_open_accounts', 'number_of_closed_accounts',
       'total_loan_months', 'delinquent_months', 'total_dpd', 'enquiry_count',
       'credit_utilization_ratio'],
      dtype='object')
[2024-11-11 12:48:43,280] INFO: common : 121] Successfully saved DataFrame to: artifacts\data_preprocessing\preprocessed_data.csv
[2024-11-11 12:48:43,285] INFO: main : 27] >>>>>>>>>>>Completed Data Pre-Processing Stage<<<<<<<<<<<<<
[2024-11-11 12:48:43,286] INFO: main : 37] >>>>>>>>>>>Starting Data Cleaning Stage<<<<<<<<<<<<<
[2024-11-11 12:48:43,299] INFO: common : 35] Successfully loaded yaml file: config\config.yaml
[2024-11-11 12:48:43,304] INFO: common : 35] Successfully loaded yaml file: params.yaml
[2024-11-11 12:48:43,310] INFO: common : 35] Successfully loaded yaml file: schema.yaml
[2024-11-11 12:48:43,312] INFO: common : 58] Created directory: artifacts
[2024-11-11 12:48:43,314] INFO: common : 58] Created directory: artifacts/data_cleaning
[2024-11-11 12:48:43,788] INFO: common : 103] Successfully loaded DataFrame from: artifacts\data_preprocessing\preprocessed_data.csv
[2024-11-11 12:48:43,788] INFO: data_cleaning : 32] Initiating train test split...
[2024-11-11 12:48:43,831] INFO: data_cleaning : 34] Train test split completed successfully.
[2024-11-11 12:48:43,837] INFO: data_cleaning : 88] Applying business rules...
[2024-11-11 12:48:43,856] INFO: data_cleaning : 92] After applying Processing Fee rule, train_df: (39987, 33), test_df: (9998, 33)
[2024-11-11 12:48:43,856] INFO: data_cleaning : 96] GST Violations in train data: 0 records
[2024-11-11 12:48:43,869] INFO: data_cleaning : 100] Net Disbursement Violations in train data: 0 records
[2024-11-11 12:48:43,888] INFO: data_cleaning : 105] Fixed loan_purpose column: loan_purpose
Personal     14031
Home         12003
Auto          7947
Education     6006
Name: count, dtype: int64
[2024-11-11 12:48:43,891] INFO: data_cleaning : 110] Generated loan_to_income column
[2024-11-11 12:48:43,900] INFO: data_cleaning : 115] Generated delinquency_ratio column: count    39987.000000
mean        10.426146
std         17.285322
min          0.000000
25%          0.000000
50%          3.800000
75%         13.200000
max        100.000000
Name: delinquency_ratio, dtype: float64
[2024-11-11 12:48:43,920] INFO: data_cleaning : 128] Generated avg_dpd_per_delinquency column: count    39987.000000
mean         3.304136
std          2.902968
min          0.000000
25%          0.000000
50%          4.300000
75%          5.800000
max         10.000000
Name: avg_dpd_per_delinquency, dtype: float64
[2024-11-11 12:48:43,926] INFO: data_cleaning : 42] Removing unnecessary columns...
[2024-11-11 12:48:43,933] INFO: data_cleaning : 44] Columns removed successfully.
[2024-11-11 12:48:43,938] INFO: data_cleaning : 42] Removing unnecessary columns...
[2024-11-11 12:48:43,941] INFO: data_cleaning : 44] Columns removed successfully.
[2024-11-11 12:48:43,944] ERROR: data_cleaning : 71] Dtype mismatch in 'age': Expected int, got int64
[2024-11-11 12:48:43,946] INFO: data_cleaning : 75] Converted column 'age' to int.
[2024-11-11 12:48:43,947] ERROR: data_cleaning : 71] Dtype mismatch in 'loan_tenure_months': Expected int, got int64
[2024-11-11 12:48:43,949] INFO: data_cleaning : 75] Converted column 'loan_tenure_months' to int.
[2024-11-11 12:48:43,950] ERROR: data_cleaning : 71] Dtype mismatch in 'number_of_open_accounts': Expected int, got int64
[2024-11-11 12:48:43,952] INFO: data_cleaning : 75] Converted column 'number_of_open_accounts' to int.
[2024-11-11 12:48:43,952] ERROR: data_cleaning : 71] Dtype mismatch in 'credit_utilization_ratio': Expected int, got int64
[2024-11-11 12:48:43,954] INFO: data_cleaning : 75] Converted column 'credit_utilization_ratio' to int.
[2024-11-11 12:48:43,955] INFO: data_cleaning : 80] Schema validation successful: Columns and dtypes match.
[2024-11-11 12:48:43,957] ERROR: data_cleaning : 71] Dtype mismatch in 'age': Expected int, got int64
[2024-11-11 12:48:43,959] INFO: data_cleaning : 75] Converted column 'age' to int.
[2024-11-11 12:48:43,960] ERROR: data_cleaning : 71] Dtype mismatch in 'loan_tenure_months': Expected int, got int64
[2024-11-11 12:48:43,962] INFO: data_cleaning : 75] Converted column 'loan_tenure_months' to int.
[2024-11-11 12:48:43,963] ERROR: data_cleaning : 71] Dtype mismatch in 'number_of_open_accounts': Expected int, got int64
[2024-11-11 12:48:43,965] INFO: data_cleaning : 75] Converted column 'number_of_open_accounts' to int.
[2024-11-11 12:48:43,966] ERROR: data_cleaning : 71] Dtype mismatch in 'credit_utilization_ratio': Expected int, got int64
[2024-11-11 12:48:43,967] INFO: data_cleaning : 75] Converted column 'credit_utilization_ratio' to int.
[2024-11-11 12:48:43,968] INFO: data_cleaning : 80] Schema validation successful: Columns and dtypes match.
[2024-11-11 12:48:44,165] INFO: data_cleaning : 188] Data cleaning process completed successfully.
[2024-11-11 12:48:44,175] INFO: main : 39] >>>>>>>>>>>Completed Data Cleaning Stage<<<<<<<<<<<<<
[2024-11-11 12:48:44,175] INFO: main : 49] >>>>>>>>>>>Starting Model Trainer Stage<<<<<<<<<<<<<
[2024-11-11 12:48:44,183] INFO: common : 35] Successfully loaded yaml file: config\config.yaml
[2024-11-11 12:48:44,185] INFO: common : 35] Successfully loaded yaml file: params.yaml
[2024-11-11 12:48:44,192] INFO: common : 35] Successfully loaded yaml file: schema.yaml
[2024-11-11 12:48:44,192] INFO: common : 58] Created directory: artifacts
[2024-11-11 12:48:44,192] ERROR: main : 54] An unexpected error occurred: "'ConfigBox' object has no attribute 'model_training'"
[2024-11-11 12:50:36,696] INFO: __init__ : 26] Credit Risk Model Building Started
[2024-11-11 12:50:43,071] INFO: _client : 1038] HTTP Request: GET https://dagshub.com/api/v1/user "HTTP/1.1 200 OK"
[2024-11-11 12:50:43,071] INFO: helpers : 107] Accessing as Ambigapathi-V
[2024-11-11 12:50:43,870] INFO: _client : 1038] HTTP Request: GET https://dagshub.com/api/v1/repos/Ambigapathi-V/credict-Risk-Model "HTTP/1.1 200 OK"
[2024-11-11 12:50:43,873] INFO: helpers : 107] Initialized MLflow to track repo "Ambigapathi-V/credict-Risk-Model"
[2024-11-11 12:50:43,875] INFO: helpers : 107] Repository Ambigapathi-V/credict-Risk-Model initialized!
[2024-11-11 12:50:43,875] INFO: main : 13] >>>>>>>>>>>Starting Data Ingestion Stage<<<<<<<<<<<<<
[2024-11-11 12:50:43,879] INFO: common : 35] Successfully loaded yaml file: config\config.yaml
[2024-11-11 12:50:43,881] INFO: common : 35] Successfully loaded yaml file: params.yaml
[2024-11-11 12:50:43,885] INFO: common : 35] Successfully loaded yaml file: schema.yaml
[2024-11-11 12:50:43,885] INFO: common : 58] Created directory: artifacts
[2024-11-11 12:50:43,885] INFO: common : 58] Created directory: artifacts/data_ingestion
[2024-11-11 12:50:43,885] INFO: data_ingestion : 17] Loading customers data...
[2024-11-11 12:50:43,978] INFO: common : 103] Successfully loaded DataFrame from: data\customers.csv
[2024-11-11 12:50:43,979] INFO: data_ingestion : 20] Loading loans data...
[2024-11-11 12:50:44,094] INFO: common : 103] Successfully loaded DataFrame from: data\loans.csv
[2024-11-11 12:50:44,094] INFO: data_ingestion : 23] Loading bureau data...
[2024-11-11 12:50:44,134] INFO: common : 103] Successfully loaded DataFrame from: data\bureau_data.csv
[2024-11-11 12:50:44,134] INFO: data_ingestion : 26] The Shape of customers data: (50000, 12)
[2024-11-11 12:50:44,136] INFO: data_ingestion : 27] The Shape of loans data: (50000, 15)
[2024-11-11 12:50:44,136] INFO: data_ingestion : 28] The Shape of bureau data: (50000, 8)
[2024-11-11 12:50:44,639] INFO: common : 121] Successfully saved DataFrame to: artifacts\data_ingestion\data.csv
[2024-11-11 12:50:44,657] INFO: main : 15] >>>>>>>>>>>Completed Data Ingestion Stage<<<<<<<<<<<<<
[2024-11-11 12:50:44,657] INFO: main : 25] >>>>>>>>>>>Starting Data Pre-Processing Stage<<<<<<<<<<<<<
[2024-11-11 12:50:44,662] INFO: common : 35] Successfully loaded yaml file: config\config.yaml
[2024-11-11 12:50:44,665] INFO: common : 35] Successfully loaded yaml file: params.yaml
[2024-11-11 12:50:44,667] INFO: common : 35] Successfully loaded yaml file: schema.yaml
[2024-11-11 12:50:44,669] INFO: common : 58] Created directory: artifacts
[2024-11-11 12:50:44,670] INFO: common : 58] Created directory: artifacts/data_preprocessing
[2024-11-11 12:50:44,865] INFO: common : 103] Successfully loaded DataFrame from: artifacts\data_ingestion\data.csv
[2024-11-11 12:50:44,865] INFO: data_preprocessing : 26] The Valure counts for 'default' column: default
0    45703
1     4297
Name: count, dtype: int64
[2024-11-11 12:50:44,880] INFO: data_preprocessing : 42] No missing values found in column 'cust_id'
[2024-11-11 12:50:44,880] INFO: data_preprocessing : 42] No missing values found in column 'age'
[2024-11-11 12:50:44,887] INFO: data_preprocessing : 42] No missing values found in column 'gender'
[2024-11-11 12:50:44,890] INFO: data_preprocessing : 42] No missing values found in column 'marital_status'
[2024-11-11 12:50:44,893] INFO: data_preprocessing : 42] No missing values found in column 'employment_status'
[2024-11-11 12:50:44,894] INFO: data_preprocessing : 42] No missing values found in column 'income'
[2024-11-11 12:50:44,895] INFO: data_preprocessing : 42] No missing values found in column 'number_of_dependants'
[2024-11-11 12:50:44,897] WARNING: data_preprocessing : 33] Missing values found in column 'residence_type', replacing with 'Unknown'
[2024-11-11 12:50:44,906] INFO: data_preprocessing : 35] Missing values replaced in column 'residence_type' with mode 'Owned'
[2024-11-11 12:50:44,906] INFO: data_preprocessing : 42] No missing values found in column 'years_at_current_address'
[2024-11-11 12:50:44,913] INFO: data_preprocessing : 42] No missing values found in column 'city'
[2024-11-11 12:50:44,916] INFO: data_preprocessing : 42] No missing values found in column 'state'
[2024-11-11 12:50:44,917] INFO: data_preprocessing : 42] No missing values found in column 'zipcode'
[2024-11-11 12:50:44,920] INFO: data_preprocessing : 42] No missing values found in column 'loan_id'
[2024-11-11 12:50:44,923] INFO: data_preprocessing : 42] No missing values found in column 'loan_purpose'
[2024-11-11 12:50:44,926] INFO: data_preprocessing : 42] No missing values found in column 'loan_type'
[2024-11-11 12:50:44,927] INFO: data_preprocessing : 42] No missing values found in column 'sanction_amount'
[2024-11-11 12:50:44,927] INFO: data_preprocessing : 42] No missing values found in column 'loan_amount'
[2024-11-11 12:50:44,928] INFO: data_preprocessing : 42] No missing values found in column 'processing_fee'
[2024-11-11 12:50:44,929] INFO: data_preprocessing : 42] No missing values found in column 'gst'
[2024-11-11 12:50:44,929] INFO: data_preprocessing : 42] No missing values found in column 'net_disbursement'
[2024-11-11 12:50:44,930] INFO: data_preprocessing : 42] No missing values found in column 'loan_tenure_months'
[2024-11-11 12:50:44,930] INFO: data_preprocessing : 42] No missing values found in column 'principal_outstanding'
[2024-11-11 12:50:44,930] INFO: data_preprocessing : 42] No missing values found in column 'bank_balance_at_application'
[2024-11-11 12:50:44,935] INFO: data_preprocessing : 42] No missing values found in column 'disbursal_date'
[2024-11-11 12:50:44,938] INFO: data_preprocessing : 42] No missing values found in column 'installment_start_dt'
[2024-11-11 12:50:44,939] INFO: data_preprocessing : 42] No missing values found in column 'default'
[2024-11-11 12:50:44,939] INFO: data_preprocessing : 42] No missing values found in column 'number_of_open_accounts'
[2024-11-11 12:50:44,941] INFO: data_preprocessing : 42] No missing values found in column 'number_of_closed_accounts'
[2024-11-11 12:50:44,942] INFO: data_preprocessing : 42] No missing values found in column 'total_loan_months'
[2024-11-11 12:50:44,942] INFO: data_preprocessing : 42] No missing values found in column 'delinquent_months'
[2024-11-11 12:50:44,943] INFO: data_preprocessing : 42] No missing values found in column 'total_dpd'
[2024-11-11 12:50:44,944] INFO: data_preprocessing : 42] No missing values found in column 'enquiry_count'
[2024-11-11 12:50:44,944] INFO: data_preprocessing : 42] No missing values found in column 'credit_utilization_ratio'
[2024-11-11 12:50:45,005] INFO: data_preprocessing : 51] No duplicate rows found
[2024-11-11 12:50:45,005] INFO: data_preprocessing : 53] Index(['cust_id', 'age', 'gender', 'marital_status', 'employment_status',
       'income', 'number_of_dependants', 'residence_type',
       'years_at_current_address', 'city', 'state', 'zipcode', 'loan_id',
       'loan_purpose', 'loan_type', 'sanction_amount', 'loan_amount',
       'processing_fee', 'gst', 'net_disbursement', 'loan_tenure_months',
       'principal_outstanding', 'bank_balance_at_application',
       'disbursal_date', 'installment_start_dt', 'default',
       'number_of_open_accounts', 'number_of_closed_accounts',
       'total_loan_months', 'delinquent_months', 'total_dpd', 'enquiry_count',
       'credit_utilization_ratio'],
      dtype='object')
[2024-11-11 12:50:45,483] INFO: common : 121] Successfully saved DataFrame to: artifacts\data_preprocessing\preprocessed_data.csv
[2024-11-11 12:50:45,487] INFO: main : 27] >>>>>>>>>>>Completed Data Pre-Processing Stage<<<<<<<<<<<<<
[2024-11-11 12:50:45,487] INFO: main : 37] >>>>>>>>>>>Starting Data Cleaning Stage<<<<<<<<<<<<<
[2024-11-11 12:50:45,487] INFO: common : 35] Successfully loaded yaml file: config\config.yaml
[2024-11-11 12:50:45,494] INFO: common : 35] Successfully loaded yaml file: params.yaml
[2024-11-11 12:50:45,497] INFO: common : 35] Successfully loaded yaml file: schema.yaml
[2024-11-11 12:50:45,498] INFO: common : 58] Created directory: artifacts
[2024-11-11 12:50:45,498] INFO: common : 58] Created directory: artifacts/data_cleaning
[2024-11-11 12:50:45,728] INFO: common : 103] Successfully loaded DataFrame from: artifacts\data_preprocessing\preprocessed_data.csv
[2024-11-11 12:50:45,728] INFO: data_cleaning : 32] Initiating train test split...
[2024-11-11 12:50:45,753] INFO: data_cleaning : 34] Train test split completed successfully.
[2024-11-11 12:50:45,753] INFO: data_cleaning : 88] Applying business rules...
[2024-11-11 12:50:45,773] INFO: data_cleaning : 92] After applying Processing Fee rule, train_df: (39987, 33), test_df: (9998, 33)
[2024-11-11 12:50:45,775] INFO: data_cleaning : 96] GST Violations in train data: 0 records
[2024-11-11 12:50:45,775] INFO: data_cleaning : 100] Net Disbursement Violations in train data: 0 records
[2024-11-11 12:50:45,787] INFO: data_cleaning : 105] Fixed loan_purpose column: loan_purpose
Personal     14031
Home         12003
Auto          7947
Education     6006
Name: count, dtype: int64
[2024-11-11 12:50:45,790] INFO: data_cleaning : 110] Generated loan_to_income column
[2024-11-11 12:50:45,797] INFO: data_cleaning : 115] Generated delinquency_ratio column: count    39987.000000
mean        10.426146
std         17.285322
min          0.000000
25%          0.000000
50%          3.800000
75%         13.200000
max        100.000000
Name: delinquency_ratio, dtype: float64
[2024-11-11 12:50:45,804] INFO: data_cleaning : 128] Generated avg_dpd_per_delinquency column: count    39987.000000
mean         3.304136
std          2.902968
min          0.000000
25%          0.000000
50%          4.300000
75%          5.800000
max         10.000000
Name: avg_dpd_per_delinquency, dtype: float64
[2024-11-11 12:50:45,809] INFO: data_cleaning : 42] Removing unnecessary columns...
[2024-11-11 12:50:45,812] INFO: data_cleaning : 44] Columns removed successfully.
[2024-11-11 12:50:45,815] INFO: data_cleaning : 42] Removing unnecessary columns...
[2024-11-11 12:50:45,817] INFO: data_cleaning : 44] Columns removed successfully.
[2024-11-11 12:50:45,819] ERROR: data_cleaning : 71] Dtype mismatch in 'age': Expected int, got int64
[2024-11-11 12:50:45,820] INFO: data_cleaning : 75] Converted column 'age' to int.
[2024-11-11 12:50:45,820] ERROR: data_cleaning : 71] Dtype mismatch in 'loan_tenure_months': Expected int, got int64
[2024-11-11 12:50:45,822] INFO: data_cleaning : 75] Converted column 'loan_tenure_months' to int.
[2024-11-11 12:50:45,822] ERROR: data_cleaning : 71] Dtype mismatch in 'number_of_open_accounts': Expected int, got int64
[2024-11-11 12:50:45,823] INFO: data_cleaning : 75] Converted column 'number_of_open_accounts' to int.
[2024-11-11 12:50:45,824] ERROR: data_cleaning : 71] Dtype mismatch in 'credit_utilization_ratio': Expected int, got int64
[2024-11-11 12:50:45,825] INFO: data_cleaning : 75] Converted column 'credit_utilization_ratio' to int.
[2024-11-11 12:50:45,825] INFO: data_cleaning : 80] Schema validation successful: Columns and dtypes match.
[2024-11-11 12:50:45,826] ERROR: data_cleaning : 71] Dtype mismatch in 'age': Expected int, got int64
[2024-11-11 12:50:45,826] INFO: data_cleaning : 75] Converted column 'age' to int.
[2024-11-11 12:50:45,826] ERROR: data_cleaning : 71] Dtype mismatch in 'loan_tenure_months': Expected int, got int64
[2024-11-11 12:50:45,826] INFO: data_cleaning : 75] Converted column 'loan_tenure_months' to int.
[2024-11-11 12:50:45,826] ERROR: data_cleaning : 71] Dtype mismatch in 'number_of_open_accounts': Expected int, got int64
[2024-11-11 12:50:45,826] INFO: data_cleaning : 75] Converted column 'number_of_open_accounts' to int.
[2024-11-11 12:50:45,826] ERROR: data_cleaning : 71] Dtype mismatch in 'credit_utilization_ratio': Expected int, got int64
[2024-11-11 12:50:45,826] INFO: data_cleaning : 75] Converted column 'credit_utilization_ratio' to int.
[2024-11-11 12:50:45,826] INFO: data_cleaning : 80] Schema validation successful: Columns and dtypes match.
[2024-11-11 12:50:45,923] INFO: data_cleaning : 188] Data cleaning process completed successfully.
[2024-11-11 12:50:45,925] INFO: main : 39] >>>>>>>>>>>Completed Data Cleaning Stage<<<<<<<<<<<<<
[2024-11-11 12:50:45,930] INFO: main : 49] >>>>>>>>>>>Starting Model Trainer Stage<<<<<<<<<<<<<
[2024-11-11 12:50:45,936] INFO: common : 35] Successfully loaded yaml file: config\config.yaml
[2024-11-11 12:50:45,939] INFO: common : 35] Successfully loaded yaml file: params.yaml
[2024-11-11 12:50:45,943] INFO: common : 35] Successfully loaded yaml file: schema.yaml
[2024-11-11 12:50:45,944] INFO: common : 58] Created directory: artifacts
[2024-11-11 12:50:45,944] INFO: common : 58] Created directory: artifacts/model_training
[2024-11-11 12:50:45,946] INFO: common : 155] Loading numpy array from artifacts\data_cleaning\train_data.arr
[2024-11-11 12:50:45,958] INFO: common : 155] Loading numpy array from artifacts\data_cleaning\test_data.arr
[2024-11-11 13:14:32,772] ERROR: model_trainer : 112] Error in model trainer: 'ClassificationMetricArtifact' object has no attribute 'precision'
[2024-11-11 13:14:32,772] ERROR: model_trainer_pipeline : 22] Error Occurred: Error occurred in python script name [C:\Users\ambig\jupiter_notebook\Projects\Credit-Risk-Model\src\Credit_Risk_Model\components\model_trainer.py] line number [109] error message['ClassificationMetricArtifact' object has no attribute 'precision']
[2024-11-11 13:14:32,772] ERROR: main : 54] An unexpected error occurred: Error occurred in python script name [C:\Users\ambig\jupiter_notebook\Projects\Credit-Risk-Model\src\Credit_Risk_Model\pipeline\model_trainer_pipeline.py] line number [19] error message[Error occurred in python script name [C:\Users\ambig\jupiter_notebook\Projects\Credit-Risk-Model\src\Credit_Risk_Model\components\model_trainer.py] line number [109] error message['ClassificationMetricArtifact' object has no attribute 'precision']]
[2024-11-11 13:18:02,012] INFO: __init__ : 26] Credit Risk Model Building Started
[2024-11-11 13:18:10,460] INFO: _client : 1038] HTTP Request: GET https://dagshub.com/api/v1/user "HTTP/1.1 200 OK"
[2024-11-11 13:18:10,476] INFO: helpers : 107] Accessing as Ambigapathi-V
[2024-11-11 13:18:11,287] INFO: _client : 1038] HTTP Request: GET https://dagshub.com/api/v1/repos/Ambigapathi-V/credict-Risk-Model "HTTP/1.1 200 OK"
[2024-11-11 13:18:11,287] INFO: helpers : 107] Initialized MLflow to track repo "Ambigapathi-V/credict-Risk-Model"
[2024-11-11 13:18:11,287] INFO: helpers : 107] Repository Ambigapathi-V/credict-Risk-Model initialized!
[2024-11-11 13:18:11,287] INFO: main : 13] >>>>>>>>>>>Starting Data Ingestion Stage<<<<<<<<<<<<<
[2024-11-11 13:18:11,308] INFO: common : 35] Successfully loaded yaml file: config\config.yaml
[2024-11-11 13:18:11,308] INFO: common : 35] Successfully loaded yaml file: params.yaml
[2024-11-11 13:18:11,317] INFO: common : 35] Successfully loaded yaml file: schema.yaml
[2024-11-11 13:18:11,318] INFO: common : 58] Created directory: artifacts
[2024-11-11 13:18:11,319] INFO: common : 58] Created directory: artifacts/data_ingestion
[2024-11-11 13:18:11,320] INFO: data_ingestion : 17] Loading customers data...
[2024-11-11 13:18:11,430] INFO: common : 103] Successfully loaded DataFrame from: data\customers.csv
[2024-11-11 13:18:11,430] INFO: data_ingestion : 20] Loading loans data...
[2024-11-11 13:18:11,575] INFO: common : 103] Successfully loaded DataFrame from: data\loans.csv
[2024-11-11 13:18:11,575] INFO: data_ingestion : 23] Loading bureau data...
[2024-11-11 13:18:11,623] INFO: common : 103] Successfully loaded DataFrame from: data\bureau_data.csv
[2024-11-11 13:18:11,623] INFO: data_ingestion : 26] The Shape of customers data: (50000, 12)
[2024-11-11 13:18:11,623] INFO: data_ingestion : 27] The Shape of loans data: (50000, 15)
[2024-11-11 13:18:11,623] INFO: data_ingestion : 28] The Shape of bureau data: (50000, 8)
[2024-11-11 13:18:12,353] INFO: common : 121] Successfully saved DataFrame to: artifacts\data_ingestion\data.csv
[2024-11-11 13:18:12,363] INFO: main : 15] >>>>>>>>>>>Completed Data Ingestion Stage<<<<<<<<<<<<<
[2024-11-11 13:18:12,364] INFO: main : 25] >>>>>>>>>>>Starting Data Pre-Processing Stage<<<<<<<<<<<<<
[2024-11-11 13:18:12,369] INFO: common : 35] Successfully loaded yaml file: config\config.yaml
[2024-11-11 13:18:12,372] INFO: common : 35] Successfully loaded yaml file: params.yaml
[2024-11-11 13:18:12,376] INFO: common : 35] Successfully loaded yaml file: schema.yaml
[2024-11-11 13:18:12,377] INFO: common : 58] Created directory: artifacts
[2024-11-11 13:18:12,377] INFO: common : 58] Created directory: artifacts/data_preprocessing
[2024-11-11 13:18:12,679] INFO: common : 103] Successfully loaded DataFrame from: artifacts\data_ingestion\data.csv
[2024-11-11 13:18:12,684] INFO: data_preprocessing : 26] The Valure counts for 'default' column: default
0    45703
1     4297
Name: count, dtype: int64
[2024-11-11 13:18:12,688] INFO: data_preprocessing : 42] No missing values found in column 'cust_id'
[2024-11-11 13:18:12,690] INFO: data_preprocessing : 42] No missing values found in column 'age'
[2024-11-11 13:18:12,693] INFO: data_preprocessing : 42] No missing values found in column 'gender'
[2024-11-11 13:18:12,698] INFO: data_preprocessing : 42] No missing values found in column 'marital_status'
[2024-11-11 13:18:12,702] INFO: data_preprocessing : 42] No missing values found in column 'employment_status'
[2024-11-11 13:18:12,703] INFO: data_preprocessing : 42] No missing values found in column 'income'
[2024-11-11 13:18:12,704] INFO: data_preprocessing : 42] No missing values found in column 'number_of_dependants'
[2024-11-11 13:18:12,708] WARNING: data_preprocessing : 33] Missing values found in column 'residence_type', replacing with 'Unknown'
[2024-11-11 13:18:12,723] INFO: data_preprocessing : 35] Missing values replaced in column 'residence_type' with mode 'Owned'
[2024-11-11 13:18:12,724] INFO: data_preprocessing : 42] No missing values found in column 'years_at_current_address'
[2024-11-11 13:18:12,728] INFO: data_preprocessing : 42] No missing values found in column 'city'
[2024-11-11 13:18:12,732] INFO: data_preprocessing : 42] No missing values found in column 'state'
[2024-11-11 13:18:12,733] INFO: data_preprocessing : 42] No missing values found in column 'zipcode'
[2024-11-11 13:18:12,738] INFO: data_preprocessing : 42] No missing values found in column 'loan_id'
[2024-11-11 13:18:12,743] INFO: data_preprocessing : 42] No missing values found in column 'loan_purpose'
[2024-11-11 13:18:12,749] INFO: data_preprocessing : 42] No missing values found in column 'loan_type'
[2024-11-11 13:18:12,750] INFO: data_preprocessing : 42] No missing values found in column 'sanction_amount'
[2024-11-11 13:18:12,751] INFO: data_preprocessing : 42] No missing values found in column 'loan_amount'
[2024-11-11 13:18:12,752] INFO: data_preprocessing : 42] No missing values found in column 'processing_fee'
[2024-11-11 13:18:12,754] INFO: data_preprocessing : 42] No missing values found in column 'gst'
[2024-11-11 13:18:12,755] INFO: data_preprocessing : 42] No missing values found in column 'net_disbursement'
[2024-11-11 13:18:12,756] INFO: data_preprocessing : 42] No missing values found in column 'loan_tenure_months'
[2024-11-11 13:18:12,757] INFO: data_preprocessing : 42] No missing values found in column 'principal_outstanding'
[2024-11-11 13:18:12,758] INFO: data_preprocessing : 42] No missing values found in column 'bank_balance_at_application'
[2024-11-11 13:18:12,762] INFO: data_preprocessing : 42] No missing values found in column 'disbursal_date'
[2024-11-11 13:18:12,767] INFO: data_preprocessing : 42] No missing values found in column 'installment_start_dt'
[2024-11-11 13:18:12,768] INFO: data_preprocessing : 42] No missing values found in column 'default'
[2024-11-11 13:18:12,769] INFO: data_preprocessing : 42] No missing values found in column 'number_of_open_accounts'
[2024-11-11 13:18:12,771] INFO: data_preprocessing : 42] No missing values found in column 'number_of_closed_accounts'
[2024-11-11 13:18:12,772] INFO: data_preprocessing : 42] No missing values found in column 'total_loan_months'
[2024-11-11 13:18:12,773] INFO: data_preprocessing : 42] No missing values found in column 'delinquent_months'
[2024-11-11 13:18:12,774] INFO: data_preprocessing : 42] No missing values found in column 'total_dpd'
[2024-11-11 13:18:12,776] INFO: data_preprocessing : 42] No missing values found in column 'enquiry_count'
[2024-11-11 13:18:12,777] INFO: data_preprocessing : 42] No missing values found in column 'credit_utilization_ratio'
[2024-11-11 13:18:12,870] INFO: data_preprocessing : 51] No duplicate rows found
[2024-11-11 13:18:12,871] INFO: data_preprocessing : 53] Index(['cust_id', 'age', 'gender', 'marital_status', 'employment_status',
       'income', 'number_of_dependants', 'residence_type',
       'years_at_current_address', 'city', 'state', 'zipcode', 'loan_id',
       'loan_purpose', 'loan_type', 'sanction_amount', 'loan_amount',
       'processing_fee', 'gst', 'net_disbursement', 'loan_tenure_months',
       'principal_outstanding', 'bank_balance_at_application',
       'disbursal_date', 'installment_start_dt', 'default',
       'number_of_open_accounts', 'number_of_closed_accounts',
       'total_loan_months', 'delinquent_months', 'total_dpd', 'enquiry_count',
       'credit_utilization_ratio'],
      dtype='object')
[2024-11-11 13:18:13,539] INFO: common : 121] Successfully saved DataFrame to: artifacts\data_preprocessing\preprocessed_data.csv
[2024-11-11 13:18:13,539] INFO: main : 27] >>>>>>>>>>>Completed Data Pre-Processing Stage<<<<<<<<<<<<<
[2024-11-11 13:18:13,539] INFO: main : 37] >>>>>>>>>>>Starting Data Cleaning Stage<<<<<<<<<<<<<
[2024-11-11 13:18:13,551] INFO: common : 35] Successfully loaded yaml file: config\config.yaml
[2024-11-11 13:18:13,553] INFO: common : 35] Successfully loaded yaml file: params.yaml
[2024-11-11 13:18:13,559] INFO: common : 35] Successfully loaded yaml file: schema.yaml
[2024-11-11 13:18:13,561] INFO: common : 58] Created directory: artifacts
[2024-11-11 13:18:13,562] INFO: common : 58] Created directory: artifacts/data_cleaning
[2024-11-11 13:18:13,863] INFO: common : 103] Successfully loaded DataFrame from: artifacts\data_preprocessing\preprocessed_data.csv
[2024-11-11 13:18:13,864] INFO: data_cleaning : 32] Initiating train test split...
[2024-11-11 13:18:13,887] INFO: data_cleaning : 34] Train test split completed successfully.
[2024-11-11 13:18:13,888] INFO: data_cleaning : 88] Applying business rules...
[2024-11-11 13:18:13,895] INFO: data_cleaning : 92] After applying Processing Fee rule, train_df: (39987, 33), test_df: (9998, 33)
[2024-11-11 13:18:13,906] INFO: data_cleaning : 96] GST Violations in train data: 0 records
[2024-11-11 13:18:13,907] INFO: data_cleaning : 100] Net Disbursement Violations in train data: 0 records
[2024-11-11 13:18:13,921] INFO: data_cleaning : 105] Fixed loan_purpose column: loan_purpose
Personal     14031
Home         12003
Auto          7947
Education     6006
Name: count, dtype: int64
[2024-11-11 13:18:13,927] INFO: data_cleaning : 110] Generated loan_to_income column
[2024-11-11 13:18:13,937] INFO: data_cleaning : 115] Generated delinquency_ratio column: count    39987.000000
mean        10.426146
std         17.285322
min          0.000000
25%          0.000000
50%          3.800000
75%         13.200000
max        100.000000
Name: delinquency_ratio, dtype: float64
[2024-11-11 13:18:13,946] INFO: data_cleaning : 128] Generated avg_dpd_per_delinquency column: count    39987.000000
mean         3.304136
std          2.902968
min          0.000000
25%          0.000000
50%          4.300000
75%          5.800000
max         10.000000
Name: avg_dpd_per_delinquency, dtype: float64
[2024-11-11 13:18:13,955] INFO: data_cleaning : 42] Removing unnecessary columns...
[2024-11-11 13:18:13,960] INFO: data_cleaning : 44] Columns removed successfully.
[2024-11-11 13:18:13,963] INFO: data_cleaning : 42] Removing unnecessary columns...
[2024-11-11 13:18:13,965] INFO: data_cleaning : 44] Columns removed successfully.
[2024-11-11 13:18:13,968] ERROR: data_cleaning : 71] Dtype mismatch in 'age': Expected int, got int64
[2024-11-11 13:18:13,970] INFO: data_cleaning : 75] Converted column 'age' to int.
[2024-11-11 13:18:13,970] ERROR: data_cleaning : 71] Dtype mismatch in 'loan_tenure_months': Expected int, got int64
[2024-11-11 13:18:13,972] INFO: data_cleaning : 75] Converted column 'loan_tenure_months' to int.
[2024-11-11 13:18:13,973] ERROR: data_cleaning : 71] Dtype mismatch in 'number_of_open_accounts': Expected int, got int64
[2024-11-11 13:18:13,975] INFO: data_cleaning : 75] Converted column 'number_of_open_accounts' to int.
[2024-11-11 13:18:13,975] ERROR: data_cleaning : 71] Dtype mismatch in 'credit_utilization_ratio': Expected int, got int64
[2024-11-11 13:18:13,977] INFO: data_cleaning : 75] Converted column 'credit_utilization_ratio' to int.
[2024-11-11 13:18:13,977] INFO: data_cleaning : 80] Schema validation successful: Columns and dtypes match.
[2024-11-11 13:18:13,978] ERROR: data_cleaning : 71] Dtype mismatch in 'age': Expected int, got int64
[2024-11-11 13:18:13,979] INFO: data_cleaning : 75] Converted column 'age' to int.
[2024-11-11 13:18:13,980] ERROR: data_cleaning : 71] Dtype mismatch in 'loan_tenure_months': Expected int, got int64
[2024-11-11 13:18:13,981] INFO: data_cleaning : 75] Converted column 'loan_tenure_months' to int.
[2024-11-11 13:18:13,981] ERROR: data_cleaning : 71] Dtype mismatch in 'number_of_open_accounts': Expected int, got int64
[2024-11-11 13:18:13,983] INFO: data_cleaning : 75] Converted column 'number_of_open_accounts' to int.
[2024-11-11 13:18:13,983] ERROR: data_cleaning : 71] Dtype mismatch in 'credit_utilization_ratio': Expected int, got int64
[2024-11-11 13:18:13,984] INFO: data_cleaning : 75] Converted column 'credit_utilization_ratio' to int.
[2024-11-11 13:18:13,985] INFO: data_cleaning : 80] Schema validation successful: Columns and dtypes match.
[2024-11-11 13:18:14,092] INFO: data_cleaning : 188] Data cleaning process completed successfully.
[2024-11-11 13:18:14,099] INFO: main : 39] >>>>>>>>>>>Completed Data Cleaning Stage<<<<<<<<<<<<<
[2024-11-11 13:18:14,100] INFO: main : 49] >>>>>>>>>>>Starting Model Trainer Stage<<<<<<<<<<<<<
[2024-11-11 13:18:14,104] INFO: common : 35] Successfully loaded yaml file: config\config.yaml
[2024-11-11 13:18:14,106] INFO: common : 35] Successfully loaded yaml file: params.yaml
[2024-11-11 13:18:14,106] INFO: common : 35] Successfully loaded yaml file: schema.yaml
[2024-11-11 13:18:14,106] INFO: common : 58] Created directory: artifacts
[2024-11-11 13:18:14,106] INFO: common : 58] Created directory: artifacts/model_training
[2024-11-11 13:18:14,114] INFO: common : 155] Loading numpy array from artifacts\data_cleaning\train_data.arr
[2024-11-11 13:18:14,127] INFO: common : 155] Loading numpy array from artifacts\data_cleaning\test_data.arr
[2024-11-11 13:47:04,596] ERROR: model_trainer : 112] Error in model trainer: 'ClassificationMetricArtifact' object has no attribute 'recall'
[2024-11-11 13:47:04,596] ERROR: model_trainer_pipeline : 22] Error Occurred: Error occurred in python script name [C:\Users\ambig\jupiter_notebook\Projects\Credit-Risk-Model\src\Credit_Risk_Model\components\model_trainer.py] line number [109] error message['ClassificationMetricArtifact' object has no attribute 'recall']
[2024-11-11 13:47:04,596] ERROR: main : 54] An unexpected error occurred: Error occurred in python script name [C:\Users\ambig\jupiter_notebook\Projects\Credit-Risk-Model\src\Credit_Risk_Model\pipeline\model_trainer_pipeline.py] line number [19] error message[Error occurred in python script name [C:\Users\ambig\jupiter_notebook\Projects\Credit-Risk-Model\src\Credit_Risk_Model\components\model_trainer.py] line number [109] error message['ClassificationMetricArtifact' object has no attribute 'recall']]
[2024-11-11 13:52:21,292] INFO: __init__ : 26] Credit Risk Model Building Started
[2024-11-11 13:52:29,466] INFO: _client : 1038] HTTP Request: GET https://dagshub.com/api/v1/user "HTTP/1.1 200 OK"
[2024-11-11 13:52:29,466] INFO: helpers : 107] Accessing as Ambigapathi-V
[2024-11-11 13:52:30,254] INFO: _client : 1038] HTTP Request: GET https://dagshub.com/api/v1/repos/Ambigapathi-V/credict-Risk-Model "HTTP/1.1 200 OK"
[2024-11-11 13:52:30,254] INFO: helpers : 107] Initialized MLflow to track repo "Ambigapathi-V/credict-Risk-Model"
[2024-11-11 13:52:30,254] INFO: helpers : 107] Repository Ambigapathi-V/credict-Risk-Model initialized!
[2024-11-11 13:52:30,268] INFO: main : 13] >>>>>>>>>>>Starting Data Ingestion Stage<<<<<<<<<<<<<
[2024-11-11 13:52:30,274] INFO: common : 35] Successfully loaded yaml file: config\config.yaml
[2024-11-11 13:52:30,277] INFO: common : 35] Successfully loaded yaml file: params.yaml
[2024-11-11 13:52:30,278] INFO: common : 35] Successfully loaded yaml file: schema.yaml
[2024-11-11 13:52:30,278] INFO: common : 58] Created directory: artifacts
[2024-11-11 13:52:30,282] INFO: common : 58] Created directory: artifacts/data_ingestion
[2024-11-11 13:52:30,282] INFO: data_ingestion : 17] Loading customers data...
[2024-11-11 13:52:30,357] INFO: common : 103] Successfully loaded DataFrame from: data\customers.csv
[2024-11-11 13:52:30,357] INFO: data_ingestion : 20] Loading loans data...
[2024-11-11 13:52:30,472] INFO: common : 103] Successfully loaded DataFrame from: data\loans.csv
[2024-11-11 13:52:30,473] INFO: data_ingestion : 23] Loading bureau data...
[2024-11-11 13:52:30,515] INFO: common : 103] Successfully loaded DataFrame from: data\bureau_data.csv
[2024-11-11 13:52:30,515] INFO: data_ingestion : 26] The Shape of customers data: (50000, 12)
[2024-11-11 13:52:30,515] INFO: data_ingestion : 27] The Shape of loans data: (50000, 15)
[2024-11-11 13:52:30,515] INFO: data_ingestion : 28] The Shape of bureau data: (50000, 8)
[2024-11-11 13:52:31,094] INFO: common : 121] Successfully saved DataFrame to: artifacts\data_ingestion\data.csv
[2024-11-11 13:52:31,094] INFO: main : 15] >>>>>>>>>>>Completed Data Ingestion Stage<<<<<<<<<<<<<
[2024-11-11 13:52:31,109] INFO: main : 25] >>>>>>>>>>>Starting Data Pre-Processing Stage<<<<<<<<<<<<<
[2024-11-11 13:52:31,114] INFO: common : 35] Successfully loaded yaml file: config\config.yaml
[2024-11-11 13:52:31,129] INFO: common : 35] Successfully loaded yaml file: params.yaml
[2024-11-11 13:52:31,129] INFO: common : 35] Successfully loaded yaml file: schema.yaml
[2024-11-11 13:52:31,129] INFO: common : 58] Created directory: artifacts
[2024-11-11 13:52:31,129] INFO: common : 58] Created directory: artifacts/data_preprocessing
[2024-11-11 13:52:31,408] INFO: common : 103] Successfully loaded DataFrame from: artifacts\data_ingestion\data.csv
[2024-11-11 13:52:31,408] INFO: data_preprocessing : 26] The Valure counts for 'default' column: default
0    45703
1     4297
Name: count, dtype: int64
[2024-11-11 13:52:31,408] INFO: data_preprocessing : 42] No missing values found in column 'cust_id'
[2024-11-11 13:52:31,408] INFO: data_preprocessing : 42] No missing values found in column 'age'
[2024-11-11 13:52:31,423] INFO: data_preprocessing : 42] No missing values found in column 'gender'
[2024-11-11 13:52:31,428] INFO: data_preprocessing : 42] No missing values found in column 'marital_status'
[2024-11-11 13:52:31,429] INFO: data_preprocessing : 42] No missing values found in column 'employment_status'
[2024-11-11 13:52:31,429] INFO: data_preprocessing : 42] No missing values found in column 'income'
[2024-11-11 13:52:31,429] INFO: data_preprocessing : 42] No missing values found in column 'number_of_dependants'
[2024-11-11 13:52:31,437] WARNING: data_preprocessing : 33] Missing values found in column 'residence_type', replacing with 'Unknown'
[2024-11-11 13:52:31,450] INFO: data_preprocessing : 35] Missing values replaced in column 'residence_type' with mode 'Owned'
[2024-11-11 13:52:31,450] INFO: data_preprocessing : 42] No missing values found in column 'years_at_current_address'
[2024-11-11 13:52:31,455] INFO: data_preprocessing : 42] No missing values found in column 'city'
[2024-11-11 13:52:31,460] INFO: data_preprocessing : 42] No missing values found in column 'state'
[2024-11-11 13:52:31,461] INFO: data_preprocessing : 42] No missing values found in column 'zipcode'
[2024-11-11 13:52:31,464] INFO: data_preprocessing : 42] No missing values found in column 'loan_id'
[2024-11-11 13:52:31,468] INFO: data_preprocessing : 42] No missing values found in column 'loan_purpose'
[2024-11-11 13:52:31,472] INFO: data_preprocessing : 42] No missing values found in column 'loan_type'
[2024-11-11 13:52:31,472] INFO: data_preprocessing : 42] No missing values found in column 'sanction_amount'
[2024-11-11 13:52:31,472] INFO: data_preprocessing : 42] No missing values found in column 'loan_amount'
[2024-11-11 13:52:31,472] INFO: data_preprocessing : 42] No missing values found in column 'processing_fee'
[2024-11-11 13:52:31,472] INFO: data_preprocessing : 42] No missing values found in column 'gst'
[2024-11-11 13:52:31,475] INFO: data_preprocessing : 42] No missing values found in column 'net_disbursement'
[2024-11-11 13:52:31,476] INFO: data_preprocessing : 42] No missing values found in column 'loan_tenure_months'
[2024-11-11 13:52:31,477] INFO: data_preprocessing : 42] No missing values found in column 'principal_outstanding'
[2024-11-11 13:52:31,478] INFO: data_preprocessing : 42] No missing values found in column 'bank_balance_at_application'
[2024-11-11 13:52:31,481] INFO: data_preprocessing : 42] No missing values found in column 'disbursal_date'
[2024-11-11 13:52:31,481] INFO: data_preprocessing : 42] No missing values found in column 'installment_start_dt'
[2024-11-11 13:52:31,481] INFO: data_preprocessing : 42] No missing values found in column 'default'
[2024-11-11 13:52:31,481] INFO: data_preprocessing : 42] No missing values found in column 'number_of_open_accounts'
[2024-11-11 13:52:31,481] INFO: data_preprocessing : 42] No missing values found in column 'number_of_closed_accounts'
[2024-11-11 13:52:31,488] INFO: data_preprocessing : 42] No missing values found in column 'total_loan_months'
[2024-11-11 13:52:31,489] INFO: data_preprocessing : 42] No missing values found in column 'delinquent_months'
[2024-11-11 13:52:31,489] INFO: data_preprocessing : 42] No missing values found in column 'total_dpd'
[2024-11-11 13:52:31,490] INFO: data_preprocessing : 42] No missing values found in column 'enquiry_count'
[2024-11-11 13:52:31,491] INFO: data_preprocessing : 42] No missing values found in column 'credit_utilization_ratio'
[2024-11-11 13:52:31,565] INFO: data_preprocessing : 51] No duplicate rows found
[2024-11-11 13:52:31,566] INFO: data_preprocessing : 53] Index(['cust_id', 'age', 'gender', 'marital_status', 'employment_status',
       'income', 'number_of_dependants', 'residence_type',
       'years_at_current_address', 'city', 'state', 'zipcode', 'loan_id',
       'loan_purpose', 'loan_type', 'sanction_amount', 'loan_amount',
       'processing_fee', 'gst', 'net_disbursement', 'loan_tenure_months',
       'principal_outstanding', 'bank_balance_at_application',
       'disbursal_date', 'installment_start_dt', 'default',
       'number_of_open_accounts', 'number_of_closed_accounts',
       'total_loan_months', 'delinquent_months', 'total_dpd', 'enquiry_count',
       'credit_utilization_ratio'],
      dtype='object')
[2024-11-11 13:52:32,102] INFO: common : 121] Successfully saved DataFrame to: artifacts\data_preprocessing\preprocessed_data.csv
[2024-11-11 13:52:32,102] INFO: main : 27] >>>>>>>>>>>Completed Data Pre-Processing Stage<<<<<<<<<<<<<
[2024-11-11 13:52:32,115] INFO: main : 37] >>>>>>>>>>>Starting Data Cleaning Stage<<<<<<<<<<<<<
[2024-11-11 13:52:32,119] INFO: common : 35] Successfully loaded yaml file: config\config.yaml
[2024-11-11 13:52:32,122] INFO: common : 35] Successfully loaded yaml file: params.yaml
[2024-11-11 13:52:32,122] INFO: common : 35] Successfully loaded yaml file: schema.yaml
[2024-11-11 13:52:32,122] INFO: common : 58] Created directory: artifacts
[2024-11-11 13:52:32,126] INFO: common : 58] Created directory: artifacts/data_cleaning
[2024-11-11 13:52:32,371] INFO: common : 103] Successfully loaded DataFrame from: artifacts\data_preprocessing\preprocessed_data.csv
[2024-11-11 13:52:32,371] INFO: data_cleaning : 32] Initiating train test split...
[2024-11-11 13:52:32,404] INFO: data_cleaning : 34] Train test split completed successfully.
[2024-11-11 13:52:32,404] INFO: data_cleaning : 88] Applying business rules...
[2024-11-11 13:52:32,414] INFO: data_cleaning : 92] After applying Processing Fee rule, train_df: (39987, 33), test_df: (9998, 33)
[2024-11-11 13:52:32,422] INFO: data_cleaning : 96] GST Violations in train data: 0 records
[2024-11-11 13:52:32,424] INFO: data_cleaning : 100] Net Disbursement Violations in train data: 0 records
[2024-11-11 13:52:32,429] INFO: data_cleaning : 105] Fixed loan_purpose column: loan_purpose
Personal     14031
Home         12003
Auto          7947
Education     6006
Name: count, dtype: int64
[2024-11-11 13:52:32,439] INFO: data_cleaning : 110] Generated loan_to_income column
[2024-11-11 13:52:32,447] INFO: data_cleaning : 115] Generated delinquency_ratio column: count    39987.000000
mean        10.426146
std         17.285322
min          0.000000
25%          0.000000
50%          3.800000
75%         13.200000
max        100.000000
Name: delinquency_ratio, dtype: float64
[2024-11-11 13:52:32,452] INFO: data_cleaning : 128] Generated avg_dpd_per_delinquency column: count    39987.000000
mean         3.304136
std          2.902968
min          0.000000
25%          0.000000
50%          4.300000
75%          5.800000
max         10.000000
Name: avg_dpd_per_delinquency, dtype: float64
[2024-11-11 13:52:32,460] INFO: data_cleaning : 42] Removing unnecessary columns...
[2024-11-11 13:52:32,464] INFO: data_cleaning : 44] Columns removed successfully.
[2024-11-11 13:52:32,466] INFO: data_cleaning : 42] Removing unnecessary columns...
[2024-11-11 13:52:32,468] INFO: data_cleaning : 44] Columns removed successfully.
[2024-11-11 13:52:32,469] ERROR: data_cleaning : 71] Dtype mismatch in 'age': Expected int, got int64
[2024-11-11 13:52:32,470] INFO: data_cleaning : 75] Converted column 'age' to int.
[2024-11-11 13:52:32,470] ERROR: data_cleaning : 71] Dtype mismatch in 'loan_tenure_months': Expected int, got int64
[2024-11-11 13:52:32,471] INFO: data_cleaning : 75] Converted column 'loan_tenure_months' to int.
[2024-11-11 13:52:32,472] ERROR: data_cleaning : 71] Dtype mismatch in 'number_of_open_accounts': Expected int, got int64
[2024-11-11 13:52:32,473] INFO: data_cleaning : 75] Converted column 'number_of_open_accounts' to int.
[2024-11-11 13:52:32,474] ERROR: data_cleaning : 71] Dtype mismatch in 'credit_utilization_ratio': Expected int, got int64
[2024-11-11 13:52:32,475] INFO: data_cleaning : 75] Converted column 'credit_utilization_ratio' to int.
[2024-11-11 13:52:32,476] INFO: data_cleaning : 80] Schema validation successful: Columns and dtypes match.
[2024-11-11 13:52:32,477] ERROR: data_cleaning : 71] Dtype mismatch in 'age': Expected int, got int64
[2024-11-11 13:52:32,478] INFO: data_cleaning : 75] Converted column 'age' to int.
[2024-11-11 13:52:32,479] ERROR: data_cleaning : 71] Dtype mismatch in 'loan_tenure_months': Expected int, got int64
[2024-11-11 13:52:32,479] INFO: data_cleaning : 75] Converted column 'loan_tenure_months' to int.
[2024-11-11 13:52:32,480] ERROR: data_cleaning : 71] Dtype mismatch in 'number_of_open_accounts': Expected int, got int64
[2024-11-11 13:52:32,481] INFO: data_cleaning : 75] Converted column 'number_of_open_accounts' to int.
[2024-11-11 13:52:32,481] ERROR: data_cleaning : 71] Dtype mismatch in 'credit_utilization_ratio': Expected int, got int64
[2024-11-11 13:52:32,482] INFO: data_cleaning : 75] Converted column 'credit_utilization_ratio' to int.
[2024-11-11 13:52:32,482] INFO: data_cleaning : 80] Schema validation successful: Columns and dtypes match.
[2024-11-11 13:52:32,579] INFO: data_cleaning : 188] Data cleaning process completed successfully.
[2024-11-11 13:52:32,585] INFO: main : 39] >>>>>>>>>>>Completed Data Cleaning Stage<<<<<<<<<<<<<
[2024-11-11 13:52:32,585] INFO: main : 49] >>>>>>>>>>>Starting Model Trainer Stage<<<<<<<<<<<<<
[2024-11-11 13:52:32,590] INFO: common : 35] Successfully loaded yaml file: config\config.yaml
[2024-11-11 13:52:32,594] INFO: common : 35] Successfully loaded yaml file: params.yaml
[2024-11-11 13:52:32,596] INFO: common : 35] Successfully loaded yaml file: schema.yaml
[2024-11-11 13:52:32,597] INFO: common : 58] Created directory: artifacts
[2024-11-11 13:52:32,598] INFO: common : 58] Created directory: artifacts/model_training
[2024-11-11 13:52:32,599] INFO: common : 155] Loading numpy array from artifacts\data_cleaning\train_data.arr
[2024-11-11 13:52:32,611] INFO: common : 155] Loading numpy array from artifacts\data_cleaning\test_data.arr
[2024-11-11 14:16:05,353] INFO: main : 51] >>>>>>>>>>>Completed Model Trainer Stage<<<<<<<<<<<<<
[2024-11-11 14:28:52,836] INFO: __init__ : 26] Credit Risk Model Building Started
[2024-11-11 14:29:02,082] INFO: _client : 1038] HTTP Request: GET https://dagshub.com/api/v1/user "HTTP/1.1 200 OK"
[2024-11-11 14:29:02,093] INFO: helpers : 107] Accessing as Ambigapathi-V
[2024-11-11 14:29:03,102] INFO: _client : 1038] HTTP Request: GET https://dagshub.com/api/v1/repos/Ambigapathi-V/credict-Risk-Model "HTTP/1.1 200 OK"
[2024-11-11 14:29:03,109] INFO: helpers : 107] Initialized MLflow to track repo "Ambigapathi-V/credict-Risk-Model"
[2024-11-11 14:29:03,110] INFO: helpers : 107] Repository Ambigapathi-V/credict-Risk-Model initialized!
[2024-11-11 14:29:03,110] INFO: main : 13] >>>>>>>>>>>Starting Data Ingestion Stage<<<<<<<<<<<<<
[2024-11-11 14:29:03,118] INFO: common : 35] Successfully loaded yaml file: config\config.yaml
[2024-11-11 14:29:03,123] INFO: common : 35] Successfully loaded yaml file: params.yaml
[2024-11-11 14:29:03,128] INFO: common : 35] Successfully loaded yaml file: schema.yaml
[2024-11-11 14:29:03,129] INFO: common : 58] Created directory: artifacts
[2024-11-11 14:29:03,129] INFO: common : 58] Created directory: artifacts/data_ingestion
[2024-11-11 14:29:03,130] INFO: data_ingestion : 17] Loading customers data...
[2024-11-11 14:29:03,267] INFO: common : 103] Successfully loaded DataFrame from: data\customers.csv
[2024-11-11 14:29:03,267] INFO: data_ingestion : 20] Loading loans data...
[2024-11-11 14:29:03,431] INFO: common : 103] Successfully loaded DataFrame from: data\loans.csv
[2024-11-11 14:29:03,431] INFO: data_ingestion : 23] Loading bureau data...
[2024-11-11 14:29:03,485] INFO: common : 103] Successfully loaded DataFrame from: data\bureau_data.csv
[2024-11-11 14:29:03,485] INFO: data_ingestion : 26] The Shape of customers data: (50000, 12)
[2024-11-11 14:29:03,485] INFO: data_ingestion : 27] The Shape of loans data: (50000, 15)
[2024-11-11 14:29:03,485] INFO: data_ingestion : 28] The Shape of bureau data: (50000, 8)
[2024-11-11 14:29:04,135] INFO: common : 121] Successfully saved DataFrame to: artifacts\data_ingestion\data.csv
[2024-11-11 14:29:04,146] INFO: main : 15] >>>>>>>>>>>Completed Data Ingestion Stage<<<<<<<<<<<<<
[2024-11-11 14:29:04,146] INFO: main : 25] >>>>>>>>>>>Starting Data Pre-Processing Stage<<<<<<<<<<<<<
[2024-11-11 14:29:04,152] INFO: common : 35] Successfully loaded yaml file: config\config.yaml
[2024-11-11 14:29:04,156] INFO: common : 35] Successfully loaded yaml file: params.yaml
[2024-11-11 14:29:04,160] INFO: common : 35] Successfully loaded yaml file: schema.yaml
[2024-11-11 14:29:04,161] INFO: common : 58] Created directory: artifacts
[2024-11-11 14:29:04,162] INFO: common : 58] Created directory: artifacts/data_preprocessing
[2024-11-11 14:29:04,424] INFO: common : 103] Successfully loaded DataFrame from: artifacts\data_ingestion\data.csv
[2024-11-11 14:29:04,440] INFO: data_preprocessing : 26] The Valure counts for 'default' column: default
0    45703
1     4297
Name: count, dtype: int64
[2024-11-11 14:29:04,442] INFO: data_preprocessing : 42] No missing values found in column 'cust_id'
[2024-11-11 14:29:04,442] INFO: data_preprocessing : 42] No missing values found in column 'age'
[2024-11-11 14:29:04,451] INFO: data_preprocessing : 42] No missing values found in column 'gender'
[2024-11-11 14:29:04,455] INFO: data_preprocessing : 42] No missing values found in column 'marital_status'
[2024-11-11 14:29:04,460] INFO: data_preprocessing : 42] No missing values found in column 'employment_status'
[2024-11-11 14:29:04,461] INFO: data_preprocessing : 42] No missing values found in column 'income'
[2024-11-11 14:29:04,462] INFO: data_preprocessing : 42] No missing values found in column 'number_of_dependants'
[2024-11-11 14:29:04,466] WARNING: data_preprocessing : 33] Missing values found in column 'residence_type', replacing with 'Unknown'
[2024-11-11 14:29:04,475] INFO: data_preprocessing : 35] Missing values replaced in column 'residence_type' with mode 'Owned'
[2024-11-11 14:29:04,475] INFO: data_preprocessing : 42] No missing values found in column 'years_at_current_address'
[2024-11-11 14:29:04,484] INFO: data_preprocessing : 42] No missing values found in column 'city'
[2024-11-11 14:29:04,490] INFO: data_preprocessing : 42] No missing values found in column 'state'
[2024-11-11 14:29:04,492] INFO: data_preprocessing : 42] No missing values found in column 'zipcode'
[2024-11-11 14:29:04,493] INFO: data_preprocessing : 42] No missing values found in column 'loan_id'
[2024-11-11 14:29:04,499] INFO: data_preprocessing : 42] No missing values found in column 'loan_purpose'
[2024-11-11 14:29:04,503] INFO: data_preprocessing : 42] No missing values found in column 'loan_type'
[2024-11-11 14:29:04,503] INFO: data_preprocessing : 42] No missing values found in column 'sanction_amount'
[2024-11-11 14:29:04,505] INFO: data_preprocessing : 42] No missing values found in column 'loan_amount'
[2024-11-11 14:29:04,506] INFO: data_preprocessing : 42] No missing values found in column 'processing_fee'
[2024-11-11 14:29:04,506] INFO: data_preprocessing : 42] No missing values found in column 'gst'
[2024-11-11 14:29:04,507] INFO: data_preprocessing : 42] No missing values found in column 'net_disbursement'
[2024-11-11 14:29:04,508] INFO: data_preprocessing : 42] No missing values found in column 'loan_tenure_months'
[2024-11-11 14:29:04,509] INFO: data_preprocessing : 42] No missing values found in column 'principal_outstanding'
[2024-11-11 14:29:04,510] INFO: data_preprocessing : 42] No missing values found in column 'bank_balance_at_application'
[2024-11-11 14:29:04,514] INFO: data_preprocessing : 42] No missing values found in column 'disbursal_date'
[2024-11-11 14:29:04,517] INFO: data_preprocessing : 42] No missing values found in column 'installment_start_dt'
[2024-11-11 14:29:04,518] INFO: data_preprocessing : 42] No missing values found in column 'default'
[2024-11-11 14:29:04,520] INFO: data_preprocessing : 42] No missing values found in column 'number_of_open_accounts'
[2024-11-11 14:29:04,521] INFO: data_preprocessing : 42] No missing values found in column 'number_of_closed_accounts'
[2024-11-11 14:29:04,522] INFO: data_preprocessing : 42] No missing values found in column 'total_loan_months'
[2024-11-11 14:29:04,523] INFO: data_preprocessing : 42] No missing values found in column 'delinquent_months'
[2024-11-11 14:29:04,525] INFO: data_preprocessing : 42] No missing values found in column 'total_dpd'
[2024-11-11 14:29:04,526] INFO: data_preprocessing : 42] No missing values found in column 'enquiry_count'
[2024-11-11 14:29:04,527] INFO: data_preprocessing : 42] No missing values found in column 'credit_utilization_ratio'
[2024-11-11 14:29:04,617] INFO: data_preprocessing : 51] No duplicate rows found
[2024-11-11 14:29:04,617] INFO: data_preprocessing : 53] Index(['cust_id', 'age', 'gender', 'marital_status', 'employment_status',
       'income', 'number_of_dependants', 'residence_type',
       'years_at_current_address', 'city', 'state', 'zipcode', 'loan_id',
       'loan_purpose', 'loan_type', 'sanction_amount', 'loan_amount',
       'processing_fee', 'gst', 'net_disbursement', 'loan_tenure_months',
       'principal_outstanding', 'bank_balance_at_application',
       'disbursal_date', 'installment_start_dt', 'default',
       'number_of_open_accounts', 'number_of_closed_accounts',
       'total_loan_months', 'delinquent_months', 'total_dpd', 'enquiry_count',
       'credit_utilization_ratio'],
      dtype='object')
[2024-11-11 14:29:05,334] INFO: common : 121] Successfully saved DataFrame to: artifacts\data_preprocessing\preprocessed_data.csv
[2024-11-11 14:29:05,334] INFO: main : 27] >>>>>>>>>>>Completed Data Pre-Processing Stage<<<<<<<<<<<<<
[2024-11-11 14:29:05,334] INFO: main : 37] >>>>>>>>>>>Starting Data Cleaning Stage<<<<<<<<<<<<<
[2024-11-11 14:29:05,346] INFO: common : 35] Successfully loaded yaml file: config\config.yaml
[2024-11-11 14:29:05,350] INFO: common : 35] Successfully loaded yaml file: params.yaml
[2024-11-11 14:29:05,354] INFO: common : 35] Successfully loaded yaml file: schema.yaml
[2024-11-11 14:29:05,355] INFO: common : 58] Created directory: artifacts
[2024-11-11 14:29:05,357] INFO: common : 58] Created directory: artifacts/data_cleaning
[2024-11-11 14:29:05,645] INFO: common : 103] Successfully loaded DataFrame from: artifacts\data_preprocessing\preprocessed_data.csv
[2024-11-11 14:29:05,645] INFO: data_cleaning : 32] Initiating train test split...
[2024-11-11 14:29:05,681] INFO: data_cleaning : 34] Train test split completed successfully.
[2024-11-11 14:29:05,681] INFO: data_cleaning : 88] Applying business rules...
[2024-11-11 14:29:05,694] INFO: data_cleaning : 92] After applying Processing Fee rule, train_df: (39987, 33), test_df: (9998, 33)
[2024-11-11 14:29:05,699] INFO: data_cleaning : 96] GST Violations in train data: 0 records
[2024-11-11 14:29:05,700] INFO: data_cleaning : 100] Net Disbursement Violations in train data: 0 records
[2024-11-11 14:29:05,719] INFO: data_cleaning : 105] Fixed loan_purpose column: loan_purpose
Personal     14031
Home         12003
Auto          7947
Education     6006
Name: count, dtype: int64
[2024-11-11 14:29:05,722] INFO: data_cleaning : 110] Generated loan_to_income column
[2024-11-11 14:29:05,736] INFO: data_cleaning : 115] Generated delinquency_ratio column: count    39987.000000
mean        10.426146
std         17.285322
min          0.000000
25%          0.000000
50%          3.800000
75%         13.200000
max        100.000000
Name: delinquency_ratio, dtype: float64
[2024-11-11 14:29:05,757] INFO: data_cleaning : 128] Generated avg_dpd_per_delinquency column: count    39987.000000
mean         3.304136
std          2.902968
min          0.000000
25%          0.000000
50%          4.300000
75%          5.800000
max         10.000000
Name: avg_dpd_per_delinquency, dtype: float64
[2024-11-11 14:29:05,757] INFO: data_cleaning : 42] Removing unnecessary columns...
[2024-11-11 14:29:05,768] INFO: data_cleaning : 44] Columns removed successfully.
[2024-11-11 14:29:05,768] INFO: data_cleaning : 42] Removing unnecessary columns...
[2024-11-11 14:29:05,768] INFO: data_cleaning : 44] Columns removed successfully.
[2024-11-11 14:29:05,768] ERROR: data_cleaning : 71] Dtype mismatch in 'age': Expected int, got int64
[2024-11-11 14:29:05,768] INFO: data_cleaning : 75] Converted column 'age' to int.
[2024-11-11 14:29:05,783] ERROR: data_cleaning : 71] Dtype mismatch in 'loan_tenure_months': Expected int, got int64
[2024-11-11 14:29:05,788] INFO: data_cleaning : 75] Converted column 'loan_tenure_months' to int.
[2024-11-11 14:29:05,788] ERROR: data_cleaning : 71] Dtype mismatch in 'number_of_open_accounts': Expected int, got int64
[2024-11-11 14:29:05,788] INFO: data_cleaning : 75] Converted column 'number_of_open_accounts' to int.
[2024-11-11 14:29:05,788] ERROR: data_cleaning : 71] Dtype mismatch in 'credit_utilization_ratio': Expected int, got int64
[2024-11-11 14:29:05,788] INFO: data_cleaning : 75] Converted column 'credit_utilization_ratio' to int.
[2024-11-11 14:29:05,788] INFO: data_cleaning : 80] Schema validation successful: Columns and dtypes match.
[2024-11-11 14:29:05,788] ERROR: data_cleaning : 71] Dtype mismatch in 'age': Expected int, got int64
[2024-11-11 14:29:05,788] INFO: data_cleaning : 75] Converted column 'age' to int.
[2024-11-11 14:29:05,788] ERROR: data_cleaning : 71] Dtype mismatch in 'loan_tenure_months': Expected int, got int64
[2024-11-11 14:29:05,788] INFO: data_cleaning : 75] Converted column 'loan_tenure_months' to int.
[2024-11-11 14:29:05,799] ERROR: data_cleaning : 71] Dtype mismatch in 'number_of_open_accounts': Expected int, got int64
[2024-11-11 14:29:05,800] INFO: data_cleaning : 75] Converted column 'number_of_open_accounts' to int.
[2024-11-11 14:29:05,801] ERROR: data_cleaning : 71] Dtype mismatch in 'credit_utilization_ratio': Expected int, got int64
[2024-11-11 14:29:05,802] INFO: data_cleaning : 75] Converted column 'credit_utilization_ratio' to int.
[2024-11-11 14:29:05,803] INFO: data_cleaning : 80] Schema validation successful: Columns and dtypes match.
[2024-11-11 14:29:05,947] INFO: data_cleaning : 188] Data cleaning process completed successfully.
[2024-11-11 14:29:05,953] INFO: main : 39] >>>>>>>>>>>Completed Data Cleaning Stage<<<<<<<<<<<<<
[2024-11-11 14:29:05,955] INFO: main : 49] >>>>>>>>>>>Starting Model Trainer Stage<<<<<<<<<<<<<
[2024-11-11 14:29:05,961] INFO: common : 35] Successfully loaded yaml file: config\config.yaml
[2024-11-11 14:29:05,964] INFO: common : 35] Successfully loaded yaml file: params.yaml
[2024-11-11 14:29:05,968] INFO: common : 35] Successfully loaded yaml file: schema.yaml
[2024-11-11 14:29:05,971] INFO: common : 58] Created directory: artifacts
[2024-11-11 14:29:05,972] INFO: common : 58] Created directory: artifacts/model_training
[2024-11-11 14:29:05,972] INFO: common : 155] Loading numpy array from artifacts\data_cleaning\train_data.arr
[2024-11-11 14:29:05,985] INFO: common : 155] Loading numpy array from artifacts\data_cleaning\test_data.arr
[2024-11-11 14:52:19,284] INFO: main : 51] >>>>>>>>>>>Completed Model Trainer Stage<<<<<<<<<<<<<
